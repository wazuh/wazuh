<?xml version="1.0" encoding="UTF-8" standalone="no"?><xccdf:Benchmark xmlns:xccdf="http://checklists.nist.gov/xccdf/1.1" xmlns="http://checklists.nist.gov/xccdf/1.1" xmlns:ecl="http://cisecurity.org/check" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="cis_apple_osx_10.6_benchmark" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.1 ../misc/xsd/xccdf-1.1.4.xsd http://cisecurity.org/check ../misc/xsd/ecl.xsd">
    <xccdf:status date="2011-11-23">accepted</xccdf:status>
    <xccdf:title>CIS Apple OSX 10.6 Benchmark</xccdf:title>
    <xccdf:description>Mac OS X 10.6 Snow Leopard is a UNIX operating system sold by Apple, Inc. that only runs on Apple Macintosh hardware. Snow Leopard comes with equipped with a number of applications and features. This document provides prescriptive guidance for securing the Snow Leopard operating system, along with its applications and features, in accordance with best practice. However, several optional applications and features offered by Snow Leopard, including iCal, iChat, iTunes, Mail, the Oxford dictionaries, Safari, X11, and printer drivers, will not be discussed.</xccdf:description>
    <xccdf:front-matter>
        <xhtml:p>Mac OS X 10.6 Snow Leopard Level 1 &amp; 2</xhtml:p>
        <xhtml:p>Benchmark by Allan Marcus; XCCDF Conversion by Patrick McCafferty</xhtml:p>
        <xhtml:p>Copyright 2001-2009, The Center for Internet Security<xhtml:a href="http://www.CISecurity.org/">http://www.CISecurity.org/</xhtml:a>
        </xhtml:p>
        <xhtml:p>TERMS OF USE AGREEMENT</xhtml:p>
        <xhtml:p>Background.</xhtml:p>
        <xhtml:p>The Center for Internet Security ("CIS") provides benchmarks, scoring tools, software, data, information, suggestions, ideas, and other services and materials from the CIS website or elsewhere (“Products”) as a public service to Internet users worldwide. Recommendations contained in the Products (“Recommendations”) result from a consensus-building process that involves many security experts and are generally generic in nature. The Recommendations are intended to provide helpful information to organizations attempting to evaluate or improve the security of their networks, systems, and devices. Proper use of the Recommendations requires careful analysis and adaptation to specific user requirements. The Recommendations are not in any way intended to be a “quick fix” for anyone’s information security needs.</xhtml:p>
        <xhtml:p>No Representations, Warranties, or Covenants.</xhtml:p>
        <xhtml:p>CIS makes no representations, warranties, or covenants whatsoever as to (i) the positive or negative effect of the Products or the Recommendations on the operation or the security of any particular network, computer system, network device, software, hardware, or any component of any of the foregoing or (ii) the accuracy, reliability, timeliness, or completeness of the Products or the Recommendations. CIS is providing the Products and the Recommendations “as is” and “as available” without representations, warranties, or covenants of any kind. </xhtml:p>
        <xhtml:p>User Agreements.</xhtml:p>
        <xhtml:p>By using the Products and/or the Recommendations, I and/or my organization (“We”) agree and acknowledge that:</xhtml:p>
        <xhtml:ol>
            <xhtml:li>
                <xhtml:p>No network, system, device, hardware, software, or component can be made fully secure;</xhtml:p>
            </xhtml:li>
            <xhtml:li>
                <xhtml:p>We are using the Products and the Recommendations solely at our own risk;</xhtml:p>
            </xhtml:li>
            <xhtml:li>
                <xhtml:p>We are not compensating CIS to assume any liabilities associated with our use of the Products or the Recommendations, even risks that result from CIS’s negligence or failure to perform;</xhtml:p>
            </xhtml:li>
            <xhtml:li>
                <xhtml:p>We have the sole responsibility to evaluate the risks and benefits of the Products and Recommendations to us and to adapt the Products and the Recommendations to our particular circumstances and requirements;</xhtml:p>
            </xhtml:li>
            <xhtml:li>
                <xhtml:p>Neither CIS, nor any CIS Party (defined below) has any responsibility to make any corrections, updates, upgrades, or bug fixes; or to notify us of the need for any such corrections, updates, upgrades, or bug fixes; and</xhtml:p>
            </xhtml:li>
            <xhtml:li>
                <xhtml:p>Neither CIS nor any CIS Party has or will have any liability to us whatsoever (whether based in contract, tort, strict liability or otherwise) for any direct, indirect, incidental, consequential, or special damages (including without limitation loss of profits, loss of sales, loss of or damage to reputation, loss of customers, loss of software, data, information or emails, loss of privacy, loss of use of any computer or other equipment, business interruption, wasted management or other staff resources or claims of any kind against us from third parties) arising out of or in any way connected with our use of or our inability to use any of the Products or Recommendations (even if CIS has been advised of the possibility of such damages), including without limitation any liability associated with infringement of intellectual property, defects, bugs, errors, omissions, viruses, worms, backdoors, Trojan horses or other harmful items.</xhtml:p>
            </xhtml:li>
        </xhtml:ol>
        <xhtml:p>Grant of Limited Rights.</xhtml:p>
        <xhtml:p>CIS hereby grants each user the following rights, but only so long as the user complies with all of the terms of these Agreed Terms of Use:</xhtml:p>
        <xhtml:ol>
            <xhtml:li>
                <xhtml:p>Except to the extent that we may have received additional authorization pursuant to a written agreement with CIS, each user may download, install and use each of the Products on a single computer;</xhtml:p>
            </xhtml:li>
            <xhtml:li>
                <xhtml:p>Each user may print one or more copies of any Product or any component of a Product that is in a .txt, .pdf, .doc, .mcw, or .rtf format, provided that all such copies are printed in full and are kept intact, including without limitation the text of this Agreed Terms of Use in its entirety.</xhtml:p>
            </xhtml:li>
        </xhtml:ol>
        <xhtml:p>Retention of Intellectual Property Rights; Limitations on Distribution.</xhtml:p>
        <xhtml:p>The Products are protected by copyright and other intellectual property laws and by international treaties. We acknowledge and agree that we are not acquiring title to any intellectual property rights in the Products and that full title and all ownership rights to the Products will remain the exclusive property of CIS or CIS Parties. CIS reserves all rights not expressly granted to users in the preceding section entitled “Grant of limited rights.”</xhtml:p>
        <xhtml:p>Subject to the paragraph entitled “Special Rules” (which includes a waiver, granted to some classes of CIS Members, of certain limitations in this paragraph), and except as we may have otherwise agreed in a written agreement with CIS, we agree that we will not (i) decompile, disassemble, reverse engineer, or otherwise attempt to derive the source code for any software Product that is not already in the form of source code; (ii) distribute, redistribute, encumber, sell, rent, lease, lend, sublicense, or otherwise transfer or exploit rights to any Product or any component of a Product; (iii) post any Product or any component of a Product on any website, bulletin board, FTP server, newsgroup, or other similar mechanism or device, without regard to whether such mechanism or device is internal or external, (iv) remove or alter trademark, logo, copyright or other proprietary notices, legends, symbols or labels in any Product or any component of a Product; (v) remove these
            Agreed Terms of Use from, or alter these Agreed Terms of Use as they appear in, any Product or any component of a Product; (vi) use any Product or any component of a Product with any derivative works based directly on a Product or any component of a Product; (vii) use any Product or any component of a Product with other products or applications that are directly and specifically dependent on such Product or any component for any part of their functionality, or (viii) represent or claim a particular level of compliance with a CIS Benchmark, scoring tool or other Product. We will not facilitate or otherwise aid other individuals or entities in any of the activities listed in this paragraph.</xhtml:p>
        <xhtml:p>We hereby agree to indemnify, defend, and hold CIS and all of its officers, directors, members, contributors, employees, authors, developers, agents, affiliates, licensors, information and service providers, software suppliers, hardware suppliers, and all other persons who aided CIS in the creation, development, or maintenance of the Products or Recommendations (“CIS Parties”) harmless from and against any and all liability, losses, costs, and expenses (including attorneys' fees and court costs) incurred by CIS or any CIS Party in connection with any claim arising out of any violation by us of the preceding paragraph, including without limitation CIS’s right, at our expense, to assume the exclusive defense and control of any matter subject to this indemnification, and in such case, we agree to cooperate with CIS in its defense of such claim. We further agree that all CIS Parties are third-party beneficiaries of our undertakings in these Agreed Terms of Use. </xhtml:p>
        <xhtml:p>Special Rules.</xhtml:p>
        <xhtml:p>The distribution of the NSA Security Recommendations is subject to the terms of the NSA Legal Notice and the terms contained in the NSA Security Recommendations themselves (<xhtml:a href="http://nsa2.www.conxion.com/cisco/notice.htm">http://nsa2.www.conxion.com/cisco/notice.htm</xhtml:a>).</xhtml:p>
        <xhtml:p>CIS has created and will from time to time create, special rules for its members and for other persons and organizations with which CIS has a written contractual relationship. Those special rules will override and supersede these Agreed Terms of Use with respect to the users who are covered by the special rules.</xhtml:p>
        <xhtml:p>CIS hereby grants each CIS Security Consulting or Software Vendor Member and each CIS Organizational User Member, but only so long as such Member remains in good standing with CIS and complies with all of the terms of these Agreed Terms of Use, the right to distribute the Products and Recommendations within such Member’s own organization, whether by manual or electronic means. Each such Member acknowledges and agrees that the foregoing grant is subject to the terms of such Member’s membership arrangement with CIS and may, therefore, be modified or terminated by CIS at any time.</xhtml:p>
        <xhtml:p>Choice of Law; Jurisdiction; Venue</xhtml:p>
        <xhtml:p>We acknowledge and agree that these Agreed Terms of Use will be governed by and construed in accordance with the laws of the State of Maryland, that any action at law or in equity arising out of or relating to these Agreed Terms of Use shall be filed only in the courts located in the State of Maryland, that we hereby consent and submit to the personal jurisdiction of such courts for the purposes of litigating any such action. If any of these Agreed Terms of Use shall be determined to be unlawful, void, or for any reason unenforceable, then such terms shall be deemed severable and shall not affect the validity and enforceability of any remaining provisions.</xhtml:p>
        <xhtml:p>Terms of Use Agreement Version 2.1 - 02/20/04</xhtml:p>
    </xccdf:front-matter>

    <xccdf:version>1.0.0.5</xccdf:version>
    <xccdf:Profile id="level-1">
        <xccdf:title>Level 1 Profile</xccdf:title>
        <xccdf:description>Can be understood and performed by system administrators with any level of security knowledge and experience; Are unlikely to cause an interruption of service to the operating system or the applications that run on it; and can be automatically monitored either by CIS Scoring Tools or by CIS Certified tools available from security software vendors.</xccdf:description>
        <xccdf:select idref="install-mac-os-x-using-mac-os-extended-journaled-disk-format-" selected="true"/>
        <xccdf:select idref="do-not-install-any-unnecessary-packages-" selected="true"/>
        <xccdf:select idref="do-not-transfer-confidential-information-in-setup-assistant" selected="true"/>
        <xccdf:select idref="create-administrator-accounts-with-difficult-to-guess-names" selected="true"/>
        <xccdf:select idref="create-complex-passwords-for-administrator-accounts-" selected="true"/>
        <xccdf:select idref="do-not-enter-a-password-related-hint" selected="true"/>
        <xccdf:select idref="create-an-administrator-account-and-a-standard-account-for-each-administrator-" selected="true"/>
        <xccdf:select idref="create-a-standard-or-managed-account-for-each-non-administrator-" selected="true"/>
        <xccdf:select idref="set-appropriate-parental-controls-for-managed-accounts" selected="true"/>
        <xccdf:select idref="use-password-assistant-to-help-generate-complex-passwords-" selected="true"/>
        <xccdf:select idref="do-not-enable-the-root-account-" selected="true"/>
        <xccdf:select idref="do-not-enable-mac-for-administrative-accounts" selected="true"/>
        <xccdf:select idref="enable-public-folder-password-protection" selected="true"/>
        <xccdf:select idref="sign-out-of-mac-if-signed-in" selected="true"/>
        <xccdf:select idref="change-initial-password-for-the-system-administrator-account-" selected="true"/>
        <xccdf:select idref="disable-automatic-login" selected="true"/>
        <xccdf:select idref="display-login-window-as-name-and-password" selected="true"/>
        <xccdf:select idref="disable-show-password-hints-" selected="true"/>
        <xccdf:select idref="disable-allow-guest-to-log-into-this-computer-" selected="true"/>
        <xccdf:select idref="disable-allow-guests-to-connect-to-shared-folders" selected="true"/>
        <xccdf:select idref="disable-bluetooth-by-using-system-preferences-for-each-user-account-" selected="true"/>
        <xccdf:select idref="disable-bluetooth-internet-connection-sharing" selected="true"/>
        <xccdf:select idref="if-bluetooth-is-used-turn-off-discoverable-when-not-needed" selected="true"/>
        <xccdf:select idref="show-bluetooth-status-in-menu-bar" selected="true"/>
        <xccdf:select idref="enter-correct-time-settings" selected="true"/>
        <xccdf:select idref="set-a-short-inactivity-interval-for-the-screen-saver-" selected="true"/>
        <xccdf:select idref="verify-display-sleep-is-set-to-a-value-larger-than-the-screen-saver" selected="true"/>
        <xccdf:select idref="disable-wake-when-the-modem-detects-a-ring-for-all-power-settings" selected="true"/>
        <xccdf:select idref="disable-wake-for-ethernet-network-administrator-access-for-power-adapter-settings" selected="true"/>
        <xccdf:select idref="do-not-set-any-screen-corner-to-disable-screen-saver" selected="true"/>
        <xccdf:select idref="set-a-screen-corner-to-start-screen-saver" selected="true"/>
        <xccdf:select idref="do-not-set-any-screen-corner-to-sleep-display" selected="true"/>
        <xccdf:select idref="disable-allow-bluetooth-devices-to-wake-this-computer" selected="true"/>
        <xccdf:select idref="disable-airport" selected="true"/>
        <xccdf:select idref="enable-show-airport-status-in-menu-bar" selected="true"/>
        <xccdf:select idref="disable-bluetooth" selected="true"/>
        <xccdf:select idref="only-use-known-printers" selected="true"/>
        <xccdf:select idref="disable-receiving-faxes" selected="true"/>
        <xccdf:select idref="do-not-install-third-party-quicktime-software" selected="true"/>
        <xccdf:select idref="disable-play-movies-automatically" selected="true"/>
        <xccdf:select idref="require-a-password-to-wake-the-computer-from-sleep-or-screen-saver" selected="true"/>
        <xccdf:select idref="disable-automatic-login2" selected="true"/>
        <xccdf:select idref="require-a-password-to-unlock-each-system-preferences-pane" selected="true"/>
        <xccdf:select idref="disable-automatic-logout-after-a-period-of-inactivity" selected="true"/>
        <xccdf:select idref="use-secure-virtual-memory" selected="true"/>
        <xccdf:select idref="disable-remote-control-infrared-receiver" selected="true"/>
        <xccdf:select idref="pair-the-remote-control-infrared-receiver" selected="true"/>
        <xccdf:select idref="enable-firewall-protection" selected="true"/>
        <xccdf:select idref="enable-secure-keyboard-entry" selected="false"/>
        <xccdf:select idref="configure-screen-sharing" selected="true"/>
        <xccdf:select idref="configure-file-sharing" selected="true"/>
        <xccdf:select idref="configure-printer-sharing" selected="true"/>
        <xccdf:select idref="configure-web-sharing" selected="true"/>
        <xccdf:select idref="configure-remote-login" selected="true"/>
        <xccdf:select idref="configure-remote-management" selected="true"/>
        <xccdf:select idref="configure-remote-apple-events" selected="true"/>
        <xccdf:select idref="configure-xgrid-sharing" selected="true"/>
        <xccdf:select idref="configure-internet-sharing" selected="true"/>
        <xccdf:select idref="disable-check-for-updates-for-standard-users" selected="true"/>
        <xccdf:select idref="only-enable-speech-recognition-in-a-secure-environment" selected="true"/>
        <xccdf:select idref="configure-speech-recognition-to-use-a-listening-key" selected="true"/>
        <xccdf:select idref="use-headphones-if-you-enable-text-to-speech-or-turn-text-to-speech-off" selected="true"/>
        <xccdf:select idref="prevent-spotlight-from-searching-all-confidential-folders" selected="true"/>
        <xccdf:select idref="prevent-spotlight-from-searching-backup-folders-or-volumes" selected="true"/>
        <xccdf:select idref="backup-" selected="true"/>
        <xccdf:select idref="securely-erase-files-in-the-finder" selected="true"/>
        <xccdf:select idref="repair-disk-permissions-after-installing-software-or-software-updates-" selected="true"/>
        <xccdf:select idref="create-an-access-warning-for-the-login-window-" selected="true"/>
        <xccdf:select idref="automatically-lock-the-keychain-after-15-minutes-of-inactivity-and-when-sleeping" selected="true"/>
        <xccdf:select idref="disable-users-or-admins-to-login-to-another-users-active-and-locked-session-" selected="true"/>
        <xccdf:select idref="disable-file-sharing" selected="true"/>
        <xccdf:select idref="disable-web-sharing" selected="true"/>
        <xccdf:select idref="disable-remote-apple-events" selected="true"/>
        <xccdf:select idref="do-not-enable-or-use-MobileMe" selected="true"/>
    </xccdf:Profile>
    <xccdf:Profile id="level-2">
        <xccdf:title>Level 2 Profile</xccdf:title>
        <xccdf:description>Prudent security beyond the minimum level. May affect operating system function and are therefore of greatest value to system administrators who have sufficient security knowledge to apply them with consideration to OS functions and software applications running in their particular environments.</xccdf:description>
        <xccdf:select idref="install-mac-os-x-using-mac-os-extended-journaled-disk-format-" selected="true"/>
        <xccdf:select idref="do-not-install-any-unnecessary-packages-" selected="true"/>
        <xccdf:select idref="do-not-transfer-confidential-information-in-setup-assistant" selected="true"/>
        <xccdf:select idref="create-administrator-accounts-with-difficult-to-guess-names" selected="true"/>
        <xccdf:select idref="create-complex-passwords-for-administrator-accounts-" selected="true"/>
        <xccdf:select idref="do-not-enter-a-password-related-hint" selected="true"/>
        <xccdf:select idref="create-an-administrator-account-and-a-standard-account-for-each-administrator-" selected="true"/>
        <xccdf:select idref="create-a-standard-or-managed-account-for-each-non-administrator-" selected="true"/>
        <xccdf:select idref="set-appropriate-parental-controls-for-managed-accounts" selected="true"/>
        <xccdf:select idref="use-password-assistant-to-help-generate-complex-passwords-" selected="true"/>
        <xccdf:select idref="do-not-enable-the-root-account-" selected="true"/>
        <xccdf:select idref="do-not-enable-mac-for-administrative-accounts" selected="true"/>
        <xccdf:select idref="enable-public-folder-password-protection" selected="true"/>
        <xccdf:select idref="sign-out-of-mac-if-signed-in" selected="true"/>
        <xccdf:select idref="change-initial-password-for-the-system-administrator-account-" selected="true"/>
        <xccdf:select idref="disable-automatic-login" selected="true"/>
        <xccdf:select idref="display-login-window-as-name-and-password" selected="true"/>
        <xccdf:select idref="disable-show-password-hints-" selected="true"/>
        <xccdf:select idref="disable-allow-guest-to-log-into-this-computer-" selected="true"/>
        <xccdf:select idref="disable-allow-guests-to-connect-to-shared-folders" selected="true"/>
        <xccdf:select idref="disable-bluetooth-by-using-system-preferences-for-each-user-account-" selected="true"/>
        <xccdf:select idref="disable-bluetooth-internet-connection-sharing" selected="true"/>
        <xccdf:select idref="if-bluetooth-is-used-turn-off-discoverable-when-not-needed" selected="true"/>
        <xccdf:select idref="show-bluetooth-status-in-menu-bar" selected="true"/>
        <xccdf:select idref="enter-correct-time-settings" selected="true"/>
        <xccdf:select idref="set-a-short-inactivity-interval-for-the-screen-saver-" selected="true"/>
        <xccdf:select idref="verify-display-sleep-is-set-to-a-value-larger-than-the-screen-saver" selected="true"/>
        <xccdf:select idref="disable-wake-when-the-modem-detects-a-ring-for-all-power-settings" selected="true"/>
        <xccdf:select idref="disable-wake-for-ethernet-network-administrator-access-for-power-adapter-settings" selected="true"/>
        <xccdf:select idref="do-not-set-any-screen-corner-to-disable-screen-saver" selected="true"/>
        <xccdf:select idref="set-a-screen-corner-to-start-screen-saver" selected="true"/>
        <xccdf:select idref="do-not-set-any-screen-corner-to-sleep-display" selected="true"/>
        <xccdf:select idref="disable-allow-bluetooth-devices-to-wake-this-computer" selected="true"/>
        <xccdf:select idref="disable-airport" selected="true"/>
        <xccdf:select idref="enable-show-airport-status-in-menu-bar" selected="true"/>
        <xccdf:select idref="disable-bluetooth" selected="true"/>
        <xccdf:select idref="only-use-known-printers" selected="true"/>
        <xccdf:select idref="disable-receiving-faxes" selected="true"/>
        <xccdf:select idref="do-not-install-third-party-quicktime-software" selected="true"/>
        <xccdf:select idref="disable-play-movies-automatically" selected="true"/>
        <xccdf:select idref="require-a-password-to-wake-the-computer-from-sleep-or-screen-saver" selected="true"/>
        <xccdf:select idref="disable-automatic-login2" selected="true"/>
        <xccdf:select idref="require-a-password-to-unlock-each-system-preferences-pane" selected="true"/>
        <xccdf:select idref="disable-automatic-logout-after-a-period-of-inactivity" selected="true"/>
        <xccdf:select idref="use-secure-virtual-memory" selected="true"/>
        <xccdf:select idref="disable-remote-control-infrared-receiver" selected="true"/>
        <xccdf:select idref="pair-the-remote-control-infrared-receiver" selected="true"/>
        <xccdf:select idref="enable-firewall-protection" selected="true"/>
        <xccdf:select idref="enable-secure-keyboard-entry" selected="true"/>
        <xccdf:select idref="configure-screen-sharing" selected="true"/>
        <xccdf:select idref="configure-file-sharing" selected="true"/>
        <xccdf:select idref="configure-printer-sharing" selected="true"/>
        <xccdf:select idref="configure-web-sharing" selected="true"/>
        <xccdf:select idref="configure-remote-login" selected="true"/>
        <xccdf:select idref="configure-remote-management" selected="true"/>
        <xccdf:select idref="configure-remote-apple-events" selected="true"/>
        <xccdf:select idref="configure-xgrid-sharing" selected="true"/>
        <xccdf:select idref="configure-internet-sharing" selected="true"/>
        <xccdf:select idref="disable-check-for-updates-for-standard-users" selected="true"/>
        <xccdf:select idref="only-enable-speech-recognition-in-a-secure-environment" selected="true"/>
        <xccdf:select idref="configure-speech-recognition-to-use-a-listening-key" selected="true"/>
        <xccdf:select idref="use-headphones-if-you-enable-text-to-speech-or-turn-text-to-speech-off" selected="true"/>
        <xccdf:select idref="prevent-spotlight-from-searching-all-confidential-folders" selected="true"/>
        <xccdf:select idref="prevent-spotlight-from-searching-backup-folders-or-volumes" selected="true"/>
        <xccdf:select idref="backup-" selected="true"/>
        <xccdf:select idref="securely-erase-files-in-the-finder" selected="true"/>
        <xccdf:select idref="repair-disk-permissions-after-installing-software-or-software-updates-" selected="true"/>
        <xccdf:select idref="securely-erase-the-mac-os-x-partition-before-installation-" selected="true"/>
        <xccdf:select idref="do-not-connect-to-the-internet-when-setting-up-a-mac" selected="true"/>
        <xccdf:select idref="update-system-software-using-verified-packages-" selected="true"/>
        <xccdf:select idref="use-an-open-firmware-or-efi-password-" selected="true"/>
        <xccdf:select idref="create-an-access-warning-for-the-login-window-" selected="true"/>
        <xccdf:select idref="create-an-access-warning-for-the-command-line-" selected="true"/>
        <xccdf:select idref="disable-the-isight-camera" selected="true"/>
        <xccdf:select idref="reduce-the-sudo-timeout-period" selected="true"/>
        <xccdf:select idref="remove-unneeded-quicktime-components" selected="true"/>
        <xccdf:select idref="disable-core-dumps" selected="true"/>
        <xccdf:select idref="restrict-sudo-users-to-being-able-to-access-only-required-commands" selected="true"/>
        <xccdf:select idref="securely-configure-ldapv3-access-" selected="true"/>
        <xccdf:select idref="securely-configure-active-directory-access-" selected="true"/>
        <xccdf:select idref="set-a-strong-password-policy" selected="true"/>
        <xccdf:select idref="secure-the-login-keychain" selected="true"/>
        <xccdf:select idref="secure-individual-keychain-items-" selected="true"/>
        <xccdf:select idref="create-specialized-keychains-for-different-purposes-" selected="true"/>
        <xccdf:select idref="use-a-portable-drive-to-store-keychains-" selected="true"/>
        <xccdf:select idref="disable-all-sync-options" selected="true"/>
        <xccdf:select idref="disable-idisk-syncing" selected="true"/>
        <xccdf:select idref="do-not-register-computers-for-synchronization" selected="true"/>
        <xccdf:select idref="disable-the-mac-preference-pane-from-system-preferences" selected="true"/>
        <xccdf:select idref="configure-allow-network-users-to-login-to-this-computer" selected="true"/>
        <xccdf:select idref="disable-enable-fast-user-switching-" selected="true"/>
        <xccdf:select idref="disable-automatic-actions-for-blank-cds-for-each-user-account-" selected="true"/>
        <xccdf:select idref="disable-automatic-actions-for-blank-dvds-for-each-user-account-" selected="true"/>
        <xccdf:select idref="disable-automatic-actions-for-music-cds-for-each-user-account" selected="true"/>
        <xccdf:select idref="disable-automatic-actions-for-picture-cds-for-each-user-account" selected="true"/>
        <xccdf:select idref="disable-automatic-actions-for-video-dvds-for-each-user-account-" selected="true"/>
        <xccdf:select idref="use-an-internal-software-update-server-" selected="true"/>
        <xccdf:select idref="disable-sleeping-the-computer-when-connected-to-power" selected="true"/>
        <xccdf:select idref="create-network-specific-locations" selected="true"/>
        <xccdf:select idref="disable-ipv6" selected="true"/>
        <xccdf:select idref="disable-save-movies-in-disk-cache" selected="true"/>
        <xccdf:select idref="enable-filevault-for-every-account" selected="true"/>
        <xccdf:select idref="change-the-computer-name" selected="true"/>
        <xccdf:select idref="secure-smb" selected="true"/>
        <xccdf:select idref="secure-web-sharing" selected="true"/>
        <xccdf:select idref="secure-remote-login" selected="true"/>
        <xccdf:select idref="completely-disable-sharing-services" selected="true"/>
        <xccdf:select idref="download-important-updates-automatically-" selected="true"/>
        <xccdf:select idref="transfer-installer-packages-from-a-test-bed-computer" selected="true"/>
        <xccdf:select idref="change-sound-input-device-to-line-in" selected="true"/>
        <xccdf:select idref="minimize-input-volume-for-all-inputs" selected="true"/>
        <xccdf:select idref="secure-home-folders" selected="true"/>
        <xccdf:select idref="encrypt-sensitive-files" selected="true"/>
        <xccdf:select idref="securely-erase-partitions" selected="true"/>
        <xccdf:select idref="securely-erase-free-space" selected="true"/>
        <xccdf:select idref="secure-bonjour" selected="true"/>
        <xccdf:select idref="use-an-outbound-network-detection-system" selected="true"/>
        <xccdf:select idref="automatically-lock-the-keychain-after-15-minutes-of-inactivity-and-when-sleeping" selected="true"/>
        <xccdf:select idref="use-an-internal-software-update-mechanism-" selected="true"/>
        <xccdf:select idref="disable-users-or-admins-to-login-to-another-users-active-and-locked-session-" selected="true"/>
        <xccdf:select idref="disable-file-sharing" selected="true"/>
        <xccdf:select idref="disable-web-sharing" selected="true"/>
        <xccdf:select idref="disable-remote-apple-events" selected="true"/>
        <xccdf:select idref="do-not-enable-or-use-MobileMe" selected="true"/>
        <xccdf:select idref="increase-the-retention-time-for-systemlog-and-securelog" selected="true"/>
    </xccdf:Profile>
    <xccdf:Group id="recommendations">
        <xccdf:title>Recommendations</xccdf:title>
	<xccdf:description/>
        <xccdf:Group id="install">
            <xccdf:title>Installation Action Items</xccdf:title>
            <xccdf:description>Security starts when the operating system is installed. There are a number of items to consider when a new system is set up for the first time, or when an existing system is repurposed.</xccdf:description>
            <xccdf:Rule id="securely-erase-the-mac-os-x-partition-before-installation-" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Securely erase the Mac OS X partition before installation </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>One never knows what is on a hard drive when one receives a computer, even new from Apple. Spyware or other malware may be present on a hard drive, so the safest course of action is to erase (reformat) the drive. Using the erase capability of Disk Utility (found on the Mac OS X Install DVD) will only erase the directory structure of disk and leave its contents intact. To make sure everything on the disk is erased, the Secure Erase feature of the Disk Utility must be used.</xhtml:p>
                        <xhtml:p class="bold">Context: System</xhtml:p>
                        <xhtml:p class="bold">Level: 2</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Boot from the Mac OS X Install DVD.<br/>Select a Language.<br/>Select Disk Utility from the Utilities menu.<br/>Select the disk to install Mac OS X on in the left panel.<br/>Select the "Erase" tab.<br/>Click on the Security Option button.<br/>Choose "Zero out data," and then the "OK" button. <br/>Click the "Erase" button.</xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="do-not-connect-to-the-internet-when-setting-up-a-mac" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Do not connect to the Internet when setting up a Mac</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>The internet is where most of the bad stuff is located, so connecting to the internet can expose the Mac to attacks and malware. When setting up a Mac it is a good idea not to connect to the internet until the Mac is secure.</xhtml:p>
                        <xhtml:p class="bold">Context: System</xhtml:p>
                        <xhtml:p class="bold">Level: 2</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>The primary reason to connect to the internet before a Mac is secure is to update the operating system. There are three options to provide additional safety when updating and securing a Mac before connecting it to the internet at large:<br/><br/>1. Install all the necessary updates from local media. <br/>2. Connect the computer directly to a hardware firewall/router with no other computers connected to the firewall/router. Use Software Update to update the computer.<br/>3. Update from a trusted Mac OS X Server's Software Update service on an isolated internal network.</xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="install-mac-os-x-using-mac-os-extended-journaled-disk-format-" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Install Mac OS X using Mac OS Extended Journaled disk format </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>This type of file system is the most compatible and supports all of the built-in security features of Mac OS X.</xhtml:p>
                        <xhtml:p class="bold">Context: System</xhtml:p>
                        <xhtml:p class="bold">Level: 1</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>None</xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="do-not-install-any-unnecessary-packages-" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Do not install any unnecessary packages </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>Unneeded software unnecessarily increases the attack surface of the system.</xhtml:p>
                        <xhtml:p class="bold">Context: System</xhtml:p>
                        <xhtml:p class="bold">Level: 1</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>Use of disk imaging technology, such as Apple System Image Utility (included with Mac OS X Server) or other third party image utilities, is recommended wherever a standard image can be used. Deployment of standard images is beyond the scope of this document, but a list of some imaging technologies is listed in Appendix A.</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>In the "Easy Install on partition_name" step, click "Customize." Deselect any packages, languages, or print drivers that you do not plan on using. Do not install X11 unless the user has a need for it. </xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="remove-any-unnecessary-applications-or-packages-" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Remove and unnecessary Applications or packages </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>Unneeded software unnecessarily increases the attack surface of the system.</xhtml:p>
                        <xhtml:p class="bold">Context: System</xhtml:p>
                        <xhtml:p class="bold">Level: 1</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>Use of disk imaging technology, such as Apple System Image Utility (included with Mac OS X Server) or other third party image utilities, is recommended wherever a standard image can be used. Deployment of standard images is beyond the scope of this document, but a list of some imaging technologies is listed in Appendix A.</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Use the appropriate method recommended by the vendor to remove unneeded software. If there is no simple way to remove all component parts from the Operating System a clean install or re-image may be necessary </xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="do-not-transfer-confidential-information-in-setup-assistant" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Do not transfer confidential information in Setup Assistant</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>The Setup Assistant will prompt the user for name, address, phone number, e-mail address, and other information. If you don't want personal information transferred to Apple, skip this step.</xhtml:p>
                        <xhtml:p class="bold">Context: System</xhtml:p>
                        <xhtml:p class="bold">Level: 1</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>In the Registration Information screen, press Command-Q to quit. Click the "Skip" button to bypass the registration process.</xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="create-administrator-accounts-with-difficult-to-guess-names" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Create administrator accounts with difficult-to-guess names</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>Simple names like "Administrator" or "Admin" are easy to guess, and provide an attacker some information needed to break into a system. Use a difficult-to-guess name for accounts with administration privileges to the Mac</xhtml:p>
                        <xhtml:p class="bold">Context: System</xhtml:p>
                        <xhtml:p class="bold">Level: 1</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>This applies to both the long name and short name, either of which may be used to log in to the computer through various login mechanisms. The short name is likely to have the widest exposure.</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>When creating the first account in the Setup Assistant, use a difficult-to-guess name.</xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="create-complex-passwords-for-administrator-accounts-" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Create complex passwords for administrator accounts </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>Passwords are the primary protection against unauthorized access. Accounts with administrative privileges are the most important to protect. Therefore, using a complex password for these accounts is very important.</xhtml:p>
                        <xhtml:p class="bold">Context: User</xhtml:p>
                        <xhtml:p class="bold">Level: 1</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>If you are color blind you may not be able to determine the quality of the password from the password assistant. However, numeric password quality information may be retrieved by hovering the cursor over the quality meter. <br/><br/>The "pwpolicy" tool can be used to enforce password policies in Mac OS X directory services, but the policies do not apply to administrator-level users.</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Apple provides a Password Assistant in the dialogs used to set password. When setting a password, click on the key icon to the right of the New Password field to display the assistant. Make sure the password for the administrator account shows a quality of green. Make sure the quality meter is about halfway across or more.<br/><br/>Alternatively, use a password that is at least 15 characters, and three of the following four items. Make sure the password does not contain a name or word found in the dictionary. Local passwords should not be reused on other devices for other purposes. Passwords and devices will be compromised, unique passwords reduce the risk.<br/>* Uppercase letter<br/>* Lowercase letter<br/>* Punctuation characters<br/>* Numbers<br/></xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="do-not-enter-a-password-related-hint" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Do not enter a password-related hint</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>A password hint will help you remember your password, but may also help an attacker to guess your password. </xhtml:p>
                        <xhtml:p class="bold">Context: User</xhtml:p>
                        <xhtml:p class="bold">Level: 1</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>Organizations might consider entering an organizational help desk phone number or other text (such as a warning to the user). A help desk number is only appropriate for organizations with trained help desk personnel that are validating user identities for password resets. </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>In the System Preferences: Accounts: Change Password dialog, enter the appropriate hint.</xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="update-system-software-using-verified-packages-" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Update system software using verified packages </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>When manually downloading update packages from Apple (or other locations), always verify that what you downloaded is what you think it is. On the Apple download page there should be an SHA-1 Digest for the download. This long series of numbers and letters that is the result of a computer algorithm that is unique to the package download. <br/><br/>Also, when looking at Apple's Web page to read the SHA-1 Digest, make sure you are visiting Apple’s site using HTTPS. </xhtml:p>
                        <xhtml:p class="bold">Context: System</xhtml:p>
                        <xhtml:p class="bold">Level: 2</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>Apple has a good explanation of how to use the SHA-1 Digest at<br/>http://docs.info.apple.com/article.html?artnum=75510 <br/>2.2) Hardware and Core Mac OS X Action Items<br/>The easiest way to break into a Mac is with physical access to the computer. Restricting physical access is a very important step when protecting a computer.</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>See http://docs.info.apple.com/article.html?artnum=75510</xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="core">
            <xccdf:title>Hardware and Core Mac OS X Action Items</xccdf:title>
            <xccdf:description>The easiest way to break into a Mac is with physical access to the computer. Restricting physical access is a very important step when protecting a computer.</xccdf:description>
            <xccdf:Rule id="use-an-open-firmware-or-efi-password-" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Use an EFI password </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>EFI (Intel) is the Mac equivalent of the BIOS on a PC. The Basic Input/Output System (BIOS) is a small piece of computer code embedded in the computer that lets the computer boot up. There are a few options that can be set in EFI, and should only be set by experienced administrators.<br/><br/>One of the most commonly used options is a password. The firmware password will not prevent the computer from booting, but is required when booting from different media, such as an external drive, a CD or DVD disc, or a NetBoot volume, which can protect a computer from someone booting and quickly changing an account password with an install disk.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Context: System</xhtml:p>
                        <xhtml:p class="bold">Level: 2</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Open the Firmware Password Utility and verify the "Require password to change firmware settings" checkbox is checked.</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>When a firmware password is present, it must also be entered to:<br/>* boot into single user mode, which provides root access by default<br/>* boot into verbose mode<br/>* start up in Target Disk Mode to access the internal hard disk (and on some models, the optical drive) from another computer.<br/><br/>A firmware password may disable FireWire DMA access, but this appears to be undocumented.<br/>
                            <br/>http://docs.info.apple.com/article.html?artnum=106482 <br/>https://support.apple.com/kb/ht1352 </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
            </xccdf:Rule>
            <xccdf:Rule id="create-an-access-warning-for-the-login-window-" role="full" selected="false" weight="1.0">
                <xccdf:title>Create an access warning for the login window </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>Displaying an access warning that informs the user that the system is reserved for authorized use only, and that the use of the system may be monitored, may reduce a casual attacker’s tendency to target the system. Access warnings may also aid in the prosecution of an attacker by evincing the attacker’s knowledge of the system’s private status, acceptable use policy, and authorization requirements. </xhtml:p>
                        <xhtml:p class="bold">Context: System</xhtml:p>
                        <xhtml:p class="bold">Level: 1</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Run the following command to see the login window text:<br/>defaults read /Library/Preferences/com.apple.loginwindow.plist LoginwindowText</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>To add text with elevated privileges:<br/><br/>sudo defaults write /Library/Preferences/com.apple.loginwindow \<br/>LoginwindowText "your text here"<br/><br/>To remove the text with elevated privileges:<br/>
                        <br/>sudo defaults delete /Library/Preferences/com.apple.loginwindow LoginwindowText</xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="command test «defaults read /Library/Preferences/com.apple.loginwindow LoginwindowText»">
                            <ecl:command>defaults read /Library/Preferences/com.apple.loginwindow
                                LoginwindowText</ecl:command>
                            <ecl:line-selection op="pm" value=".+"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="create-an-access-warning-for-the-command-line-" role="full" selected="false" weight="1.0">
                <xccdf:title>Create an access warning for the command line </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>There are two common ways to login to a Mac using the command line, bypassing the GUI login window: FTP and SSH. Displaying an access warning that informs the user that the system is reserved for authorized use only, and that the use of the system may be monitored, may reduce a casual attacker’s tendency to target the system. Access warnings may also aid in the prosecution of an attacker by evincing the attacker’s knowledge of the system’s private status, acceptable use policy, and authorization requirements.</xhtml:p>
                        <xhtml:p class="bold">Context: System</xhtml:p>
                        <xhtml:p class="bold">Level: 2</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Run the following commands to determine if the banner text is set:<br/><br/>cat /etc/sshd_config | grep Banner<br/><br/>If there is a valid entry for Banner, cat the path show and view the results.</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>see man sshd_config</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Create a text file with the login text. This is commonly done in /etc/motd for SSH and /etc/ftpwelcome for FTP.<br/><br/>For SSH, edit /etc/sshd_config (using sudo) and add the line:<br/><br/>Banner /etc/banner<br/><br/>Where /etc/banner is the path to your login banner text file.</xhtml:p>
                </xccdf:fixtext>
                <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Set Banner for SSHD server">
                            <ecl:command>egrep '^Banner[[:space:]]+[A-Za-z0-9/]+$' /etc/sshd_config</ecl:command>
                            <ecl:line-selection op="pm" value="^.+$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command comment="Banner file exists" success="pass">
                                <ecl:command>test -f `egrep '^Banner[[:space:]]+[A-Za-z0-9/]+$' /etc/sshd_config | awk {'print $2'}`</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="turn-on-file-extensions-" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Turn on file extensions</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>By making the file extension visible, you can determine the type of file it is and the application it is associated with. It is fairly simple for malicious code or unapproved software to appear as if it is something other than what it is. File Types should be visible</xhtml:p>
                        <xhtml:p class="bold">Context: System</xhtml:p>
                        <xhtml:p class="bold">Level: 1</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>1. Open Finder.<br/> 2. From the Finder menu, select Preferences.<br/> 3. Click Advanced and select the “Show all filename extensions” checkbox.<br/>
                    </xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="disable-bluetooth" role="full" selected="false" weight="1.0">
                <xccdf:title>Disable Bluetooth</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>Bluetooth is a very useful technology, but it also can expose a Mac to certain risks, if Bluetooth is not allowed in your environment use these settings. Bluetooth can be disabled via software or hardware. Temporary disablement via System Preferences will be discussed in Section 2.4.10.4.<br/><br/>To completely secure Bluetooth, the Bluetooth hardware should be removed from the Mac. Alternatively, and somewhat less secure: <br/>* remove the Bluetooth extensions (drivers) from the operating system<br/>* disable the Bluetooth process using launchd<br/>* use MCX settings to disable Bluetooth</xhtml:p>
                        <xhtml:p class="bold">Context: System</xhtml:p>
                        <xhtml:p class="bold">Level: 2</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Run the following command to determine if Bluetooth is present. Note: This command cannot distinguish between software or hardware disabled Bluetooth.<br/><br/>system_profiler SPBluetoothDataType</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>Removing the Bluetooth hardware may void the Mac's warranty and should only be done by an authorized Apple technician. Software disablement will not completely secure the Bluetooth as the software can be reinstalled.</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>1. Have an authorized Apple technician remove the Bluetooth hardware from the Mac.<br/><br/>2. Remove the following files from /System/Library/Extensions and reboot the Mac:<br/><br/>IOBluetoothFamily.kext <br/>IOBluetoothHIDDriver.kext<br/><br/>3. Run sudo launctl unload -w /System/Library/LaunchDaemons/com.apple.blued.plist<br/><br/>4. Use a Mac OS X Server or Apple's free WorkGroup Manager (part of the Server Administration Tools) to disable Bluetooth.</xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Check System Profiler for 'SPBluetoothDataType'">
                            <ecl:command>system_profiler SPBluetoothDataType</ecl:command>
                            <ecl:line-selection op="pm" value="^.*Bluetooth Power: On.*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="disable-the-isight-camera" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Disable the iSight camera</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>The iSight camera built-in to many Macs can allow a remote attacker to watch and view potentially sensitive information. External iSight cameras (and other brands too) should be disconnected when not in use. Internal iSight cameras should be disconnected if required by the organization. If video conferencing is not required in your organization the camera should be covered and the software should be disabled. Vulnerabilities have been identified with software that have taken control of built-in cameras and if there is not a business need the future vulnerabilities have already been mitigated if disabled.</xhtml:p>
                        <xhtml:p class="bold">Context: System</xhtml:p>
                        <xhtml:p class="bold">Level: 2</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Run the following command to determine if an iSight is present.<br/><br/>system_profiler SPUSBDataType | grep iSight</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Have an authorized Apple technician disconnect the internal iSight camera. Alternatively, but less secure, place opaque tape or label over the camera lens. Consider removing or altering the following file to disable iSight capabilities:<br/> /System/Library/Extensions/Apple_iSight.kext </xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="reduce-the-sudo-timeout-period" role="full" selected="false" weight="1.0">
                <xccdf:title>Reduce the sudo timeout period</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>The sudo command is used by a user to elevate privileges. By default, privileges will remain escalated for 5 minutes after the sudo command is completed. During this time, the sudo command can be executed again without authentication. This window of opportunity should be eliminated.</xhtml:p>
                        <xhtml:p class="bold">Context: System</xhtml:p>
                        <xhtml:p class="bold">Level: 2</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Run the following command:<br/><br/>sudo cat /etc/sudoers | grep timestamp<br/><br/>and make sure the result is:<br/><br/>Defaults timestamp_timeout=0</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Execute the following command in Terminal. This command required knowledge of the "vi" editor.<br/><br/>sudo visudo<br/><br/>In the "# Defaults specification" section, add the line: <br/>Defaults timestamp_timeout=0</xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:file-content check="all" comment="check «/etc/sudoers»">
                            <ecl:path>/etc/sudoers</ecl:path>
                            <ecl:line-selection op="pm" value="^Defaults\s+timestamp_timeout=0$"/>
                        </ecl:file-content>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="remove-unneeded-quicktime-components" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Remove unneeded QuickTime components</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>QuickTime provides a modular architecture that allows for components to increase the number of media types QuickTime understands. These add-in components can be used in whatever context QuickTime runs.<br/><br/>While these components can be used in local applications, the QuickTime plug-in allows browsers (including any that are based on WebKit) to play embedded content in the Web pages. If a particular QuickTime component, such as a codec, is not needed then consider removing it. This reduces the kind and number of media that could be used as vectors for attack in a web environment. </xhtml:p>
                        <xhtml:p class="bold">Context: System and User</xhtml:p>
                        <xhtml:p class="bold">Level: 2</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>Opening media types in local applications could be an attack vector for documents attached to e-mail or stored/transferred in other ways. Viewing the same media in a Web browser may be considered riskier since the data could be coming from an untrusted source and will likely be interpreted immediately by the browser.<br/><br/>Some optional QuickTime components, such as additional codecs, can be obtained through the QuickTime System Preferences pane. It links to this Web page:<br/><br/>http://www.apple.com/quicktime/resources/components.html</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>QuickTime components are stored in <xhtml:code>/Library/QuickTime</xhtml:code> and <xhtml:code>~/Library/QuickTime.</xhtml:code>; Other components are stored in the system domain at <xhtml:code>/System/Library/QuickTime,</xhtml:code> where removal is not recommended.<br/><br/>Additional Internet plug-ins for browsers, which may or may not have a relationship with QuickTime, may be found in the local domain at <xhtml:code>/Library/Internet Plug-ins</xhtml:code> as well as in the user domain at <xhtml:code>~/Library/Internet Plug-ins.</xhtml:code> Any unneeded Internet plug-ins may be removed.</xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="disable-core-dumps" role="full" selected="false" weight="1.0">
                <xccdf:title>Disable Core Dumps</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>When an application encounters a runtime error the operating system has the opportunity to dump the application's state, including memory contents, to disk. This operation is called a core dump. It is possible for a core dump to contain sensitive information, including passwords. Therefore it is recommended that core dumps be disabled in high security scenarios.</xhtml:p>
                        <xhtml:p class="bold">Context: System and User</xhtml:p>
                        <xhtml:p class="bold">Level: 2</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Run the following command:<br/><br/>launchctl limit core</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>For more information, execute "man core"<br/><br/>2.3)</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Run the following command:<br/><br/>launchctl limit core 0<br/></xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="command test «launchctl limit core»">
                            <ecl:command>launchctl limit core</ecl:command>
                            <ecl:line-selection op="pm" value=".*core.*0.*0.*"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="account">
            <xccdf:title>Account Configuration Action Items</xccdf:title>
            <xccdf:description>
                <xhtml:p>Account management is critical to computer security. Accounts are comprised of account information and, for some account types, a home directory for storage of settings and files.</xhtml:p>
                <xhtml:p>The account information in Snow Leopard is stored in the new DSLocal store, which replaces the legacy NetInfo service used in previous versions of Mac OS X. The DSLocal store is a filesystem hierarchy of individual property list (plist) files, rather than a database (as in NetInfo) or a set of flat files (as might be seen in other Unix systems).</xhtml:p>
                <xhtml:p>Mac OS X provides for a number of different types of accounts, each with different levels of default privileges. Each account type needs to be secured.</xhtml:p>
                <xhtml:p>
                    <xhtml:ul>
                        <xhtml:li>An administrator account has full privileges, largely because of its membership in the local admin group. Members of this group are granted access to portions of the file system outside of its own home folder, especially in the system domain (such as ―/Library‖). By default, members of ―admin‖ also have sudo rights. An administrator account is sometimes referred to as a privileged account.</xhtml:li>
                        <xhtml:li>A standard account has a medium level of privileges, generally providing access only to only its own settings, folders, and files.</xhtml:li>
                        <xhtml:li>A managed account is equivalent to a standard account with the addition of Parental Controls or Managed Client (MCX) settings applied to it. While a managed account can log in and store data or settings in its home directory, further restrictions can be enforced on it. These restrictions are defined in Accounts System Preferences for Parental Controls.</xhtml:li>
                        <xhtml:li>A sharing only account is roughly equivalent to a standard account. Its shell is set to /usr/bin/false and it does not have login access. It has no home directory (which is set to /dev/null). It can have access to some other portions of the file system, such as temporary space, as a member of the staff group. A sharing only account is meant solely for access to the local system’s sharing services, as seen in the Sharing System Preferences, as well as any other sharing features enabled by applications that use the Identity Services system.</xhtml:li>
                        <xhtml:li>The guest account has the least privileges (and is new in Snow Leopard). It is meant for temporary access to the system. The guest account is similar to a standard account whose settings are purged between logins. It requires no password.</xhtml:li>
                    </xhtml:ul>
                </xhtml:p>
                <xhtml:p>More information on the different types of accounts is available in Apple’s Identity Services documentation at: </xhtml:p>
                <xhtml:p>http://developer.apple.com/documentation/Networking/Conceptual/IdentityServices_ProgGuide/architecture/chapter_2_section_4.html#/apple_ref/doc/uid/TP40004490-CH3-DontLinkElementID_8</xhtml:p>
                <xhtml:p>Each user should have an account to ensure that their settings and documents are kept separate. This can provide compartmentalization, so that compromise of one does not necessarily lead to another. Even with kids on the family computer, each user should have their own account, which can make it easier to apply individual controls (such as enforced time limits or applications that can be launched) to them.</xhtml:p>
                <xhtml:p>Each user should try to run with the least privileges necessary for whatever they are doing on the computer. This also provides compartmentalization, since users with lower privileges have less access system-wide to settings and the file system.</xhtml:p>
                <xhtml:p>Never have shared accounts, and take special note of how the guest account is similar to one.</xhtml:p>
                <xhtml:p>Managed accounts are subject to Parental Controls or MCX settings, which both use the same underlying account control mechanisms in the operating system. The settings can be applied locally or remotely. Parental Controls can be shared between Snow Leopard-based computers (see the Parental Controls System Preferences pane). MCX settings can be applied from a directory service with Apple’s schema additions.</xhtml:p>
                <xhtml:p>It is important for some environments to note that Snow Leopard enables a local Kerberos Key Distribution Center (KDC) for the accounts specific to each computer. This is used with the new Identity Services system in Snow Leopard to support sharing. For more on Identity Services, identities, and their Access Control Lists (ACLs) see:</xhtml:p>
                <xhtml:p>http://developer.apple.com/documentation/Networking/Conceptual/IdentityServices_ProgGuide/Introduction/chapter_1_section_1.html</xhtml:p>
            </xccdf:description>
            <xccdf:Rule id="create-an-administrator-account-and-a-standard-account-for-each-administrator-" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Create an administrator account and a standard account for each
                    administrator </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>An administrator account should rarely be used. In most cases when administrative privileges are needed, the Mac will prompt the user for a user name and password. There are some operations where logging in as an administrator is necessary, but these are rare.<br/><br/>The reason to not regularly use an administrator account for daily operations is security. Many operations that affect security can be accomplished without a password when an administrator is logged in. When logged in as a standard user, very few, if any, of the operations that affect the entire computer are possible without authentication to obtain elevated privileges.</xhtml:p>
                        <xhtml:p class="bold">Context: User</xhtml:p>
                        <xhtml:p class="bold">Level: 1</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Open System Preferences: Accounts and verify there is a regular user account for each administrator.</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>If administrator rights need to be controlled, consider granting specific "sudo" rights to individual users as needed.<br/><br/>In larger environments, you may wish to grant administrator rights only to directory service-based groups.</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Do not log in with an administrator account unless necessary.</xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="create-a-standard-or-managed-account-for-each-non-administrator-" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Create a standard or managed account for each non-administrator </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>A non-administrator should not need administrator privileges on the Mac, so create a standard (or managed, if using Mac OS X Server or Parental Controls) account for these users. </xhtml:p>
                        <xhtml:p class="bold">Context: User</xhtml:p>
                        <xhtml:p class="bold">Level: 1</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>If you need to grant specific rights to non-administrator users, such as the ability to change time zones, consult the Apple support knowledgebase. Some of these rights can be changed in the authorization rights database, <xhtml:code>/etc/authorization,</xhtml:code> and Apple does provide articles for common ones. Standard users have reduced rights which may affect their ability to alter things on the computer. Standard users cannot install software in the <xhtml:code>/Applications</xhtml:code> folder and cannot change various System Preferences, including creation and modification of network settings or the computer's time zone. Standard users can still make some changes, such as switching between administrator-defined network locations.</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Do not give the "Allow user to administer this computer" right to standard users in System Preferences: Accounts.</xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="set-appropriate-parental-controls-for-managed-accounts" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Set appropriate parental controls for managed accounts</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>Many aspects and features of the Mac can be restricted on a user-by-user basis, including computer usage time limits. Although this feature is called Parental Controls, these restrictions may be appropriate for corporate, government, or educational use. </xhtml:p>
                        <xhtml:p class="bold">Context: User</xhtml:p>
                        <xhtml:p class="bold">Level: 1</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>Parental Controls typically apply locally, although in Snow Leopard they can be shared between computers. For wider deployments, consider the use of the Apple MCX schema in your directory service; it is available in Mac OS X Server by default.</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>In the System Preferences: Accounts or in WorkGroup manager, activate Parental Controls and set the appropriate controls for each standard user.</xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="restrict-sudo-users-to-being-able-to-access-only-required-commands" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Restrict sudo users to being able to access only required commands</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>The sudo command allows a user to execute a command in Terminal as another user, typically the "root" user. By default, standard users cannot use the sudo command and administrator users can use all commands via sudo. Specific commands can be restricted to specific users or groups as needed.</xhtml:p>
                        <xhtml:p class="bold">Context: System and User</xhtml:p>
                        <xhtml:p class="bold">Level: 2</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Run the following command and verify the correct groups and user and the correct authorities.<br/><br/>sudo cat /etc/sudoers</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>man visudo<br/>man sudo<br/>man sudoers</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Always use the visudo command to edit the <xhtml:code>/etc/sudoers</xhtml:code> file. Read the <xhtml:code>man sudo</xhtml:code> page for more information.</xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <!-- TODO: file bug, should be non-scorable -->
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="securely-configure-ldapv3-access-" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Securely configure LDAPv3 access </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>When configuring LDAPv3, you should not add DHCP-supplied LDAP servers to automatic search policies. Whenever possible, use authenticated and encrypted LDAP connections.</xhtml:p>
                        <xhtml:p class="bold">Context: System</xhtml:p>
                        <xhtml:p class="bold">Level: 2</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>When using authenticated and/or encrypted connections, the LDAP server must support these options.</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Proper and secure configuration of LDAP is beyond the scope of this document. Make sure to have an experienced LDAP administrator configure and secure the connection.</xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="securely-configure-active-directory-access-" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Securely configure Active Directory access </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>When configuring Active Directory on the Mac client, verify that all the settings are correct. Specifically, make sure that the:<br/>* UID and GID mapping (if used) are appropriate<br/>* The list of groups of OS X administrators that can administer the Mac (if used) is configured as intended.</xhtml:p>
                        <xhtml:p class="bold">Context: System</xhtml:p>
                        <xhtml:p class="bold">Level: 2</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Proper and secure configuration of AD is beyond the scope of this document. Make sure to have an experienced AD administrator configure and secure the connection.</xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="use-password-assistant-to-help-generate-complex-passwords-" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Use Password Assistant to help generate complex passwords </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>Passwords are the primary protection against unwanted access. </xhtml:p>
                        <xhtml:p class="bold">Context: User</xhtml:p>
                        <xhtml:p class="bold">Level: 1</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Apple provides a Password Assistant in the dialogs used to set password. When setting a password, click on the key icon to the right of the New Password field to display the assistant. Make sure the password for the administrator account shows a quality of green. If you are color blind you may not be able to determine the quality of the password from the Password Assistant. Make sure the quality meter is about halfway across or more, or hover over the meter to see its calculated entropy value in a tooltip. For the entropy value, higher is better.</xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="set-a-strong-password-policy" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Set a strong password policy</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>Mac OS X Server allows the use of centrally managed password policies. If possible, use this feature to set a strong policy for passwords.</xhtml:p>
                        <xhtml:p class="bold">Context: System</xhtml:p>
                        <xhtml:p class="bold">Level: 2</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>Apple provides the <xhtml:code>pwpolicy</xhtml:code> command which can set some policies locally, without a Mac OS X Server. See <xhtml:code>man pwpolicy</xhtml:code> for more information. Note that many of the options are not available without Mac OS X Server (and are not documented as such). Also note that use of the <xhtml:code>pwpolicy</xhtml:code> command is not enforced for administrators or for users when using the CLI <xhtml:code>passwd</xhtml:code> command.</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Determining a strong policy and making the appropriate settings in Mac OS X Server is beyond the scope of this document.</xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="automatically-lock-the-keychain-after-15-minutes-of-inactivity-and-when-sleeping" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Automatically lock the login keychain after 15 minutes of inactivity and when sleeping</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>The keychain is a secure database store for passwords and certificates. A keychain is created for each user account on Mac OS X, and the system software itself uses keychains for secure storage. As of this writing, items secured in a keychain are encrypted with 3DES, while the directory or metadata information is available in clear text.<br/> For example, when Safari asks if you want to save a password and you answer yes, the password is stored in the default keychain. Many applications are keychain aware, others like Firefox and Thunderbird have their own dedicated password managers by default.<br/> All keychain aware applications store their passwords in a keychain (Login Keychain by default.) In order to protect those credentials the keychain should lock automatically after 15 minutes or an organizationally defined value. </xhtml:p>
                        <xhtml:p class="bold">Context: User</xhtml:p>
                        <xhtml:p class="bold">Level: 1</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>1. In <xhtml:code>Keychain Access,</xhtml:code> Select the keychain<br/> 2. Choose <xhtml:code>Edit &gt; Change Settings for keychain &lt;keychain_name&gt;,</xhtml:code> and authenticate, if requested.<br/> 3. Change the <xhtml:code>Lock after # minutes of inactivity</xhtml:code> setting for the Login Keychain to <xhtml:code>15 minutes</xhtml:code> or based on the access frequency of the security credentials included in the keychain for other keychains.</xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <!-- TODO: audit via CLI? no steps provided. -->
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="secure-the-login-keychain" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Secure the login keychain</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>By default, the login keychain for an account, especially a local account, has the same password as the account's logon password. If the logon password is compromised, the login keychain would also be compromised. It is possible to change the password on the login keychain to something different than the logon password, and doing so would keep that keychain locked until it is needed after login.</xhtml:p>
                        <xhtml:p class="bold">Context: User</xhtml:p>
                        <xhtml:p class="bold">Level: 2</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>Having two different passwords can be an inconvenience. Logging in to an account would no longer unlock the login keychain by default.In environments using Directory authentication with regular or frequent mandated password changes there are both positive and negative repercussions in having a different password for the login keychain, particularly with FileVault use.</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                 <xccdf:fixtext>
                    <xhtml:p>Open <xhtml:code>/Applications/Utilities/Keychain Access</xhtml:code><br/> Select login in the left panel<br/>Select Edit:Change Password for Keychain and change the password</xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="secure-individual-keychain-items-" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Secure individual keychain items </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>Each keychain entry can have different access controls. It's possible to set the keychain item to require a keychain password every time an item is accessed, even if the keychain is unlocked. This level of security could be useful for bank passwords or other passwords that need extra security.</xhtml:p>
                        <xhtml:p class="bold">Context: User</xhtml:p>
                        <xhtml:p class="bold">Level: 2</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>In Keychain Access search for the entry to protect<br/>Open the Entry and click on the Access Control tab<br/>Make sure the Ask for Keychain password checkbox is checked</xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="create-specialized-keychains-for-different-purposes-" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Create specialized keychains for different purposes </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>A user can have more than one keychain. If the user can logically split password and other entries into different keychains with different passwords, a compromise of one password will have limited effect.</xhtml:p>
                        <xhtml:p class="bold">Context: User</xhtml:p>
                        <xhtml:p class="bold">Level: 2</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>One useful separation of keychains might be in a business environment. Personal information might be stored in one keychain and business information in a different keychain. Using multiple keychains can be inconvenient. It is also not necessarily possible for all kinds of data, such as Safari auto-fill information, to be stored in secondary keychains. Not all keychain-aware applications may provide an interface to choose secondary keychains.</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Use Keychain Access to create multiple keychains. Store entries in the appropriate keychain when possible.</xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="use-a-portable-drive-to-store-keychains-" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Use a portable drive to store keychains </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>Keychains are just files on the computer, and thus do not need to be stored on the computer. Storing a keychain file on a portable drive (such as a USB flash drive) could help protect the data in the event the computer were stolen or compromised.</xhtml:p>
                        <xhtml:p class="bold">Context: User</xhtml:p>
                        <xhtml:p class="bold">Level: 2</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>Using keychains stored on portable drives can be inconvenient. The portable drive needs to be protected and backed up. The potential for the portable drive being lost or stolen must be weighed against the security benefit.</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Copy the files from <xhtml:code>~/Library/Keychains/</xhtml:code> to a portable drive then securely delete the files on the computer.</xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="do-not-enable-the-root-account-" selected="false" weight="0.0">
                <xccdf:title>Do not enable the "root" account </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>The <xhtml:code>root</xhtml:code> account is a superuser account that has access privileges to perform any actions and read/write to any file on the computer. In the UNIX/Linux world, the system administrator commonly uses the root account to perform administrative functions. On a Mac, root should not be enabled. In any circumstance an administrator can escalate privileges using the <xhtml:code>sudo</xhtml:code> command (use <xhtml:code>-s</xhtml:code> or <xhtml:code>-i</xhtml:code> to get a root shell).<br/>
                            <br/>By default the root account is not enabled on a Mac OS X client computer. It is enabled on Mac OS X Server.</xhtml:p>
                        <xhtml:p class="bold">Context: System</xhtml:p>
                        <xhtml:p class="bold">Level: 1</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Open <xhtml:code>/Applications/Utilities/Directory Utility</xhtml:code> program and verify root is disabled.<br/><br/>Alternatively, run the following command:<br/><br/><xhtml:code>dscl . -read /Users/root AuthenticationAuthority</xhtml:code><br/><br/>The result should be:<br/>
                            <br/><xhtml:code>No such key: AuthenticationAuthority</xhtml:code></xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>The <xhtml:code>root</xhtml:code> password, like those of other local user accounts, can still be reset when using the Password Reset Utility on the Mac OS X Install DVD.<br/><br/>The <xhtml:code>AuthenticationAuthority</xhtml:code> attribute could also contain <xhtml:code>;DisabledUser;</xhtml:code> which would prevent logins by the account.<br/>2.4) Securing System Software Action Items<br/>Every system preference with security-related configuration settings has its own action item checklist. </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Nothing specific; just don't enable root using the Directory Access program (in <xhtml:code>/Applications/Utilities/</xhtml:code>), with the CLI <xhtml:code>passwd</xhtml:code> command via <xhtml:code>sudo,</xhtml:code> or with the Reset Password utility on the installer DVD.</xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="command test «dscl . -read /Users/root AuthenticationAuthority»">
                            <ecl:command>dscl . -read /Users/root AuthenticationAuthority</ecl:command>
                            <ecl:line-selection op="pm" value="^No such key: AuthenticationAuthority$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="system">
            <xccdf:title>Securing System Software Action Items</xccdf:title>
            <xccdf:description>Every system preference with security-related configuration settings has its own action item checklist.</xccdf:description>
            
            <xccdf:Group id="mobileme-settings">
                <xccdf:title>MobileMe Settings</xccdf:title>
		<xccdf:description/>
                <xccdf:Rule id="do-not-enable-or-use-MobileMe" role="full" selected="false" weight="1.0">
                    <xccdf:title>Do not Enable or use MobileMe</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>MobileMe was a service offered by Apple, Inc. that allows seamless integration between many Mac applications and Apple services. The service is deprecated and will be ended on June 30th, 2012 in favor of iCloud services available with IOS5 and with 10.7 (as of 10.7.2)</xhtml:p>
                            <xhtml:p class="bold">Context: User</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>Open System Preferences: MobileMe for user and make sure the user name and password field are blank.<br/> Alternatively, run the following command for each user account:<br/>
                            <xhtml:code>defaults read ~/Library/Preferences/.GlobalPreferences iToolsMember</xhtml:code><br/> And ensure the results are blank or returns:<br/>
                            <xhtml:code>The domain/default pair of (.GlobalPreferences, iToolsMember) does not exist</xhtml:code>
                        </xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <!-- Check all users to ensure there is no ouput from the defaults command. Any output causes check to fail.
                                If iToolsMember doesn't exist, the message will be sent to <err> and not <out_raw>.-->
                            <ecl:shell-command check="none exist" comment="Check to make sure no users have MobileMe enabled.">
                                <ecl:command> find /Users -maxdepth 1 \! -name ".localized" \! -name
                                    "Shared" \! -name "Guest" \! -name "Users" -exec bash -c '
                                    dom="{}/Library/Preferences/.GlobalPreferences iToolsMember";
                                    defaults read $dom; ' \;</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                    </xccdf:check>
                </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="accounts-preferences-action-items">
                <xccdf:title>Accounts Preferences Action Items</xccdf:title>
                <xccdf:description>
                    <xhtml:p>Proper account management is critical to computer security. Many options and settings in the Account System Preference Pane can be used to increase the security of the Mac.</xhtml:p>
                </xccdf:description>
                <xccdf:Rule id="change-initial-password-for-the-system-administrator-account-" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Change initial password for the system administrator account </xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>If you did not set the initial password to the Mac, the password should be changed for all accounts, including the administrator account, as soon as possible. If the initial admin account is not needed, the account should be deleted.</xhtml:p>
                            <xhtml:p class="bold">Context: User</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>At least one admin account is required, although it does not necessarily need to be enabled or have a known password at any given time. The admin account could be disabled to prevent logins. Or, its password could be set to a strong, highly complicated password that is forgotten and not used. In such cases, you would need to re-enable the account or change its password before use.<br/><br/>It should also be noted that an attacker who has the ability to remove the <xhtml:code>/var/db/.AppleSetupDone</xhtml:code> file can restart the computer and create a new administrator account from the Mac OS X Setup Assistant. The <xhtml:code>.AppleSetupDone</xhtml:code> file determines whether the system runs the Setup Assistant or not.</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Accounts, select the user, then change the password or delete the account if not needed. </xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
                <xccdf:Rule id="disable-automatic-login" role="full" selected="false" weight="1.0">
                    <xccdf:title>Disable automatic login</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Having a computer automatically log in bypasses a major security feature (the login) and can allow a casual user access to sensitive data in that user's home directory and keychain.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>Open System Preferences: Accounts, Login Options, and verify Automatic Login is disabled.<br/><br/>Alternatively, run the following command:<br/><br/><xhtml:code>defaults read /Library/Preferences/.GlobalPreferences \<br/>com.apple.userspref.DisableAutoLogin </xhtml:code><br/><br/>Make sure the value returned is <xhtml:code>1.</xhtml:code></xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Accounts, Login Options, disable Automatic Login. <br/><br/>Note: Automatic login can also be disabled in System Preferences: Security. <br/><br/>Alternatively, run the following command:<br/><br/>
                            <xhtml:code>sudo defaults write /Library/Preferences/.GlobalPreferences \<br/> com.apple.userspref.DisableAutoLogin -bool yes</xhtml:code><br/></xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="command test «defaults read /Library/Preferences/.GlobalPreferences com.apple.userspref.DisableAutoLogin»">
                                <ecl:command>defaults read /Library/Preferences/.GlobalPreferences
                                    com.apple.userspref.DisableAutoLogin</ecl:command>
                                <ecl:line-selection op="pm" value="^1$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    
                </xccdf:Rule>
                <xccdf:Rule id="display-login-window-as-name-and-password" role="full" selected="false" weight="1.0">
                    <xccdf:title>Display login window as name and password</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Displaying the names of the accounts on the computer may make breaking in easier. Force the user to enter a login name and password to log in. </xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>Open System Preferences: Accounts, Login Options, and verify Name and Password is selected.<br/><br/>Alternatively, run the following command:<br/><br/><xhtml:code>defaults read /Library/Preferences/com.apple.loginwindow SHOWFULLNAME </xhtml:code><br/><br/>Make sure the value returned is <xhtml:code>1.</xhtml:code></xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Accounts, Login Options, select Name and Password<br/><br/>Alternatively, run the following command<br/><br/><xhtml:code>sudo defaults write /Library/Preferences/com.apple.loginwindow \<br/>SHOWFULLNAME -bool yes</xhtml:code></xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="command test «defaults read /Library/Preferences/com.apple.loginwindow SHOWFULLNAME»">
                                <ecl:command>defaults read /Library/Preferences/com.apple.loginwindow
                                    SHOWFULLNAME</ecl:command>
                                <ecl:line-selection op="pm" value="^1$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:Rule>
                <xccdf:Rule id="disable-show-password-hints-" role="full" selected="false" weight="1.0">
                    <xccdf:title>Disable "Show password hints" </xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Password hints can give an attacker a hint as well, so the option to display hints should be turned off. If your organization has a policy to enter a help desk number in the password hints areas, do not turn off the option. </xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>Open System Preferences: Accounts, Login Options, and verify "Show password hints" checkbox is off.<br/><br/>Alternatively, run the following command:<br/><br/><xhtml:code>defaults read /Library/Preferences/com.apple.loginwindow RetriesUntilHint</xhtml:code><br/><br/>Make sure the value returned is <xhtml:code>0.</xhtml:code></xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Accounts, Login Options, make sure the "Show password hints" checkbox is off.<br/><br/>Alternatively, run the following command<br/><br/><xhtml:code>sudo defaults write /Library/Preferences/com.apple.loginwindow \<br/>RetriesUntilHint -int 0</xhtml:code></xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="command test «defaults read /Library/Preferences/com.apple.loginwindow RetriesUntilHint»">
                                <ecl:command>defaults read /Library/Preferences/com.apple.loginwindow
                                    RetriesUntilHint</ecl:command>
                                <ecl:line-selection op="pm" value="^0$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:Rule>
                <xccdf:Rule id="configure-allow-network-users-to-login-to-this-computer" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Configure "Allow network users to login to this
                        computer"</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>This option is only available is the Mac is configured to authenticate through a Directory Service (like Active Directory or Open Directory). The Options button will allow the computer to restrict which network user can log on to the Mac; the default is to allow all network users to log in. If there is no business need for all users to log in to the computer only those users that need to should be enabled.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 2</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Accounts, Login Options, turn on "Allow network users to login to this computer," then click the Options button to configure logon access as needed. </xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
                <xccdf:Rule id="disable-enable-fast-user-switching-" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Disable "Enable fast user switching" </xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Fast user switching allows a person to quickly log in to the computer with a different account. While only a minimal security risk, when a second user is logged in, that user might be able to see what processes the first user is using, or possibly gain other information about the first user.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 2</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Accounts, Login Options, make sure the "Enable fast user switching" checkbox is off.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>Mac OS X is a multi-user operating system, and there are other similar methods that might provide the same kind of risk. The Remote Login service that can be turned on in the Sharing System Preferences pane is another.</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Accounts, Login Options, make sure the "Enable fast user switching" checkbox is off.</xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
                <xccdf:Rule id="disable-allow-guest-to-log-into-this-computer-" role="full" selected="false" weight="1.0">
                    <xccdf:title>Disable "Allow guest to log into this computer" </xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>The Guest account allows a guest to log in to a Mac and use all of its services. When the guest logs out, the Mac clears most of whatever the guest did on the Mac. This allows one person to let another borrow the computer for a short period, and still protect information in other accounts on the Mac.<br/><br/>The usage of a Guest account may give the Mac owner a false sense of security. If the guest has physical access to the Mac and the owner is not present, the guest could gain full access to the Mac. That said, use of the Guest account allows for quick and moderately safe computer sharing.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>Run the following command<br/><br/><xhtml:code>dscl . -read /Users/Guest AuthenticationAuthority</xhtml:code><br/><br/>The result should be: <br/><br/><xhtml:code>AuthenticationAuthority: ;basic;</xhtml:code></xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>By default, the guest account is enabled for access to sharing services, but is not allowed to log in to the computer.<br/><br/>The guest account does not need a password when it is enabled to log in to the computer.</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Account, click on the Guest user.<br/>Make sure the "Allow guests to log into this computer" is not checked.<br/><br/>Alternatively, run the following commands:<br/><br/><xhtml:code>sudo dscl . -create /Users/Guest AuthenticationAuthority ";basic;"<br/>sudo dscl . -create /Users/Guest passwd "*"<br/>sudo dscl . -create /Users/Guest UserShell "/sbin/nologin"</xhtml:code></xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:complex-check operator="OR">
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="command test «dscl . -read /Users/Guest AuthenticationAuthority»" success="fail">
                                    <ecl:command>dscl . -read /Users/Guest
                                        AuthenticationAuthority</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="command test «dscl . -read /Users/Guest AuthenticationAuthority»">
                                    <ecl:command>dscl . -read /Users/Guest
                                        AuthenticationAuthority</ecl:command>
                                    <ecl:line-selection op="pm" value="^AuthenticationAuthority: ;basic;$"/>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                    </xccdf:complex-check>
                </xccdf:Rule>
                <xccdf:Rule id="disable-allow-guests-to-connect-to-shared-folders" role="full" selected="false" weight="1.0">
                    <xccdf:title>Disable "Allow guests to connect to shared folders"</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>If files need to be shared, a dedicated file server should be used. If file sharing on the client Mac must be used, then only authenticated access should be used. Guest access allows guest to access files they might not need access to.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Account, click on the Guest user.<br/>Make sure the "Allow guests to connect to shared folders" is not checked.<br/><br/>Alternatively, run the following command:<br/><br/>For AFP sharing:<br/><xhtml:code>defaults read /Library/Preferences/com.apple.AppleFileServer guestAccess</xhtml:code><br/><br/>for SMB sharing:<br/><xhtml:code>defaults write \<br/> /Library/Preferences/SystemConfiguration/com.apple.smb.server \<br/>AllowGuestAccess</xhtml:code><br/><br/>Make sure the results are <xhtml:code>0.</xhtml:code></xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>This setting is not enabled by default in Snow Leopard, but the sharing services themselves are all turned off.<br/><br/>The guest account does not need a password for access to shared services when it is enabled.</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Account, click on the Guest user.<br/>Make sure the "Allow guests to connect to shared folders" is not checked.<br/><br/>Alternatively, run the following commands:<br/><br/>For AFP sharing:<br/><xhtml:code>sudo defaults write /Library/Preferences/com.apple.AppleFileServer \<br/>guestAccess -bool no</xhtml:code><br/><br/>for SMB sharing:<br/><xhtml:code>sudo defaults write \<br/> /Library/Preferences/SystemConfiguration/com.apple.smb.server \<br/>AllowGuestAccess -bool no</xhtml:code></xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:complex-check operator="AND">
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="command test «defaults read /Library/Preferences/com.apple.AppleFileServer guestAccess»">
                                    <ecl:command>defaults read
                                        /Library/Preferences/com.apple.AppleFileServer
                                        guestAccess</ecl:command>
                                    <ecl:line-selection op="pm" value="^0$"/>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="command test «defaults read /Library/Preferences/SystemConfiguration/com.apple.smb.server AllowGuestAccess»">
                                    <ecl:command>defaults read
                                        /Library/Preferences/SystemConfiguration/com.apple.smb.server
                                        AllowGuestAccess</ecl:command>
                                    <ecl:line-selection op="pm" value="^0$"/>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                    </xccdf:complex-check>
                </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="bluetooth-preferences-action-items">
                <xccdf:title>Bluetooth Preferences Action Items</xccdf:title>
                <xccdf:description>
                    <xhtml:p>Bluetooth can be a very useful technology, but it can also leave an unprotected computer open to compromise. Bluetooth is best used in a secure environment where unauthorized users have no physical access near the Mac. If Bluetooth is used, it should be secured properly (see below). Also, please note a recommendation earlier in this document to completely disable Bluetooth.</xhtml:p>
                </xccdf:description>
                <xccdf:Rule id="disable-bluetooth-by-using-system-preferences-for-each-user-account-" role="full" selected="false" weight="1.0">
                    <xccdf:title>Disable Bluetooth by using System Preferences for each user account </xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>As stated earlier, Bluetooth can be very useful, but can also expose a Mac to certain risks. Unless specifically needed and configured properly, Bluetooth should be turned off</xhtml:p>
                            <xhtml:p class="bold">Context: User</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Bluetooth, verify "On" box is unchecked.<br/><br/>Alternatively, run the following command:<br/><br/><xhtml:code>defaults read /Library/Preferences/com.apple.Bluetooth ControllerPowerState</xhtml:code><br/><br/>and make sure the value returned is <xhtml:code>0.</xhtml:code></xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>Removes Bluetooth functionality. See recommendations in sections 2.4.3.3 and 2.4.3.4 on how to secure Bluetooth if it is used.</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Bluetooth, uncheck the "On" box.<br/><br/>Alternatively, run the following commands:<br/><br/><xhtml:code>sudo defaults write /Library/Preferences/com.apple.Bluetooth \<br/>ControllerPowerState -int 0<br/>sudo killall -HUP blued</xhtml:code><br/></xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="command test «defaults read /Library/Preferences/com.apple.Bluetooth ControllerPowerState»">
                                <ecl:command>defaults read /Library/Preferences/com.apple.Bluetooth
                                    ControllerPowerState</ecl:command>
                                <ecl:line-selection op="pm" value="^0$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:Rule>
                <xccdf:Rule id="disable-bluetooth-internet-connection-sharing" role="full" selected="false" weight="1.0">
                    <xccdf:title>Disable Bluetooth internet connection sharing</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Bluetooth internet sharing can expose a Mac and the network to certain risks and should be turned off.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Bluetooth, Advanced options, verify "Share my internet connection with other Bluetooth devices" if off<br/><br/>Alternatively, run the following commands<br/><br/><xhtml:code>defaults read /Library/Preferences/com.apple.Bluetooth PANServices<br/><br/></xhtml:code>and make sure the value returned is <xhtml:code>0.</xhtml:code></xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>This setting is turned off by default in Snow Leopard.</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Bluetooth, Advanced options, turn off "Share my internet connection with other Bluetooth devices"<br/><br/>Alternatively, run the following commands:<br/><br/><xhtml:code>sudo defaults write /Library/Preferences/com.apple.Bluetooth \<br/>PANServices -int 0<br/>sudo killall -HUP blued</xhtml:code><br/></xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:complex-check operator="OR">
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="command test «defaults read /Library/Preferences/com.apple.Bluetooth PANServices»" success="fail">
                                    <ecl:command>defaults read /Library/Preferences/com.apple.Bluetooth
                                        PANServices</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="command test «defaults read /Library/Preferences/com.apple.Bluetooth PANServices»">
                                    <ecl:command>defaults read /Library/Preferences/com.apple.Bluetooth
                                        PANServices</ecl:command>
                                    <ecl:line-selection op="pm" value="^0$"/>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                    </xccdf:complex-check>
                </xccdf:Rule>
                <xccdf:Rule id="if-bluetooth-is-used-turn-off-discoverable-when-not-needed" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>If Bluetooth is used, turn off "Discoverable" when not
                        needed</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>When Bluetooth is set to "discoverable" mode, the Mac sends a signal indicating that it's available to "pair" with another Bluetooth device. When in discoverable state an attacker could gain access to data on the Mac. Use discoverable mode when "pairing" a Bluetooth device to the Mac, but once the "pairing" is complete, turn discoverable mode off.</xhtml:p>
                            <xhtml:p class="bold">Context: User</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Bluetooth, turn Discoverable off when not actively "pairing" a Bluetooth device.</xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
                <xccdf:Rule id="show-bluetooth-status-in-menu-bar" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Show Bluetooth status in menu bar</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>By showing the Bluetooth status in the menu bar, a small Bluetooth icon is placed in the menu bar. This icon quickly shows the status of Bluetooth, and can allow the user to quickly turn Bluetooth on or off.</xhtml:p>
                            <xhtml:p class="bold">Context: User</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Bluetooth, turn Show Bluetooth Status In Menu Bar on.</xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="cd-dvd-preferences-action-items">
                <xccdf:title>CDs &amp; DVDs Preferences Action Items</xccdf:title>
		<xccdf:description/>
                <xccdf:Rule id="cds-and-dvds-preferences-actions-items-" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>CDs &amp; DVDs Preferences Action Items</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Managing automatic actions, while useful in very few situations, is unlikely to increase security on the computer and does complicate the users experience and add additional complexity to the configuration. These settings are user controlled and can be changed without Administrator privileges unless controlled through MCX settings or Parental Controls. Unlike Windows Auto-run the optical media is accessed through Operating System applications, those same applications can open and access the media directly. If optical media is not allowed in the environment the optical media drive should be disabled in hardware and software.</xhtml:p>
                            <xhtml:p class="bold">Context: User</xhtml:p>
                            <xhtml:p class="bold">Level: 2</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>None</xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="date-and-time-preferences-action-items">
                <xccdf:title>Date &amp; Time Preferences Action Items</xccdf:title>
                <xccdf:description>
                    <xhtml:p>As stated earlier in this document, setting the correct date and time can be very important. Use the Set date &amp; time automatically feature.</xhtml:p>
                </xccdf:description>
                <xccdf:Rule id="enter-correct-time-settings" role="full" selected="false" weight="1.0">
                    <xccdf:title>Enter correct time settings</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Having the correct date, time, time zone, and daylight saving time setting (if applicable) on a Mac is very important. File creation and modification dates use the system time. Log entries use the system time. Kerberos may not operate correctly if the time on the Mac is off by more than 5 minutes, which can affect Apple's single sign-on feature, Active Directory logons, and other features.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Date &amp; Time select the Date &amp; Time tab. Make sure the "Set date &amp; time automatically" checkbox is checked.<br/><br/>Alternatively, run the following commands:<br/><br/><xhtml:code>cat /etc/hostconfig | grep TIMESYNC</xhtml:code><br/><br/>Make sure the results are:<br/><xhtml:code>TIMESYNC=-YES-<br/><br/>cat /etc/ntp.conf </xhtml:code><br/>Make sure the results list desired time servers. For example:<br/><br/><xhtml:code>server time.apple.com</xhtml:code><br/><br/>Verify the <xhtml:code>/System/Library/LaunchDaemons/org.ntp.ntpd.plist </xhtml:code>job is running<br/>
                                <br/><xhtml:code>cat /System/Library/LaunchDaemons/org.ntp.ntpd.plist | grep Disabled</xhtml:code><br/><br/>make sure the results are blank.<br/></xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p><xhtml:code>man ntp.conf</xhtml:code>
                                <br/>http://support.ntp.org/bin/view/Main/WebHome<br/><br/>By default, a system set up with the Mac OS X Setup Assistant will use one of Apple's time servers.<br/><br/>Be sure you understand the ramifications if you do not use fully-qualified domain names (FQDN) or IP addresses when specifying your time servers. If port 123 (the NTP port) is blocked by a firewall, the automatic date and time feature will not work. If the port is blocked, a time server accessible behind the firewall must be used to set the date and time automatically. A mix of internal and external time servers is recommended for mobile systems.</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Date &amp; Time, Select the Time Zone tab. Make sure the correct Time Zone is selected. Next, select the Date &amp; Time tab. Make sure the "Set date &amp; time automatically" checkbox is checked. If your organization runs its own time server, enter its address in the field. You can enter multiple time servers by separating them with a space, listing them in order of preference.<br/><br/>Alternatively, perform the following <br/><br/>Using <xhtml:code>sudo,</xhtml:code> edit <xhtml:code>/private/etc/hostconfig</xhtml:code> and change the <xhtml:code>TIMESYNC</xhtml:code> entry to <xhtml:code>-YES-</xhtml:code><br/><br/> Using <xhtml:code>sudo</xhtml:code> edit <xhtml:code>/private/etc/ntp.conf</xhtml:code>and enter desired servers. For example:<br/><br/><xhtml:code>server time.mycompany.com preferred<br/>server time.apple.com</xhtml:code><br/><br/>Then restart the time daemon:<br/><br/><xhtml:code>sudo launchctl load -w
                            /System/Library/LaunchDaemons/org.ntp.ntpd.plist</xhtml:code><br/></xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:complex-check operator="AND">
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:file-content check="all" comment="test «/etc/hostconfig»">
                                    <ecl:path>/etc/hostconfig</ecl:path>
                                    <ecl:line-selection op="pm" value="^TIMESYNC=-YES-$"/>
                                </ecl:file-content>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:file-content check="all" comment="test «/etc/ntp.conf»">
                                    <ecl:path>/etc/ntp.conf</ecl:path>
                                    <ecl:line-selection op="pm" value="^server.*$"/>
                                </ecl:file-content>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:file-content check="none exist" comment="test «/System/Library/LaunchDaemons/org.ntp.ntpd.plist»">
                                    <ecl:path>/System/Library/LaunchDaemons/org.ntp.ntpd.plist</ecl:path>
                                    <ecl:line-selection op="pm" value=".*Disabled.*"/>
                                </ecl:file-content>
                            </xccdf:check-content>
                        </xccdf:check>
                    </xccdf:complex-check>
                </xccdf:Rule>
                <xccdf:Rule id="use-an-internal-software-update-mechanism-" role="full" selected="false" weight="1.0">
                    <xccdf:title>Use an internal Software Update mechanism </xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Apple offers a Software Update Service in the Mac OS X Server product. If your organization uses such a service, set the computer to use your internal server. Other products are available as well to manage patching and enable consistent configuration management. Consistent patching and management adds greatly to the security of computers inside an organization.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 2</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>Run the following comment to determine if a software update server is defined.<br/><br/><xhtml:code>defaults read /Library/Preferences/com.apple.SoftwareUpdate CatalogURL</xhtml:code><br/><br/>Note: in a Mac OS X server environment the software update server may be defined using MCX and may be located in a different place. </xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>Mac OS X defaults to using Apple's Software Update servers. Your computer will not be able to get updates using Software Update unless it has network access to the organizational software update server.<br/></xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>The Software Update Service setting can be set though a managed Mac environment using Apple's Workgroup Manager. <br/><br/>Alternatively, the following command can be run from Terminal:<br/><br/><xhtml:code>sudo defaults write /Library/Preferences/com.apple.SoftwareUpdate CatalogURL &lt;url&gt;</xhtml:code><br/><br/>where <xhtml:code>&lt;url&gt;</xhtml:code>is the URL to the update server.<br/><br/>Use the following command to clear the setting and use the Apple, Inc., software update server:<br/><br/><xhtml:code>sudo defaults delete /Library/Preferences/com.apple.SoftwareUpdate CatalogURL</xhtml:code></xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="command test «defaults read /Library/Preferences/com.apple.SoftwareUpdate CatalogURL»" success="pass">
                                <ecl:command>defaults read /Library/Preferences/com.apple.SoftwareUpdate
                                    CatalogURL</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:Rule>
                
                <xccdf:Rule id="maintain-a-software-asset-inventory-external-to-the-computer" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Maintain a software asset inventory external to the computer</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>With the introduction of Mac OS X 10.6.6, Apple added a new application, App Store, which resides in the Applications directory. This application allows a user with admin privileges and an Apple ID to browse Apple’s online App Store, purchase (including no cost purchases) and install new applications, bypassing corporate software inventory controls. Any admin user can install software in the /Applications directory whether from internet downloads, thumb drives, optical media, cloud storage or even binaries through email. Even standard users can run executables if permitted. The source of the software is not nearly as important as a consistent audit of all installed software patch compliance and appropriateness. </xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 2</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>Scan systems on a monthly basis and determine the number of unauthorized pieces of software that are installed. Verify that if an unauthorized piece of software is found one month, it is removed from the system the next.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>https://www.sans.org/critical-security-controls/control.php?id=2 <br/></xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>Export Apple System Profiler information through the built-in or other third party tools on an organizationally defined timetable </xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="desktop-and-screen-saver-preferences-action-items-">
                <xccdf:title>Desktop &amp; Screen Saver Preferences Action Items</xccdf:title>
                <xccdf:description/>
                <xccdf:Rule id="set-a-short-inactivity-interval-for-the-screen-saver-" selected="false" weight="0.0">
                    <xccdf:title>Set a short inactivity interval for the screen saver</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>By obscuring the screen with a picture, graphic, or just an opaque color, the screen saver can keep prying eyes off of an unattended screen and potentially sensitive information.</xhtml:p>
                            <xhtml:p class="bold">Context: User</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>Open System Preferences: Desktop &amp; Screen Saver, Screen Saver Tab, make sure the Start screen saver slider is not set to <xhtml:code>Never</xhtml:code> and is a reasonably low value (like 15 minutes). <br/><br/>Alternatively, run the following command:<br/><br/><xhtml:code>defaults -currentHost read com.apple.screensaver idleTime</xhtml:code>
                                <br/><br/>and verify the setting is not 0 but is an adequately low number(&lt;= 900).<br/></xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Desktop &amp; Screen Saver, Screen Saver Tab, make sure the Start screen saver slider is not set to <xhtml:code>Never</xhtml:code> and is a reasonably low value.<br/><br/>Alternatively, run the following command:<br/><br/><xhtml:code>defaults -currentHost write com.apple.screensaver idleTime -int 900</xhtml:code><br/><br/>where 900 is the number of idle seconds until the screen saver starts. A logout of the user may be required for the new settings to take effect.</xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="command test «defaults -currentHost read com.apple.screensaver idleTime»">
                                <ecl:command>find /Users -maxdepth 1 \! -name ".localized" \! -name "Shared"
                                    \! -name "Users" \! -name "Guest" -exec bash -c
                                    'dom="com.apple.screensaver idleTime"; result=`sudo -u \`basename {}\`
                                    defaults -currentHost read com.apple.screensaver idleTime 2&gt;/dev/null`;
                                    if [ $? -ne 0 ]; then echo "Invalid"; else if [ $result -eq 0 ]; then echo "Invalid"; else if [ $result -le 900 ]; then
                                    echo "Valid"; else echo "Invalid"; fi; fi; fi;' \;</ecl:command>
                                <ecl:line-selection op="pm" value="^Invalid$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:Rule>
                
                <xccdf:Rule id="disable-users-or-admins-to-login-to-another-users-active-and-locked-session-" role="full" selected="false" weight="1.0">
                    <xccdf:title>Disable users or admins to login to another users active and locked session</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Administrators with rights to manage the device do not necessarily have rights to access everything the user of the computer has rights to including email, web applications and mounted shares and disk images and there are definitely privacy and personal information implications by allowing everyone with administrative rights access to any users active session</xhtml:p>
                            <xhtml:p class="bold">Context: User</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p><xhtml:code>grep -ir "&lt;string&gt;authenticate-session-owner-or-admin &lt;/string&gt;" /etc/authorization</xhtml:code>
                                <br/>No results will be returned if the system is configured as recommended. </xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>Edit <xhtml:code>/etc/authorization system.login.screensaver</xhtml:code> setting to the following: <br/><br/><xhtml:code> &lt;key&gt;system.login.screensaver&lt;/key&gt;<br/> &lt;dict&gt;<br/> &lt;key&gt;class&lt;/key&gt;<br/> &lt;string&gt;rule&lt;/string&gt;<br/> &lt;key&gt;comment&lt;/key&gt;<br/> &lt;string&gt;The owner can unlock the screensaver.&lt;/string&gt;<br/> &lt;key&gt;rule&lt;/key&gt;<br/> &lt;string&gt;authenticate-session-owner&lt;/string&gt;<br/>
                        </xhtml:code>
                        </xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="Check /etc/authorization for admin fast-user switching" success="fail">
                                <ecl:command>grep -ir "&lt;string&gt;authenticate-session-owner-or-admin&lt;/string&gt;" /etc/authorization</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:Rule>
                
            </xccdf:Group>
            <xccdf:Group id="energy-saver-preferences-action-items-">
                <xccdf:title>Energy Saver Preferences Action Items</xccdf:title>
                <xccdf:description/>
                <xccdf:Rule id="disable-sleeping-the-computer-when-connected-to-power" role="full" selected="false" weight="1.0">
                    <xccdf:title>Disable sleeping the computer when connected to power</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>In some institutions certain software must be run that requires the computer to be awake. In these situations the computer should not be set to sleep.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 2</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Energy Saver, verify the slider for "Put the computer to sleep..." to never.<br/><br/>Alternatively, use the following command:<br/><br/><xhtml:code>pmset -g | grep sleep </xhtml:code><br/>
                                <br/>and verify the value returned is <xhtml:code>0</xhtml:code></xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p><xhtml:code>man pmset</xhtml:code></xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Energy Saver, drag the slider for "Put the computer to sleep..." to never.<br/><br/>Alternatively, use the following command:<br/><br/><xhtml:code>sudo pmset -c sleep 0 </xhtml:code></xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="command test «pmset -g»">
                                <ecl:command>pmset -g</ecl:command>
                                <ecl:line-selection op="pm" value="^\s*sleep\s+0$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:Rule>
                <xccdf:Rule id="verify-display-sleep-is-set-to-a-value-larger-than-the-screen-saver" role="full" selected="false" weight="1.0">
                    <xccdf:title>Verify Display Sleep is set to a value larger than the Screen
                        Saver</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>If the Screen Saver is used to lock the screen, verify the Display Sleep settings are longer than the Screen Saver setting. If the display goes to sleep before the screen saver activates, the computer will appear to be off, but will be unprotected. </xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Energy Saver, verify the slider for "Put the display(s) to sleep..." to a reasonable number, but longer than the screen saver setting. The Mac will display a warning if the number is too short.<br/><br/>Alternatively, use the following command:<br/><br/><xhtml:code>pmset -g | grep displaysleep </xhtml:code><br/><br/>and verify the value returned is longer than the Screen Saver, if the Screen Saver is used to lock the screen.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p><xhtml:code>man pmset</xhtml:code></xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Energy Saver, drag the slider for "Put the display(s) to sleep..." to a reasonable number, but longer than the screen saver setting. The Mac will display a warning if the number is too short.<br/><br/>Alternatively, use the following command:<br/><br/><xhtml:code>sudo pmset -c displaysleep 0</xhtml:code><br/><br/>Note: The <xhtml:code>–c</xhtml:code> flag means "wall power." Different settings must be used for other power sources.</xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <!-- Script to find both the Screensaver idleTime value and the displaysleep value. The Screensaver idleTime value is stored as an integer value in seconds.
                                The displaysleep value is stored in minutes. We are using "let" to change the displaysleep value to seconds so the comparison will function correctly. -->
                            <ecl:shell-command check="none exist" comment="Script to compare the displaysleep value and screensaver value. If the screensaver idle time is great than displaysleep, this check will fail.">
                                <ecl:command>find /Users -maxdepth 1 \! -name ".localized" \! -name "Shared" \! -name "Users" \! -name "Guest" -exec bash -c 'dom="com.apple.screensaver idleTime";
                                    idle=`sudo -u \`basename {}\` defaults -currentHost read $dom`;
                                    asleep=$(pmset -g | grep displaysleep | awk {"print \$2"});
                                    let "sleep=60*$asleep";
                                    if [ $idle -lt $sleep ]; then echo "Valid"; else echo "Invalid"; fi; ' \;</ecl:command>
                                <ecl:line-selection op="pm" value="^Invalid$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:Rule>
                <xccdf:Rule id="disable-wake-when-the-modem-detects-a-ring-for-all-power-settings" role="full" selected="false" weight="1.0">
                    <xccdf:title>Disable "Wake when the modem detects a ring" for all power
                        settings</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Unless the computer is used to receive facsimiles or is used as a modem access point for incoming calls, this feature is not needed. An attacker could remotely wake a machine using a modem, then attack the machine through the internet.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Energy Saver, Options tab, verify the "Wake when the modem detects a ring" is not checked.<br/><br/>Alternatively, use the following command:<br/><br/><xhtml:code>pmset -g | grep ring </xhtml:code><br/><br/>and verify the value returned is <xhtml:code>0.</xhtml:code></xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p><xhtml:code>man pmset</xhtml:code></xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Energy Saver, Options tab, make sure the "Wake when the modem detects a ring" is not checked.<br/><br/>Alternatively, use the following command:<br/><br/><xhtml:code>sudo pmset -c ring 0</xhtml:code><br/>
                            <br/>Note: The <xhtml:code>-c</xhtml:code> flag means "wall power." Different settings must be used for other power sources.</xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:complex-check operator="OR">
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="command test «pmset -g»">
                                    <ecl:command>pmset -g</ecl:command>
                                    <ecl:line-selection op="pm" value=".*ring.*"/>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="command test «pmset -g»">
                                    <ecl:command>pmset -g</ecl:command>
                                    <ecl:line-selection op="pm" value="^\s*ring\s+0$"/>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                    </xccdf:complex-check>
                </xccdf:Rule>
                <xccdf:Rule id="disable-wake-for-ethernet-network-administrator-access-for-power-adapter-settings" role="full" selected="false" weight="1.0">
                    <xccdf:title>Disable "Wake for Ethernet network administrator access" for
                        power adapter settings</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>This option might be used in certain organizations. The feature, sometimes called the "Wake-on-LAN", is only useful for those organizations that specifically need it. Otherwise it should be turned off so an attacker cannot use it to wake your computer remotely.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Energy Saver, Options tab, verify the "Wake for Ethernet network administrator access" is not checked.<br/><br/>Alternatively, use the following command:<br/><br/><xhtml:code>pmset -g | grep womp </xhtml:code><br/><br/>and verify the value returned is <xhtml:code>0.</xhtml:code></xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p><xhtml:code>man pmset</xhtml:code></xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Energy Saver, Options tab, make sure the "Wake for Ethernet network administrator access" is not checked.<br/><br/>Alternatively, use the following command:<br/><br/><xhtml:code>sudo pmset -c womp 0</xhtml:code><br/><br/>Note: The <xhtml:code>-c</xhtml:code> flag means "wall power." Different settings must be used for other power sources.</xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:complex-check operator="OR">
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="command test «pmset -g»">
                                    <ecl:command>pmset -g</ecl:command>
                                    <ecl:line-selection op="pm" value=".*womp.*"/>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="command test «pmset -g»">
                                    <ecl:command>pmset -g</ecl:command>
                                    <ecl:line-selection op="pm" value="^\s*womp\s+0$"/>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                    </xccdf:complex-check>
                </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="exposé-and-spaces-preferences-action-items">
                <xccdf:title>Expose &amp; Spaces Preferences Action Items</xccdf:title>
                <xccdf:description>
                    <xhtml:p>Management of the Exposé and Spaces preferences are useful primarily to change "hot corner" settings that affect the screen saver and display sleep.</xhtml:p>
                </xccdf:description>
                <xccdf:Rule id="do-not-set-any-screen-corner-to-disable-screen-saver" role="full" selected="false" weight="1.0">
                    <xccdf:title>Do not set any screen corner to Disable Screen Saver</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>The screen saver should be set to turn on after a period of inactivity, and should require a password to dismiss. Disabling the screen saver would disable the screen lock.</xhtml:p>
                            <xhtml:p class="bold">Context: User</xhtml:p>
                            <xhtml:p class="bold">Level: 2</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Exposé &amp; Spaces, make sure none of the Active Screen Corners are set to disable the screen saver.<br/><br/>Alternatively, Use the following command when logged is as each user:<br/><br/><xhtml:code>read ~/Library/Preferences/com.apple.dock</xhtml:code><br/><br/>verify none of the *-corner keys has a value of "<xhtml:code>1</xhtml:code>".</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Exposé &amp; Spaces, make sure none of the Active Screen Corners are set to disable the screen saver.<br/><br/>The screen corners can be set using the defaults command, but the permutations of combinations are many. The plist file to check is <br/>
                            <xhtml:code>~/Library/Preferences/com.apple.dock</xhtml:code> and the keys are: <br/><br/><xhtml:code>wvous-bl-corner<br/>wvous-br-corner <br/>wvous-tl-corner <br/>wvous-tr-corner</xhtml:code><br/><br/>There are also modifier keys to check and various values for each of these keys. A value of <xhtml:code>6</xhtml:code> for any of corners should not be allowed (6 = disable screen saver). If any value is <xhtml:code>6</xhtml:code>, change the value to <xhtml:code>1</xhtml:code> (which means no action). Also change the corresponding wvous-xx-modifier key to <xhtml:code>1048576</xhtml:code></xhtml:p>
                    </xccdf:fixtext>
                    <!-- Complex AND check to make sure all hot corners are not set to disable the screensaver -->
                    <xccdf:complex-check operator="AND">
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="Check all users for &quot;disable screen saver&quot; top left hot corner">
                                    <ecl:command> find /Users -maxdepth 1 \! -name ".localized" \! -name
                                        "Shared" \! -name "Guest" \! -name "Users" -exec bash -c '
                                        dom="{}/Library/Preferences/com.apple.dock";
                                        defaults read $dom | egrep ^[[:space:]]*\"wvous\-tl\-corner\".*6\;$ ' \;</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="Check all users for &quot;disable screen saver&quot; top right hot corner">
                                    <ecl:command> find /Users -maxdepth 1 \! -name ".localized" \! -name
                                        "Shared" \! -name "Guest" \! -name "Users" -exec bash -c '
                                        dom="{}/Library/Preferences/com.apple.dock";
                                        defaults read $dom | egrep ^[[:space:]]*\"wvous\-tr\-corner\".*6\;$ ' \;</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="Check all users for &quot;disable screen saver&quot; bottom left hot corner">
                                    <ecl:command> find /Users -maxdepth 1 \! -name ".localized" \! -name
                                        "Shared" \! -name "Guest" \! -name "Users" -exec bash -c '
                                        dom="{}/Library/Preferences/com.apple.dock";
                                        defaults read $dom | egrep ^[[:space:]]*\"wvous\-bl\-corner\".*6\;$ ' \;</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="Check all users for &quot;disable screen saver&quot; bottom right hot corner">
                                    <ecl:command> find /Users -maxdepth 1 \! -name ".localized" \! -name
                                        "Shared" \! -name "Guest" \! -name "Users" -exec bash -c '
                                        dom="{}/Library/Preferences/com.apple.dock";
                                        defaults read $dom | egrep ^[[:space:]]*\"wvous\-br\-corner\".*6\;$ ' \;</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                    </xccdf:complex-check>
                </xccdf:Rule>
                <xccdf:Rule id="set-a-screen-corner-to-start-screen-saver" role="full" selected="false" weight="1.0">
                    <xccdf:title>Set a screen corner to Start Screen Saver</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>A user should be able to activate the screen saver quickly. </xhtml:p>
                            <xhtml:p class="bold">Context: User</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Exposé &amp; Spaces, make sure at least one Active Screen Corner is set to Start Screen Saver. Make sure the user knows about this feature.<br/><br/>Alternatively, Use the following command:<br/><br/><xhtml:code>read ~/Library/Preferences/com.apple.dock</xhtml:code><br/><br/>verify at least one of the *-corner keys has a value of <xhtml:code>5</xhtml:code>.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Exposé &amp; Spaces, make sure at least one Active Screen Corner is set to Start Screen Saver. Make sure the user knows about this feature.<br/><br/>The screen corners can be set using the defaults command, but the permutations of combinations are many. The plist file to check is<br/><xhtml:code> ~/Library/Preferences/com.apple.dock</xhtml:code> and the keys are <br/><br/><xhtml:code>wvous-bl-corner<br/>wvous-br-corner <br/>wvous-tl-corner <br/>wvous-tr-corner</xhtml:code><br/><br/>There are also modifier keys to check and various values for each of these keys. A value of <xhtml:code>5</xhtml:code> means the corner will start the screen saver. The corresponding wvous-xx-modifier key should be set to <xhtml:code>0</xhtml:code>.</xhtml:p>
                    </xccdf:fixtext>
                    <!-- Complex OR to check all users for at least one hot corner set to start the screensaver. -->
                    <xccdf:complex-check operator="OR">
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="Check all users for &quot;start screen saver&quot; top left hot corner">
                                    <ecl:command> find /Users -maxdepth 1 \! -name ".localized" \! -name
                                        "Shared" \! -name "Guest" \! -name "Users" -exec bash -c '
                                        dom="{}/Library/Preferences/com.apple.dock";
                                        defaults read $dom | egrep ^[[:space:]]*\"wvous\-tl\-corner\".*5\;$ ' \;</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="Check all users for &quot;start screen saver&quot; top right hot corner">
                                    <ecl:command> find /Users -maxdepth 1 \! -name ".localized" \! -name
                                        "Shared" \! -name "Guest" \! -name "Users" -exec bash -c '
                                        dom="{}/Library/Preferences/com.apple.dock";
                                        defaults read $dom | egrep ^[[:space:]]*\"wvous\-tr\-corner\".*5\;$ ' \;</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="Check all users for &quot;start screen saver&quot; bottom left hot corner">
                                    <ecl:command> find /Users -maxdepth 1 \! -name ".localized" \! -name
                                        "Shared" \! -name "Guest" \! -name "Users" -exec bash -c '
                                        dom="{}/Library/Preferences/com.apple.dock";
                                        defaults read $dom | egrep ^[[:space:]]*\"wvous\-bl\-corner\".*5\;$ ' \;</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="Check all users for &quot;start screen saver&quot; bottom right hot corner">
                                    <ecl:command> find /Users -maxdepth 1 \! -name ".localized" \! -name
                                        "Shared" \! -name "Guest" \! -name "Users" -exec bash -c '
                                        dom="{}/Library/Preferences/com.apple.dock";
                                        defaults read $dom | egrep ^[[:space:]]*\"wvous\-br\-corner\".*5\;$ ' \;</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                    </xccdf:complex-check>
                </xccdf:Rule>
                <xccdf:Rule id="do-not-set-any-screen-corner-to-sleep-display" role="full" selected="false" weight="1.0">
                    <xccdf:title>Do not set any screen corner to Sleep Display</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>When this feature is used the screen goes blank but moving the mouse or pressing a button brings up the screen again with no password required. The screen saver (with its lock) will still kick in after X minutes, but the user could be lulled into a false sense of security if she sees her screen is blank and the screen saver has not activated.</xhtml:p>
                            <xhtml:p class="bold">Context: User</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Exposé &amp; Spaces, make sure none of the Active Screen Corners are set to Sleep Display.<br/><br/>Alternatively, Use the following command:<br/><br/>read ~/Library/Preferences/com.apple.dock<br/><br/>verify none of the *-corner keys has a value of "10".</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Exposé &amp; Spaces, make sure none of the Active Screen Corners are set to Sleep Display.<br/><br/>The screen corners can be set using the defaults command, but the permutations of combinations are many. The plist file to check is <br/><xhtml:code>~/Library/Preferences/com.apple.dock</xhtml:code> and the keys are <br/><br/><xhtml:code>wvous-bl-corner<br/>wvous-br-corner <br/>wvous-tl-corner <br/>wvous-tr-corner</xhtml:code><br/><br/>There are also modifier keys to check and various values for each of these keys. A value of <xhtml:code>10</xhtml:code> for any of corners should not be allowed (<xhtml:code>10</xhtml:code> = sleep display). If any value is <xhtml:code>10</xhtml:code>, change the value to <xhtml:code>1</xhtml:code> (which means no action). Also change the corresponding wvous-xx-modifier key to <xhtml:code>1048576</xhtml:code>.</xhtml:p>
                    </xccdf:fixtext>
                    <!-- Complex AND check to make sure all hot corners are not set to sleep the display. -->
                    <xccdf:complex-check operator="AND">
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="Check all users for &quot;sleep display&quot; top left hot corner">
                                    <ecl:command> find /Users -maxdepth 1 \! -name ".localized" \! -name
                                        "Shared" \! -name "Guest" \! -name "Users" -exec bash -c '
                                        dom="{}/Library/Preferences/com.apple.dock";
                                        defaults read $dom | egrep ^[[:space:]]*\"wvous\-tl\-corner\".*10\;$ ' \;</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="Check all users for &quot;sleep display&quot; top right hot corner">
                                    <ecl:command> find /Users -maxdepth 1 \! -name ".localized" \! -name
                                        "Shared" \! -name "Guest" \! -name "Users" -exec bash -c '
                                        dom="{}/Library/Preferences/com.apple.dock";
                                        defaults read $dom | egrep ^[[:space:]]*\"wvous\-tr\-corner\".*10\;$ ' \;</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="Check all users for &quot;sleep display&quot; bottom left hot corner">
                                    <ecl:command> find /Users -maxdepth 1 \! -name ".localized" \! -name
                                        "Shared" \! -name "Guest" \! -name "Users" -exec bash -c '
                                        dom="{}/Library/Preferences/com.apple.dock";
                                        defaults read $dom | egrep ^[[:space:]]*\"wvous\-bl\-corner\".*10\;$ ' \;</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="Check all users for &quot;sleep display&quot; bottom right hot corner">
                                    <ecl:command> find /Users -maxdepth 1 \! -name ".localized" \! -name
                                        "Shared" \! -name "Guest" \! -name "Users" -exec bash -c '
                                        dom="{}/Library/Preferences/com.apple.dock";
                                        defaults read $dom | egrep ^[[:space:]]*\"wvous\-br\-corner\".*10\;$ ' \;</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                    </xccdf:complex-check>
                </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="keyboard-and-mouse-action-items-">
                <xccdf:title>Keyboard &amp; Mouse Action Items</xccdf:title>
                <xccdf:description/>
                <xccdf:Rule id="disable-allow-bluetooth-devices-to-wake-this-computer" role="full" selected="false" weight="1.0">
                    <xccdf:title>Disable "Allow Bluetooth devices to wake this
                        computer"</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Unless you are using a Bluetooth keyboard or mouse in a secure environment, there is no reason to allow Bluetooth devices to wake the computer. An attacker could use a Bluetooth device to wake a computer and then attempt to gain access.</xhtml:p>
                            <xhtml:p class="bold">Context: User</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Keyboard &amp; Mouse, Bluetooth tab, make sure the "Allow Bluetooth devices to wake this computer" is not checked.<br/><br/>Alternatively, run the following command:<br/><br/><xhtml:code>defaults -currentHost read \ <br/> ~/Library/Preferences/com.apple.Bluetooth BluetoothSystemWakeEnable</xhtml:code><br/>
                                <br/>And verify the result is <xhtml:code>0</xhtml:code>.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Keyboard &amp; Mouse, Bluetooth tab, make sure the "Allow Bluetooth devices to wake this computer" is not checked.<br/><br/>Alternatively, run the following command:<br/><br/><xhtml:code>defaults -currentHost write ~/Library/Preferences/com.apple.Bluetooth \<br/>BluetoothSystemWakeEnable -bool 0 </xhtml:code></xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="command test «defaults -currentHost read com.apple.Bluetooth BluetoothSystemWakeEnable»">
                                <ecl:command>find /Users -maxdepth 1 \! -name ".localized" \! -name "Shared"
                                    \! -name "Users" \! -name "Guest" -exec bash -c
                                    'dom="com.apple.Bluetooth BluetoothSystemWakeEnable"; result=`sudo -u
                                    \`basename {}\` defaults -currentHost read $dom 2&gt;/dev/null`; if [ $?
                                    -ne 0 ]; then echo "Valid"; else if [ $result -eq 0 ]; then echo
                                    "Valid"; else echo "Invalid"; fi; fi;' \;</ecl:command>
                                <ecl:line-selection op="pm" value="^Invalid$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="network-preferences-action-items">
                <xccdf:title>Network Preferences Action Items</xccdf:title>
                <xccdf:description>
                    <xhtml:p>Configuring the network from the CLI is extremely tricky, but some options can be configured using the networksetup command.</xhtml:p>
                </xccdf:description>
                <xccdf:Rule id="create-network-specific-locations" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Create network specific locations</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>The network location feature of the Mac is very powerful tool to manage network security. By creating different network locations, a user can easily (and without administrative privileges) change the network settings on the Mac. By only using the network interfaces needed at any specific time, exposure to attackers is limited.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 2</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>Open System Preferences: Network<br/>Verify each network location is set up properly. </xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>Deleting the Automatic location cannot be undone.</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>Create multiple network locations as needed. <br/><br/>Delete the Automatic location for any device that does not use multiple network services set for DHCP or dynamic addressing. If network services like FireWire, VPN, AirPort or Ethernet are not used by a specific device class those services should be deleted: <br/>1. Select Edit Locations from the Locations popup menu. <br/>2. Select the Automatic location. <br/>3. Click the minus button for any unneeded service.<br/>
                            <br/>Create network locations as needed. Ideally, if your goal is to limit which interfaces can be used at any given time, one network location for each interface should be created. See the Appendix C for an example.</xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
                <xccdf:Rule id="disable-airport" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Disable AirPort</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>If Airport is installed and not needed, disable it. There is no need to allow attackers a possible route to the Mac. </xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Network, select the Airport interface and verify the Airport card off.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Network, select the Airport interface and click the minus button or turn the Airport card off.</xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
                <xccdf:Rule id="enable-show-airport-status-in-menu-bar" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Enable Show AirPort Status in Menu Bar</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>If an Airport or other wireless card is installed, show the AirPort status in the menu bar so that user can quickly determine if AirPort is on or off. If on, the user can quickly turn it off if AirPort interface should be off.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Network, select the Airport interface, then click the Advanced button. Verify Show AirPort status in menu bar is on.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>AirPort is Apple's marketing name for its 802.11b, g, and n wireless interfaces.</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Network, select the Airport interface, then click the Advanced button. Turn on Show AirPort status in menu bar.</xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
                <xccdf:Rule id="disable-bluetooth2" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Disable Bluetooth</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>If Bluetooth is installed and not needed, disable it. There is no need to allow attackers a possible route to the Mac. </xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Network, select the Bluetooth interface and verify that Bluetooth is not offered as a network interface option.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Network, select the Bluetooth interface and click the minus button or turn Bluetooth off.</xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
                <xccdf:Rule id="disable-ipv6" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Disable IPv6</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Unless used, IPv6 should be turned off for each interface. IPv6 is not widely used yet, so most people can turn this off until needed.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 2</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Network, select the each active interface then click the Advanced button.<br/>Find the Configure IPv6 popup menu and verify it is Off.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Network, select the each active interface then click the Advanced button.<br/>Find the Configure IPv6 popup menu and set it to Off.</xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="print-and-fax-preferences-action-items-">
                <xccdf:title>Print &amp; Fax Preferences Action Items</xccdf:title>
                <xccdf:description/>
                <xccdf:Rule id="only-use-known-printers" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Only use known printers</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>The Mac's ability to browse and find printers is very good. One should only print to a known printer. When at a public location, such as a hotel or trade show, many printers may appear available in the Print &amp; Fax panel. Only print to a known printer.</xhtml:p>
                            <xhtml:p class="bold">Context: User</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>This rule cannot be implemented technically. One just has to use one's judgment when printing.</xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
                <xccdf:Rule id="disable-receiving-faxes" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Disable receiving faxes</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Unless fax reception is required, the option should be turned off. While there is no known vector to attack a Mac using a fax, an attacker could attempt to use fax reception to determine if a modem is connected to a computer. </xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Print &amp; Fax, Fax tab, verify fax reception is off. This option will only be present if the computer is equipped with a fax modem.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Print &amp; Fax, Fax tab, turn off fax reception. </xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="quicktime-preferences-action-items">
                <xccdf:title>QuickTime Preferences Action Items</xccdf:title>
                <xccdf:description>
                    <xhtml:p>One of the few known common attack vectors is QuickTime. Securing QuickTime can help protect your computer against malware.</xhtml:p>
                </xccdf:description>
                
                <xccdf:Rule id="do-not-install-third-party-quicktime-software" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Do not install third-party QuickTime software</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Do not install any QuickTime software unless the source is known and trusted. </xhtml:p>
                            <xhtml:p class="bold">Context: System and User</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>Check that software in <xhtml:code>/Library/QuickTime</xhtml:code> and <xhtml:code>~/Library/QuickTime</xhtml:code> is valid.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>Check that software in <xhtml:code>/Library/QuickTime</xhtml:code> and <xhtml:code>~/Library/QuickTime</xhtml:code> is valid. </xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
                <xccdf:Rule id="disable-play-movies-automatically" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Disable "Play Movies automatically"</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>QuickTime is used in browsers to play audio and video content. When the browser sees such content the browser passes off control to QuickTime through its Web browser plug-in. QuickTime can be set to start playing this content immediately. Some content may contain malicious code embedded in the audio or video. Ensure the user wants to play the embedded content by turning off the "Play Movie Automatically" option. </xhtml:p>
                            <xhtml:p class="bold">Context: User</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: QuickTime: Browser tab, verify "Play movies automatically" is disabled.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: QuickTime: Browser tab, disable "Play movies automatically"</xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="security-preferences-action-items-">
                <xccdf:title>Security Preferences Action Items</xccdf:title>
                <xccdf:description/>
                <xccdf:Rule id="require-a-password-to-wake-the-computer-from-sleep-or-screen-saver" role="full" selected="false" weight="1.0">
                    <xccdf:title>Require a password to wake the computer from sleep or screen
                        saver</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Sometimes referred to as a "screen lock" this option will keep the casual user away from your Mac when the screen saver has started.</xhtml:p>
                            <xhtml:p class="bold">Context: User</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Security, General tab, verify "Require a password to wake the computer from sleep or screen saver" is on<br/><br/>Alternatively, run the following command:<br/><br/><xhtml:code>defaults -currentHost read com.apple.screensaver askForPassword</xhtml:code><br/><br/>and verify the setting is <xhtml:code>1</xhtml:code></xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>This only protects the system when the screen saver is running.</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Security, General tab, check "Require a password to wake the computer from sleep or screen saver"<br/><br/>Alternatively, run the following command. The current user will need to log off and on for changes to take effect.<br/><br/><xhtml:code>defaults -currentHost write \<br/> com.apple.screensaver askForPassword -int 1</xhtml:code></xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="command test «defaults -currentHost read com.apple.screensaver askForPassword»">
                                <ecl:command>find /Users -maxdepth 1 \! -name ".localized" \! -name "Shared"
                                    \! -name "Users" \! -name "Guest" -exec bash -c
                                    'dom="com.apple.screensaver askForPassword"; result=`sudo -u \`basename
                                    {}\` defaults read $dom 2&gt;/dev/null`; if [ $? -ne 0 ]; then
                                    echo "Invalid"; else if [ $result -eq 1 ]; then echo "Valid"; else echo
                                    "Invalid"; fi; fi;' \;</ecl:command>
                                <ecl:line-selection op="pm" value="^Invalid$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:Rule>
                <xccdf:Rule id="disable-automatic-login2" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Disable automatic login</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Having a computer automatically log in bypasses a major security feature (the login password) and can allow a casual user access to sensitive data.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Security, General tab, verify "Disable Automatic Login" is checked.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Security, General tab, check "Disable Automatic Login". <br/><br/>Note: Automatic login can also be disabled in System Preferences: Accounts. </xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
                <xccdf:Rule id="require-a-password-to-unlock-each-system-preferences-pane" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Require a password to unlock each System Preferences pane</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>By requiring a password to unlock System Preferences, a casual user is less likely to compromise the security of the Mac.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Security, General tab, verify "Require a password to unlock each System Preferences pane" is checked.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Security, General tab, check "Require a password to unlock each System Preferences pane." <br/><br/>Alternatively, using <xhtml:code>sudo</xhtml:code> edit the /private/etc/authorization file. This file should be backed up first and then edited. This is a critical file for OS X operations and should edited with the greatest of care. <br/><br/>Find <xhtml:code>&lt;key&gt;system.preferences&lt;/key&gt;</xhtml:code><br/>Then find <xhtml:code>&lt;key&gt;shared&lt;/key&gt;</xhtml:code><br/> Then replace <xhtml:code>true</xhtml:code> with <xhtml:code>false</xhtml:code>.</xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
                
                <xccdf:Rule id="automatically-update-safe-downloads-list-" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Automatically update safe downloads list</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Files downloaded via applications such as Safari, iChat, and Mail are checked for safety at the time that they are opened. If a file is identified as containing known malware, the system will display a dialog that alerts you to move it to the Trash. You should empty the Trash to finalize the removal of the file. Apple maintains a list of known malicious software that is used during the safe download check to determine if a file contains malicious software, the list is updated daily by a background process.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>none</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>https://support.apple.com/kb/HT4651 </xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Security, General tab, ensure that “Automatically update safe downloads list” is checked </xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
                <xccdf:Rule id="disable-automatic-logout-after-a-period-of-inactivity" role="full" selected="false" weight="1.0">
                    <xccdf:title>Disable "automatic logout" after a period of
                        inactivity</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>If the machine automatically logs out, unsaved work might be lost. The same level of security is available by using a Screen Saver and the "Require a password to wake the computer from sleep or screen saver" option. </xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Security, General tab, verify "Log out after X minutes of inactivity" is unchecked.<br/><br/>Alternatively, run the following command<br/><br/><xhtml:code>defaults read /Library/Preferences/.GlobalPreferences \<br/>com.apple.autologout.AutoLogOutDelay </xhtml:code><br/><br/>and verify the result is <xhtml:code>0</xhtml:code>.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Security, General tab, uncheck "Log out after X minutes of inactivity."<br/><br/>Alternatively, run the following command<br/><br/><xhtml:code>sudo defaults write /Library/Preferences/.GlobalPreferences \<br/>com.apple.autologout.AutoLogOutDelay -int 0</xhtml:code></xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:complex-check operator="OR">
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="command test «defaults read /Library/Preferences/.GlobalPreferences com.apple.autologout.AutoLogOutDelay»" success="fail">
                                    <ecl:command>defaults read /Library/Preferences/.GlobalPreferences
                                        com.apple.autologout.AutoLogOutDelay</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="command test «defaults read /Library/Preferences/.GlobalPreferences com.apple.autologout.AutoLogOutDelay»">
                                    <ecl:command>defaults read /Library/Preferences/.GlobalPreferences
                                        com.apple.autologout.AutoLogOutDelay</ecl:command>
                                    <ecl:line-selection op="pm" value="^0$"/>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                    </xccdf:complex-check>
                </xccdf:Rule>
                <xccdf:Rule id="use-secure-virtual-memory" role="full" selected="false" weight="1.0">
                    <xccdf:title>Use secure virtual memory</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Passwords and other sensitive information can be extracted from insecure virtual memory, so it's a good idea to secure virtual memory. If an attacker gained control of the Mac, the attacker would be able to extract user names and passwords or other kinds of data from the virtual memory swap files.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Security, General tab, verify "Use secure virtual memory" is checked.<br/><br/>Alternatively, run the following command<br/><br/><xhtml:code>defaults read /Library/Preferences/com.apple.virtualMemory UseEncryptedSwap</xhtml:code><br/><br/>verify the result is <xhtml:code>1</xhtml:code></xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>Enabling secure virtual memory in Snow Leopard also encrypts the hibernation file if the safe sleep feature is enabled on compatible hardware.</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Security, General tab, check "Use secure virtual memory."<br/><br/>Alternatively, run the following command<br/><br/><xhtml:code>sudo defaults write /Library/Preferences/com.apple.virtualMemory \<br/>UseEncryptedSwap -bool yes</xhtml:code><br/><br/>A reboot is required to make a change.</xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <!--
                                1. This check will execute "defaults" and reads from /Library/Preferences/com.apple.virtualMemory.plist
                                for the value UseEncryptedSwap.\
                                2. If the file is not present, the "defaults" command will fail and generate an error which is sent to <err>.
                                3. If the file is present, the "defaults" command will return the value assigned to UseEncryptedSwap to <out_raw>
                                4. If the output matches the pattern of 1, the check passes.
                                5. If an error or any other value is returned, the check fails.
                            -->
                            <ecl:shell-command check="all" comment="Virtual memory is encrypted.">
                                <ecl:command>defaults read /Library/Preferences/com.apple.virtualMemory UseEncryptedSwap</ecl:command>
                                <ecl:line-selection op="pm" value="^1$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:Rule>
                <xccdf:Rule id="disable-remote-control-infrared-receiver" role="full" selected="false" weight="1.0">
                    <xccdf:title>Disable remote control infrared receiver</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>It's very humorous to watch a jokester use an Apple remote at a Mac trade show. Macs all over the place start to obey the remote and the unsuspecting user is left bewildered. More importantly, a remote could be used to page through a document or presentation, thus revealing sensitive information. The solution is to turn off the remote and only turn it on when needed. <br/><br/>Optionally, the user can "pair" the remote with the computer. Pairing will force the computer to only respond to commands from the paired remote. Pairing a remote is discussed in section 2.4.13.7.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Security, General tab, verify that "Disable remote control infrared receiver" is checked or the computer is paired with a specific remote.<br/><br/>Alternatively, run the following command:<br/><br/><xhtml:code>defaults read /Library/Preferences/com.apple.driver.AppleIRController</xhtml:code><br/><br/>Verify the <xhtml:code>DeviceEnabled</xhtml:code> is <xhtml:code>0</xhtml:code> or the <xhtml:code>UIDFilter</xhtml:code> does not equal <xhtml:code>none</xhtml:code></xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Security, General tab, check "Disable remote control infrared receiver".<br/><br/>Alternatively to disable the remote use the following command:<br/><br/><xhtml:code>sudo defaults write /Library/Preferences/com.apple.driver.AppleIRController \<br/>DeviceEnabled -bool no</xhtml:code><br/></xhtml:p>
                    </xccdf:fixtext>
                    <!-- OR check - Either of the following will pass the check:
                        1. Check if IR Controller is not present. (PASS) 
                        note: the check="" attribute is not required for this as we are only evaluating the command being run for pass/fail.
                        2. Check to see if the IR Controller is disabled (PASS). 
                    -->
                    <xccdf:complex-check operator="OR">
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command comment="IR Controller not present." success="fail">
                                    <ecl:command>ls /Library/Preferences/com.apple.driver.AppleIRController.plist</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="IR Controller is disabled.">
                                    <ecl:command>defaults read /Library/Preferences/com.apple.driver.AppleIRController DeviceEnabled</ecl:command>
                                    <ecl:line-selection op="pm" value="^0$"/>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                    </xccdf:complex-check>
                </xccdf:Rule>
                <xccdf:Rule id="pair-the-remote-control-infrared-receiver" role="full" selected="false" weight="1.0">
                    <xccdf:title>Pair the remote control infrared receiver</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>If a remote is used often with a computer, the remote can be "pair" to work with the computer. This will allow on the paired remote to work on that computer. </xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p><br/>Open System Preferences: Security and verify the remote is paired.<br/>Alternatively, run the following command:<br/><br/><xhtml:code>defaults read /Library/Preferences/com.apple.driver.AppleIRController</xhtml:code><br/><br/>Verify the <xhtml:code>UIDFilter</xhtml:code> does not equal <xhtml:code>none.</xhtml:code></xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>Pairing your Apple Remote with your computer:<br/>http://docs.info.apple.com/article.html?artnum=302545</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>See http://docs.info.apple.com/article.html?artnum=302545 for complete instructions.</xhtml:p>
                    </xccdf:fixtext>
                    <!-- OR check - Any one of the following will pass the check:
                        1. Check if IR Controller is not present. (PASS) 
                        note: the check="" attribute is not required for this as we are only evaluating the command being run for pass/fail.
                        2. Check to see if the IR Controller is disabled (PASS). 
                        3. Check to see if the IR Controller is paired to a remote (PASS)
                        note: the success="pass" here is to catch command failures. If the settings file doesn't exist, this would pass without this additional check.
                    -->
                    <xccdf:complex-check operator="OR">
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command comment="IR Controller not present." success="fail">
                                    <ecl:command>ls /Library/Preferences/com.apple.driver.AppleIRController.plist</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="IR Controller is disabled.">
                                    <ecl:command>defaults read /Library/Preferences/com.apple.driver.AppleIRController UIDFilter</ecl:command>
                                    <ecl:line-selection op="pm" value="^0$"/>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="IR Controller is paired to a remote." success="pass">
                                    <ecl:command>defaults read /Library/Preferences/com.apple.driver.AppleIRController UIDFilter</ecl:command>
                                    <ecl:line-selection op="pm" value="^none$"/>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                    </xccdf:complex-check>
                </xccdf:Rule>
                <xccdf:Rule id="enable-filevault-for-every-account" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Enable FileVault for every account</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>FileVault offers protection for data at rest. This means that the data is only protected when the user is not logged in, which is useful if the computer is stolen.</xhtml:p>
                            <xhtml:p class="bold">Context: User</xhtml:p>
                            <xhtml:p class="bold">Level: 2</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Security, FileVault tab, verify FileVault is on for each user.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>http://www.apple.com/sg/macosx/features/filevault/</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Security, FileVault tab, press the "Set Master Password" button and set a master password. Set and secure this master password according to your organization's policies.<br/>Press the Turn FileVault on button to turn FileVault on.<br/><br/>Apple offers a workaround solution for organizations to maintain a common Master password. Contact your Apple representative for more information.</xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
                <xccdf:Rule id="enable-firewall-protection" role="full" selected="false" weight="1.0">
                    <xccdf:title>Enable firewall protection</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Apple's firewall will protect your computer from certain incoming attacks. Apple offers three firewall options: Allow all, Allow only essential, and Allow access for specific incoming connections. Unless you have a specific need to allow incoming connection (for services such as SSH, file sharing, or web services), set the firewall to "Allow only essential services," otherwise use the "Allow access for specific incoming connections" option.Only enable stealth mode if approved by your network engineering, scanning or security team.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Security, Firewall tab, verify "Allow only essential services" or "Set access for specific services and applications" is selected.<br/><br/>Alternatively, run the following command:<br/><br/><xhtml:code>defaults read /Library/Preferences/com.apple.alf globalstate</xhtml:code>
                                <br/><br/>verify the value returned is <xhtml:code>1</xhtml:code> or <xhtml:code>2</xhtml:code>.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>http://docs.info.apple.com/article.html?artnum=306938</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Security, Firewall tab, select "Allow only essential services" or "Set access for specific services and applications".<br/><br/>Alternatively, run the following command:<br/><br/><xhtml:code>sudo defaults write \/Library/Preferences/com.apple.alf globalstate -int &lt;value&gt;</xhtml:code><br/><br/>where <xhtml:code>&lt;value&gt;</xhtml:code> is<br/><xhtml:code>0</xhtml:code> = off<br/><xhtml:code>1</xhtml:code> = on for specific services<br/><xhtml:code>2</xhtml:code> = on for essential services</xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="command test «defaults read /Library/Preferences/com.apple.alf globalstate»">
                                <ecl:command>defaults read /Library/Preferences/com.apple.alf
                                    globalstate</ecl:command>
                                <ecl:line-selection op="pm" value="^0$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:Rule>
                <xccdf:Rule id="enable-secure-keyboard-entry" role="full" selected="false" weight="1.0">
                    <xccdf:title>Secure Keyboard Entry</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>In a multi-user environment it is possible for keystrokes to be intercepted. If an admin is typing sensitive commands in <xhtml:code>terminal.app</xhtml:code> it is suggested that secure keyboard entry is enabled.</xhtml:p>
                            <xhtml:p class="bold">Context: User</xhtml:p>
                            <xhtml:p class="bold">Level: 2</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>Launch <xhtml:code>terminal.app</xhtml:code> and make sure "Secure Keyboard Entry" is checked.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>http://docs.info.apple.com/article.html?path=Terminal/2.1/en/5386.html</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>From <xhtml:code>terminal.app</xhtml:code> click on Terminal and then click on " Secure Keyboard Entry."</xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="command test «defaults read com.apple.Terminal SecureKeyboardEntry»">
                                <ecl:command>find /Users -maxdepth 1 \! -name ".localized" \! -name "Shared"
                                    \! -name "Users" \! -name "Guest" -exec bash -c
                                    'dom="com.apple.Terminal SecureKeyboardEntry"; result=`sudo -u \`basename
                                    {}\` defaults read $dom 2&gt;/dev/null`; if [ $? -ne 0 ]; then
                                    echo "Invalid"; else if [ $result -eq 1 ]; then echo "Valid"; else echo
                                    "Invalid"; fi; fi;' \;</ecl:command>
                                <ecl:line-selection op="pm" value="^Invalid$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="sharing-preferences-action-items-">
                <xccdf:title>Sharing Preferences Action Items</xccdf:title>
                <xccdf:description/>
                <xccdf:Rule id="change-the-computer-name" role="full" selected="false" weight="1.0">
                    <xccdf:title>Change the computer name</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>If the computer is used in an organization that assigns host names, it is a good idea to change the computer name to the host name. This is more of a best practice than a security measure. If the host name and the computer name are the same, computer support may be able to track problems down easier.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 2</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Sharing, verify the computer name is set to the host name.<br/><br/>Alternatively, use the following command:<br/><br/><xhtml:code>systemsetup -getcomputername </xhtml:code></xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Sharing, change the computer name to the host name.<br/><br/>Alternatively, use the following command:<br/><br/><xhtml:code>sudo systemsetup -setcomputername &lt;host name&gt;</xhtml:code></xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <!-- `expr` returns: 0=false, 1=true -->
                            <ecl:shell-command check="all" comment="Computer hostname matches Sharing name">
                                <ecl:command>expr "`systemsetup -getcomputername | cut -d" " -f3-`" = `hostname -s`</ecl:command>
                                <ecl:line-selection op="pm" value="^1$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:Rule>
                <xccdf:Rule id="configure-screen-sharing" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Configure Screen Sharing</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Screen Sharing uses the open source VNC protocol to let one computer observe or control the screen on another computer. Apple Screen Sharing is encrypted (using a proprietary encryption protocol), so others cannot eavesdrop on a screen sharing session. The most important aspect of securing screen sharing is to make sure only the correct people can observe or control the Mac.<br/><br/>Apple allows for a few options when configuring screen sharing and each has its place for a secure Mac. These option are not mutually exclusive.<br/><br/>1. Screen Sharing off<br/>This is the most secure option.<br/>2. Anyone may request permission to control screen<br/>This is the second most secure option. When a remote user attempts to share the screen, the Mac will prompt the local user for permission. If the local user doesn't grant permission, the remote user cannot share the screen. If a local user is not at the Mac to grant permission, then the screen cannot be
                                shared. <br/>3. VNC viewers may control screen with password<br/>This is the least secure option since the remote user only needs to know the password. <br/>4. Allow access to all users of the Mac, or specific users (or groups of users)<br/>Allowing access to only users with accounts on the Mac, or if a directory service (like Open Directory or Active Directory) is used, specific users or groups, allows some restriction of who can share the screen. Any authorized user would be able to observe or control the screen without the express permission of the local user. This option should only be used when necessary (possibly in a school environment).</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Sharing, turn on Screen Sharing only if necessary. Configure Screen Sharing according to personal or organizational needs, but be aware of the implications of each option.</xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
                <xccdf:Rule id="disable-file-sharing" role="full" selected="false" weight="1.0">
                    <xccdf:title>Disable File Sharing</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Apple's File Sharing uses a combination of many technologies: FTP, SMB (Windows sharing) and AFP (Mac sharing). Generally speaking, file sharing should be turned off and a dedicated, well-managed file server should be used to share files. If file sharing must be turned on, the user should be aware of the security implications of each option.<br/><br/>Turning on File Sharing automatically shares the entire hard drive to anyone with an account on the Mac, or anyone who can access the Mac using a network account. File and folder access control restrictions are enforced by default, so user Mary cannot access user Joe's Documents folder (by default). Specific access controls can be relaxed or strengthened for specific folders in the Sharing System Preference pane.<br/><br/>Each method of sharing files has advantages and disadvantages. Regardless of which method used, the folder and file access permissions must be controlled to make sure only the correct data
                                is shared. The three ways to share files using File Sharing are:5<br/>1. Apple File Protocol (AFP)<br/>AFP under Snow Leopard automatically uses encrypted logins, so this method of sharing files is fairly secure. The entire hard disk is shared to administrator user accounts. Individual home folders are shared to their respective user accounts. Users' "Public" folders (and the "Drop Box" folder inside) are shared to any user account that has sharing access to the computer (i.e. anyone in the "staff" group, including the guest account if it is enabled).<br/>2. File Transfer Protocol (FTP)<br/>FTP send password via clear text and thus is very insecure. FTP is commonly used for anonymous upload and download of files where security is of less concern. FTP should not be used on a client Mac except in rare case for temporary anonymous sharing. <br/>3. Server Message Block (SMB), Common Internet File System (CIFS)<br/>When Windows (or
                                possibly Linux) computers need to access file shared on a Mac, SMB/CIFS file sharing is commonly used. Apple warns that SMB sharing stores passwords is a less secure fashion than AFP sharing and anyone with system access can gain access to the password for that account. When sharing with SMB, each user that will access the Mac must have SMB enabled.<br/></xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences; Sharing, File Sharing; Options, verify only the needed sharing services are on.<br/><br/>Alternatively, run the following commands:<br/><xhtml:code>launchctl list</xhtml:code><br/><br/>and look for the various services listed above in the remediation section.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>If authenticated ftp is used all console and SSH users should be entered into the <xhtml:code>/etc/ftpusers</xhtml:code> list to deny ftp access for those users with full access.</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Sharing, turn on Screen Sharing only if necessary. Configure Screen Sharing according to personal or organizational needs, but be aware of the implications of each option.<br/><br/>To turn off AFP from the command line: <br/><xhtml:code>sudo launctl unload -w /System/Library/LaunchDaemons/com.apple.AppleFileServer.plist</xhtml:code><br/><br/>To turn off FTP from the command line: <br/><xhtml:code>sudo launctl unload -w /System/Library/LaunchDaemons/ftp.plist</xhtml:code><br/><br/>To turn off SMB sharing from the CLI:<br/><xhtml:code>sudo defaults delete /Library/Preferences/SystemConfiguration/com.apple.smb.server \<br/>EnabledServices<br/><br/>sudo launctl unload -w /System/Library/LaunchDaemons/nmbd.plist<br/>sudo launctl unload -w /System/Library/LaunchDaemons/smbd.plist</xhtml:code></xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:complex-check operator="AND">
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="command test «launchctl list»">
                                    <ecl:command>launchctl list</ecl:command>
                                    <ecl:line-selection op="pm" value=".*com.apple.AppleFileServer$"/>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="command test «launchctl list»">
                                    <ecl:command>launchctl list</ecl:command>
                                    <ecl:line-selection op="pm" value=".*org.samba.smbd$"/>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="command test «launchctl list»">
                                    <ecl:command>launchctl list</ecl:command>
                                    <ecl:line-selection op="pm" value=".*org.samba.nmbd$"/>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="command test «launchctl list»">
                                    <ecl:command>launchctl list</ecl:command>
                                    <ecl:line-selection op="pm" value=".*com.apple.ftpd$"/>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                    </xccdf:complex-check>
                </xccdf:Rule>
                <xccdf:Rule id="secure-smb" role="full" selected="false" weight="1.0">
                    <xccdf:title>Secure SMB</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>SMB can be configured using the <xhtml:code>/etc/smb.conf</xhtml:code> file. By default, SMB is fairly secure, but it can be made more secure with a few additions to the <xhtml:code>/etc/smb.conf</xhtml:code> file. </xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 2</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p><xhtml:code>cat /etc/smb.conf</xhtml:code> and look for the options as listed in the remediation section.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p><xhtml:code>man smb.conf</xhtml:code></xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>Using <xhtml:code>sudo</xhtml:code>, edit the file <xhtml:code>/etc/smb.conf</xhtml:code>
                            <br/>Find the [Global] section and add the following lines:<br/>
                            <br/><xhtml:code>; don't allow any anonymous connections <br/>restrict anonymous = 2<br/><br/>; do not allow guest access (this is the default)<br/>guest OK = no<br/><br/>; only allow NTLMv2 and LMv2 response<br/>client ntlmv2 auth = yes</xhtml:code></xhtml:p>
                    </xccdf:fixtext>
                    <!-- Re-wrote all checks for this recommendation as shell-command checks that will now grep /etc/smb.conf for the values in the [global] section only.
                    All checks must be successful or the recommendation fails.-->
                    <xccdf:complex-check operator="AND">
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command comment="Verify that restrict anonymous = 2 appears in the [global] section of /etc/smb.conf." success="pass">
                                    <ecl:command>egrep -A 1000 '^[[:space:]]*\[global\]' /etc/smb.conf | egrep -m 2 -B 1000 '^[[:space:]]*\[' | egrep '^[[:space:]]*restrict[[:space:]]+anonymous[[:space:]]+=[[:space:]]+2[[:space:]]*$'</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command comment="Verify that guest ok = no appears in the [global] section of /etc/smb.conf." success="pass">
                                    <ecl:command>egrep -A 1000 '^[[:space:]]*\[global\]' /etc/smb.conf | egrep -m 2 -B 1000 '^[[:space:]]*\[' | egrep '^[[:space:]]*guest[[:space:]]+ok[[:space:]]+=[[:space:]]+no[[:space:]]*$'</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command comment="Verify that client ntlmv2 auth = yes appears in the [global] section of /etc/smb.conf" success="pass">
                                    <ecl:command>egrep -A 1000 '^[[:space:]]*\[global\]' /etc/smb.conf | egrep -m 2 -B 1000 '^[[:space:]]*\[' | egrep '^[[:space:]]*client[[:space:]]+ntlmv2[[:space:]]+auth[[:space:]]+=[[:space:]]+yes[[:space:]]*$'</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                    </xccdf:complex-check>
                </xccdf:Rule>
                <xccdf:Rule id="turn-off-printer-sharing" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Turn off Printer Sharing</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Printer Sharing makes the Mac into a print server. Attackers could attempt to exploit the print server to gain access to the Mac. As with File Sharing, Printer Sharing is best left off and a dedicated, well-managed print server or a printer with built-in IP network capability is recommended.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Sharing, verify Printer Sharing is off for each printer listed.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Sharing, turn of Printer Sharing.</xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
                <xccdf:Rule id="disable-web-sharing" role="full" selected="false" weight="1.0">
                    <xccdf:title>Disable Web Sharing</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Web Sharing uses the Apache 2.2.x Web server to turn the Mac into an HTTP/Web server. When Web Sharing is on, files in <xhtml:code>/Library/WebServer/Documents</xhtml:code> as well as each user's "Sites" folder are made available on the Web. As with File Sharing, Web Sharing is best left off and a dedicated, well-managed Web server is recommended. </xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Sharing, verify Web Sharing is off.<br/><br/>Alternatively, run the following command:<br/><br/><xhtml:code>launchctl list</xhtml:code><br/><br/>and look for a line with <xhtml:code>"apache."</xhtml:code></xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>Snow Leopard includes Apache 2.2</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Sharing, turn on Web Sharing only if necessary.<br/><br/>To turn off Web sharing from the command line:<br/><xhtml:code>sudo launchctl unload -w \<br/> /System/Library/LaunchDaemons/org.apache.httpd.plist</xhtml:code></xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="command test «launchctl list»">
                                <ecl:command>launchctl list</ecl:command>
                                <ecl:line-selection op="pm" value=".*org.apache.httpd$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:Rule>
                <xccdf:Rule id="secure-web-sharing" role="full" selected="false" weight="1.0">
                    <xccdf:title>Secure Web Sharing</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Web Sharing can be configured using the <xhtml:code>/etc/apache2/httpd.conf</xhtml:code> file (for global configurations). By default, Apache is fairly secure, but it can be made more secure with a few additions to the <xhtml:code>/etc/apache2/httpd.conf</xhtml:code> file. </xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 2</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p><xhtml:code>cat /etc/apache2/httpd.conf</xhtml:code> and look for the remediation above.<br/></xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>The <xhtml:code>UserDir</xhtml:code> directive below will stop the "Sites" folders from being shared on the Web. Only the <xhtml:code>/Library/WebServer/Documents</xhtml:code> folder is shared if <xhtml:code>UserDir</xhtml:code> is off. A user might not understand the relevance of the "Sites" folder and may place sensitive files in the "Sites" folder that would be shared if Web Sharing is turned on. Also, an attacker might attempt to determine user names using Web requests if <xhtml:code>UserDir</xhtml:code> is on. Do not disable <xhtml:code>UserDir</xhtml:code> if your needs dictate that the "Sites" folders for users need to be shared.</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>Using <xhtml:code>sudo</xhtml:code> edit the <xhtml:code>/apache2/httpd.conf</xhtml:code> file and add the following to the bottom of the file. Restart Web Sharing after making the changes (turn it off and on again)<br/>
                            <br/><xhtml:code># limit the information the server gives out about its version <br/> ServerTokens Prod<br/>
                                <br/># limit the information the server gives out about its version <br/> ServerSignature Off<br/>
                                <br/># turns off all username-to-directory translations except <br/> #those explicitly named with the enabled keyword this directive <br/> #turns off the Sites folder for every user as a Web share<br/> # Only the DocumentRoot folder is shared <br/>UserDir Disabled<br/>
                                <br/># causes the core server and mod_proxy to return <br/> # a 405 (Method not allowed) error to the client.<br/>TraceEnable Off</xhtml:code><br/></xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:complex-check operator="AND">
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:file-content check="all" comment="test «/etc/apache2/httpd.conf» - ServerTokens Prod">
                                    <ecl:path>/etc/apache2/httpd.conf</ecl:path>
                                    <ecl:line-selection op="pm" value="^\s*ServerTokens\s+Prod\s*$"/>
                                </ecl:file-content>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:file-content check="all" comment="test «/etc/apache2/httpd.conf» - ServerSignature Off">
                                    <ecl:path>/etc/apache2/httpd.conf</ecl:path>
                                    <ecl:line-selection op="pm" value="^\s*ServerSignature\s+Off\s*$"/>
                                </ecl:file-content>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:file-content check="all" comment="test «/etc/apache2/httpd.conf» - UserDir Disabled">
                                    <ecl:path>/etc/apache2/httpd.conf</ecl:path>
                                    <ecl:line-selection op="pm" value="^\s*UserDir\s+Disabled\s*$"/>
                                </ecl:file-content>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:file-content check="all" comment="test «/etc/apache2/httpd.conf» - TraceEnable Off">
                                    <ecl:path>/etc/apache2/httpd.conf</ecl:path>
                                    <ecl:line-selection op="pm" value="^\s*TraceEnable\s+Off\s*$"/>
                                </ecl:file-content>
                            </xccdf:check-content>
                        </xccdf:check>
                    </xccdf:complex-check>
                </xccdf:Rule>
                
                <xccdf:Rule id="secure-remote-login" role="full" selected="false" weight="1.0">
                    <xccdf:title>Secure Remote Login</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Remote Login is Apple’s implementation of Secure Shell (SSH). SSH is an effective and efficient method for remote management of devices. If the service is not configured appropriately enabling remote login can open major security holes. Do not enable SSH if not needed. The configuration file for SSHD should be configured such that if the service is enabled it is appropriately hardened.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 2</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>See Remediation </xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p><xhtml:code>man sshd_config</xhtml:code></xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>Set the following in <xhtml:code>sshd_config: <br/> GSSAPIAuthentication yes<br/> GSSAPICleanupCredentials yes<br/><br/> X11Forwarding no<br/> Protocol 2<br/> PermitRootLogin no<br/> MaxAuthTries 4 # or less<br/> IgnoreRhosts yes<br/> HostbasedAuthentication no<br/> PermitEmptyPasswords no<br/> PermitUserEnvironment no<br/> ClientAliveInterval 300 # or less<br/> ClientAliveCountMax 0<br/> AllowUsers &lt;userlist&gt; # or AllowGroups<br/> LogLevel VERBOSE<br/> LoginGraceTime 120 # or less</xhtml:code><br/><br/> Note: A prior recommendation sets the Banner directive for Remote Login </xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:complex-check operator="AND">
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="Set SSH GSSAPIAuthentication to 'yes' for SSH server">
                                    <ecl:command>egrep '^[[:space:]]*GSSAPIAuthentication[[:space:]]+yes[[:space:]]*$' /etc/sshd_config</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="Set SSH GSSAPICleanupCredentials to 'yes' for SSH server">
                                    <ecl:command>egrep '^[[:space:]]*GSSAPICleanupCredentials[[:space:]]+yes[[:space:]]*$' /etc/sshd_config</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="Set SSH X11Forwarding to 'no' for SSH server">
                                    <ecl:command>egrep '^[[:space:]]*X11Forwarding[[:space:]]+no[[:space:]]*$' /etc/sshd_config</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="Set SSH protocol to '2' for SSHD server">
                                    <ecl:command>egrep '^[[:space:]]*Protocol[[:space:]]+2[[:space:]]*$' /etc/sshd_config</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="Set SSH PermitRootLogin to 'no' for SSHD server">
                                    <ecl:command>egrep '^[[:space:]]*PermitRootLogin[[:space:]]+no[[:space:]]*$' /etc/sshd_config</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="Set SSH MaxAuthTries to '4' or less for SSHD server">
                                    <ecl:command>egrep '^[[:space:]]*MaxAuthTries.*$' /etc/sshd_config | awk {'print $NF'}</ecl:command>
                                    <ecl:line-selection op="le" value="4"/>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="Set SSH IgnoreRhosts to 'yes' for SSHD server">
                                    <ecl:command>egrep '^[[:space:]]*IgnoreRhosts[[:space:]]+yes[[:space:]]*$' /etc/sshd_config</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="Set SSH HostbasedAuthentication to 'no' for SSHD server">
                                    <ecl:command>egrep '^[[:space:]]*HostbasedAuthentication[[:space:]]+no[[:space:]]*$' /etc/sshd_config</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="Set SSH PermitEmptyPasswords to 'no' for SSHD server">
                                    <ecl:command>egrep '^[[:space:]]*PermitEmptyPasswords[[:space:]]+no[[:space:]]*$' /etc/sshd_config</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="Set SSH PermitUserEnvironment to 'no' for SSHD server">
                                    <ecl:command>egrep '^[[:space:]]*PermitUserEnvironment[[:space:]]+no[[:space:]]*$' /etc/sshd_config</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="Set SSH ClientAliveInterval to '300' or less for SSHD server">
                                    <ecl:command>egrep '^[[:space:]]*ClientAliveInterval.*$' /etc/sshd_config | awk {'print $NF'}</ecl:command>
                                    <ecl:line-selection op="le" value="300"/>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="Set SSH ClientAliveCountMax to '0' for SSHD server">
                                    <ecl:command>egrep '^[[:space:]]*ClientAliveCountMax[[:space:]]+0[[:space:]]*$' /etc/sshd_config</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="Set SSH LogLevel to 'VERBOSE' for SSHD server">
                                    <ecl:command>egrep '^[[:space:]]*LogLevel[[:space:]]+VERBOSE[[:space:]]*$' /etc/sshd_config</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="Set SSH LoginGraceTime to '120' or less for SSHD server">
                                    <ecl:command>egrep '^[[:space:]]*LoginGraceTime.*$' /etc/sshd_config | awk {'print $NF'}</ecl:command>
                                    <ecl:line-selection op="le" value="120"/>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                    </xccdf:complex-check>
                </xccdf:Rule>
                <xccdf:Rule id="configure-remote-management" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Configure Remote Management</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Remote Management is the client portion of Apple Remote Desktop (ARD) &lt; http://www.apple.com/remotedesktop/&gt;. Remote Management has a screen sharing component similar to the Screen Sharing feature described above. Remote Management can also be used by administrators to install software, report on, and generally manage client Macs. ARD is mostly likely to be used in an organization and not by home users.<br/><br/>The screen sharing options in Remote Management are identical to those in the Screen Sharing section. In fact, only one of the two can be configured. If Remote Management is used, refer to the Screen Sharing section above on issues regard screen sharing.<br/><br/>Other features of Remote Management should be configured if the service is used. One option is to "Show Remote Management status in the menu bar." Turning this option on allows the user to see if screen sharing or other remote management features are being
                                used.<br/><br/>More security settings of relevance are found after clicking on the Options button. Only those options needed by the Remote Management Administrator should be turned on. <br/><br/>The final security concern with Remote Management is the list of users that access the Mac with Remote Management. The easiest and least secure method is to have the same username and password for a Remote Management administrator on every Mac in an organization. If this one name/password combination is compromised, the entire network of Macs is compromised.<br/><br/>The second method would be to have a different username/password combination on each Mac. This is difficult to implement since one would need to remember a large number of passwords and usernames, or one would need to write them down, thus creating a target for compromise. <br/><br/>The ideal solution is to use a directory service (like Open Directory or Active Directory) and only allow group access.
                                This method allows an organization to add or remove people to the directory group as needed, thus controlling access to the network of Macs. There are four groups used by ARD for this purpose: <xhtml:code>ard_admin, ard_interact, ard_manage</xhtml:code> and <xhtml:code>ard_reports</xhtml:code>. Therefore, combining or nesting local or network groups and user accounts may meet your needs. Various versions of Mac OS X and ARD may or may not allow the use of these groups, particularly if groups are nested within groups.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>Use the kickstart program to set or determine Remote Management settings.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p><xhtml:code>/System/Library/CoreServices/RemoteManagement/ARDAgent.app/Contents/Resources/kickstart -help</xhtml:code></xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Sharing, turn on Remote Management if necessary. If turned on, configure the screen sharing options as discussed above in the Screen Sharing section. Turn on the option: "Show Remote Management status in the menu bar"<br/><br/>Only turn on the options in the Options button if necessary.<br/><br/>Use a directory service to allow Remote Management access. Do not use a common username/password across multiple Macs.</xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
                <xccdf:Rule id="disable-remote-apple-events" role="full" selected="false" weight="1.0">
                    <xccdf:title>Disable Remote Apple Events</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Apple Events is a technology that allows one program to communicate with other programs. Remote Apple Events allows a program on one computer to communicate with a program on a different computer. Typically Remote Apple Events is used to automate a business process. Unless needed, Remote Apple Events should be turned off. If needed, it should be configured with the least access granted as possible. If Mac OS 9 is not being used, the option to allow events from OS 9 should be turned off. If OS 9 events are needed, a username and password should be used.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Sharing, verify Remote Apple Events is off.<br/><br/>Alternatively, run the following command:<br/><br/><xhtml:code>launchctl list | grep -I eppc</xhtml:code><br/><br/>There should be no results.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Sharing, turn on Remote Apple Events only if necessary. If turned on, add users to the Allow Access for list if possible. <br/><br/>To turn off Remote Apple Events from the command line:<br/><xhtml:code>sudo launchctl unload -w /System/Library/LaunchDaemons/eppc.plist</xhtml:code></xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="command test «launchctl list»">
                                <ecl:command>launchctl list</ecl:command>
                                <ecl:line-selection op="pm" value=".*com.apple.AEServer$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:Rule>
                <xccdf:Rule id="disable-xgrid-sharing" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Disable Xgrid Sharing</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Xgrid is Apple's distributed computing technology. Xgrid should be turned off unless specifically needed. If needed, access should be controlled using the Single Sign On option.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>http://www.apple.com/server/macosx/technology/xgrid.html<br/><br/>The single sign on option for Xgrid uses Kerberos.</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Sharing, turn on XGrid only if necessary. If turned on, select Single Sign On for the Authentication method.</xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="command test «launchctl list»">
                                <ecl:command>launchctl list</ecl:command>
                                <ecl:line-selection op="pm" value=".*com.apple.xgridagentd$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:Rule>
                <xccdf:Rule id="disable-internet-sharing" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Disable Internet Sharing</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Internet Sharing uses the open source <xhtml:code>natd</xhtml:code> process to share an internet connection with other computers and devices on a local network. Unless specifically required, Internet Sharing should be turned off. If used, it should only be turned on when actual sharing is needed. A much better solution is a dedicated router (available for as little as $10US). Apple makes a number of certified compatible routers.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Sharing, verify Internet Sharing is off.<br/></xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>http://www.apple.com/wifi/</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Sharing, turn on Internet Sharing only if necessary.<br/><br/>Alternatively, run the following commands:<br/><br/><xhtml:code>sudo defaults write /Library/Preferences/SystemConfiguration/com.apple.nat \<br/>NAT -dict Enabled -int 0<br/><br/>sudo launchctl unload -w /System/Library/LaunchDaemons/ com.apple.InternetSharing.plist</xhtml:code></xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="command test «launchctl list»">
                                <ecl:command>launchctl list</ecl:command>
                                <ecl:line-selection op="pm" value=".*com.apple.InternetSharing$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:Rule>
                <xccdf:Rule id="completely-disable-sharing-services" role="full" selected="false" weight="1.0">
                    <xccdf:title>Completely disable sharing services</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Various sharing services can offer an attacker a conduit to compromise a system. Unless absolutely needed, sharing should be turned off or completely disabled so that it cannot be turned on. If any of these services are needed, a better solution is a dedicated server.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 2</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>Verify the files are removed for the service(s) disabled.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>The following files should be moved or deleted from <xhtml:code>/System/Library/LaunchDaemons/:<br/><br/> * com.apple.AppleFileServer.plist</xhtml:code> (AFP)<br/> * <xhtml:code>ftp.plist</xhtml:code> (FTP)<br/> * <xhtml:code>smbd.plist</xhtml:code> (SMB)<br/> * <xhtml:code>org.apache.httpd.plist</xhtml:code> (Web)<br/> * <xhtml:code>eppc.plist</xhtml:code> (Remote Apple Events)<br/> * <xhtml:code>com.apple.mDNSResponder.plist</xhtml:code>(Bonjour)<br/> * <xhtml:code>com.apple.mDNSResponderHelper.plist</xhtml:code> (Bonjour)<br/> * <xhtml:code>com.apple.xgridagentd.plist</xhtml:code> (Xgrid)<br/> * <xhtml:code>com.apple.xgridcontrollerd.plist</xhtml:code> (Xgrid)<br/> * <xhtml:code>com.apple.InternetSharing.plist</xhtml:code> (Internet Sharing)</xhtml:p>
                    </xccdf:fixtext>
                    <xccdf:complex-check operator="AND">
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="command test «test -e /System/Library/LaunchDaemons/com.apple.AppleFileServer.plist»" success="fail">
                                    <ecl:command>test -e
                                        /System/Library/LaunchDaemons/com.apple.AppleFileServer.plist</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="command test «test -e /System/Library/LaunchDaemons/ftp.plist»" success="fail">
                                    <ecl:command>test -e
                                        /System/Library/LaunchDaemons/ftp.plist</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="command test «test -e /System/Library/LaunchDaemons/smbd.plist»" success="fail">
                                    <ecl:command>test -e
                                        /System/Library/LaunchDaemons/smbd.plist</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="command test «test -e /System/Library/LaunchDaemons/org.apache.httpd.plist»" success="fail">
                                    <ecl:command>test -e
                                        /System/Library/LaunchDaemons/org.apache.httpd.plist</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="command test «test -e /System/Library/LaunchDaemons/eppc.plist»" success="fail">
                                    <ecl:command>test -e
                                        /System/Library/LaunchDaemons/eppc.plist</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="command test «test -e /System/Library/LaunchDaemons/com.apple.mDNSResponder.plist»" success="fail">
                                    <ecl:command>test -e
                                        /System/Library/LaunchDaemons/com.apple.mDNSResponder.plist</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="command test «test -e /System/Library/LaunchDaemons/com.apple.mDNSResponderHelper.plist»" success="fail">
                                    <ecl:command>test -e
                                        /System/Library/LaunchDaemons/com.apple.mDNSResponderHelper.plist</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="command test «test -e /System/Library/LaunchDaemons/com.apple.xgridagentd.plist»" success="fail">
                                    <ecl:command>test -e
                                        /System/Library/LaunchDaemons/com.apple.xgridagentd.plist</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="command test «test -e /System/Library/LaunchDaemons/com.apple.xgridcontrollerd.plist»" success="fail">
                                    <ecl:command>test -e
                                        /System/Library/LaunchDaemons/com.apple.xgridcontrollerd.plist</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="command test «test -e /System/Library/LaunchDaemons/com.apple.InternetSharing.plist»" success="fail">
                                    <ecl:command>test -e
                                        /System/Library/LaunchDaemons/com.apple.InternetSharing.plist</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                    </xccdf:complex-check>
                </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="update">
                <xccdf:title>Software Update Preferences Action Items</xccdf:title>
                <xccdf:description>Note: Software Update preferences must be set for each user</xccdf:description>
                <xccdf:Rule id="disable-check-for-updates-for-standard-users" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Disable "Check for updates" for standard users</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Since most updates require an administrative password to install, there is little need to notify standard users when updates are available. The exception would be if the standard user also has an administrator account on the same Mac.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>Only disable for standard users that do not have an administrator account.</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Software Update, turn on "Check for updates" for administrator accounts, and for standard users that also have an administrator account. Turn off "Check for updates" for all others.</xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
                <xccdf:Rule id="download-important-updates-automatically-" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Download important updates automatically </xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Generally, it is not a good idea to have a computer automatically download operating level software patches from unknown sites automatically. Since the Software Update process will either use the Apple's own Software Update service or one provided by the organization (via Mac OS X Server), there is little benefit in turning this option off.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 2</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>This option only downloads, but does not install, the updates.</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Software Update, turn off "Download important updates automatically".</xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
                <xccdf:Rule id="transfer-installer-packages-from-a-test-bed-computer" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Transfer installer packages from a test-bed computer</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>In the software update program, one can choose to download only or install and keep packages. Ideally one would download the updates from Apple, install them on a test computer, then test the functionality and compatibility of the new software. If approved, the installer packages would be moved to production machines for installation. </xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 2</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>Downloading and vetting packages for various kinds of Apple hardware may be difficult to manage even for an organization. Some updates apply only to specific computer models. The Software Update utility, in contrast, only makes updates available if they apply to the current computer — but it lists all updates that apply.</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In Apple Menu: Software Update, select File Download Only when updates are available. Update packages are stored in the user's <xhtml:code>~/Download</xhtml:code> folder. Test updates for compatibility and functionality and if approved, deploy the updates to other Macs.</xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="sound-preferences-action-items-">
                <xccdf:title>Sound Preferences Action Items</xccdf:title>
                <xccdf:description/>
                <xccdf:Rule id="change-sound-input-device-to-line-in" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Change sound input device to Line In</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Apple provides no way to turn off the internal microphone (if so equipped). A remote attacker could enable the microphone and listen in on potentially sensitive conversations. The only way to limit the microphone is to turn the input volume off and to set the input to line in. Even if done, however, the internal microphone can still be turned on by a remote hacker or by an application running on the Mac. The safest method to disable the internal microphone it to have it disconnected by an authorized Apple technician.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 2</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>If the Mac is equipped with an internal microphone, in System Preferences: Sound, Input tab, verify the input is set to Line In.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>If the Mac is equipped with an internal microphone, in System Preferences: Sound, Input tab, set the input to Line In.</xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
                <xccdf:Rule id="minimize-input-volume-for-all-inputs" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Minimize input volume for all inputs</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Apple provides no way to turn off the internal microphone (if so equipped). A remote attacker could enable the microphone and listen in on potentially sensitive conversations. The only way to limit the microphone is to turn the input volume off and to set the input to line in. Even if done, however, the internal microphone can still be turned on by a remote hacker or by an application running on the Mac. The safest method to disable the internal microphone it to have it disconnected by an authorized Apple technician.</xhtml:p>
                            <xhtml:p class="bold">Context: System</xhtml:p>
                            <xhtml:p class="bold">Level: 2</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>If the Mac is equipped with an internal microphone, in System Preferences: Sound, Input tab, verify the input volume is set all the way to left (off). Click on each input device and verify the volume is set to off for each device.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>If the Mac is equipped with an internal microphone, in System Preferences: Sound, Input tab, set the input volume all the way to left (off). Click on each input device and set the volume to off for each device.</xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="speech-preferences-action-items">
                <xccdf:title>Speech Preferences Action Items</xccdf:title>
                <xccdf:description>
                    <xhtml:p>Note: Speech preferences must be set for each user.</xhtml:p>
                </xccdf:description>
                <xccdf:Rule id="only-enable-speech-recognition-in-a-secure-environment" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Only enable speech recognition in a secure environment</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Apple's speech recognition allows a user to speak a finite list of commands that are recognizable by the computer. If configured improperly, anyone within earshot of the Mac can initiate these actions. Use of speech recognition should be in a secure environment where only the user of the Mac can issue commands.</xhtml:p>
                            <xhtml:p class="bold">Context: User</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences, Speech, Speech Recognition tab, verify Speakable Items is off.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>Apple's speech recognition is listener independent, does not require training, and is optimized for a speaker within about 21 inches of the built-in microphones on Macintosh models. It may work better with a speech-quality microphone. A brief calibration routine for each user (and often, in each new aural environment) is recommended.<br/><br/>The speech command sets enabled by default include:<br/>* Address Book<br/>* Global Speakable Items (such as "What time is it" and "What day is it")<br/>* Application Specific Items (provided in the bundles of running applications)<br/>* Application Switching.<br/><br/>Additional Speakable Items are found in <xhtml:code>~/Library/Speech/Speakable Items,</xhtml:code> a directory which does not exist by default (and is not in the User Template).</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences, Speech, Speech Recognition tab, turn off Speakable Items unless in a secure environment. </xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
                <xccdf:Rule id="configure-speech-recognition-to-use-a-listening-key" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Configure Speech Recognition to use a Listening Key</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Speech Recognition can be configured to listen continuously or only when a specific key is pressed. Listening continuously can allow anyone within earshot of the Mac to initiate an operation on the Mac. Configure speech recognition to use a Listening Key to commands are only executed when the Mac user desires them to be.</xhtml:p>
                            <xhtml:p class="bold">Context: User</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences, Speech, Speech Recognition tab, verify "Listen only while key is pressed" is selected.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences, Speech, Speech Recognition tab, select "Listen only while key is pressed".</xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
                <xccdf:Rule id="use-headphones-if-you-enable-text-to-speech-or-turn-text-to-speech-off" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Use headphones if you enable text to speech, or turn text to speech
                        off</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>When using the Text to Speech feature, use headphones to others cannot hear what the computer is saying. The computer may convert sensitive text to speech, so limit who can hear it.</xhtml:p>
                            <xhtml:p class="bold">Context: User</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences, Speech, Text to Speech tab, turn off all options or wear headphones.</xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
            </xccdf:Group>
            <xccdf:Group id="spotlight-preferences-action-items-">
                <xccdf:title>Spotlight Preferences Action Items</xccdf:title>
                <xccdf:description/>
                <xccdf:Rule id="prevent-spotlight-from-searching-all-confidential-folders" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Prevent Spotlight from searching all confidential folders</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Spotlight is Apple's search technology built into the operating system. By default it indexes every file on any local hard drive. While spotlight will enforce access control restrictions to limit access to files, the index itself may contain information about sensitive files that others should not see. The Spotlight System Preference Pane allows the user to exclude volume, folders, and data types from being indexed.</xhtml:p>
                            <xhtml:p class="bold">Context: User and System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>Adding folders or volumes to the privacy settings will restrict searching for information in those folders and volumes. For example, adding ~/Library/Mail will disable the ability to search through the body of Mail messages, even within the Mail application.<br/><br/>Also, authentication is not required to add or remove items to the exclusion list. Any user can remove items from the exclusion list.</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Spotlight, Search Results tab turn off any categories that should not be indexed. <br/><br/>In System Preferences: Spotlight, Privacy tab add any volumes or folders that contain sensitive data.<br/><br/>Alternatively you can disable spotlight from indexing and search specific volumes with the following command:<br/><br/><xhtml:code>sudo mdutil -E -i off &lt;volumename&gt;</xhtml:code></xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
                <xccdf:Rule id="prevent-spotlight-from-searching-backup-folders-or-volumes" role="unscored" selected="false" weight="0.0">
                    <xccdf:title>Prevent Spotlight from searching backup folders or volumes</xccdf:title>
                    <xccdf:description>
                        <xhtml:div>
                            <xhtml:p class="bold">Explanation:</xhtml:p>
                            <xhtml:p>Spotlight is Apple's search technology built into the operating system. By default it indexes every file on any local hard drive. If a local hard drive is used for backup, spotlight will find the original and the backup of a file. The user may edit the backup file and lose changes if the back up file overwrites the backup with the original.</xhtml:p>
                            <xhtml:p class="bold">Context: User and System</xhtml:p>
                            <xhtml:p class="bold">Level: 1</xhtml:p>
                            <xhtml:p class="bold">Audit:</xhtml:p>
                            <xhtml:p>In System Preferences: Spotlight, Privacy tab verify all backup volumes or folders are in the privacy list.</xhtml:p>
                            <xhtml:p class="bold">Additional Info:</xhtml:p>
                            <xhtml:p>None</xhtml:p>
                        </xhtml:div>
                    </xccdf:description>
                    <xccdf:fixtext>
                        <xhtml:p>In System Preferences: Spotlight, Privacy tab add any volumes or folders that contain backups.</xhtml:p>
                    </xccdf:fixtext>
                </xccdf:Rule>
            </xccdf:Group>
        </xccdf:Group>
        <xccdf:Group id="data">
            <xccdf:title>Data Maintenance and Encryption Action Items</xccdf:title>
            <xccdf:description/>
            <xccdf:Rule id="backup-" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Backup </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>Backing up is very important. This point cannot be stressed enough. Apple includes Time Machine to make backing up easier. Numerous third party free and commercial products are also available to back up one's Mac. A good backup scheme can mitigate the loss of data if a Mac is compromised, lost, stolen, or becomes unusable. </xhtml:p>
                        <xhtml:p class="bold">Context: System</xhtml:p>
                        <xhtml:p class="bold">Level: 1</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>When using Time Machine, simply connect and external drive to the Mac and the Mac will ask if you want to use the drive as a backup drive. Select yes.<br/><br/>When using other software, follow the software's instructions to backup.</xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="secure-home-folders" role="full" selected="false" weight="1.0">
                <xccdf:title>Secure Home Folders</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>By default the Mac is set up to allow every user to see into the top level of the home folder of other users. This allows user to drop files into the "Drop Box" folders of other users. This also allows users to see newly-created files and folders in the top level of other users' home folders but not within the standard subfolders such as "Documents" and "Library." This access to the top of other users' home folders may not be desirable. To resolve this potential revelation of sensitive information, permissions should be set on home folder to restrict access to the owner of the folder.</xhtml:p>
                        <xhtml:p class="bold">Context: User</xhtml:p>
                        <xhtml:p class="bold">Level: 2</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Run the following command:<br/><br/><xhtml:code>ls -l /Users/</xhtml:code><br/><br/>verify that each user home folder looks like <xhtml:code>drwx------</xhtml:code></xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>If implemented, users will not be able to use the "Public" folders in other users' home folders. "Public" folders with appropriate permissions would need to be set up in the /Shared folder.</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Open Terminal and enter:<br/><br/><xhtml:code>sudo chmod 700 /Users/&lt;username&gt;</xhtml:code><br/>where &lt;username&gt; is the name of each user. This command has to be run for each user account with a local home folder.</xhtml:p>
                </xccdf:fixtext>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="command test «find non-700 dirs»" success="pass">
                            <ecl:command>find /Users -maxdepth 1 \! -perm 700 \! -name ".localized" \!
                                -name "Shared" \! -name "Users" \! -name "Guest"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="encrypt-sensitive-files" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Encrypt sensitive files</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>Sensitive files should be encrypted, especially when sent over e-mail, the network, or on removable media or laptops. FileVault will encrypt all files in the home directory, including Mail, but only at rest (when the user is logged out). In order to encrypt files when in transit (mailed, copied over the network, on removable media), encryption software is required. Apple provides encrypted disk images as a feature of Disk Utility, and Apple Mail supports encryption for Mail. There are also numerous third party products that provide for individual or enterprise level encryption and key management. Which product to use and how to use it is beyond the scope of this document.</xhtml:p>
                        <xhtml:p class="bold">Context: User</xhtml:p>
                        <xhtml:p class="bold">Level: 2</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Encrypt sensitive data whenever possible.</xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="securely-erase-files-in-the-finder" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Securely erase files in the Finder</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>When a file is put into the trash and trash is emptied, only the directory entry for the file is deleted; the data in the file is not actually deleted.<br/><br/>Think of a magic book library. When the librarian wants to remove a book she just removes the card catalog card for the book. The book stays on the shelf until the space is needed. When space is needed, pages from the book are removed until the needed space is made available. Until all the space of the original book is needed, some pages may remain on the shelf.<br/><br/>The computer operates in a similar fashion. The data from the file is still on the hard drive until the operating systems needs the space. "Undelete" software is available to recover these files, and special disk reading software is available to look at partial remains of the file if part of its space is used.<br/><br/>To be sure a deleted file is actually deleted, the Mac has a feature called Secure Empty Trash (under the
                            Finder menu). When selected the Mac not only removes the file information from the file directory, the Mac also overwrites the data in the file with meaningless data, thus preventing the file from being recovered.<br/><br/>Use Secure Erase Trash to erase sensitive files.<br/><br/>Finder: Preferences: Advanced allows the user to set Empty Trash Securely as the default.<br/><br/>The command line tool <xhtml:code>srm</xhtml:code> is also available as an alternative to <xhtml:code>rm.</xhtml:code></xhtml:p>
                        <xhtml:p class="bold">Context: User</xhtml:p>
                        <xhtml:p class="bold">Level: 1</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p><xhtml:code>man srm</xhtml:code></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>When emptying the trash, use Finder: Secure Empty Trash if sensitive files are in the trash.<br/><br/>If sensitive files are commonly deleted, set the Finder: Preferences: Advanced Empty Trash Securely option to on.<br/><br/>Use the <xhtml:code>srm</xhtml:code> command in Terminal when deleting sensitive files from the CLI.</xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="securely-erase-partitions" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Securely erase partitions</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>Using the erase capability of Disk Utility (found on the Mac OS X Install DVD) will only erase the directory structure of disk and leave its contents intact. To make sure everything on the partition is erased, the Secure Erase feature of the Disk Utility must be used.<br/><br/>Unless an organizational hard drive disposal policy must be followed, a 7 pass wipe secure erase should be used before a hard drive is discarded, sold, or transferred to another party. If time permits, a 35 pass wipe can be used, but a 7 pass wipe is generally adequate.</xhtml:p>
                        <xhtml:p class="bold">Context: System</xhtml:p>
                        <xhtml:p class="bold">Level: 2</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>According to Apple, the "7-Pass Erase" option conforms to the DoD 5220.22-M specification. This specification calls for three passes, but Disk Utility performs seven. https://support.apple.com/kb/HT3680</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>1. Open /Applications/Disk Utility.<br/>2. Select the partition to erase on in the left panel.<br/>3. Select the Erase tab.<br/>4. Click on the Security Option button.<br/>5. Choose "Zero out data", then OK. Use a 7 or 35 pass erase if required. <br/>6. Click the erase button.</xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="securely-erase-free-space" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Securely erase free space</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>If sensitive files have been erased without using Secure Erase, Mac OS X offers an additional way to securely erase all of the free space on a drive. This action will make it even harder for anyone to recover deleted files from the Mac.</xhtml:p>
                        <xhtml:p class="bold">Context: System</xhtml:p>
                        <xhtml:p class="bold">Level: 2</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p><xhtml:code>man diskutil</xhtml:code></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>1. Open /Applications/Disk Utility<br/>2. Select the desired partition on in the left panel<br/>3. Select the Erase tab<br/>4. Click the Erase Free Space... button<br/>5. Choose the desired option<br/>6. Click the Erase Free Space button.<br/><br/>Warning: if performing this operation on a laptop, make sure the power adaptor is plugged in. Also, even though there is a cancel option, we do not recommend canceling. <br/><br/>The following CLI command will securely erase free space:<br/><br/><xhtml:code>sudo diskutil secureErase freespace [1|2|3] /</xhtml:code><br/><br/>where <xhtml:code>[1|2|3]</xhtml:code> is one of the following:<br/> * 1 = single pass erase<br/> * 2 = 7 pass erase<br/> * 3 = 35 pass erase</xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="repair-disk-permissions-after-installing-software-or-software-updates-" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Repair disk permissions after installing software or software updates </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>Sometimes file permissions get set differently from the desired permissions. A number of reasons might cause this, and most are beyond the control of the user.<br/><br/>Every time a package is installed, the package leaves a receipt that tells the computer what files were installed and what their permissions on disk should be.<br/><br/>Using the repair permissions feature of Disk Utility, the permissions of most program files can be reset to the desired values.</xhtml:p>
                        <xhtml:p class="bold">Context: System</xhtml:p>
                        <xhtml:p class="bold">Level: 1</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>Apple recommends running repair permissions from an up-to-date system disk, rather than the system installer DVD.<br/><br/>http://docs.info.apple.com/article.html?artnum=25751<br/><br/>If the system is not maintained by a configuration management tool that manages permissions, a good best practice is to schedule a permission repair to occur at least monthly. Tools like <xhtml:code>launchd</xhtml:code> can be used ( use <xhtml:code>Lingon</xhtml:code> as a GUI front end for <xhtml:code>launchd</xhtml:code>). Also, the command line above can be placed in the file <xhtml:code>/etc/monthly.local</xhtml:code> and the command will be executed monthly (<xhtml:code>/etc/weekly.local</xhtml:code> will execute the command weekly).<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>1. Open Applications: Disk Utility. <br/>2. Select the startup disk in the left panel. <br/>3. Select the First Aid tab. <br/>4. Click on the Repair Permission button<br/><br/>Alternatively the command can be run from Terminal:<br/><br/><xhtml:code>diskutil repairPermissions /</xhtml:code><br/><br/>Permissions can be repaired when started up from a Mac OS X Install DVD, but Apple recommends running it from a fully-updated Mac OS X system instead.</xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="network-services">
            <xccdf:title>Network Services Configuration Action Items</xccdf:title>
	    <xccdf:description/>
            <xccdf:Rule id="secure-bonjour" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Secure Bonjour</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>Bonjour is an auto-discovery mechanism for TCP/IP devices. Because Bonjour can enumerate devices and services within a local subnet it can simplify device discovery from an internal rogue or compromised host. An attacker could use Bonjour’s multicast DNS feature to discover a vulnerable or poorly-configured service or additional information to aid a targeted attack. The actual discovery is performed via DNS Service Discovery (DNS-SD). DNS on Mac OS X (10.6) is integrated with Bonjour and should not be turned off. If required the Bonjour advertising service can be disabled</xhtml:p>
                        <xhtml:p class="bold">Context: System</xhtml:p>
                        <xhtml:p class="bold">Level: 2</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Run the following command:<br/><br/>launchctl list<br/><br/>verify that mDNSResponder is not in the result list.</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>https://support.apple.com/kb/HT3789?viewlocale=en_US </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>To disable Bonjour advertising service without disabling Bonjour queries and DNS.:<br/><br/> 1. Make a back up copy of the mDNSResponder.plist file as a precaution.<br/> 2. Open the mDNSResponder.plist file in Terminal using your preferred text editor. <br/> Below is a sample command:<br/><br/>
                        <xhtml:code>sudo nano \ "/System/Library/LaunchDaemons/com.apple.mDNSResponder.plist"</xhtml:code><br/><br/> 3. Add <xhtml:code>&lt;string&gt;-NoMulticastAdvertisements&lt;/string&gt;</xhtml:code> to the array in the ProgramArguments section. For example:<br/><br/> The following: <br/><xhtml:code> &lt;key&gt;ProgramArguments&lt;/key&gt;<br/> &lt;array&gt;<br/> &lt;string&gt;/usr/sbin/mDNSResponder&lt;/string&gt;<br/> &lt;string&gt;-launchd&lt;/string&gt;<br/> &lt;/array&gt; <br/><br/></xhtml:code> becomes:<br/><xhtml:code> &lt;key&gt;ProgramArguments&lt;/key&gt;<br/> &lt;array&gt;<br/> &lt;string&gt;/usr/sbin/mDNSResponder&lt;/string&gt;<br/> &lt;string&gt;-launchd&lt;/string&gt;<br/> &lt;string&gt;-NoMulticastAdvertisements&lt;/string&gt;<br/> &lt;/array&gt;<br/><br/></xhtml:code> 4. Save the file. </xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
            <xccdf:Rule id="use-an-outbound-network-detection-system" role="unscored" selected="false" weight="0.0">
                <xccdf:title>Use an outbound network detection system</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>The Apple firewall will prevent unwanted incoming network traffic, but will not prevent unwanted outbound network traffic. Unwanted outbound traffic might include spyware or malware traffic. Included with Mac OS X is a firewall called <xhtml:code>ipfw</xhtml:code>, which is what Apple used as the main firewall in prior releases of the operating system. Apple doesn't use <xhtml:code>ipfw</xhtml:code> anymore, but still includes it in Snow Leopard. Configuring <xhtml:code>ipfw</xhtml:code> to prevent unwanted outbound traffic is beyond the scope of this document. Various third party software products, notably Little Snitch, have outbound traffic firewall capabilities. </xhtml:p>
                        <xhtml:p class="bold">Context: System</xhtml:p>
                        <xhtml:p class="bold">Level: 2</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>None</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p>http://seaotter.berkeley.edu/cab/mac-firewalls/ has a good run down of firewall products for Mac OS X</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Use a firewall product that blocks unwanted outbound traffic.</xhtml:p>
                </xccdf:fixtext>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="system-integrity-validation-action-items">
            <xccdf:title>System Integrity Validation Action Items</xccdf:title>
            <xccdf:description/>
            <xccdf:Rule id="increase-the-retention-time-for-systemlog-and-securelog" role="full" selected="false" weight="1.0">
                <xccdf:title>Increase the retention time for system.log and secure.log</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Explanation:</xhtml:p>
                        <xhtml:p>Many log files are archived and retained for 5 days based on the default Mac OS X configuration. Snow Leopard includes a new utility (<xhtml:code>newsyslog</xhtml:code>) to configure how log files are stored and retained. Two important logs should be retained for longer than the default 5 days: syslog.log and secure.log.</xhtml:p>
                        <xhtml:p class="bold">Context: System</xhtml:p>
                        <xhtml:p class="bold">Level: 2</xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p><xhtml:code>cat /etc/newsyslog.conf</xhtml:code> and verify the count is 30 for system.log and secure.log</xhtml:p>
                        <xhtml:p class="bold">Additional Info:</xhtml:p>
                        <xhtml:p><xhtml:code>man newsyslog.conf</xhtml:code> Snow Leopard includes the Apple System Log (ASL) facility, which is a replacement for syslog but provides compatibility with it. See <xhtml:code>man syslogd</xhtml:code> and <xhtml:code>man asl.conf</xhtml:code> for more information.</xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:fixtext>
                    <xhtml:p>Backup then, using <xhtml:code>sudo</xhtml:code>, edit <xhtml:code>/etc/newsyslog.conf</xhtml:code> Change the 5 in the count column to 30 for the syslog.log line and the secure.log line. </xhtml:p>
                </xccdf:fixtext>
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="system.log count is greater than 30">
                                <ecl:command>grep "system.log" /etc/newsyslog.conf | awk {'print $3'}</ecl:command>
                                <ecl:line-selection op="ge" value="30"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="secure.log count is greater than 30">
                                <ecl:command>grep "secure.log" /etc/newsyslog.conf | awk {'print $3'}</ecl:command>
                                <ecl:line-selection op="ge" value="30"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="application-security">
        <xccdf:title>Application Security</xccdf:title>
	<xccdf:description/>
        <xccdf:Rule id="safari-should-not-open-safe-files-after-downloading" role="unscored" selected="false" weight="0.0">
            <xccdf:title>Safari should not open safe files after downloading</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p class="bold">Explanation:</xhtml:p>
                    <xhtml:p>Safari will automatically run or execute what it considers safe files. This can include installers and other files that execute on the operating system. Malware has taken advantage of this setting through drive-by attacks.</xhtml:p>
                    <xhtml:p class="bold">Context: Safari</xhtml:p>
                    <xhtml:p class="bold">Level: 1</xhtml:p>
                    <xhtml:p class="bold">Audit:</xhtml:p>
                    <xhtml:p>none</xhtml:p>
                    <xhtml:p class="bold">Additional Info:</xhtml:p>
                    <xhtml:p>none</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:fixtext>
                <xhtml:p>1. Start the Safari program. <br/> 2. Select Preferences from the Safari menu on the left side of the menu bar. <br/> 3. Choose the "General" tab. <br/> 4. Uncheck the box that says "Open 'safe' files after downloading". Quit Safari.<br/>
                </xhtml:p>
            </xccdf:fixtext>
        </xccdf:Rule>
    </xccdf:Group>
    </xccdf:Group>
<xccdf:signature><ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
<ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
<ds:Reference URI="">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
<ds:DigestValue>lVNMkZdm14mcA6C5eA94D/pV4KY=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>
WLrYmONWgKa7juKz9A0m5QaEKDR2vYm7vgiwHGZWO4N5F5z1R557FN6JONnShTz9hA57aEU0+VY8
E9Y9OIAzgMNbiN99huWYddM57UMq5bq/CYCEaVWE6rLOQyw9b4CURQlO+YmXUGLLfSbBRATcN6h7
J6Wj+aT9zd16dLb7E8UhsgiYzCkRyQDNwo2oN79I6seDuISqEBfx4kGMBKjyiymRPfJ3jgGJ6JV9
ppqi8iyN3Po95Z5Pm2m3ujQIH7VEL6X7p6WHqdJhkafX/oOb0M+ZLUVrsFb1w5sxWQe5J5VkXUDM
Szi0XOR9Eevbm9Q2Ymvz/2DuDE1fgBq/YWVyog==
</ds:SignatureValue>
<ds:KeyInfo>
<ds:X509Data>
<ds:X509Certificate>
MIIFUjCCBDqgAwIBAgIIYySGQYnuNVswDQYJKoZIhvcNAQELBQAwgbQxCzAJBgNVBAYTAlVTMRAw
DgYDVQQIEwdBcml6b25hMRMwEQYDVQQHEwpTY290dHNkYWxlMRowGAYDVQQKExFHb0RhZGR5LmNv
bSwgSW5jLjEtMCsGA1UECxMkaHR0cDovL2NlcnRzLmdvZGFkZHkuY29tL3JlcG9zaXRvcnkvMTMw
MQYDVQQDEypHbyBEYWRkeSBTZWN1cmUgQ2VydGlmaWNhdGUgQXV0aG9yaXR5IC0gRzIwHhcNMTcx
MDIzMTQ1ODAwWhcNMjAxMDIwMTg1NzQ0WjCBkzELMAkGA1UEBhMCVVMxETAPBgNVBAgTCE5ldyBZ
b3JrMRcwFQYDVQQHEw5FYXN0IEdyZWVuYnVzaDErMCkGA1UEChMiQ2VudGVyIGZvciBJbnRlcm5l
dCBTZWN1cml0eSwgSW5jLjErMCkGA1UEAxMiQ2VudGVyIGZvciBJbnRlcm5ldCBTZWN1cml0eSwg
SW5jLjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANDBp4+sl9kB5JRmnQH0wcbLLz/t
n2HoD6TRl3xJj12V61njBNgaiGzvoSl07sFLnESukb0CU44MzYDoUMdx3HJUcEAeMY/9eITqGUnk
N4WsP145eFqH7FoszOY/4NYlgYMYt8ZP2kRHyim9LpQTLT/1mBaUkY2f2e5uUCootH3iT8W3/sK2
flLzWfLgXTvkhJm4Uvw1RErBFs15+krW0KWtnZ6NmiDhmV0CnFGNnd1meGZPs2sBXEVGLJVSKzoT
G9Ht/oWyRLRcJuXpHoXTYpkqM2MsixmSaJy5b6/D35r0NXHru3p1gkX2a0VgJQxxWqLi3bVPzpl3
PlJu3C8M/FUCAwEAAaOCAYUwggGBMAwGA1UdEwEB/wQCMAAwEwYDVR0lBAwwCgYIKwYBBQUHAwMw
DgYDVR0PAQH/BAQDAgeAMDUGA1UdHwQuMCwwKqAooCaGJGh0dHA6Ly9jcmwuZ29kYWRkeS5jb20v
Z2RpZzJzNS0zLmNybDBdBgNVHSAEVjBUMEgGC2CGSAGG/W0BBxcCMDkwNwYIKwYBBQUHAgEWK2h0
dHA6Ly9jZXJ0aWZpY2F0ZXMuZ29kYWRkeS5jb20vcmVwb3NpdG9yeS8wCAYGZ4EMAQQBMHYGCCsG
AQUFBwEBBGowaDAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuZ29kYWRkeS5jb20vMEAGCCsGAQUF
BzAChjRodHRwOi8vY2VydGlmaWNhdGVzLmdvZGFkZHkuY29tL3JlcG9zaXRvcnkvZ2RpZzIuY3J0
MB8GA1UdIwQYMBaAFEDCvSeOzDSDMKIz1/tss/C0LIDOMB0GA1UdDgQWBBT7fOf4ISDprbE+qUFe
+friFTKgHjANBgkqhkiG9w0BAQsFAAOCAQEAs5SDIMcr3jwOwgKipP7NWsWyAO0zfpmHGaU2C/gW
Kz6DZuwhTLPbn015ZlvjRZ27Jd7rjg3WK2Qs9xaRYn2yb1s4mx/NtlVUBsNpL0CDOrdOgt/ZEweI
uoknr5gPlsFPXmsxEQoFb3KKt/Al1YbjcKHhHZ7BtEL3MGnSOAyItdodtLzxFuLOJKpvEk2OOVoW
BgHAteWAvlKd6exCvfWKHipJ5DTC9eM859tpW0xM+f12CycvrkQVI2lyEHMzDFaHkBO0URjhySSu
SkWLBywIIM02d+Ud7bbC60nXfuxIjayeDJLvDxyMJ/bx12X75w1frT1oKTuifL1bmeualQHKXw==
</ds:X509Certificate>
</ds:X509Data>
<ds:KeyValue>
<ds:RSAKeyValue>
<ds:Modulus>
0MGnj6yX2QHklGadAfTBxssvP+2fYegPpNGXfEmPXZXrWeME2BqIbO+hKXTuwUucRK6RvQJTjgzN
gOhQx3HcclRwQB4xj/14hOoZSeQ3haw/Xjl4WofsWizM5j/g1iWBgxi3xk/aREfKKb0ulBMtP/WY
FpSRjZ/Z7m5QKii0feJPxbf+wrZ+UvNZ8uBdO+SEmbhS/DVESsEWzXn6StbQpa2dno2aIOGZXQKc
UY2d3WZ4Zk+zawFcRUYslVIrOhMb0e3+hbJEtFwm5ekehdNimSozYyyLGZJonLlvr8PfmvQ1ceu7
enWCRfZrRWAlDHFaouLdtU/OmXc+Um7cLwz8VQ==
</ds:Modulus>
<ds:Exponent>AQAB</ds:Exponent>
</ds:RSAKeyValue>
</ds:KeyValue>
</ds:KeyInfo>
</ds:Signature></xccdf:signature></xccdf:Benchmark>