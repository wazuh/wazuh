<?xml version="1.0" encoding="UTF-8" standalone="no"?><xccdf:Benchmark xmlns:xccdf="http://checklists.nist.gov/xccdf/1.1" xmlns:ecl="http://cisecurity.org/check" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="xccdf_org.cisecurity.benchmarks_benchmark_1.1.0_CIS_IBM_AIX_5.3-6.1_Benchmark" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.1 ../misc/xsd/xccdf-1.1.4.xsd http://cisecurity.org/check ../misc/xsd/ecl.xsd">
    
    <xccdf:status date="2012-09-28">accepted</xccdf:status>
    <xccdf:title>CIS AIX 5.3 and AIX 6.1 Benchmark</xccdf:title>
    <xccdf:description>
        This document, Security Configuration Benchmark for AIX 5.3 and AIX 6.1, provides prescriptive guidance for establishing a secure configuration posture for AIX versions 5.3 and 6.1 running on the Power Systems platform. This guide was tested against AIX 5.3 TL-05 / TL-07 and AIX 6.1 TL-01, installed from IBM base installation media. To obtain the latest version of this guide, please visit http://benchmarks.cisecurity.org. If you have questions, comments, or have identified ways to improve this guide, please write us at feedback@cisecurity.org.
    </xccdf:description>    
    
    <xccdf:notice id="terms-of-use" xml:lang="en">	
        BACKGROUND.
        The Center for Internet Security ("CIS") provides benchmarks, scoring tools, software, data, information, suggestions, ideas, and other services and materials from the CIS website or elsewhere ("Products") as a public service to Internet users worldwide.  Recommendations contained in the Products ("Recommendations") result from a consensus-building process that involves many security experts and are generally generic in nature.  The Recommendations are intended to provide helpful information to organizations attempting to evaluate or improve the security of their networks, systems, and devices.  Proper use of the Recommendations requires careful analysis and adaptation to specific user requirements.  The Recommendations are not in any way intended to be a "quick fix" for anyone's information security needs.
        NO REPRESENTATIONS, WARRANTIES, OR COVENANTS.
        CIS makes no representations, warranties, or covenants whatsoever as to (i) the positive or negative effect of the Products or the Recommendations on the operation or the security of any particular network, computer system, network device, software, hardware, or any component of any of the foregoing or (ii) the accuracy, reliability, timeliness, or completeness of  the Products or the Recommendations.  CIS is providing the Products and the Recommendations "as is" and "as available" without representations, warranties, or covenants of any kind.	USER AGREEMENTS.
        By using the Products and/or the Recommendations, I and/or my organization ("We") agree and acknowledge that:
        1.	No network, system, device, hardware, software, or component can be made fully secure;
        2.	We are using the Products and the Recommendations solely at our own risk;
        3.	We are not compensating CIS to assume any liabilities associated with our use of the Products or the Recommendations, even risks that result from 		CIS's negligence or failure to perform; 
        4.	We have the sole responsibility to evaluate the risks and benefits of the Products and Recommendations to us and to adapt the Products and the 			Recommendations to our particular circumstances and requirements;
        5.	Neither CIS, nor any CIS Party (defined below) has any responsibility to make any corrections, updates, upgrades, or bug fixes; or to notify us of 		the need for any such corrections, updates, upgrades, or bug fixes; and
        6.	Neither CIS nor any CIS Party has or will have any liability to us whatsoever (whether based in contract, tort, strict liability or otherwise) for 		any direct, indirect, incidental, consequential, or special damages (including without limitation loss of profits, loss of sales, loss of or damage 		to reputation,loss of customers, loss of software, data, information or emails, loss of privacy, loss of use of any computer or other equipment, 	business interruption, wasted management or other staff resources or claims of any kind against us from third parties) arising out of or in any way 	Connected with our use of or our inability to use any of the Products or Recommendations (even if CIS has been advised of the possibility of such 	damages), including without limitation any liability associated with infringement of intellectual property, defects, bugs, errors, omissions, 	viruses, worms, backdoors, Trojan horses or other harmful items.
        GRANT OF LIMITED RIGHTS.
        CIS hereby grants each user the following rights, but only so long as the user complies with all of the terms of these Agreed Terms of Use:
        1.	Except to the extent that we may have received additional authorization pursuant to a written agreement with CIS, each user may download, install and 	use each of the Products on a single computer;
        2.	Each user may print one or more copies of any Product or any component of a Product that is in a .txt, .pdf, .doc, .mcw, or .rtf format, provided 		that all such copies are printed in full and are kept intact, including without limitation the text of this Agreed Terms of Use in its entirety.
        RETENTION OF INTELLECTUAL PROPERTY RIGHTS; LIMITATIONS ON DISTRIBUTION.
        The Products are protected by copyright and other intellectual property laws and by international treaties.  We acknowledge and agree that we are not acquiring title to any intellectual property rights in the Products and that full title and all ownership rights to the Products will remain the exclusive property of CIS or CIS Parties.  CIS reserves all rights not expressly granted to users in the preceding section entitled "Grant of limited rights."
        Subject to the paragraph entitled "Special Rules" (which includes a waiver, granted to some classes of CIS Members, of certain limitations in this paragraph), and except as we may have otherwise agreed in a written agreement with CIS, we agree that we will not (i) decompile, disassemble, reverse engineer, or otherwise attempt to derive the source code for any software Product that is not already in the form of source code; (ii) distribute, redistribute, encumber, sell, rent, lease, lend, sublicense, or otherwise transfer or exploit rights to any Product or any component of a Product; (iii) post any Product or any component of a Product on any website, bulletin board, ftp server, newsgroup, or other similar mechanism or device, without regard to whether such mechanism or device is internal or external, (iv) remove or alter trademark, logo, copyright or other proprietary notices, legends, symbols or labels in any Product or any component of a Product; (v) remove these Agreed Terms of Use from, or alter these Agreed Terms of Use as they appear in, any Product or any component of a Product; (vi) use any Product or any component of a Product with any derivative works based directly on a Product or any component of a Product; (vii) use any Product or any component of a Product with other products or applications that are directly and specifically dependent on such Product or any component for any part of their functionality, or (viii) represent or claim a particular level of compliance with a CIS Benchmark, scoring tool or other Product.  We will not facilitate or otherwise aid other individuals or entities in any of the activities listed in this paragraph.
        We hereby agree to indemnify, defend, and hold CIS and all of its officers, directors, members, contributors, employees, authors, developers, agents, affiliates, licensors, information and service providers, software suppliers, hardware suppliers, and all other persons who aided CIS in the creation, development, or maintenance of the Products or Recommendations ("CIS Parties") harmless from and against any and all liability, losses, costs, and expenses (including attorneys' fees and court costs) incurred by CIS or any CIS Party in connection with any claim arising out of any violation by us of the preceding paragraph, including without limitation CIS's right, at our expense, to assume the exclusive defense and control of any matter subject to this indemnification, and in such case, we agree to cooperate with CIS in its defense of such claim.  We further agree that all CIS Parties are third-party beneficiaries of our undertakings in these Agreed Terms of Use.	SPECIAL RULES.
        CIS has created and will from time to time create, special rules for its members and for other persons and organizations with which CIS has a written contractual relationship.  Those special rules will override and supersede these Agreed Terms of Use with respect to the users who are covered by the special rules.
        CIS hereby grants each CIS Security Consulting or Software Vendor Member and each CIS Organizational User Member, but only so long as such Member remains in good standing with CIS and complies with all of the terms of these Agreed Terms of Use, the right to distribute the Products and Recommendations within such Member's own organization, whether by manual or electronic means.  Each such Member acknowledges and agrees that the foregoing grant is subject to the terms of such Member's membership arrangement with CIS and may, therefore, be modified or terminated by CIS at any time.
        CHOICE OF LAW; JURISDICTION; VENUE.
        We acknowledge and agree that these Agreed Terms of Use will be governed by and construed in accordance with the laws of the State of Maryland, that any action at law or in equity arising out of or relating to these Agreed Terms of Use shall be filed only in the courts located in the State of Maryland, that we hereby consent and submit to the personal jurisdiction of such courts for the purposes of litigating any such action.  If any of these Agreed Terms of Use shall be determined to be unlawful, void, or for any reason unenforceable, then such terms shall be deemed severable and shall not affect the validity and enforceability of any remaining provisions.
        BY USING THE PRODUCTS I(WE) ACKNOWLEDGE THAT WE HAVE READ THESE AGREED TERMS OF USE IN THEIR ENTIRETY, UNDERSTAND THEM, AND I(WE) AGREE TO BE BOUND BY THEM IN ALL RESPECTS.
    </xccdf:notice>
    
    <xccdf:version>1.1.0</xccdf:version>
    
    <xccdf:Profile id="aix-level-1-profile">
        <xccdf:title>Level 1</xccdf:title>
        <xccdf:description>
            <xhtml:p>Items in this profile intend to:</xhtml:p>
            <xhtml:ul>
                <xhtml:li>be practical and prudent;</xhtml:li>
                <xhtml:li>provide a clear security benefit; and</xhtml:li>
                <xhtml:li>not negatively inhibit the utility of the technology beyond acceptable means.</xhtml:li>
            </xhtml:ul>
        </xccdf:description>
        <xccdf:select idref="etc-security-user-mindiff" selected="true"/>
        <xccdf:select idref="etc-security-user-minage" selected="true"/>
        <xccdf:select idref="etc-security-user-maxage" selected="true"/>
        <xccdf:select idref="etc-security-user-minlen" selected="true"/>
        <xccdf:select idref="etc-security-user-minalpha" selected="true"/>
        <xccdf:select idref="etc-security-user-minother" selected="true"/>
        <xccdf:select idref="etc-security-user-maxrepeats" selected="true"/>
        <xccdf:select idref="etc-security-user-histexpire" selected="true"/>
        <xccdf:select idref="etc-security-user-histsize" selected="true"/>
        <xccdf:select idref="etc-security-user-maxexpired" selected="true"/>
        <xccdf:select idref="etc-security-login-cfg-pwd-algorithm-aix-5-3-tl-07-" selected="true"/>
        <xccdf:select idref="etc-security-login-cfg-logininterval" selected="true"/>
        <xccdf:select idref="etc-security-login-cfg-logindisable" selected="true"/>
        <xccdf:select idref="etc-security-login-cfg-loginreenable" selected="true"/>
        <xccdf:select idref="etc-security-login-cfg-logintimeout" selected="true"/>
        <xccdf:select idref="etc-security-login-cfg-logindelay" selected="true"/>
        <xccdf:select idref="etc-security-user-loginretries" selected="true"/>
        <xccdf:select idref="etc-security-user-rlogin" selected="true"/>
        <xccdf:select idref="etc-security-user-sugroups" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-permissions-and-ownership" selected="true"/>
        <xccdf:select idref="miscellaneous-enhancements-etc-ftpusers" selected="true"/>
        <xccdf:select idref="miscellaneous-enhancements-login-herald" selected="true"/>
        <xccdf:select idref="miscellaneous-enhancements-guest-account-removal" selected="true"/>
        <xccdf:select idref="miscellaneous-enhancements-crontab-permissions" selected="true"/>
        <xccdf:select idref="configuring-ssh-disabling-direct-root-access" selected="true"/>
        <xccdf:select idref="configuring-ssh-server-protocol-2" selected="true"/>
        <xccdf:select idref="configuring-ssh-client-protocol-2" selected="true"/>
        <xccdf:select idref="configuring-ssh-banner-configuration" selected="true"/>
        <xccdf:select idref="configuring-ssh-ignore-shosts-and-rhosts" selected="true"/>
        <xccdf:select idref="configuring-ssh-disable-null-passwords" selected="true"/>
        <xccdf:select idref="configuring-ssh-set-privilege-separation" selected="true"/>
        <xccdf:select idref="configuring-ssh-sshd_config-permissions-lockdown" selected="true"/>
        <xccdf:select idref="configuring-ssh-ssh_config-permissions-lockdown" selected="true"/>
        <xccdf:select idref="etc-mail-sendmail-cf-smtpgreetingmessage" selected="true"/>
        <xccdf:select idref="etc-mail-sendmail-cf-permissions-and-ownership" selected="true"/>
        <xccdf:select idref="var-spool-mqueue-permissions-and-ownership" selected="true"/>
        <xccdf:select idref="cde-sgid-suid-binary-lockdown" selected="true"/>
        <xccdf:select idref="cde-screensaver-lock" selected="true"/>
        <xccdf:select idref="cde-etc-dt-config-xconfig-permissions-and-ownership" selected="true"/>
        <xccdf:select idref="cde-etc-dt-config-xservers-permissions-and-ownership" selected="true"/>
        <xccdf:select idref="cde-login-screen-hostname-masking" selected="true"/>
        <xccdf:select idref="cde-etc-dt-config-xresources-permissions-and-ownership" selected="true"/>
        <xccdf:select idref="nfs-nosuid-on-nfs-client-mounts" selected="true"/>
        <xccdf:select idref="nfs-localhost-removal" selected="true"/>
        <xccdf:select idref="nfs-no-root-squash-option" selected="true"/>
        <xccdf:select idref="tcp-wrappers-creating-a-hosts-deny-file" selected="true"/>
        <xccdf:select idref="tcp-wrappers-creating-a-hosts-allow-file" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-etc-security" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-etc-group" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-etc-passwd" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-etc-security-audit" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-audit" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-smit.log" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-var-adm-cron-log" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-var-spool-cron-crontabs" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-var-adm-cron-at.allow" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-var-adm-cron-cron.allow" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-etc-motd" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-var-adm-ras" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-var-ct-rmstart-log" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-var-tmp-dpid2-log" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-var-tmp-hostmibd-log" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-var-tmp-snmpd-log" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-var-adm-sa" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-world-writable-directory-in-root-path" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-home-directory-configuration-files" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-home-directory-permissions" selected="true"/>
        <xccdf:select idref="miscellaneous-config-ftp-umask" selected="true"/>
        <xccdf:select idref="miscellaneous-config-ftp-banner" selected="true"/>
        <xccdf:select idref="miscellaneous-config-etc-motd" selected="true"/>
        <xccdf:select idref="miscellaneous-config-authorized-users-in-at-allow" selected="true"/>
        <xccdf:select idref="miscellaneous-config-authorized-users-in-cron-allow" selected="true"/>
        <xccdf:select idref="miscellaneous-config-all-unlocked-accounts-must-have-a-password" selected="true"/>
        <xccdf:select idref="miscellaneous-config-all-user-id-must-be-unique" selected="true"/>
        <xccdf:select idref="miscellaneous-config-all-group-id-must-be-unique" selected="true"/>
	    <xccdf:select idref="miscellaneous-config-removing-current-working-directory-from-roots-PATH" selected="true"/>
        <xccdf:select idref="miscellaneous-config-removing-current-working-directory-from-default-etc-environment-PATH" selected="true"/>
    </xccdf:Profile>
    <xccdf:Profile id="aix-level-2-profile">
        <xccdf:title>Level 2</xccdf:title>
        <xccdf:description>
            <xhtml:p>This profile extends the "Level 1" profile. Items in this profile exhibit one or more of the following characteristics:</xhtml:p>
            <xhtml:ul>
                <xhtml:li>are intended for environments or use cases where security is paramount.</xhtml:li>
                <xhtml:li>acts as defense in depth measure.</xhtml:li>
                <xhtml:li>may negatively inhibit the utility or performance of the technology.</xhtml:li>
            </xhtml:ul>
        </xccdf:description>
        <xccdf:select idref="etc-security-user-mindiff" selected="true"/>
        <xccdf:select idref="etc-security-user-minage" selected="true"/>
        <xccdf:select idref="etc-security-user-maxage" selected="true"/>
        <xccdf:select idref="etc-security-user-minlen" selected="true"/>
        <xccdf:select idref="etc-security-user-minalpha" selected="true"/>
        <xccdf:select idref="etc-security-user-minother" selected="true"/>
        <xccdf:select idref="etc-security-user-maxrepeats" selected="true"/>
        <xccdf:select idref="etc-security-user-histexpire" selected="true"/>
        <xccdf:select idref="etc-security-user-histsize" selected="true"/>
        <xccdf:select idref="etc-security-user-maxexpired" selected="true"/>
        <xccdf:select idref="etc-security-login-cfg-pwd-algorithm-aix-5-3-tl-07-" selected="true"/>
        <xccdf:select idref="etc-security-login-cfg-logininterval" selected="true"/>
        <xccdf:select idref="etc-security-login-cfg-logindisable" selected="true"/>
        <xccdf:select idref="etc-security-login-cfg-loginreenable" selected="true"/>
        <xccdf:select idref="etc-security-login-cfg-logintimeout" selected="true"/>
        <xccdf:select idref="etc-security-login-cfg-logindelay" selected="true"/>
        <xccdf:select idref="etc-security-user-loginretries" selected="true"/>
        <xccdf:select idref="etc-security-user-rlogin" selected="true"/>
        <xccdf:select idref="etc-security-user-sugroups" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-permissions-and-ownership" selected="true"/>
        <xccdf:select idref="miscellaneous-enhancements-etc-ftpusers" selected="true"/>
        <xccdf:select idref="miscellaneous-enhancements-login-herald" selected="true"/>
        <xccdf:select idref="miscellaneous-enhancements-guest-account-removal" selected="true"/>
        <xccdf:select idref="miscellaneous-enhancements-crontab-permissions" selected="true"/>
        <xccdf:select idref="configuring-ssh-disabling-direct-root-access" selected="true"/>
        <xccdf:select idref="configuring-ssh-server-protocol-2" selected="true"/>
        <xccdf:select idref="configuring-ssh-client-protocol-2" selected="true"/>
        <xccdf:select idref="configuring-ssh-banner-configuration" selected="true"/>
        <xccdf:select idref="configuring-ssh-ignore-shosts-and-rhosts" selected="true"/>
        <xccdf:select idref="configuring-ssh-disable-null-passwords" selected="true"/>
        <xccdf:select idref="configuring-ssh-set-privilege-separation" selected="true"/>
        <xccdf:select idref="configuring-ssh-sshd_config-permissions-lockdown" selected="true"/>
        <xccdf:select idref="configuring-ssh-ssh_config-permissions-lockdown" selected="true"/>
        <xccdf:select idref="etc-mail-sendmail-cf-smtpgreetingmessage" selected="true"/>
        <xccdf:select idref="etc-mail-sendmail-cf-permissions-and-ownership" selected="true"/>
        <xccdf:select idref="var-spool-mqueue-permissions-and-ownership" selected="true"/>
        <xccdf:select idref="cde-sgid-suid-binary-lockdown" selected="true"/>
        <xccdf:select idref="cde-screensaver-lock" selected="true"/>
        <xccdf:select idref="cde-etc-dt-config-xconfig-permissions-and-ownership" selected="true"/>
        <xccdf:select idref="cde-etc-dt-config-xservers-permissions-and-ownership" selected="true"/>
        <xccdf:select idref="cde-login-screen-hostname-masking" selected="true"/>
        <xccdf:select idref="cde-etc-dt-config-xresources-permissions-and-ownership" selected="true"/>
        <xccdf:select idref="nfs-nosuid-on-nfs-client-mounts" selected="true"/>
        <xccdf:select idref="nfs-localhost-removal" selected="true"/>
        <xccdf:select idref="nfs-no-root-squash-option" selected="true"/>
        <xccdf:select idref="tcp-wrappers-creating-a-hosts-deny-file" selected="true"/>
        <xccdf:select idref="tcp-wrappers-creating-a-hosts-allow-file" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-etc-security" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-etc-group" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-etc-passwd" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-etc-security-audit" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-audit" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-smit.log" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-var-adm-cron-log" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-var-spool-cron-crontabs" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-var-adm-cron-at.allow" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-var-adm-cron-cron.allow" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-etc-motd" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-var-adm-ras" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-var-ct-rmstart-log" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-var-tmp-dpid2-log" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-var-tmp-hostmibd-log" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-var-tmp-snmpd-log" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-var-adm-sa" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-world-writable-directory-in-root-path" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-home-directory-configuration-files" selected="true"/>
        <xccdf:select idref="permissions-and-ownership-home-directory-permissions" selected="true"/>
        <xccdf:select idref="miscellaneous-config-ftp-umask" selected="true"/>
        <xccdf:select idref="miscellaneous-config-ftp-banner" selected="true"/>
        <xccdf:select idref="miscellaneous-config-etc-motd" selected="true"/>
        <xccdf:select idref="miscellaneous-config-authorized-users-in-at-allow" selected="true"/>
        <xccdf:select idref="miscellaneous-config-authorized-users-in-cron-allow" selected="true"/>
        <xccdf:select idref="miscellaneous-config-all-unlocked-accounts-must-have-a-password" selected="true"/>
        <xccdf:select idref="miscellaneous-config-all-user-id-must-be-unique" selected="true"/>
        <xccdf:select idref="miscellaneous-config-all-group-id-must-be-unique" selected="true"/>
        <xccdf:select idref="miscellaneous-config-removing-current-working-directory-from-roots-PATH" selected="true"/>
        <xccdf:select idref="miscellaneous-config-removing-current-working-directory-from-default-etc-environment-PATH" selected="true"/>        
        <xccdf:select idref="system-account-lockdown" selected="true"/>
        <xccdf:select idref="etc-inittab-qdaemon" selected="true"/>
        <xccdf:select idref="etc-inittab-lpd" selected="true"/>
        <xccdf:select idref="etc-inittab-piobe" selected="true"/>
        <xccdf:select idref="etc-inittab-dt" selected="true"/>
        <xccdf:select idref="etc-inittab-rcnfs" selected="true"/>
        <xccdf:select idref="etc-rc-tcpip-sendmail" selected="true"/>
        <xccdf:select idref="etc-rc-tcpip-snmpd" selected="true"/>
        <xccdf:select idref="etc-rc-tcpip-dhcpcd" selected="true"/>
        <xccdf:select idref="etc-rc-tcpip-dhcprd" selected="true"/>
        <xccdf:select idref="etc-rc-tcpip-dhcpsd" selected="true"/>
        <xccdf:select idref="etc-rc-tcpip-autoconf6" selected="true"/>
        <xccdf:select idref="etc-rc-tcpip-gated" selected="true"/>
        <xccdf:select idref="etc-rc-tcpip-mrouted" selected="true"/>
        <xccdf:select idref="etc-rc-tcpip-named" selected="true"/>
        <xccdf:select idref="etc-rc-tcpip-routed" selected="true"/>
        <xccdf:select idref="etc-rc-tcpip-rwhod" selected="true"/>
        <xccdf:select idref="etc-rc-tcpip-timed" selected="true"/>
        <xccdf:select idref="etc-rc-tcpip-dpid2" selected="true"/>
        <xccdf:select idref="etc-rc-tcpip-hostmibd" selected="true"/>
        <xccdf:select idref="etc-rc-tcpip-snmpmibd" selected="true"/>
        <xccdf:select idref="etc-rc-tcpip-aixmibd" selected="true"/>
        <xccdf:select idref="etc-rc-tcpip-ndpd-host" selected="true"/>
        <xccdf:select idref="etc-rc-tcpip-ndpd-router" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-telnet" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-exec" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-daytime" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-shell" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-cmsd" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-ttdbserver" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-uucp" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-time" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-login" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-talk" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-ntalk" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-ftp" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-chargen" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-discard" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-dtspc" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-echo" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-pcnfs" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-rstatd" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-rusersd" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-rwalld" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-sprayd" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-klogin" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-kshell" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-rquotad" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-tftp" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-imap" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-pop3" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-fingerd" selected="true"/>
        <xccdf:select idref="etc-inetd-conf-instsrv" selected="true"/>
        <xccdf:select idref="remote-command-lockdown" selected="true"/>
        <xccdf:select idref="remote-daemon-lockdown" selected="true"/>
        <xccdf:select idref="removal-of-rhosts-and-netrc-files" selected="true"/>
        <xccdf:select idref="removal-of-entries-from-etc-hosts-equiv" selected="true"/>
        <xccdf:select idref="tcp-ip-tuning-ipsrcrouteforward" selected="true"/>
        <xccdf:select idref="tcp-ip-tuning-ipignoreredirects" selected="true"/>
        <xccdf:select idref="tcp-ip-tuning-clean-partial-conns" selected="true"/>
        <xccdf:select idref="tcp-ip-tuning-ipsrcroutesend" selected="true"/>
        <xccdf:select idref="tcp-ip-tuning-ipforwarding" selected="true"/>
        <xccdf:select idref="tcp-ip-tuning-ipsendredirects" selected="true"/>
        <xccdf:select idref="tcp-ip-tuning-ip6srcrouteforward" selected="true"/>
        <xccdf:select idref="tcp-ip-tuning-directed-broadcast" selected="true"/>
        <xccdf:select idref="tcp-ip-tuning-tcp-pmtu-discover" selected="true"/>
        <xccdf:select idref="tcp-ip-tuning-bcastping" selected="true"/>
        <xccdf:select idref="tcp-ip-tuning-icmpaddressmask" selected="true"/>
        <xccdf:select idref="tcp-ip-tuning-udp-pmtu-discover" selected="true"/>
        <xccdf:select idref="tcp-ip-tuning-ipsrcrouterecv" selected="true"/>
        <xccdf:select idref="tcp-ip-tuning-nonlocsrcroute" selected="true"/>
        <xccdf:select idref="tcp-ip-tuning-tcp-tcpsecure" selected="true"/>
        <xccdf:select idref="tcp-ip-tuning-sockthresh" selected="true"/>
        <xccdf:select idref="tcp-ip-tuning-rfc1323" selected="true"/>
        <xccdf:select idref="tcp-ip-tuning-tcp-sendspace" selected="true"/>
        <xccdf:select idref="tcp-ip-tuning-tcp-recvspace" selected="true"/>
        <xccdf:select idref="tcp-ip-tuning-tcp-mssdflt" selected="true"/>
        <xccdf:select idref="tcp-ip-tuning-nfs-use-reserved-ports" selected="true"/>
        <xccdf:select idref="miscellaneous-enhancements-crontab-access" selected="true"/>
        <xccdf:select idref="miscellaneous-enhancements-at-access" selected="true"/>
        <xccdf:select idref="miscellaneous-enhancements-default-umask" selected="true"/>
        <xccdf:select idref="miscellaneous-enhancements-disabling-core-dumps" selected="true"/>
        <xccdf:select idref="miscellaneous-enhancements-aix-auditing" selected="true"/>
        <xccdf:select idref="configuring-syslog-local-logging" selected="true"/>
        <xccdf:select idref="configuring-syslog-remote-logging" selected="true"/>
        <xccdf:select idref="configuring-syslog-remote-messages" selected="true"/>
        <xccdf:select idref="configuring-ssh-installation" selected="true"/>
        <xccdf:select idref="configuring-ssh-disallow-host-based-authentication" selected="true"/>
        <xccdf:select idref="configuring-ssh-removal-of-shosts-files" selected="true"/>
        <xccdf:select idref="configuring-ssh-removal-of-etc-shosts-equiv" selected="true"/>
        <xccdf:select idref="cde-de-installing-cde" selected="true"/>
        <xccdf:select idref="cde-disabling-dtlogin" selected="true"/>
        <xccdf:select idref="cde-remote-gui-login-disabled" selected="true"/>
        <xccdf:select idref="nfs-de-install-nfs" selected="true"/>
        <xccdf:select idref="nfs-restrict-nfs-access" selected="true"/>
        <xccdf:select idref="nfs-secure-nfs" selected="true"/>
        <xccdf:select idref="nis-disable-nis-client" selected="true"/>
        <xccdf:select idref="nis-disable-nis-server" selected="true"/>
        <xccdf:select idref="nis-remove-nis-markers-from-password-and-group-files" selected="true"/>
        <xccdf:select idref="nis-restrict-nis-server-communication" selected="true"/>
        <xccdf:select idref="snmp-disable-private-community" selected="true"/>
        <xccdf:select idref="snmp-disable-system-community" selected="true"/>
        <xccdf:select idref="snmp-disable-public-community" selected="true"/>
        <xccdf:select idref="snmp-restrict-community-access" selected="true"/>
        <xccdf:select idref="snmp-disable-readwrite-community" selected="true"/>
        <xccdf:select idref="inetd-disabling-inetd" selected="true"/>
        <xccdf:select idref="etc-rc-tcpip-portmap" selected="true"/>
        <xccdf:select idref="tcp-wrappers-installing-tcp-wrappers" selected="true"/>
        <xccdf:select idref="tcp-wrappers-wrapping-inetd-services" selected="true"/>
        <xccdf:select idref="miscellaneous-config-serial-port-restriction" selected="true"/>
        <xccdf:select idref="miscellaneous-config-disable-i4ls" selected="true"/>
        <xccdf:select idref="miscellaneous-config-disable-ncs" selected="true"/>
        <xccdf:select idref="miscellaneous-config-disable-httpdlite" selected="true"/>
        <xccdf:select idref="miscellaneous-config-disable-pmd" selected="true"/>
        <xccdf:select idref="miscellaneous-config-disable-writesrv" selected="true"/>
        <xccdf:select idref="miscellaneous-config-block-talk-write-" selected="true"/>
        <xccdf:select idref="miscellaneous-config-enable-sar-accounting" selected="true"/>
        <xccdf:select idref="miscellaneous-config-etc-ftpusers" selected="true"/>
        <xccdf:select idref="miscellaneous-config-unnecessary-user-and-group-removal" selected="true"/>
        <xccdf:select idref="pcm-sudo" selected="true"/>
        <xccdf:select idref="pcm-enhanced-rbac-aix-6-1-only-" selected="true"/>
        <xccdf:select idref="encrypted-filesystems-efs-aix-6-1-only" selected="true"/>
        <xccdf:select idref="te-implementation-aix-6-1-only-" selected="true"/>
        <xccdf:select idref="fpm-suid-sgid-files" selected="true"/>
        <xccdf:select idref="fpm-un-owned-files-and-directories" selected="true"/>
        <xccdf:select idref="fpm-world-writable-files-and-directories" selected="true"/>
    </xccdf:Profile>
    
    <xccdf:Group id="aix-security-expert-recommendations">
        <xccdf:title>AIX Security Expert - Recommendations</xccdf:title>
        <xccdf:description>
            <xhtml:div>
                <xhtml:p>This section provides details of the recommended settings controlled within the AIX Security Expert framework. The settings within this section can all be automatically applied, utilizing the <xhtml:code>aixpert</xhtml:code> command to implement the customized XML file.</xhtml:p>
            </xhtml:div>
        </xccdf:description>
        <xccdf:Group id="aix-security-expert-password-policy">
            <xccdf:title>AIX Security Expert - Password Policy</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p>This section provides guidance on the configuration of the password policy. This includes recommended length, complexity, re-use and expiration.</xhtml:p>
                    <xhtml:p>The recommendations in this section affect the parameters of the default user stanza. The values set are only applicable if specific values are not defined during the creation of a user. It is therefore recommended to not set any of these values explicitly, unless there is a specific requirement to do so when a user is created.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            
            <xccdf:Rule id="etc-security-user-mindiff" selected="false">
                <xccdf:title>/etc/security/user - mindiff </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Defines the minimum number of characters that are required in a new password which were not in the old password.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>In setting the <xhtml:code>mindiff</xhtml:code> attribute, it ensures that users are not able to reuse the same or similar passwords.<br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/security/user</xhtml:code>, set the default user stanza <xhtml:code>mindiff</xhtml:code> attribute to be greater than or equal to <xhtml:code>4</xhtml:code>.   <br/><br/>This means that when a user password is set it needs to comprise of at least 4 characters not present in the previous password.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsec -f /etc/security/user -s default -a mindiff=4</xhtml:code><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>lssec -f /etc/security/user -s default -a mindiff</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>default mindiff=4</xhtml:code><br/><br/><b>Default Value:</b> No limit<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	mindiff=4<br/>Medium Level policy	mindiff =3<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure password 'mindiff' is greater than or equal to '4'" success="pass">
                            <ecl:command>lssec -f /etc/security/user -s default -a mindiff</ecl:command>
                            <ecl:line-selection op="pm" value="^default\s+mindiff=(\d+)\s*$">
                                <ecl:regex-group dt="xs:integer" group="1" op="ge" value="4"/>
                            </ecl:line-selection>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-security-user-minage" selected="false">
                <xccdf:title>/etc/security/user - minage </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Defines the minimum number of weeks before a password can be changed.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>In setting the <xhtml:code>minage</xhtml:code> attribute, it prohibits users changing their password until a set number of weeks have passed.<br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/security/user</xhtml:code>, set the default user stanza <xhtml:code>minage</xhtml:code> attribute to <xhtml:code>1</xhtml:code>. <br/><br/>This means that a user cannot change their password until at least a week after being set.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsec -f /etc/security/user -s default -a minage=1</xhtml:code><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>lssec -f /etc/security/user -s default -a minage</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>default minage=1</xhtml:code><br/><br/><b>Default Value:</b> No limit<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	minage=1<br/>Medium Level policy	minage =4<br/>Low Level policy 	No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure password 'minage' is equal to '1'" success="pass">
                            <ecl:command>lssec -f /etc/security/user -s default -a minage</ecl:command>
                            <ecl:line-selection op="pm" value="^default\s+minage=(\d+)\s*$">
                                <ecl:regex-group dt="xs:integer" group="1" op="eq" value="1"/>
                            </ecl:line-selection>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-security-user-maxage" selected="false">
                <xccdf:title>/etc/security/user - maxage </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Defines the maximum number of weeks that a password is valid.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>In setting the <xhtml:code>maxage</xhtml:code> attribute, it enforces regular password changes.<br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/security/user</xhtml:code>, set the default user stanza maxage attribute a number greater than 0 but less than or equal to <xhtml:code>13</xhtml:code>. <br/><br/>This means that a user password must be changed 13 weeks after being set.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsec -f /etc/security/user -s default -a maxage=13</xhtml:code><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>lssec -f /etc/security/user -s default -a maxage</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>default maxage=13</xhtml:code><br/><br/><b>Default Value:</b> No limit<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	maxage =13<br/>Medium Level policy maxage = 13<br/>Low Level policy 	maxage = 52<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure password 'maxage' is less than or equal to '13'" success="pass">
                                <ecl:command>lssec -f /etc/security/user -s default -a maxage</ecl:command>
                                <ecl:line-selection op="pm" value="^default\s+maxage=(\d+)\s*$">
                                    <ecl:regex-group dt="xs:integer" group="1" op="le" value="13"/>
                                </ecl:line-selection>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure password 'maxage' is not set to '0'" success="pass">
                                <ecl:command>lssec -f /etc/security/user -s default -a maxage</ecl:command>
                                <ecl:line-selection op="pm" value="^default\s+maxage=(\d+)\s*$">
                                    <ecl:regex-group dt="xs:integer" group="1" op="ne" value="0"/>
                                </ecl:line-selection>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-security-user-minlen" selected="false">
                <xccdf:title>/etc/security/user - minlen </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Defines the minimum length of a password.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>In setting the <xhtml:code>minlen</xhtml:code> attribute, it ensures that passwords meet the required length criteria.<br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/security/user</xhtml:code>, set the default user stanza <xhtml:code>minlen</xhtml:code> attribute to be greater than or equal to <xhtml:code>8</xhtml:code>.<br/><br/>This means that all user passwords must be at least 8 characters in length.<br/><br/>NOTE: If a password length greater than 8 is required, an enhanced password hashing algorithm must be selected as detailed in section 1.1.11. The default crypt algorithm only supports 8 character passwords.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsec -f /etc/security/user -s default -a minlen=8</xhtml:code><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>lssec -f /etc/security/user -s default -a minlen</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>default minlen=8</xhtml:code><br/><br/><b>Default Value:</b> No limit<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	minlen = 8<br/>Medium Level policy minlen = 8<br/>Low Level policy 	minlen = 8<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure password 'minlen' is greater than or equal to '8'" success="pass">
                            <ecl:command>lssec -f /etc/security/user -s default -a minlen</ecl:command>
                            <ecl:line-selection op="pm" value="^default\s+minlen=(\d+)\s*$">
                                <ecl:regex-group dt="xs:integer" group="1" op="le" value="8"/>
                            </ecl:line-selection>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-security-user-minalpha" selected="false">
                <xccdf:title>/etc/security/user - minalpha</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Defines the minimum number of alphabetic characters in a password.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>In setting the <xhtml:code>minalpha</xhtml:code> attribute, it ensures that passwords have a minimum number of alphabetic characters.<br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/security/user</xhtml:code>, set the default user stanza <xhtml:code>minalpha</xhtml:code> attribute to be greater than or equal to 2.<br/><br/>This means that there must be at least <xhtml:code>2</xhtml:code> alphabetic characters within an <xhtml:code>8</xhtml:code> character user password.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsec -f /etc/security/user -s default -a minalpha=2</xhtml:code><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>lssec -f /etc/security/user -s default -a minalpha</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>default minalpha=2</xhtml:code><br/><br/><b>Default Value:</b> No limit<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	minalpha = 2<br/>Medium Level policy minalpha = 1<br/>Low Level policy 	No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure password 'minalpha' is greater than or equal to '2'" success="pass">
                            <ecl:command>lssec -f /etc/security/user -s default -a minalpha</ecl:command>
                            <ecl:line-selection op="pm" value="^default\s+minalpha=(\d+)\s*$">
                                <ecl:regex-group dt="xs:integer" group="1" op="ge" value="2"/>
                            </ecl:line-selection>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-security-user-minother" selected="false">
                <xccdf:title>/etc/security/user - minother </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Defines the number of characters within a password which must be non-alphabetic.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>In setting the <xhtml:code>minother</xhtml:code> attribute, it increases password complexity by enforcing the use of non-alphabetic characters in every user password. <br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/security/user</xhtml:code>, set the default user stanza minother attribute to be greater than or equal to  <xhtml:code>2</xhtml:code>.<br/><br/>This means that there must be at least <xhtml:code>2</xhtml:code> non-alphabetic characters within an <xhtml:code>8</xhtml:code> character user password.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsec -f /etc/security/user -s default -a minother=2</xhtml:code><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>lssec -f /etc/security/user -s default -a minother</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>default minother=2</xhtml:code><br/><br/><b>Default Value:</b> No limit<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	minother = 2<br/>Medium Level policy minother = 1<br/>Low Level policy 	no effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure password 'minother' is greater than or equal to '2'" success="pass">
                            <ecl:command>lssec -f /etc/security/user -s default -a minother</ecl:command>
                            <ecl:line-selection op="pm" value="^default\s+minother=(\d+)\s*$">
                                <ecl:regex-group dt="xs:integer" group="1" op="ge" value="2"/>
                            </ecl:line-selection>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-security-user-maxrepeats" selected="false">
                <xccdf:title>/etc/security/user - maxrepeats </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Defines the maximum number of times a character may appear in a password.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>In setting the <xhtml:code>maxrepeats</xhtml:code> attribute, it enforces a maximum number of character repeats within a password<br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/security/user</xhtml:code>, set the default user stanza <xhtml:code>maxrepeats</xhtml:code> attribute to <xhtml:code>2</xhtml:code>.<br/><br/>This means that a user may not use the same character more than twice in a password.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsec -f /etc/security/user -s default -a maxrepeats=2</xhtml:code><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>lssec -f /etc/security/user -s default -a maxrepeats</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>default maxrepeats=2</xhtml:code><br/><br/><b>Default Value:</b> 8<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	maxrepeats = 2<br/>Medium Level policy no effect<br/>Low Level policy 	no effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure password 'maxrepeats' is less than or equal to '2'" success="pass">
                            <ecl:command>lssec -f /etc/security/user -s default -a maxrepeats</ecl:command>
                            <ecl:line-selection op="pm" value="^default\s+maxrepeats=(\d+)\s*$">
                                <ecl:regex-group dt="xs:integer" group="1" op="le" value="2"/>
                            </ecl:line-selection>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-security-user-histexpire" selected="false">
                <xccdf:title>/etc/security/user - histexpire </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Defines the period of time in weeks that a user will not be able to reuse a password.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>In setting the <xhtml:code>histexpire</xhtml:code> attribute, it ensures that a user cannot reuse a password within a set period of time.<br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/security/user</xhtml:code>, set the default user stanza <xhtml:code>histexpire</xhtml:code> attribute to be less than or equal to <xhtml:code>13</xhtml:code>.<br/><br/>This means that a user will not be able to re-use any password set in the last <xhtml:code>13</xhtml:code> weeks.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsec -f /etc/security/user -s default -a histexpire=13</xhtml:code><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>lssec -f /etc/security/user -s default -a histexpire</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>default histexpire=13</xhtml:code><br/><br/><b>Default Value:</b> No limit<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	histexpire = 13<br/>Medium Level policy histexpire = 13<br/>Low Level policy 	histexpire = 26<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure password 'histexpire' is greater than or equal to '13'" success="pass">
                            <ecl:command>lssec -f /etc/security/user -s default -a histexpire</ecl:command>
                            <ecl:line-selection op="pm" value="^default\s+histexpire=(\d+)\s*$">
                                <ecl:regex-group dt="xs:integer" group="1" op="ge" value="13"/>
                            </ecl:line-selection>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-security-user-histsize" selected="false">
                <xccdf:title>/etc/security/user - histsize </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Defines the number of previous passwords that a user may not reuse.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>In setting the <xhtml:code>histsize</xhtml:code> attribute, it enforces a minimum number of previous passwords a user cannot reuse.<br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/security/user</xhtml:code>, set the default user stanza <xhtml:code>histsize</xhtml:code> attribute to be greater than or equal to <xhtml:code>20</xhtml:code>.<br/><br/>This means that a user many not re-use any of the previous <xhtml:code>20</xhtml:code> passwords.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsec -f /etc/security/user -s default -a histsize=20</xhtml:code><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>lssec -f /etc/security/user -s default -a histsize</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>default histsize=20</xhtml:code><br/><br/><b>Default Value:</b> No limit<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	histsize = 20<br/>Medium Level policy histsize = 4<br/>Low Level policy 	histsize = 4<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure password 'histsize' is greater than or equal to '20'" success="pass">
                            <ecl:command>lssec -f /etc/security/user -s default -a histsize</ecl:command>
                            <ecl:line-selection op="pm" value="^default\s+histsize=(\d+)\s*$">
                                <ecl:regex-group dt="xs:integer" group="1" op="ge" value="20"/>
                            </ecl:line-selection>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-security-user-maxexpired" selected="false">
                <xccdf:title>/etc/security/user - maxexpired </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Defines the number of weeks after <xhtml:code>maxage</xhtml:code>, that a password can be reset by the user<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>In setting the <xhtml:code>maxexpired</xhtml:code> attribute, it limits the number of weeks after password expiry when it may be changed by the user.<br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/security/user</xhtml:code>, set the default user stanza <xhtml:code>maxexpired</xhtml:code> attribute to <xhtml:code>2</xhtml:code>.<br/><br/>This means that a user can only reset their password up to <xhtml:code>2</xhtml:code> weeks after it has expired. After this an administrative user would need to reset the password.  <br/> <br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsec -f /etc/security/user -s default -a maxexpired=2</xhtml:code><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>lssec -f /etc/security/user -s default -a maxexpired</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>default maxexpired=2</xhtml:code><br/><br/><b>Default Value:</b> No limit<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	maxexpired = 2<br/>Medium Level policy maxexpired = 4<br/>Low Level policy 	maxexpired = 8<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure password 'maxexpired' is less than or equal to '2'" success="pass">
                            <ecl:command>lssec -f /etc/security/user -s default -a maxexpired</ecl:command>
                            <ecl:line-selection op="pm" value="^default\s+maxexpired=(\d+)\s*$">
                                <ecl:regex-group dt="xs:integer" group="1" op="le" value="2"/>
                            </ecl:line-selection>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-security-login-cfg-pwd-algorithm-aix-5-3-tl-07-" selected="false">
                <xccdf:title>/etc/security/login.cfg - pwd_algorithm (AIX 5.3 TL-07 +) </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Defines the loadable password algorithm used when storing user passwords. <br/>The management of the password encryption algorithm is not performed within the default AIX Security Expert framework. This change is managed as a customized entry in the XML files.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>A development of AIX 6.1 was the ability to use different password algorithms as defined in <xhtml:code>/etc/security/pwdalg.cfg</xhtml:code>. This functionality has been back ported into AIX 5.3 TL-07 and above. The traditional UNIX password algorithm is <xhtml:code>crypt</xhtml:code>, which is a one-way hash function supporting only 8 character passwords. The use of brute force password guessing attacks means that crypt no longer provides an appropriate level of security and so other encryption mechanisms are recommended. <br/><br/>The recommendation of this benchmark is to set the password algorithm to <xhtml:code>ssha256</xhtml:code>. This algorithm supports long passwords, up to 255 characters in length and allows passphrases including the use of the extended ASCII table and the space character. Any passwords already set using <xhtml:code>crypt</xhtml:code> will remain supported, but there can only one system password algorithm active at any one time.<br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/security/login.cfg</xhtml:code>, set the <xhtml:code>usw</xhtml:code> user stanza <xhtml:code>pwd_algorithm</xhtml:code> attribute to <xhtml:code>ssha256</xhtml:code>.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsec -f /etc/security/login.cfg -s usw -a pwd_algorithm=ssha256</xhtml:code><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>lssec -f /etc/security/login.cfg -s usw -a pwd_algorithm</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>usw pwd_algorithm=ssha256</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to continue to use the <xhtml:code>crypt</xhtml:code> algorithm or the system is running on a level older than AIX 5.3 TL-07, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;"chsec -f /etc/security/login.cfg -s usw -a pwd_algorithm=ssha256"&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;"chsec -f /etc/security/login.cfg -s usw -a pwd_algorithm=ssha256"&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> crypt<br/><br/>Default AIX Security Expert policy values:<br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure password algorithm is ssha256" success="pass">
                            <ecl:command>lssec -f /etc/security/login.cfg -s usw -a pwd_algorithm</ecl:command>
                            <ecl:line-selection op="pm" value="^usw\s+pwd_algorithm=ssha256\s*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="aix-security-expert-login-policy">
            <xccdf:title>AIX Security Expert - Login Policy </xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p>This section provides guidance on the configuration of the system login policy. This includes login timeouts, delays and remote root access.</xhtml:p>
                    <xhtml:p>The recommendations in this section affect the general login policy of the system for all users. Every user should have a dedicated account, to ensure accountability and audit trailing. Any generic accounts should be disabled from direct login, where possible. All remote logons as root should also be prohibited, instead elevation to root should only be allowed once a user has authenticated locally through their individual user account.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:Rule id="etc-security-login-cfg-logininterval" selected="false">
                <xccdf:title>/etc/security/login.cfg - logininterval </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Defines the time interval, in seconds, when the unsuccessful logins must occur to disable a port. This parameter is applicable to all <xhtml:code>tty</xhtml:code> connections and the system console.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>In setting the <xhtml:code>logininterval</xhtml:code> attribute, a port will be disabled if the incorrect password is entered a pre-defined number of times, set via <xhtml:code>logindisable</xhtml:code>, within this interval. <br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/security/login.cfg</xhtml:code>, set the default stanza <xhtml:code>logininterval</xhtml:code> attribute to be less than or equal to <xhtml:code>300</xhtml:code>.<br/><br/>This means that the port will be disabled if the incorrect password is typed the appropriate number of times, within a <xhtml:code>300</xhtml:code> second interval.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsec -f /etc/security/login.cfg -s default -a logininterval=300</xhtml:code><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>lssec -f /etc/security/login.cfg -s default -a logininterval</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>default logininterval=300</xhtml:code><br/><br/><b>Default Value:</b> No limit<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	logininterval = 300<br/>Medium Level policy logininterval = 60<br/>Low Level policy 	no effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure password 'logininterval' is less than or equal to '300'" success="pass">
                            <ecl:command>lssec -f /etc/security/login.cfg -s default -a logininterval</ecl:command>
                            <ecl:line-selection op="pm" value="^default\s+logininterval=(\d+)\s*$"/>
                            <ecl:regex-group dt="xs:integer" group="1" op="le" value="300"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-security-login-cfg-logindisable" selected="false">
                <xccdf:title>/etc/security/login.cfg - logindisable </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Defines the number of unsuccessful login attempts required before a port will be locked. This parameter is applicable to all <xhtml:code>tty</xhtml:code> connections and the system console.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>In setting the <xhtml:code>logindisable</xhtml:code> attribute, a port will be disabled if the incorrect password is entered a set number of times within a specified interval, set via <xhtml:code>logininterval</xhtml:code>.<br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/security/login.cfg</xhtml:code>, set the default stanza <xhtml:code>logindisable</xhtml:code> attribute  to be less than or equal to  <xhtml:code>10</xhtml:code>.<br/><br/>This means that the port will be disabled if the incorrect password is typed <xhtml:code>10</xhtml:code> times within a <xhtml:code>300</xhtml:code> second interval.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsec -f /etc/security/login.cfg -s default -a logindisable=10</xhtml:code><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>lssec -f /etc/security/login.cfg -s default -a logindisable</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>default logindisable=10</xhtml:code><br/><br/><b>Default Value:</b> No limit<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	logindisable = 10<br/>Medium Level policy logindisable = 10<br/>Low Level policy 	no effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure password 'logindisable' is less than or equal to '10'" success="pass">
                            <ecl:command>lssec -f /etc/security/login.cfg -s default -a logindisable</ecl:command>
                            <ecl:line-selection op="pm" value="^default\s+logindisable=(\d+)\s*$">
                                <ecl:regex-group dt="xs:integer" group="1" op="le" value="10"/>
                            </ecl:line-selection>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-security-login-cfg-loginreenable" selected="false">
                <xccdf:title>/etc/security/login.cfg - loginreenable</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Defines the number of minutes after a port is locked when it will be automatically un-locked. This parameter is applicable to all <xhtml:code>tty</xhtml:code> connections and the system console.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>In setting the <xhtml:code>loginreenable</xhtml:code> attribute, a locked port will be automatically re-enabled once a given number of minutes have passed.<br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/security/login.cfg</xhtml:code>, set the default stanza <xhtml:code>loginreenable</xhtml:code> attribute to be greater than or equal to <xhtml:code>360</xhtml:code>.<br/><br/>This means that a locked port will be automatically re-enabled <xhtml:code>360</xhtml:code> minutes after being locked.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsec -f /etc/security/login.cfg -s default -a loginreenable=360</xhtml:code><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>lssec -f /etc/security/login.cfg -s default -a loginreenable</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>default loginreenable=360</xhtml:code><br/><br/><b>Default Value:</b> No limit<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	loginreenable = 360<br/>Medium Level policy loginreenable = 30<br/>Low Level policy 	no effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure password 'loginreenable' is greater than or equal to '360'" success="pass">
                            <ecl:command>lssec -f /etc/security/login.cfg -s default -a loginreenable</ecl:command>
                            <ecl:line-selection op="pm" value="^default\s+loginreenable=(\d+)\s*$">
                                <ecl:regex-group dt="xs:integer" group="1" op="ge" value="360"/>
                            </ecl:line-selection>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-security-login-cfg-logintimeout" selected="false">
                <xccdf:title>/etc/security/login.cfg - logintimeout </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Defines the number of seconds during which the password must be typed at login. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>In setting the <xhtml:code>logintimeout</xhtml:code> attribute, a password must be entered within a specified time period. <br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/security/login.cfg</xhtml:code>, set the usw stanza <xhtml:code>logintimeout</xhtml:code> attribute to be less than or equal to 30.<br/><br/>This means that a user will have 30 seconds, from prompting, in which to type in their password.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsec -f /etc/security/login.cfg -s usw -a logintimeout=30</xhtml:code><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>lssec -f /etc/security/login.cfg -s usw -a logintimeout</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>usw logintimeout=30</xhtml:code><br/><br/><b>Default Value:</b> 60<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	logintimeout = 30<br/>Medium Level policy logintimeout = 60<br/>Low Level policy 	logintimeout = 60<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure password 'logintimeout' is less than or equal to '30'" success="pass">
                            <ecl:command>lssec -f /etc/security/login.cfg -s usw -a logintimeout</ecl:command>
                            <ecl:line-selection op="pm" value="^usw\s+logintimeout=(\d+)\s*$">
                                <ecl:regex-group dt="xs:integer" group="1" op="le" value="30"/>
                            </ecl:line-selection>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-security-login-cfg-logindelay" selected="false">
                <xccdf:title>/etc/security/login.cfg - logindelay </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Defines the number of seconds delay between each failed login attempt. This works as a multiplier, so if the parameter is set to <xhtml:code>10</xhtml:code>, after the first failed login it would delay for <xhtml:code>10</xhtml:code> seconds, after the second failed login <xhtml:code>20</xhtml:code> seconds etc.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>In setting the <xhtml:code>logindelay</xhtml:code> attribute, this implements a delay multiplier in-between unsuccessful login attempts. <br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/security/login.cfg</xhtml:code>, set the default stanza <xhtml:code>logindelay</xhtml:code> attribute to be greater than or equal to  10.<br/><br/>This means that a user will have to wait 10 seconds before being able to re-enter their password. During subsequent attempts this delay will increase as a multiplier of (the number of failed login attempts * <xhtml:code>logindelay</xhtml:code>)<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsec -f /etc/security/login.cfg -s default -a logindelay=10</xhtml:code><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>lssec -f /etc/security/login.cfg -s default -a logindelay</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>default logindelay=10</xhtml:code><br/><br/><b>Default Value:</b> No limit<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	logindelay = 10<br/>Medium Level policy logindelay = 5<br/>Low Level policy 	logindelay = 5<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure password 'logindelay' is greater than or equal to '10'" success="pass">
                            <ecl:command>lssec -f /etc/security/login.cfg -s default -a logindelay</ecl:command>
                            <ecl:line-selection op="pm" value="^default\s+logindelay=(\d+)\s*$">
                                <ecl:regex-group dt="xs:integer" group="1" op="ge" value="10"/>
                            </ecl:line-selection>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-security-user-loginretries" selected="false">
                <xccdf:title>/etc/security/user - loginretries </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Defines the number of attempts a user has to login to the system before their account is disabled.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>In setting the <xhtml:code>loginretries</xhtml:code> attribute, this ensures that a user can have a pre-defined number of attempts to get their password right, prior to locking the account. <br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/security/user</xhtml:code>, set the default stanza <xhtml:code>loginretries</xhtml:code> attribute to <xhtml:code>3</xhtml:code>.<br/><br/>This means that a user will have <xhtml:code>3</xhtml:code> attempts to enter the correct password. This does not apply to the root user, which has its own stanza entry disabling this feature. <br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsec -f /etc/security/user -s default -a loginretries=3</xhtml:code><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>lssec -f /etc/security/user -s default -a loginretries</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>default loginretries=3</xhtml:code><br/><br/><b>Default Value:</b> No limit<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	loginretries = 3<br/>Medium Level policy loginretries = 4<br/>Low Level policy 	AIX 5.3 =No effect   AIX 6.1 = 5<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure password 'loginretries' is less than or equal to '3'" success="pass">
                            <ecl:command>lssec -f /etc/security/user -s default -a loginretries</ecl:command>
                            <ecl:line-selection op="pm" value="^default\s+loginretries=(\d+)\s*$">
                                 <ecl:regex-group dt="xs:integer" group="1" op="le" value="3"/>
                            </ecl:line-selection>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-security-user-rlogin" selected="false">
                <xccdf:title>/etc/security/user - rlogin </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Defines whether or not the root user can login remotely.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>In setting the <xhtml:code>rlogin</xhtml:code> attribute to false, this ensures that the root user cannot remotely log into the system.  All remote logins as root should be prohibited, instead elevation to root should only be allowed once a user has authenticated locally through their individual user account.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/security/user</xhtml:code>, set the root stanza <xhtml:code>rlogin</xhtml:code> attribute to false.<br/><br/>This means that the root user will not be able to log in the system directly. <br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsec -f /etc/security/user -s root -a rlogin=false</xhtml:code><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>lssec -f /etc/security/user -s root -a rlogin</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>root rlogin=false</xhtml:code><br/><br/><b>Default Value:</b> No limit<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	rlogin = false<br/>Medium Level policy rlogin = false<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure password 'rlogin' is 'false'" success="pass">
                            <ecl:command>lssec -f /etc/security/user -s root -a rlogin</ecl:command>
                            <ecl:line-selection op="pm" value="^root\s+rlogin=false\s*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-security-user-sugroups" selected="false">
                <xccdf:title>/etc/security/user - sugroups </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Restricts access to root, via <xhtml:code>su</xhtml:code>, to members of a specific group.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>In setting the <xhtml:code>sugroups</xhtml:code> attribute to <xhtml:code>system</xhtml:code>, this ensures that only members of the system group are able to su root.  This makes it difficult for an attacker to use a stolen root password as the attacker first has to get access to a system user ID.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/security/user</xhtml:code>, set the root stanza <xhtml:code>sugroups</xhtml:code> attribute to <xhtml:code>system</xhtml:code>.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chuser su=true sugroups=system root</xhtml:code><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>lssec -f /etc/security/user -s root -a sugroups -a su</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>root sugroups=system su=true</xhtml:code><br/><br/><b>Default Value:</b> N/A<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/>Low Level policy 	N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure password 'sugroups' is 'ALL' and 'su' is true" success="pass">
                            <ecl:command>lssec -f /etc/security/user -s root -a sugroups -a su</ecl:command>
                            <ecl:line-selection op="pm" value="^root\s+sugroups=system\s*su=true\s*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="system-account-lockdown" selected="false">
                <xccdf:title>System account lockdown </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This change disables direct login access for the generic system accounts i.e. <xhtml:code>daemon, bin, sys, adm, uucp, nobody</xhtml:code> and <xhtml:code>lpd</xhtml:code>.<br/>The lockdown of the non-interactive system users is not a managed process within the default AIX Security Expert framework. This change is managed as a customized entry in the XML files.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>This change disables direct local and remote login to the generic system accounts i.e. <xhtml:code>daemon, bin, sys, adm, uucp, nobody</xhtml:code> and <xhtml:code>lpd</xhtml:code>.  It is recommended that a password is not set on these accounts to ensure that the only access is via <xhtml:code>su</xhtml:code> from the root account.<br/><br/>There should not be a requirement to log in as any of these users directly. All users should be given specific logon ids to ensure traceability and accountability.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Change the login and remote login user flags to disable access.<br/><br/>Please note the commands below are for information only, as the setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chuser login=false rlogin=false daemon<br/>chuser login=false rlogin=false bin<br/>chuser login=false rlogin=false sys<br/>chuser login=false rlogin=false adm<br/>chuser login=false rlogin=false uucp<br/>chuser login=false rlogin=false nobody<br/>chuser login=false rlogin=false lpd</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p><xhtml:code>lsuser -a login rlogin &lt;user&gt;</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>&lt;user&gt; login=false rlogin=false</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to enable generic account remote access, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>Replace:<br/> <xhtml:code>&lt;AIXPertArgs&gt;"chuser login=false rlogin=false daemon; chuser login=false rlogin=false bin; chuser login=false rlogin=false sys; chuser login=false rlogin=false adm; chuser login=false rlogin=false uucp; chuser login=false rlogin=false nobody; chuser login=false rlogin=false lpd"&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;"chuser login=false rlogin=false daemon; chuser login=false rlogin=false bin; chuser login=false rlogin=false sys; chuser login=false rlogin=false adm; chuser login=false rlogin=false uucp; chuser login=false rlogin=false nobody; chuser login=false rlogin=false lpd"&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> No effect<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/>Low Level policy	N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <!-- generated via Python for loop -->
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure the user 'daemon' is disabled" success="pass">
                                <ecl:command>lsuser -a login rlogin daemon</ecl:command>
                                <ecl:line-selection op="pm" value="^\s*daemon login=false rlogin=false\s*$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure the user 'bin' is disabled" success="pass">
                                <ecl:command>lsuser -a login rlogin bin</ecl:command>
                                <ecl:line-selection op="pm" value="^\s*bin login=false rlogin=false\s*$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure the user 'sys' is disabled" success="pass">
                                <ecl:command>lsuser -a login rlogin sys</ecl:command>
                                <ecl:line-selection op="pm" value="^\s*sys login=false rlogin=false\s*$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure the user 'adm' is disabled" success="pass">
                                <ecl:command>lsuser -a login rlogin adm</ecl:command>
                                <ecl:line-selection op="pm" value="^\s*adm login=false rlogin=false\s*$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure the user 'uucp' is disabled" success="pass">
                                <ecl:command>lsuser -a login rlogin uucp</ecl:command>
                                <ecl:line-selection op="pm" value="^\s*uucp login=false rlogin=false\s*$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure the user 'nobody' is disabled" success="pass">
                                <ecl:command>lsuser -a login rlogin nobody</ecl:command>
                                <ecl:line-selection op="pm" value="^\s*nobody login=false rlogin=false\s*$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure the user 'lpd' is disabled" success="pass">
                                <ecl:command>lsuser -a login rlogin lpd</ecl:command>
                                <ecl:line-selection op="pm" value="^\s*lpd login=false rlogin=false\s*$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
               </xccdf:complex-check>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="aix-security-expert-system-services-management">
            <xccdf:title>AIX Security Expert - System Services Management</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p>The objective of this section is to reduce the number of running services down to those which are core to the common functions of a UNIX server. When a superfluous service is not running, the system will not be subject to any latent vulnerability later discovered with that service and not require any subsequent remediation.</xhtml:p>
                    <xhtml:p>This section provides guidance on the startup of system services in <xhtml:code>/etc/inittab</xhtml:code>, <xhtml:code>/etc/rc.tcpip</xhtml:code> and <xhtml:code>/etc/inetd.conf</xhtml:code>. The majority of services within these files are disabled in AIX by default, so this section will focus on those services which are enabled, which if possible, should be disabled.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:Rule id="etc-inittab-qdaemon" selected="false">
                <xccdf:title>/etc/inittab - qdaemon </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This is the printing scheduling daemon that manages the submission of print jobs to piobe.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>If there is not a requirement to support local or remote printing, remove the <xhtml:code>qdaemon</xhtml:code> entry from <xhtml:code>/etc/inittab</xhtml:code>. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inittab</xhtml:code>, remove the <xhtml:code>qdaemon</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>rmitab qdaemon</xhtml:code><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>lsitab qdaemon</xhtml:code><br/><br/>The above command should yield not yield output<br/><br/><b>Reversion:</b><br/>If there is a requirement to implement print queues on the system, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;qdaemon: /etc/inittab : d disqdaemonhls&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;qdaemon: /etc/inittab : d disqdaemonhls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;qdaemon: /etc/inittab : d hls_disqdaemon&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;qdaemon: /etc/inittab : d hls_disqdaemon&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><br/><b>Default Value:</b> Uncommented<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Entry removed<br/>Medium Level policy Entry removed<br/>Low Level policy 	No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'qdaemon' is disabled" success="fail">
                            <ecl:command>lsitab qdaemon</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inittab-lpd" selected="false">
                <xccdf:title>/etc/inittab - lpd </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The <xhtml:code>lpd</xhtml:code> daemon accepts remote print jobs from other systems. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>If there is not a requirement for the system to act as a remote print server for other servers, remove the <xhtml:code>lpd</xhtml:code> entry.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inittab</xhtml:code>, remove the <xhtml:code>lpd </xhtml:code>entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>rmitab lpd</xhtml:code><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>lsitab lpd</xhtml:code><br/><br/>The above command should not yield output<br/><br/><b>Reversion:</b><br/>If there is a requirement to allow remote print queues on the system, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;lpd: /etc/inittab : d dislpdhls &lt;/AIXPertArgs&gt; </xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;lpd: /etc/inittab : d dislpdhls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt; lpd: /etc/inittab : d hls_dislpd&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt; lpd: /etc/inittab : d hls_dislpd&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Uncommented<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Entry removed<br/>Medium Level policy Entry removed<br/>Low Level policy 	No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'lpd' is disabled" success="fail">
                            <ecl:command>lsitab lpd</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inittab-piobe" selected="false">
                <xccdf:title>/etc/inittab - piobe </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This daemon is the I/O back end for the printing process, handling the job scheduling and spooling.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>If there is not a requirement for the system to support either local or remote printing, remove the <xhtml:code>piobe</xhtml:code> entry.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inittab</xhtml:code>, remove the <xhtml:code>piobe</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>rmitab piobe</xhtml:code><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>lsitab piobe</xhtml:code><br/><br/>The above command should yield not yield output<br/><br/><b>Reversion:</b><br/>If there is a requirement to implement print queues on the system, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;piobe: /etc/inittab : d dispiobehls&lt;/AIXPertArgs&gt; </xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;piobe: /etc/inittab : d dispiobehls&lt;/AIXPertArgs --&gt;</xhtml:code><br/><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;piobe: /etc/inittab : d hls_dispiobe&lt;/AIXPertArgs&gt; </xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;piobe: /etc/inittab : d hls_dispiobe&lt;/AIXPertArgs --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Uncommented<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Entry removed<br/>Medium Level policy Entry removed<br/>Low Level policy 	No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'piobe' is disabled" success="fail">
                            <ecl:command>lsitab piobe</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inittab-dt" selected="false">
                <xccdf:title>/etc/inittab - dt </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry executes the CDE startup script which starts the AIX Common Desktop Environment. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>If there is not an <xhtml:code>lft</xhtml:code> connected to the system and there are no other X11 clients that require CDE, remove the <xhtml:code>dt</xhtml:code> entry.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inittab</xhtml:code>, remove  the <xhtml:code>dt</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>rmitab dt</xhtml:code><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>lsitab dt</xhtml:code><br/><br/>The above command should yield not yield output<br/><br/><b>Reversion:</b><br/>No reversion is required if an <xhtml:code>lft</xhtml:code> is attached, it will not be disabled.<br/><br/>If there is a requirement to run CDE, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;"dt:" "/etc/inittab" ":" d discdehls&lt;/AIXPertArgs&gt;</xhtml:code> <br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;"dt:" "/etc/inittab" ":" d discdehls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt; &gt;"dt:" "/etc/inittab" ":" d hls_discde&lt;/AIXPertArgs&gt; <br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;"dt:" "/etc/inittab" ":" d hls_discde&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Uncommented (if an lft is present)<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Entry removed (if an lft is not present)<br/>Medium Level policy Entry removed (if an lft is not present)<br/>Low Level policy 	No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'dt' is disabled" success="fail">
                            <ecl:command>lsitab dt</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inittab-rcnfs" selected="false">
                <xccdf:title>/etc/inittab - rcnfs</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The <xhtml:code>rcnfs</xhtml:code> entry starts the NFS daemons during system boot.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>NFS is a service with numerous historical vulnerabilities and should not be enabled unless there is no alternative. If NFS serving is required, then read-only exports are recommended and no filesystem or directory should be exported with root access. Unless otherwise required the NFS daemons will be disabled. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Use the rmitab command to remove the NFS start-up script from <xhtml:code>/etc/inittab</xhtml:code>.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>rmitab rcnfs</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>lsitab rcnfs</xhtml:code><br/><br/>The above command should yield not yield output<br/><br/><b>Reversion:</b><br/>If there is a requirement to run NFS, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code> <br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;d disablenfshls&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;d disablenfshls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>AIX 6.1 <br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;d hls_disablenfs&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;d hls_disablenfs&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> No effect<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	NFS disabled<br/>Medium Level policy No effect<br/>Low Level policy 	No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'rcnfs' is disabled" success="fail">
                            <ecl:command>lsitab rcnfs</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-rc-tcpip-sendmail" selected="false">
                <xccdf:title>/etc/rc.tcpip - sendmail </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>sendmail</xhtml:code> daemon on system startup. This means that the system can operate as a mail server. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p><xhtml:code>sendmail</xhtml:code> is a service with many historical vulnerabilities and where possible should be disabled. If the system is not required to operate as a mail server i.e. sending, receiving or processing e-mail, comment out the <xhtml:code>sendmail</xhtml:code> entry.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/rc.tcpip</xhtml:code>, comment out the <xhtml:code>sendmail</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chrctcp -d sendmail</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#start[[:blank::]]/usr/lib/sendmail" /etc/rc.tcpip</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#start /usr/lib/sendmail "$src_running" "-bd -q${qpi}"</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run sendmail, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;sendmail d dismaildmnhls&lt;/AIXPertArgs&gt; </xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;sendmail d dismaildmnhls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;sendmail d hls_dismaildmn&lt;/AIXPertArgs&gt; </xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;sendmail d hls_dismaildmn&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Uncommented <br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Commented out<br/>Medium Level policy No effect<br/>Low Level policy	No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'sendmail' is disabled in '/etc/rc.tcpip'">
                            <ecl:command>egrep '^[^#].*sendmail' /etc/rc.tcpip</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-rc-tcpip-snmpd" selected="false">
                <xccdf:title>/etc/rc.tcpip - snmpd </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>snmpd</xhtml:code> daemon on system startup. This allows remote monitoring of network and server configuration.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>snmpd</xhtml:code> daemon is used by many 3rd party applications to monitor the health of the system. If <xhtml:code>snmpd</xhtml:code> is not required, it is recommended that it is disabled. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/rc.tcpip</xhtml:code>, comment out the <xhtml:code>snmpd </xhtml:code>entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chrctcp -d snmpd</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#start[[:blank::]]/usr/sbin/snmpd" /etc/rc.tcpip</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#start /usr/sbin/snmpd "$src_running"</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run <xhtml:code>snmpd</xhtml:code>, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;snmpd d dissnmpdmnhls&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;snmpd d dissnmpdmnhls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;snmpd d hls_dissnmpdmn&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;snmpd d hls_dissnmpdmn&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Uncommented <br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Commented out<br/>Medium Level policy Commented out<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'snmpd' is disabled in '/etc/rc.tcpip'">
                            <ecl:command>egrep '^[^#].*snmpd' /etc/rc.tcpip</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-rc-tcpip-dhcpcd" selected="false">
                <xccdf:title>/etc/rc.tcpip - dhcpcd </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>dhcpcd</xhtml:code> daemon on system startup. The <xhtml:code>dhcpcd</xhtml:code> deamon receives address and configuration information from the DHCP server.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>dhcpcd</xhtml:code> daemon is the DHCP client that receives address and configuration information from the DHCP server. This must be disabled if DHCP is not used to serve IP address to the local system. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/rc.tcpip</xhtml:code>, comment out the <xhtml:code>dhcpcd</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chrctcp -d dhcpcd</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#start[[:blank::]]/usr/sbin/dhcpcd" /etc/rc.tcpip</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#start /usr/sbin/dhcpcd "$src_running"</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run <xhtml:code>dhcpcd</xhtml:code>, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;dhcpcd d disdhcpclienthls&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;dhcpcd d disdhcpclienthls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;dhcpcd d hls_disdhcpclient&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;dhcpcd d hls_disdhcpclient&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented out <br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Commented out<br/>Medium Level policy Commented out<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'dhcpcd' is disabled in '/etc/rc.tcpip'">
                            <ecl:command>egrep '^[^#].*/usr/sbin/dhcpcd' /etc/rc.tcpip</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-rc-tcpip-dhcprd" selected="false">
                <xccdf:title>/etc/rc.tcpip - dhcprd </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>dhcprd</xhtml:code> daemon on system startup. The <xhtml:code>dhcpcd</xhtml:code> deamon receives address and configuration information from the DHCP server.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>dhcprd</xhtml:code> daemon is the DHCP relay deamon that forwards the DHCP and BOOTP packets in the network. You must disable this service if DHCP is not enabled in the network.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/rc.tcpip</xhtml:code>, comment out the <xhtml:code>dhcprd</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>chrctcp -d dhcprd<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "/sbin/dhcprd" /etc/rc.tcpip</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#start /usr/sbin/dhcprd "$src_running"</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run <xhtml:code>dhcprd</xhtml:code>, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;dhcprd d disdhcpagenthls&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;dhcprd d disdhcpagenthls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;dhcprd d hls_disdhcpagent&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;dhcprd d hls_disdhcpagent&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented out <br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Commented out<br/>Medium Level policy Commented out<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'dhcprd' is disabled in '/etc/rc.tcpip'">
                            <ecl:command>egrep '^[^#].*dhcprd' /etc/rc.tcpip</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-rc-tcpip-dhcpsd" selected="false">
                <xccdf:title>/etc/rc.tcpip - dhcpsd </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>dhcpsd</xhtml:code> daemon on system startup. The <xhtml:code>dhcpsd</xhtml:code> deamon is the DHCP server that serves addresses and configuration information to DHCP clients in the network.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>dhcpsd</xhtml:code> daemon is the DHCP server that serves addresses and configuration information to DHCP clients in the network. You must disable this service if the server is not a DHCP server. <br/> <br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/rc.tcpip</xhtml:code>, comment out the <xhtml:code>dhcpsd</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chrctcp -d dhcpsd</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#start[[:blank::]]/usr/sbin/dhcpsd" /etc/rc.tcpip</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#start /usr/sbin/dhcpsd "$src_running"</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run <xhtml:code>dhcpsd</xhtml:code>, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;dhcpsd d disdhcpservhls&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;dhcpsd d disdhcpservhls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;dhcpsd d hls_disdhcpserv&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;dhcpsd d hls_disdhcpserv&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented out <br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Commented out<br/>Medium Level policy Commented out<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'dhcpsd' is disabled in '/etc/rc.tcpip'">
                            <ecl:command>egrep '^[^#].*dhcpsd' /etc/rc.tcpip</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-rc-tcpip-autoconf6" selected="false">
                <xccdf:title>/etc/rc.tcpip - autoconf6 </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts <xhtml:code>autoconf6</xhtml:code> on system startup. This is to automatically configure IPv6 interfaces at boot time.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p><xhtml:code>authoconf6</xhtml:code> is used to automatically configure IPv6 interfaces at boot time.  Running this service may allow other hosts on the same physical subnet to connect via IPv6, even when the network does not support it. You must disable this unless you utilize IPv6 on the server. <br/> <br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/rc.tcpip</xhtml:code>, comment out the <xhtml:code>autoconf6</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chrctcp -d autoconf6</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#start[[:blank::]]/usr/sbin/autoconf6" /etc/rc.tcpip</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#start /usr/sbin/autoconf6 ""</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run <xhtml:code>autoconf6</xhtml:code>, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;autoconf6 d disautoconf6hls&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;autoconf6 d disautoconf6hls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;autoconf6 d hls_disautoconf6&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;autoconf6 d hls_disautoconf6&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented out <br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Commented out<br/>Medium Level policy No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'autoconf6' is disabled in '/etc/rc.tcpip'">
                            <ecl:command>egrep '^[^#].*autoconf6' /etc/rc.tcpip</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-rc-tcpip-gated" selected="false">
                <xccdf:title>/etc/rc.tcpip - gated </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>gated</xhtml:code> daemon system startup. This daemon provides gateway routing functions for protocols such as RIP and SNMP.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>gated</xhtml:code> daemon provides gateway routing functions for protocols such as RIP and SNMP. It is recommended that this daemon is disabled, unless the server is functioning as a network router.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/rc.tcpip</xhtml:code>, comment out the <xhtml:code>gated</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chrctcp -d gated</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#start[[:blank::]]/usr/sbin/gated" /etc/rc.tcpip</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#start /usr/sbin/gated "$src_running"</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run <xhtml:code>gated</xhtml:code>, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;gated d disgateddmnhls&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;gated d disgateddmnhls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;gated d hls_disgateddmn&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;gated d hls_disgateddmn&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented out <br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Commented out<br/>Medium Level policy Commented out<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'gated' is disabled in '/etc/rc.tcpip'">
                            <ecl:command>egrep '^[^#].*gated' /etc/rc.tcpip</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-rc-tcpip-mrouted" selected="false">
                <xccdf:title>/etc/rc.tcpip - mrouted </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>mrouted</xhtml:code> daemon at system startup. This daemon is an implementation of the multicast routing protocol.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>mrouted</xhtml:code> daemon is an implementation of the multicast routing protocol. It is recommended that this daemon is disabled, unless the server is functioning as a multicast router.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/rc.tcpip</xhtml:code>, comment out the <xhtml:code>mrouted</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chrctcp -d mrouted</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#start[[:blank::]]/usr/sbin/mrouted" /etc/rc.tcpip</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#start /usr/sbin/mrouted "$src_running"</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run <xhtml:code>mrouted</xhtml:code>, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;mrouted d dismrouteddmnhls&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;mrouted d dismrouteddmnhls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;mrouted d hls_dismrouteddmn&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;mrouted d hls_dismrouteddmn&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented out <br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Commented out<br/>Medium Level policy No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'mrouted' is disabled in '/etc/rc.tcpip'">
                            <ecl:command>egrep '^[^#].*mrouted' /etc/rc.tcpip</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-rc-tcpip-named" selected="false">
                <xccdf:title>/etc/rc.tcpip - named </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>named</xhtml:code> daemon at system startup. This is the server for the DNS protocol and controls domain name resolution for its clients.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>named</xhtml:code> daemon is the server for the DNS protocol and controls domain name resolution for its clients. It is recommended that this daemon is disabled, unless the server is functioning as a DNS server.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/rc.tcpip</xhtml:code>, comment out the <xhtml:code>named</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chrctcp -d named</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#start[[:blank::]]/usr/sbin/named" /etc/rc.tcpip</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#start /usr/sbin/named "$src_running"</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run named, edit the customized XML file prior to implementing:<br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;named d disdnsdmnhls&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;named d disdnsdmnhls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;named d hls_disdnsdmn&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;named d hls_disdnsdmn&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented out <br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Commented out<br/>Medium Level policy No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'named' is disabled in '/etc/rc.tcpip'">
                            <ecl:command>egrep '^[^#].*named' /etc/rc.tcpip</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-rc-tcpip-routed" selected="false">
                <xccdf:title>/etc/rc.tcpip - routed </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>routed</xhtml:code> daemon at system startup. The <xhtml:code>routed</xhtml:code> daemon manages the network routing tables in the kernel.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>routed</xhtml:code> daemon manages the network routing tables in the kernel. It is recommended that this daemon is disabled, unless the server is functioning as a network router.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/rc.tcpip</xhtml:code>, comment out the <xhtml:code>routed</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chrctcp -d routed</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#start[[:blank::]]/usr/sbin/routed" /etc/rc.tcpip</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#start /usr/sbin/routed "$src_running" -q</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run routed, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;routed d disrtngdmnhls&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;routed d disrtngdmnhls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;mrouted d hls_dismrouteddmn&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;mrouted d hls_dismrouteddmn&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented out <br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Commented out<br/>Medium Level policy No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'routed' is disabled in '/etc/rc.tcpip'">
                            <ecl:command>egrep '^[^#].*routed' /etc/rc.tcpip</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-rc-tcpip-rwhod" selected="false">
                <xccdf:title>/etc/rc.tcpip - rwhod </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>rwhod</xhtml:code> daemon at system startup. This is the remote WHO service.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>rwhod</xhtml:code> daemon is the remote WHO service, which collects and broadcasts status information to peer servers on the same network. It is recommended that this daemon is disabled, unless it is required.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/rc.tcpip</xhtml:code>, comment out the <xhtml:code>rwhod</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chrctcp -d rwhod</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#start[[:blank::]]/usr/sbin/rwhod" /etc/rc.tcpip</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#start /usr/sbin/rwhod "$src_running"</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run <xhtml:code>rwhod</xhtml:code>, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;rwhod d disrwhoddmnhls&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;rwhod d disrwhoddmnhls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>Enable the daemon:<br/><br/><xhtml:code>chrctcp -a rwhod</xhtml:code><br/><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;rwhod d hls_disrwhoddmn&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;rwhod d hls_disrwhoddmn&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>Enable the daemon:<br/><br/><xhtml:code>chrctcp -a rwhod</xhtml:code><br/><br/><b>Default Value:</b> Commented out <br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Commented out<br/>Medium Level policy No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'rwhod' is disabled in '/etc/rc.tcpip'">
                            <ecl:command>egrep '^[^#].*rwhod' /etc/rc.tcpip</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-rc-tcpip-timed" selected="false">
                <xccdf:title>/etc/rc.tcpip - timed </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>timed</xhtml:code> daemon at system startup. This is old UNIX time service.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>timed</xhtml:code> daemon is the old UNIX time service. You must disable this service and use <xhtml:code>xntp</xhtml:code>, if time synchronization is required in your environment.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/rc.tcpip</xhtml:code>, comment out the <xhtml:code>timed</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chrctcp -d timed</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#start[[:blank::]]/usr/sbin/timed" /etc/rc.tcpip</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#start /usr/sbin/timed "$src_running"</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run timed, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;timed d distimedmnhls&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;timed d distimedmnhls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>Enable the daemon:<br/><br/><xhtml:code>chrctcp -a timed</xhtml:code><br/><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;timed d hls_distimedmn&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;timed d hls_distimedmn&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>Enable the daemon:<br/><br/><xhtml:code>chrctcp -a timed</xhtml:code><br/><br/><b>Default Value:</b> Commented out <br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Commented out<br/>Medium Level policy Commented out<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'timed' is disabled in '/etc/rc.tcpip'">
                            <ecl:command>egrep '^[^#].*timed' /etc/rc.tcpip</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-rc-tcpip-dpid2" selected="false">
                <xccdf:title>/etc/rc.tcpip - dpid2 </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>dpid2</xhtml:code> daemon on system startup. The <xhtml:code>dpid2</xhtml:code> deamon acts as a protocol converter, which enables DPI (SNMP v2) sub-agents, such as <xhtml:code>hostmibd</xhtml:code>, to talk to a SNMP v1 agent that follows SNMP MUX protocol<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>dpid2</xhtml:code> deamon acts as a protocol converter, which enables DPI (SNMP v2) sub-agents, such as <xhtml:code>hostmibd</xhtml:code>, to talk to a SNMP v1 agent that follows SNMP MUX protocol. Unless the server hosts an SNMP agent, it is recommended that <xhtml:code>dpid2</xhtml:code> is disabled. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/rc.tcpip</xhtml:code>, comment out the <xhtml:code>dpid2</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chrctcp -d dpid2</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#start[[:blank::]]/usr/sbin/dpid2" /etc/rc.tcpip</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#start /usr/sbin/dpid2 "$src_running"</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run <xhtml:code>dpid2</xhtml:code>, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;dipid2 d disdpid2dmnhls&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;dipid2 d disdpid2dmnhls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>Enable the daemon:<br/><br/><xhtml:code>chrctcp -a dpid2</xhtml:code><br/><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;dpid2 d hls_disdpid2dmn&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;dpid2 d hls_disdpid2dmn&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>Enable the daemon:<br/><xhtml:code>chrctcp -a dpid2</xhtml:code><br/><br/><b>Default Value:</b> Commented out <br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Commented out<br/>Medium Level policy No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'dpid2' is disabled in '/etc/rc.tcpip'">
                            <ecl:command>egrep '^[^#].*dpid2' /etc/rc.tcpip</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-rc-tcpip-hostmibd" selected="false">
                <xccdf:title>/etc/rc.tcpip - hostmibd </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>hostmibd</xhtml:code> daemon on system startup. This is a dpi2 sub-agent that may be required if the server runs SNMP. <br/>The <xhtml:code>hostmibd</xhtml:code> daemon is not managed within the default AIX Security Expert framework. This change is managed as a customized entry in the XML files.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>hostmibd</xhtml:code> daemon is a dpi2 sub-agent which manages a number of MIB variables. If <xhtml:code>snmpd</xhtml:code> is not required, it is recommended that it is disabled. <br/><br/>The specific MIB variables which are managed by <xhtml:code>hostmibd</xhtml:code> are defined by RFC 2790. Further details relating to these MIBS can be found in the URL below:<br/><br/>http://publib.boulder.ibm.com/infocenter/systems/index.jsp?topic=/com.ibm.aix.cmds/doc/aixcmds2/hostmibd.htm<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/rc.tcpip</xhtml:code>, comment out the <xhtml:code>hostmibd</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chrctcp -d hostmibd</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#start[[:blank::]]/usr/sbin/hostmibd" /etc/rc.tcpip</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#start /usr/sbin/hostmibd "$src_running"</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run <xhtml:code>hostmibd</xhtml:code>, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;"chrctcp -d hostmibd"&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;"chrctcp -d hostmibd"&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>Enable the daemon:<br/><xhtml:code>chrctcp -a hostmibd</xhtml:code><br/><br/><b>Default Value:</b> Uncommented <br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'hostmibd' is disabled in '/etc/rc.tcpip'">
                            <ecl:command>egrep '^[^#].*hostmibd' /etc/rc.tcpip</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-rc-tcpip-snmpmibd" selected="false">
                <xccdf:title>/etc/rc.tcpip - snmpmibd </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>snmpmibd</xhtml:code> daemon on system startup. This is a dpi2 sub-agent that may be required if the server runs SNMP. <br/>The snmpmibd daemon is not managed within the default AIX Security Expert framework. This change is managed as a customized entry in the XML files.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>snmpmibd</xhtml:code> daemon is a dpi2 sub-agent which manages a number of MIB variables. If <xhtml:code>snmpd</xhtml:code> is not required, it is recommended that it is disabled. <br/><br/>The specific MIB variables which are managed by <xhtml:code>snmpmibd</xhtml:code> are defined by numerous RFCs. Further details relating to these MIBS can be found in the URL below:<br/><br/>http://publib.boulder.ibm.com/infocenter/systems/index.jsp?topic=/com.ibm.aix.cmds/doc/aixcmds5/snmpmibd.htm<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/rc.tcpip</xhtml:code>, comment out the <xhtml:code>snmpmibd</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chrctcp -d snmpmibd</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#start[[:blank::]]/usr/sbin/snmpmibd" /etc/rc.tcpip</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#start /usr/sbin/snmpmibd "$src_running"</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run <xhtml:code>snmpmibd</xhtml:code>, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;"chrctcp -d snmpmibd"&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;"chrctcp -d snmpmibd"&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>Enable the daemon:<br/><xhtml:code>chrctcp -a snmpmibd</xhtml:code><br/><br/><b>Default Value:</b> Uncommented <br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'snmpmibd' is disabled in '/etc/rc.tcpip'">
                            <ecl:command>egrep '^[^#].*snmpmibd' /etc/rc.tcpip</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-rc-tcpip-aixmibd" selected="false">
                <xccdf:title>/etc/rc.tcpip - aixmibd </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>aixmibd</xhtml:code> daemon on system startup. This is a dpi2 sub-agent that may be required if the server runs SNMP. <br/>The <xhtml:code>aixmibd</xhtml:code> daemon is not a managed within the default AIX Security Expert framework. This change is managed as a customized entry in the XML files.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>aixmibd</xhtml:code> daemon is a dpi2 sub-agent which manages a number of MIB variables. If <xhtml:code>snmpd</xhtml:code> is not required, it is recommended that it is disabled. <br/><br/>The <xhtml:code>aixmibd</xhtml:code> collects data from an AIX specific MIB. Further details relating to this MIB can be found in the URL below:<br/><br/>http://publib.boulder.ibm.com/infocenter/systems/index.jsp?topic=/com.ibm.aix.cmds/doc/aixcmds1/aixmibd.htm<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/rc.tcpip</xhtml:code>, comment out the <xhtml:code>aixmibd</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chrctcp -d aixmibd</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#start[[:blank::]]/usr/sbin/aixmibd" /etc/rc.tcpip</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#start /usr/sbin/aixmibd "$src_running"</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run <xhtml:code>aixmibd</xhtml:code>, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;"chrctcp -d aixmibd"&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;"chrctcp -d aixmibd"&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>Enable the daemon:<br/><xhtml:code>chrctcp -a aixmibd</xhtml:code><br/><br/><b>Default Value:</b> Uncommented <br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'aixmibd' is disabled in '/etc/rc.tcpip'">
                            <ecl:command>egrep '^[^#].*aixmibd' /etc/rc.tcpip</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-rc-tcpip-ndpd-host" selected="false">
                <xccdf:title>/etc/rc.tcpip - ndpd-host </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts <xhtml:code>ndpd-host</xhtml:code> on system startup. This is the Neighbor Discovery Protocol (NDP) daemon, required in IPv6.<br/>The ndpd-host entry is not managed within the default AIX Security Expert framework. This change is managed as a customized entry in the XML files.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>ndpd-host</xhtml:code> is the NDP deamon for the server. Unless the server utilizes IPv6, this is not required and should be disabled.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/rc.tcpip</xhtml:code>, comment out the <xhtml:code>ndpd-host</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chrctcp -d ndpd-host</xhtml:code><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#start[[:blank::]]/usr/sbin/ndpd-host" /etc/rc.tcpip</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#start /usr/sbin/ndpd-host "$src_running"</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run <xhtml:code>ndpd-host</xhtml:code>, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>Replace:<br/><br/><xhtml:code>&lt;AIXPertArgs&gt;"chrctcp -d ndpd-host"&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;"chrctcp -d ndpd-host"&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>Enable the daemon:<br/><br/><xhtml:code>chrctcp -a ndpd-host</xhtml:code><br/><br/><b>Default Value:</b> Commented out <br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'ndpd-host' is disabled in '/etc/rc.tcpip'">
                            <ecl:command>egrep '^[^#].*ndpd-host' /etc/rc.tcpip</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-rc-tcpip-ndpd-router" selected="false">
                <xccdf:title>/etc/rc.tcpip - ndpd-router </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts <xhtml:code>ndpd-router</xhtml:code> on system startup. This manages the Neighbor Discovery Protocol (NDP) for non kernel activities, required in IPv6.<br/>The <xhtml:code>ndpd-router</xhtml:code> entry is not managed within the default AIX Security Expert framework. This change is managed as a customized entry in the XML files.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>ndpd-router</xhtml:code> manages NDP for non-kernel activities. Unless the server utilizes IPv6, this is not required and should be disabled.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/rc.tcpip</xhtml:code>, comment out the <xhtml:code>ndpd-router</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chrctcp -d ndpd-router</xhtml:code><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#start[[:blank::]]/usr/sbin/ndpd-router" /etc/rc.tcpip</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#start /usr/sbin/ndpd-router "$src_running"</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run ndpd-router, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>Replace:<br/><br/><xhtml:code>&lt;AIXPertArgs&gt;"chrctcp -d ndpd-router"&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;"chrctcp -d ndpd-router"&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>Enable the daemon:<br/><br/><xhtml:code>chrctcp -a ndpd-router</xhtml:code><br/><br/><b>Default Value:</b> Commented out <br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/>Low Level policy 	N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'ndpd-router' is disabled in '/etc/rc.tcpip'">
                            <ecl:command>egrep '^[^#].*ndpd-router' /etc/rc.tcpip</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-telnet" selected="false">
                <xccdf:title>/etc/inetd.conf - telnet </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>telnetd</xhtml:code> daemon when required. This provides a protocol for command line access, from a remote machine.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>This <xhtml:code>telnet</xhtml:code> service is used to service remote user connections. This is historically the most commonly used remote access method for UNIX servers. The username and passwords are passed over the network in clear text and therefore insecurely. Unless required the <xhtml:code>telnetd</xhtml:code> daemon will be disabled. <br/><br/>Many older legacy systems do not support SSH and still require <xhtml:code>telnet</xhtml:code> as a protocol for access. If this is not required, it is recommended that <xhtml:code>telnet</xhtml:code> is disabled and SSH is used as a replacement authentication mechanism.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>telnet</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'telnet' -p 'tcp6'</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#telnet[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#telnet stream  tcp6    nowait  root    /usr/sbin/telnetd       telnetd -a</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run <xhtml:code>telnet</xhtml:code>, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;telnet tcp d telnethls&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;telnet tcp d telnethls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;telnet tcp d hls_telnet&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;telnet tcp d hls_telnet&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented in<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Commented out<br/>Medium Level policy No effect<br/>Low Level policy 	No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'telnet' is disabled in '/etc/inetd.conf'">
                            <ecl:command>egrep '^[^#].*telnet' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-exec" selected="false">
                <xccdf:title>/etc/inetd.conf - exec </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>rexecd</xhtml:code> daemon when required. This daemon executes a command from a remote system, once the connection has been authenticated.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>exec</xhtml:code> service is used to execute a command sent from a remote server. The username and passwords are passed over the network in clear text and therefore insecurely. Unless required the <xhtml:code>rexecd</xhtml:code> daemon will be disabled. This function, if required, should be facilitated through SSH.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>exec</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'exec' -p 'tcp6'</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#exec[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#exec    stream  tcp6    nowait  root    /usr/sbin/rexecd        rexecd</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run <xhtml:code>exec</xhtml:code>, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;exec tcp d rexecdhls&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;exec tcp d rexecdhls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;exec tcp d hls_rexecd&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;exec tcp d hls_rexecd&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><b>Default Value:</b> Commented in<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Commented out<br/>Medium Level policy Commented out<br/>Low Level policy 	No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'exec' is disabled in '/etc/inetd.conf'">
                            <ecl:command>egrep '^[^#].*rexecd' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-daytime" selected="false">
                <xccdf:title>/etc/inetd.conf - daytime </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>daytime</xhtml:code> service when required. This provides the current date and time to other servers on a network.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>This <xhtml:code>daytime</xhtml:code> service is a defunct time service, typically used for testing purposes only. The service should be disabled as it can leave the system vulnerable to DoS <xhtml:code>ping</xhtml:code> attacks. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>daytime</xhtml:code> entries.<br/><br/>Please note the commands below are for information only, as the settings will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'daytime' -p 'udp'<br/>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'daytime' -p 'tcp'</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#daytime[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#daytime        stream  tcp     nowait  root    internal         <br/>#daytime        dgram   udp     wait    root    internal</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run daytime, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;daytime tcp d tcpdaytimehls&lt;/AIXPertArgs&gt;<br/>&lt;AIXPertArgs&gt;daytime udp d udpdaytimehls&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;daytime tcp d tcpdaytimehls&lt;/AIXPertArgs&gt; --&gt;<br/>&lt;!-- &lt;AIXPertArgs&gt;daytime udp d udpdaytimehls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;daytime tcp d hls_tcpdaytime&lt;/&lt;/AIXPertArgs&gt;<br/>&lt;AIXPertArgs&gt;daytime udp d hls_udpdaytime&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;daytime tcp d hls_tcpdaytime&lt;/&lt;/AIXPertArgs&gt; --&gt;<br/>&lt;!-- &lt;AIXPertArgs&gt;daytime udp d hls_udpdaytime&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented in<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Commented out<br/>Medium Level policy No effect<br/>Low Level policy 	No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'daytime' is disabled in '/etc/inetd.conf'">
                            <ecl:command>egrep '^[^#].*daytime' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-shell" selected="false">
                <xccdf:title>/etc/inetd.conf - shell </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>rshd</xhtml:code> daemon when required. This daemon executes a command from a remote system.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>This <xhtml:code>shell</xhtml:code> service is used to execute a command from a remote server. The username and passwords are passed over the network in clear text and therefore insecurely. Unless required the rshd daemon will be disabled. This function, if required, should be facilitated through SSH.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>shell</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'shell' -p 'tcp6'</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#shell[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#shell  stream  tcp6    nowait  root    /usr/sbin/rshd  rshd</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run shell, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;shell tcp d shellhls&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;shell tcp d shellhls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;shell tcp d hls_shell&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;shell tcp d hls_shell&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><br/><b>Default Value:</b> Commented in<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Commented out<br/>Medium Level policy Commented out<br/>Low Level policy 	Commented out<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'shell' is disabled in '/etc/inetd.conf'">
                            <ecl:command>egrep '^[^#].*shell' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-cmsd" selected="false">
                <xccdf:title>/etc/inetd.conf - cmsd </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>cmsd</xhtml:code> service when required. This is a calendar and appointment service.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>cmsd</xhtml:code> service is utilized by CDE to provide calendar functionality. If CDE is not required, this service should be disabled. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>cmsd</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'cmsd' -p 'sunrpc_udp'</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#cmsd[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#cmsd   sunrpc_udp      udp     wait    root    /usr/dt/bin/rpc.cmsd cmsd 100068 2-5</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run <xhtml:code>cmsd</xhtml:code>, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;cmsd udp d cmsdhls&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;cmsd udp d cmsdhls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;cmsd udp d hls_cmsd&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;cmsd udp d hls_cmsd&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented in<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Commented out<br/>Medium Level policy No effect<br/>Low Level policy 	No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'cmsd' is disabled in '/etc/inetd.conf'">
                            <ecl:command>egrep '^[^#].*cmsd' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-ttdbserver" selected="false">
                <xccdf:title>/etc/inetd.conf - ttdbserver </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>ttdbserver</xhtml:code> service when required. It is not a pre-requisite service for CDE, which is fully functional when it is disabled.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>ttdbserver</xhtml:code> service is the tool-talk database service for CDE. This service runs as root and should be disabled. Unless required the <xhtml:code>ttdbserver</xhtml:code> service will be disabled. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>ttdbserver</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'ttdbserver' -p 'sunrpc_tcp'</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#ttdbserver[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#ttdbserver     sunrpc_tcp      tcp     wait    root    /usr/dt/bin/rpc.ttdbserver rpc.ttdbserver 100083 1</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run ttdbserver, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;ttdbserver tcp d ttdbserverhls&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;ttdbserver tcp d ttdbserverhls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;ttdbserver tcp d hls_ttdbserver&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;ttdbserver tcp d hls_ttdbserver&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented in<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Commented out<br/>Medium Level policy No effect<br/>Low Level policy 	No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'ttdbserver' is disabled in '/etc/inetd.conf'">
                            <ecl:command>egrep '^[^#].*ttdbserver' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-uucp" selected="false">
                <xccdf:title>/etc/inetd.conf - uucp </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>uucp</xhtml:code> service when required. This service facilitates file copying between networked servers.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>uucp</xhtml:code> (UNIX to UNIX Copy Program), service allows users to copy files between networked machines. Unless an application or process requires UUCP this should be disabled.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>uucp</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'uucp' -p 'tcp' </xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#uucp[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#uucp    stream  tcp     nowait  root    /usr/sbin/uucpd uucpd</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run uucp, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;uucp tcp d uucphls&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;uucp tcp d uucphls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;uucp tcp d hls_uucp&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;uucp tcp d hls_uucp&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented in<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Commented out<br/>Medium Level policy No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'uucp' is disabled in '/etc/inetd.conf'">
                            <ecl:command>egrep '^[^#].*uucp' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-time" selected="false">
                <xccdf:title>/etc/inetd.conf - time </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>time</xhtml:code> service when required. This service can be used to synchronize system clocks.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>time</xhtml:code> service is an obsolete process used to synchronize system clocks at boot time. This has been superseded by NTP, which should be use if time synchronization is necessary. Unless required the <xhtml:code>time</xhtml:code> service will be disabled. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>time</xhtml:code> entries.<br/><br/>Please note the commands below are for information only, as these settings will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'time' -p 'udp'<br/>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'time' -p 'tcp' </xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#time[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#time   stream  tcp     nowait  root    internal         <br/>#time   dgram   udp     wait    root    internal</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run time, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;time tcp d tcptimehls&lt;/AIXPertArgs&gt;<br/>&lt;AIXPertArgs&gt;time udp d udptimehls&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;time tcp d tcptimehls&lt;/AIXPertArgs&gt; --&gt;<br/>&lt;!-- &lt;AIXPertArgs&gt;time udp d udptimehls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;time tcp d hls_tcptime&lt;/AIXPertArgs&gt;<br/>&lt;AIXPertArgs&gt;time udp d hls_udptime&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;time tcp d hls_tcptime&lt;/AIXPertArgs&gt; --&gt;<br/>&lt;!-- &lt;AIXPertArgs&gt;time udp d hls_udptime&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented in<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Commented out<br/>Medium Level policy No effect<br/>Low Level policy 	No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'time' is disabled in '/etc/inetd.conf'">
                            <ecl:command>egrep '^[^#].*time' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-login" selected="false">
                <xccdf:title>/etc/inetd.conf - login </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>rlogin</xhtml:code> daemon when required. This service authenticates remote user logins.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>This <xhtml:code>login</xhtml:code> service is used to authenticate a remote user connection when logging in via the rlogin command. The username and password are passed over the network in clear text and therefore insecurely. Unless required the <xhtml:code>rlogin</xhtml:code> daemon will be disabled. This function, if required, should be facilitated through SSH.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>login</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'login' -p 'tcp'</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#login[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#login  stream  tcp6    nowait  root    /usr/sbin/rlogind       rlogind</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run login, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;login tcp d rloginhls&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;login tcp d rloginhls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;login tcp d hls_rlogin&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;login tcp d hls_rlogin&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented in<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Commented out<br/>Medium Level policy Commented out<br/>Low Level policy 	No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'login' is disabled in '/etc/inetd.conf'">
                            <ecl:command>egrep '^[^#].*login' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-talk" selected="false">
                <xccdf:title>/etc/inetd.conf - talk </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>talkd</xhtml:code> daemon when required. This service establishes a two-way communication link between two users, either locally or remotely.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>This <xhtml:code>talk</xhtml:code> service is used to establish an interactive two-way communication link between two UNIX users. It is unlikely that there would be a requirement to run this type of service on a UNIX system. Unless required the <xhtml:code>talk</xhtml:code> service will be disabled<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>talk</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'talk' -p 'udp'</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#talk[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#talk   dgram   udp     wait    root    /usr/sbin/talkd talkd</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run talk, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;talk udp d talkhls&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;talk udp d talkhls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;talk udp d hls_talk&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;talk udp d hls_talk&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><br/><b>Default Value:</b> Commented in<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Commented out<br/>Medium Level policy Commented out<br/>Low Level policy 	Commented out<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'talk' is disabled in '/etc/inetd.conf'">
                            <ecl:command>grep '^talk[[::blank::]]' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-ntalk" selected="false">
                <xccdf:title>/etc/inetd.conf - ntalk </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>talkd</xhtml:code> daemon when required. This service establishes a two-way communication link between two users, either locally or remotely. <br/>The <xhtml:code>ntalk</xhtml:code> service is not a managed parameter within the default AIX Security Expert framework. This parameter is managed as a customized entry in the XML files.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>This <xhtml:code>talk</xhtml:code> service is used to establish an interactive two-way communication link between two UNIX users. It is unlikely that there would be a requirement to run this type of service on a UNIX system. Unless required the <xhtml:code>ntalk</xhtml:code> service will be disabled<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>ntalk</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'ntalk' -p 'udp'</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#ntalk[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#ntalk  dgram   udp     wait    root    /usr/sbin/talkd talkd</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run ntalk, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'ntalk' -p 'udp'" &lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'ntalk' -p 'udp'" --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented in<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/>Low Level policy 	N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'ntalk' is disabled in '/etc/inetd.conf'">
                            <ecl:command>grep '^ntalk[[::blank::]]' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-ftp" selected="false">
                <xccdf:title>/etc/inetd.conf - ftp </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>ftpd</xhtml:code> daemon when required. This service is used for transferring files from/to a remote machine.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>This <xhtml:code>ftp</xhtml:code> service is used to transfer files from or to a remote machine. The username and passwords are passed over the network in clear text and therefore insecurely. Unless required the <xhtml:code>ftpd</xhtml:code> daemon will be disabled. <br/><br/>Many older legacy systems do not support SSH and still required <xhtml:code>ftp</xhtml:code> as a service for data copying. If this is not required it is recommended that <xhtml:code>ftp</xhtml:code> is disabled and <xhtml:code>sftp</xhtml:code> is used as a replacement file and directory copying mechanism.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>ftp </xhtml:code>entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'ftp' -p 'tcp6'</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#ftp[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#ftp    stream  tcp6    nowait  root    /usr/sbin/ftpd  ftpd</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run ftp, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;ftp tcp d ftphls&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;ftp tcp d ftphls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;ftp tcp d hls_ftp&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;ftp tcp d hls_ftp&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented in<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Commented out<br/>Medium Level policy No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'ftp' is disabled in '/etc/inetd.conf'">
                            <ecl:command>egrep '^[^#].*ftp' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-chargen" selected="false">
                <xccdf:title>/etc/inetd.conf - chargen </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>chargen</xhtml:code> service when required. This service is used to test the integrity of TCP/IP packets arriving at the destination.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>This <xhtml:code>chargen</xhtml:code> service is a character generator service and is used for testing the integrity of TCP/IP packets arriving at the destination. An attacker may spoof packets between machines running the <xhtml:code>chargen</xhtml:code> service and thus provide an opportunity for DoS attacks. You must disable this service unless you are testing your network.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>chargen</xhtml:code> entries.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'chargen' -p 'tcp'<br/>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'chargen' -p 'udp'</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#chargen[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#chargen        stream  tcp     nowait  root    internal         <br/>#chargen        dgram   udp     wait    root    internal</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run chargen, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'chargen' -p 'udp'" &lt;/AIXPertArgs&gt;<br/>&lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'chargen' -p 'tcp'" &lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'chargen' -p 'udp'" &lt;/AIXPertArgs&gt; --&gt;<br/>&lt;!-- &lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'chargen' -p 'tcp'" &lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented out <br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'chargen' is disabled in '/etc/inetd.conf'">
                            <ecl:command>egrep '^[^#].*chargen' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-discard" selected="false">
                <xccdf:title>/etc/inetd.conf - discard </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>discard</xhtml:code> service when required. This service is used as a debugging tool by setting up a listening socket which ignores the data it receives.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>discard</xhtml:code> service is used as a debugging and measurement tool. It sets up a listening socket and ignores data that it receives. This is a <xhtml:code>/dev/null</xhtml:code> service and is obsolete. This can be used in DoS attacks and therefore, must be disabled.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>discard</xhtml:code> entries.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'discard' -p 'tcp'<br/>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'discard' -p 'udp'</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#discard[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#discard        stream  tcp     nowait  root    internal         <br/>#discard        dgram   udp     wait    root    internal</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run <xhtml:code>discard</xhtml:code>, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'discard' -p 'udp'" &lt;/AIXPertArgs&gt;<br/>&lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'discard' -p 'tcp'" &lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'discard' -p 'udp'" &lt;/AIXPertArgs&gt; --&gt;<br/>&lt;!-- &lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'discard' -p 'tcp'" &lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented out<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'discard' is disabled in '/etc/inetd.conf'">
                            <ecl:command>egrep '^[^#].*discard' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-dtspc" selected="false">
                <xccdf:title>/etc/inetd.conf - dtspc </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>dtspc</xhtml:code> service when required. This service is used in response to a CDE client request. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>dtspc</xhtml:code> service deals with the CDE interface of the X11 daemon. It is started automatically by the <xhtml:code>inetd</xhtml:code> daemon in response to a CDE client requesting a process to be started on the daemon's host. This makes it vulnerable to buffer overflow attacks, which may allow an attacker to gain root privileges on a host. This service must be disabled unless it is absolutely required. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>dtspc</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'dtspc' -p 'tcp'</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#dtspc[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#dtspcd stream  tcp     nowait  root    /usr/dt/bin/dtspcd /usr/dt/bin/dtspcd</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run <xhtml:code>dtspc</xhtml:code>, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'dtspc' -p 'tcp'"<br/>&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'dtspc' -p 'tcp'" &lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented out<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'dtspc' is disabled in '/etc/inetd.conf'">
                            <ecl:command>egrep '^[^#].*dtspc' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-echo" selected="false">
                <xccdf:title>/etc/inetd.conf - echo </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>echo</xhtml:code> service when required. This service sends back data received by it on a specified port.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>echo</xhtml:code> service sends back data received by it on a specified port. This can be misused by an attacker to launch DoS attacks or Smurf attacks by initiating a data storm and causing network congestion. The service is used for testing purposes and therefore must be disabled if not required. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>echo</xhtml:code> entries.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'echo' -p 'tcp'<br/>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'echo' -p 'udp'</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#echo[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#echo   stream  tcp     nowait  root    internal         <br/>#echo   dgram   udp     wait    root    internal</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run discard, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'echo' -p 'udp'"<br/>&lt;/AIXPertArgs&gt;<br/>&lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'echo' -p 'tcp'"<br/>&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'echo' -p 'udp'" &lt;/AIXPertArgs&gt; --&gt;<br/>&lt;!-- &lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'echo' -p 'tcp'" &lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented out<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'echo' is disabled in '/etc/inetd.conf'">
                            <ecl:command>egrep '^[^#].*echo' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-pcnfs" selected="false">
                <xccdf:title>/etc/inetd.conf - pcnfs </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the pcnfsd daemon when required. This service is an authentication and printing program, which uses NFS to provide file transfer services.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>pcnfsd</xhtml:code> service is an authentication and printing program, which uses NFS to provide file transfer services. This service is vulnerable and exploitable and permits the machine to be compromised both locally and remotely. If PC NFS clients are required within the environment, Samba is recommended as an alternative software solution. The <xhtml:code>pcnfsd</xhtml:code> daemon predates Microsoft's release of SMB specifications. This service should therefore be disabled. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>pcnfsd</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'pcnfsd' -p 'udp'</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#pcnfsd[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#pcnfsd sunrpc_udp      udp     wait    root    /usr/sbin/rpc.pcnfsd    pcnfsd 150001 1-2</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run pcnfsd, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'pcnfsd' -p 'udp'"<br/>&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'pcnfsd' -p 'udp'" &lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented out<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'pcnfs' is disabled in '/etc/inetd.conf'">
                            <ecl:command>egrep '^[^#].*pcnfs' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-rstatd" selected="false">
                <xccdf:title>/etc/inetd.conf - rstatd </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>rstatd</xhtml:code> daemon when required. This service is used to provide kernel statistics and other monitorable parameters such as CPU usage, system uptime, network usage etc<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>rstatd</xhtml:code> service is used to provide kernel statistics and other monitorable parameters pertinent to the system such as: CPU usage, system uptime, network usage etc. An attacker may use this information in a DoS attack. This service should be disabled. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>rstatd</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'rstatd' -p 'udp'<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#rstatd[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#rstatd sunrpc_udp      udp     wait    root    /usr/sbin/rpc.rstatd    rstatd 100001 1-3</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run <xhtml:code>rstatd</xhtml:code>, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'rstatd' -p 'udp'"<br/>&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'rstatd' -p 'udp'" &lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented out<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'rstatd' is disabled in '/etc/inetd.conf'">
                            <ecl:command>egrep '^[^#].*rstatd' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-rusersd" selected="false">
                <xccdf:title>/etc/inetd.conf - rusersd </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>rsusersd</xhtml:code> daemon when required. This service provides a list of current users active on a system.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>rusersd</xhtml:code> service runs as root and provides a list of current users active on a system. An attacker may use this information in a DoS attack. This is not an essential service and should be disabled.  <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>rusersd</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'rusersd' -p 'udp'</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#rusersd[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#rusersd        sunrpc_udp      udp     wait    root    /usr/lib/netsvc/rusers/rpc.rusersd      rusersd 100002 1-2</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run <xhtml:code>rusersd</xhtml:code>, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'rusersd' -p 'udp'" &lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'rusersd' -p 'udp'" &lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented out<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'rusersd' is disabled in '/etc/inetd.conf'">
                            <ecl:command>egrep '^[^#].*rusersd' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-rwalld" selected="false">
                <xccdf:title>/etc/inetd.conf - rwalld </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>rwalld</xhtml:code> daemon when required. This service allows remote users to broadcast system wide messages.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>rwalld</xhtml:code> service allows remote users to broadcast system wide messages. The service runs as root and must be disabled unless absolutely necessary. Attackers may use this service to launch DoS attacks. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>rwalld</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'rwalld' -p 'udp'</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#rwalld[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#rwalld sunrpc_udp      udp     wait    root    /usr/lib/netsvc/rwall/rpc.rwalld        rwalld 100008 1</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run <xhtml:code>rwalld</xhtml:code>, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'rwalld' -p 'udp'"<br/>&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'rwalld' -p 'udp'" &lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented out<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'rwalld' is disabled in '/etc/inetd.conf'">
                            <ecl:command>egrep '^[^#].*rwalld' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-sprayd" selected="false">
                <xccdf:title>/etc/inetd.conf - sprayd </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>sprayd</xhtml:code> daemon when required. This service is used as a tool to generate UDP packets for testing and diagnosing network problems.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>sprayd</xhtml:code> service is used as a tool to generate UDP packets for testing and diagnosing network problems. The service must be disabled if you are not running NFS, as it can be used by attackers in a Distributed Denial of Service (DDoS) attack.  <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>sprayd</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'sprayd' -p 'udp'</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#sprayd[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#sprayd sunrpc_udp      udp     wait    root    /usr/lib/netsvc/spray/rpc.sprayd        sprayd 100012 1</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run <xhtml:code>sprayd</xhtml:code>, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'sprayd' -p 'udp'"<br/>&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'sprayd' -p 'udp'" &lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented out<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'sprayd' is disabled in '/etc/inetd.conf'">
                            <ecl:command>egrep '^[^#].*sprayd' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-klogin" selected="false">
                <xccdf:title>/etc/inetd.conf - klogin </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>klogin</xhtml:code> service when required. This is a kerberized login service, which provides a higher degree of security over traditional <xhtml:code>rlogin</xhtml:code> and <xhtml:code>telnet</xhtml:code>.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>klogin</xhtml:code> service offers a higher degree of security than traditional <xhtml:code>rlogin</xhtml:code> or <xhtml:code>telnet</xhtml:code> by eliminating most clear-text password exchanges on the network. However, it is still not as secure as SSH, which encrypts all traffic. If you use <xhtml:code>klogin</xhtml:code> to login to a system, the password is not sent in clear text; however, if you su to another user, that password exchange is open to detection from network-sniffing programs. The recommendation is to utilize SSH wherever possible instead of <xhtml:code>klogin</xhtml:code>.<br/><br/>If the <xhtml:code>klogin</xhtml:code> service is used, you must use the latest kerberos version available and make sure that all the latest patches are installed. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>klogin</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'klogin' -p 'tcp'</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#klogin[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#klogin stream  tcp     nowait  root    /usr/sbin/krlogind      krlogind</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run <xhtml:code>klogin</xhtml:code>, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'klogin' -p 'tcp'"<br/>&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'klogin' -p 'tcp'" &lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented out<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'klogin' is disabled in '/etc/inetd.conf'">
                            <ecl:command>egrep '^[^#].*klogin' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-kshell" selected="false">
                <xccdf:title>/etc/inetd.conf - kshell </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>kshell</xhtml:code> service when required. This is a kerberized remote shell service, which provides a higher degree of security over traditional <xhtml:code>rsh</xhtml:code>.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>kshell</xhtml:code> service offers a higher degree of security than traditional <xhtml:code>rsh</xhtml:code> services. However, it still does not use encrypted communications. The recommendation is to utilize SSH wherever possible instead of <xhtml:code>kshell</xhtml:code>.<br/><br/>If the <xhtml:code>kshell</xhtml:code> service is used, you should use the latest kerberos version available and must make sure that all the latest patches are installed. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>kshell</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'kshell' -p 'tcp'</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#kshell[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#kshell stream  tcp     nowait  root    /usr/sbin/krshd krshd</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run klogin, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'kshell' -p 'tcp'"<br/>&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'kshell' -p 'tcp'" &lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented out<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'kshell' is disabled in '/etc/inetd.conf'">
                            <ecl:command>egrep '^[^#].*kshell' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-rquotad" selected="false">
                <xccdf:title>/etc/inetd.conf - rquotad </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>rquotad</xhtml:code> service when required. This allows NFS clients to enforce disk quotas on locally mounted filesystems.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>rquotad</xhtml:code> service allows NFS clients to enforce disk quotas on file systems that are mounted on the local system. This service should be disabled if it is not required. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>rquotad</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'rquotad' -p 'udp'</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#rquotad[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#rquotad        sunrpc_udp      udp     wait    root    /usr/sbin/rpc.rquotad   rquotad 100011 1</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run rquotad, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'rquotad' -p 'udp'" &lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'rquotad' -p 'udp'" &lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented out<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'rquotad' is disabled in '/etc/inetd.conf'">
                            <ecl:command>egrep '^[^#].*rquotad' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-tftp" selected="false">
                <xccdf:title>/etc/inetd.conf - tftp </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>tftp</xhtml:code> service when required. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>tftp</xhtml:code> service allows remote systems to download or upload files to the tftp server without any authentication. It is therefore a service that should not run, unless needed. One of the main reasons for requiring this service to be activated is if the host is a NIM master. However, the service can be enabled and then disabled once a NIM operation has completed, rather than left running permanently.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>tftp</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'tftp' -p 'udp'</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#tftp[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#tftp   dgram   udp6    SRC     nobody  /usr/sbin/tftpd tftpd -n</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run <xhtml:code>tftp</xhtml:code>, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'tftp' -p 'udp'"<br/>&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'tftp' -p 'udp'" &lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented out<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'tftp' is disabled in '/etc/inetd.conf'">
                            <ecl:command>egrep '^[^#].*tftp' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-imap" selected="false">
                <xccdf:title>/etc/inetd.conf - imap </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>imap2</xhtml:code> service when required. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>imap2</xhtml:code> service or Internet Message Access Protocol (IMAP) supports the IMAP4 remote mail access protocol. It works with <xhtml:code>sendmail</xhtml:code> and <xhtml:code>bellmail</xhtml:code>. This service should be disabled if it is not required.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>imap2</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'imap2' -p 'tcp'</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#imap2[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#imap2  stream  tcp     nowait  root    /usr/sbin/imapd imapd</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run <xhtml:code>imap2</xhtml:code>, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'imap2' -p 'tcp'" &lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'imap2' -p 'tcp'" &lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented out<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'imap2' is disabled in '/etc/inetd.conf'">
                            <ecl:command>egrep '^[^#].*imap2' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-pop3" selected="false">
                <xccdf:title>/etc/inetd.conf - pop3 </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>pop3</xhtml:code> service when required. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>pop3</xhtml:code> service provides a <xhtml:code>pop3</xhtml:code> server. It supports the <xhtml:code>pop3</xhtml:code> remote mail access protocol. It works with sendmail and bellmail. This service should be disabled if it is not required.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>pop3</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'pop3' -p 'tcp'</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#pop3[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#pop3   stream  tcp     nowait  root    /usr/sbin/pop3d pop3d</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run <xhtml:code>pop3</xhtml:code>, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'pop3' -p 'tcp"<br/>&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'pop3' -p 'tcp'" &lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented out<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'pop3' is disabled in '/etc/inetd.conf'">
                            <ecl:command>egrep '^[^#].*pop3' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-fingerd" selected="false">
                <xccdf:title>/etc/inetd.conf - fingerd </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>fingerd</xhtml:code> daemon when required. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>fingerd</xhtml:code> daemon provides the server function for the <xhtml:code>finger</xhtml:code> command. This allows users to view real-time pertinent user login information on other remote systems. This service should be disabled if it is not required.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>fingerd</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'finger' -p 'tcp'</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#finger[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#finger stream  tcp     nowait  nobody  /usr/sbin/fingerd     fingerd</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run fingerd, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'finger' -p 'tcp'" &lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'finger' -p 'tcp'" &lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented out<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'finger' is disabled in '/etc/inetd.conf'">
                            <ecl:command>egrep '^[^#].*finger' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-instsrv" selected="false">
                <xccdf:title>/etc/inetd.conf - instsrv </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This entry starts the <xhtml:code>instsrv</xhtml:code> service when required. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>instsrv</xhtml:code> service is part of the Network Installation Tools, used for servicing servers running AIX 3.2. This service should be disabled.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In <xhtml:code>/etc/inetd.conf</xhtml:code>, comment out the <xhtml:code>instsrv</xhtml:code> entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chsubserver -r inetd -C /etc/inetd.conf -d  -v 'instsrv' -p 'tcp'</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>grep "^#instsrv[[::blank::]]" /etc/inetd.conf</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#instsrv stream tcp     nowait  netinst /u/netinst/bin/instsrv instsrv -r /tmp/netinstalllog /u/netinst/scripts</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run instsrv, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'instsrv' -p 'tcp'" &lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt; "chsubserver -r inetd -C /etc/inetd.conf -d  -v 'instsrv' -p 'tcp'" &lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> Commented out<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'instsrv' is disabled in '/etc/inetd.conf'">
                            <ecl:command>egrep '^[^#].*instsrv' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-inetd-conf-permissions-and-ownership" selected="false">
                <xccdf:title>/etc/inetd.conf - permissions and ownership </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommended permissions and ownership for <xhtml:code>/etc/inetd.conf</xhtml:code> are applied.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The <xhtml:code>/etc/inetd.conf</xhtml:code> file contains the list of services that <xhtml:code>inetd</xhtml:code> controls and determines their current status i.e. active or disabled. This file must be protected from unauthorized access and modifications to ensure that the services disabled in this benchmark remain locked down. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Set the recommended permissions and ownership to <xhtml:code>/etc/inetd.conf</xhtml:code>.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chmod u=rw,go=r /etc/inetd.conf<br/>chown root:system /etc/inetd.conf</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/><xhtml:code>ls -l /etc/inetd.conf | awk '{print $1 " " $3 " " $4 " " $9}'</xhtml:code><br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>-rw-r--r--   root     system         /etc/inetd.conf</xhtml:code><br/>If there is a requirement to leave the current ownership and permissions in place, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml</xhtml:code><br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt; "chmod 644 /etc/inetd.conf; chown root:system /etc/inetd.conf" &lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt; "chmod 644 /etc/inetd.conf; chown root:system /etc/inetd.conf" &lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/><b>Default Value:</b> 644, root:system<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/>Low Level policy 	N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure group/other have no write/execute permissions on '/etc/inetd'" success="pass">
                            <ecl:command>ls -l /etc/inetd.conf | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                            <ecl:line-selection op="pm" value="^-r(w|-)-(r|-)--(r|-)--\s+root\s+system\s*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="aix-security-expert-disabling-remote-services">
            <xccdf:title>AIX Security Expert - Disabling Remote Services</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p>This section provides guidance on the local disablement of remote system services. In the previous section, recommendations were made to disable the remote services in <xhtml:code>/etc/inetd.conf</xhtml:code>. This stops the server from accepting connections, but the binaries to initiate remote connections from the server to another host should also be restricted along with the daemons themselves being fully disabled. There are also many known security vulnerabilities that relate to these services, they are a primary target for any DoS attack.</xhtml:p>
                    <xhtml:p>It is recommended that, unless otherwise required, that the following services and daemons will have their execute permissions removed:</xhtml:p>
                    <xhtml:p><br/>
                        <xhtml:code>
                            /usr/bin/rcp<br/>
                            /usr/bin/rlogin<br/>
                            /usr/bin/rsh<br/>
                            /usr/sbin/rlogind<br/>
                            /usr/sbin/rshd<br/>
                        </xhtml:code></xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:Rule id="remote-command-lockdown" selected="false">
                <xccdf:title>Remote command lockdown </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Removes all permissions from the remote service commands: rsh, rlogin and rcp. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>This effectively disables the following commands, for all users:<br/><br/><xhtml:code>/usr/bin/rcp<br/>/usr/bin/rlogin<br/>/usr/bin/rsh</xhtml:code><br/><br/>These remote services send usernames and passwords in clear text and should not be used. Unless required these binaries will be disabled for all users. The SSH suite of commands should be utilized to provide equivalent functionality.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Use the chmod command to remove all permissions on the remote services.<br/><br/>Please note the commands below are for information only, as these settings will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chmod ugo= /usr/bin/rcp <br/>chmod ugo= /usr/bin/rlogin<br/>chmod ugo= /usr/bin/rsh</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following commands:<br/><br/><xhtml:code>ls -l /usr/bin/rcp | awk '{print $1}'<br/>ls -l /usr/bin/rlogin | awk '{print $1}'<br/>ls -l /usr/bin/rsh | awk '{print $1}'</xhtml:code><br/><br/>Each of the above commands should return with the following permissions:<br/><br/><xhtml:code>----------</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run any of these services, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 </xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;d disrmtcmdshls&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;d disrmtcmdshls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;d hls_disrmtcmds&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;d hls_disrmtcmds&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>If there is a requirement to just revert one or more services, implement the customized AIX Security Expert XML file and execute the relevant command/s:<br/><br/>chmod ugo=rx,u+s /usr/bin/rcp <br/><xhtml:code>chmod ugo=rx,u+s /usr/bin/rlogin<br/>chmod ugo=rx,u+s /usr/bin/rsh </xhtml:code><br/><br/><b>Default Value:</b> No effect<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Permissions removed<br/>Medium Level policy No effect<br/>Low Level policy 	No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure '/usr/bin/rcp' is not executable" success="pass">
                                <ecl:command>ls -l /usr/bin/rcp | awk '{print $1'}</ecl:command>
                                <ecl:line-selection op="pm" value="^----------$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure '/usr/bin/rlogin' is not executable" success="pass">
                                <ecl:command>ls -l /usr/bin/rlogin | awk '{print $1'}</ecl:command>
                                <ecl:line-selection op="pm" value="^----------$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure '/usr/bin/rsh' is not executable" success="pass">
                                <ecl:command>ls -l /usr/bin/rsh | awk '{print $1'}</ecl:command>
                                <ecl:line-selection op="pm" value="^----------$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="remote-daemon-lockdown" selected="false">
                <xccdf:title>Remote daemon lockdown </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Removes all permissions from the remote service daemons: rshd, and rlogind. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>This effectively disables the following daemons, for all users:<br/><br/><xhtml:code>/usr/sbin/rlogind<br/>/usr/sbin/rshd<br/>/usr/sbin/tftpd</xhtml:code><br/><br/>These remote services both send and receive usernames and passwords in clear text and should not be used. Unless required these daemons will be disabled for all users.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Use the chmod command to remove all permissions on the remote daemons.<br/><br/>Please note the commands below are for information only, as these settings will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/><xhtml:code>chmod ugo= /usr/sbin/rlogind<br/>chmod ugo= /usr/sbin/rshd<br/>chmod ugo= /usr/sbin/tftpd</xhtml:code><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following commands:<br/><br/><xhtml:code>ls -l /usr/sbin/rlogind | awk '{print $1}'<br/>ls -l /usr/sbin/rshd | awk '{print $1}'<br/>ls -l /usr/sbin/tftpd | awk '{print $1}'</xhtml:code><br/><br/>Each of the above commands should return with the following permissions:<br/><br/><xhtml:code>----------</xhtml:code><br/><br/><b>Reversion:</b><br/>If there is a requirement to run any of these services, edit the customized XML file prior to implementing:<br/><br/><xhtml:code>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 </xhtml:code><br/><br/>AIX 5.3<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;d disrmtdmnshls&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;d disrmtdmnshls&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>AIX 6.1<br/><br/>Replace:<br/><xhtml:code>&lt;AIXPertArgs&gt;d hls_disrmtdmns&lt;/AIXPertArgs&gt;</xhtml:code><br/><br/>With:<br/><xhtml:code>&lt;!-- &lt;AIXPertArgs&gt;d hls_disrmtdmns&lt;/AIXPertArgs&gt; --&gt;</xhtml:code><br/><br/>If there is a requirement to just revert one or more daemons, implement the customized AIX Security Expert XML file and execute the relevant command/s:<br/><br/><xhtml:code>chmod ug=rx,o=r /usr/sbin/rlogind<br/>chmod ug=rx,o=r /usr/sbin/rshd<br/>chmod ug=rx,o=r /usr/sbin/tftpd</xhtml:code><br/><br/><b>Default Value:</b> No effect<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Permissions removed<br/>Medium Level policy No effect<br/>Low Level policy 	No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure '/usr/sbin/rlogind' is not executable" success="pass">
                                <ecl:command>ls -l /usr/sbin/rlogind | awk '{print $1'}</ecl:command>
                                <ecl:line-selection op="pm" value="^----------$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure '/usr/sbin/rshd' is not executable" success="pass">
                                <ecl:command>ls -l /usr/sbin/rshd | awk '{print $1'}</ecl:command>
                                <ecl:line-selection op="pm" value="^----------$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure '/usr/sbin/tftpd' is not executable" success="pass">
                                <ecl:command>ls -l /usr/sbin/tftpd | awk '{print $1'}</ecl:command>
                                <ecl:line-selection op="pm" value="^----------$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="aix-security-expert-automated-authentication">
            <xccdf:title>AIX Security Expert - Automated Authentication</xccdf:title>
            
            <xccdf:Rule id="removal-of-rhosts-and-netrc-files" selected="false">
                <xccdf:title>Removal of .rhosts and .netrc files </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This process removes all instances of .rhosts and .netrc files.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The .rhosts and .netrc files can be used to circumvent normal login or change control procedures. The existence of such files, with the relevant entries, can allow remote user access to a system bypassing local user and password authentication. Unless required these files will be removed from all user home directories. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Remove the .rhosts and .netrc files from all user home directories.<br/><br/>Please note the commands below are for information only, as these settings will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>find / -name ".netrc" --exec rm {} \;<br/>find / -name ".rhosts" --exec rm {} \;<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following commands:<br/><br/>find / -name ".netrc" --print<br/>find / -name ".rhosts" -print<br/><br/>The above commands should not yield output<br/><br/><b>Reversion:</b><br/>If there is a requirement to implement .nertrc and .rhosts files, edit the customized XML file prior to implementing:<br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 <br/><br/>AIX 5.3<br/><br/>Replace:<br/>&lt;AIXPertArgs&gt;h rmrhostsnetrchls&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;h rmrhostsnetrchls&lt;/AIXPertArgs&gt; --&gt;<br/><br/>AIX 6.1<br/><br/>Replace:<br/>&lt;AIXPertArgs&gt;h hls_rmrhostsnetrc&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;h hls_rmrhostsnetrc&lt;/AIXPertArgs&gt; --&gt;<br/><br/><b>Default Value:</b> No effect<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	All files removed from all home directories<br/>Medium Level policy All files removed from all home directories<br/>Low Level policy 	All files removed from root home directory only<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="Check all home directories for '.netrc' files">
                                <ecl:command>find `lsuser -a home ALL | cut -f2 -d= |sort -u` -type f  -name '.netrc' -ls</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="Check all home directories for '.rhosts' files">
                                <ecl:command>find `lsuser -a home ALL | cut -f2 -d= |sort -u` -type f  -name '.rhosts' -ls</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="removal-of-entries-from-etc-hosts-equiv" selected="false">
                <xccdf:title>Removal of entries from /etc/hosts.equiv </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This process removes all entries from the /etc/hosts.equiv file.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The /etc/hosts.equiv file can be used to circumvent normal login or change control procedures. The existence of this file, with the relevant entries, can allow remote user access to a system bypassing local user and password authentication. Unless required all entries will be removed from this file. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Remove all entries from the /etc/hosts.equiv file.<br/><br/>Please note the commands below are for information only, as these settings will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>sed '/^\s*$/d; s/^\(\s*[^#].*\)/#\1/' /etc/hosts.equiv &gt; /etc/hosts.equiv.work<br/>mv hosts.equiv.work hosts.equiv<br/>chown root:system /etc/hosts.equiv<br/>chmod 644 /etc/hosts.equiv<br/><br/>Note: the above command removes blank lines and comments out any non comments entries.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/>grep -v "^\s*<xhtml:code>#" /etc/hosts.equiv<br/><br/>The above command should not yield output<br/><br/><b>Reversion:</b><br/>If there is a requirement to have entries in this file, edit the customized XML file prior to implementing:<br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 <br/><br/>AIX 5.3<br/><br/>Replace:<br/>&lt;AIXPertArgs&gt;rmetchostsequivhls&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;rmetchostsequivhls&lt;/AIXPertArgs&gt; --&gt;<br/><br/>AIX 6.1<br/><br/>Replace:<br/>&lt;AIXPertArgs&gt;hls_rmetchostsequiv&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;hls_rmetchostsequiv&lt;/AIXPertArgs&gt; --&gt;<br/><br/><b>Default Value:</b> No effect<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Remove all entries from /etc/hosts.equiv<br/>Medium Level policy Remove all entries from /etc/hosts.equiv<br/></xhtml:code></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure no entries in /etc/hosts.equiv" success="fail">
                            <ecl:command>egrep -v "^\s*#" /etc/hosts.equiv</ecl:command>
                       </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="aix-security-expert-tcp-ip-hardening">
            <xccdf:title>AIX Security Expert - TCP/IP Hardening</xccdf:title>
            
            <xccdf:Rule id="tcp-ip-tuning-ipsrcrouteforward" selected="false">
                <xccdf:title>TCP/IP Tuning - ipsrcrouteforward </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The ipsrcrouteforward parameter determines whether or not the system forwards IPV4 source-routed packets.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The ipsrcrouteforward will be set to 0, to prevent source-routed packets being forwarded by the system. This would prevent a hacker from using source-routed packets to bridge an external facing server to an internal LAN, possibly even through a firewall. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In /etc/tunables/nextboot, add the ipsrcrouteforward entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>no -p -o ipsrcrouteforward=0<br/><br/>This makes the change permanent by adding the entry into /etc/tunables/nextboot<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>no -a |grep "ipsrcrouteforward[[:space:]]=[[:space:]]0"<br/><br/>The above command should yield the following output:<br/><br/>ipsrcrouteforward = 0<br/><br/><b>Reversion:</b><br/>If there is a requirement have this parameter enabled, edit the customized XML file prior to implementing:<br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 <br/><br/>AIX 5.3<br/><br/>Replace:<br/>&lt;AIXPertArgs&gt;ipsrcrouteforward=0 s ipsrcrouteforwardhls&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;ipsrcrouteforward=0 s ipsrcrouteforwardhls&lt;/AIXPertArgs&gt; --&gt;<br/><br/>AIX 6.1<br/><br/>Replace:<br/>&lt;AIXPertArgs&gt;ipsrcrouteforward=0 s hls_ipsrcrouteforward&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;ipsrcrouteforward=0 s hls_ipsrcrouteforward&lt;/AIXPertArgs&gt; --&gt;<br/><br/><b>Default Value:</b> 1<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	0<br/>Medium Level policy 0<br/>Low Level policy 	No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'ipsrcrouteforward' is set to '0'" success="pass">
                            <ecl:command>no -a |grep "ipsrcrouteforward[[:space:]]=[[:space:]]0"</ecl:command>
		    </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="tcp-ip-tuning-ipignoreredirects" selected="false">
                <xccdf:title>TCP/IP Tuning - ipignoreredirects </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The ipignoreredirects parameter determines whether or not the system will process IP redirects.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The ipignoreredirects will be set to 1, to prevent IP re-directs being processed by the system. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In /etc/tunables/nextboot, add the ipignoreredirects entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>no -p -o ipignoreredirects=1<br/><br/>This makes the change permanent by adding the entry into /etc/tunables/nextboot<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>no -a |grep "ipignoreredirects[[:space:]]=[[:space:]]1"<br/><br/>The above command should yield the following output:<br/><br/>ipignoreredirects = 1<br/><br/><b>Reversion:</b><br/>If there is a requirement have this parameter enabled, edit the customized XML file prior to implementing:<br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 <br/><br/>AIX 5.3<br/><br/>Replace:<br/>&lt;AIXPertArgs&gt;ipignoreredirects=1 s ipignoreredirectshls&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;ipignoreredirects=1 s ipignoreredirectshls&lt;/AIXPertArgs&gt; --&gt;<br/><br/>AIX 6.1<br/><br/>Replace:<br/>&lt;AIXPertArgs&gt;ipignoreredirects=1 s hls_ipignoreredirects&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;ipignoreredirects=1 s hls_ipignoreredirects&lt;/AIXPertArgs&gt; --&gt;<br/><br/><b>Default Value:</b> 0<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	1<br/>Medium Level policy 0<br/>Low Level policy 	No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'ipignoreredirects' is set to '1'" success="pass">
                            <ecl:command>no -a |grep "ipignoreredirects[[:space:]]=[[:space:]]1"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="tcp-ip-tuning-clean-partial-conns" selected="false">
                <xccdf:title>TCP/IP Tuning - clean_partial_conns </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The clean_partial_conns parameter determines whether or not the system is open to SYN attacks. This parameter, when enabled, clears down connections in the SYN RECEIVED state after a set period of time. This attempts to stop DoS attacks when a hacker may flood a system with SYN flag set packets.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The clean_partial_conns parameter will be set to 1, to clear down pending SYN received connections after a set period of time.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In /etc/tunables/nextboot, add the clean_partial_conns entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>no -p -o clean_partial_conns=1<br/><br/>This makes the change permanent by adding the entry into /etc/tunables/nextboot<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>no -a |grep "clean_partial_conns[[:space:]]=[[:space:]]1" <br/><br/>The above command should yield the following output:<br/><br/>clean_partial_conns = 1<br/><br/><b>Reversion:</b><br/>If there is a requirement have this parameter enabled, edit the customized XML file prior to implementing:<br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 <br/><br/>AIX 5.3<br/><br/>Replace:<br/>&lt;AIXPertArgs&gt;clean_partial_conns=1 s clean_partial_connshls&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;clean_partial_conns=1 s clean_partial_connshls &lt;/AIXPertArgs&gt;  --&gt;<br/><br/>AIX 6.1<br/><br/>Replace:<br/>&lt;AIXPertArgs&gt;clean_partial_conns=1 s hls_clean_partial_conns&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;clean_partial_conns=1 s hls_clean_partial_conns&lt;/AIXPertArgs&gt;  --&gt;<br/><br/><b>Default Value:</b> 0<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	1<br/>Medium Level policy 1<br/>Low Level policy 	1<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'clean_partial_conns' is set to '1'" success="pass">
                            <ecl:command> no -a |grep "clean_partial_conns[[:space:]]=[[:space:]]1" </ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="tcp-ip-tuning-ipsrcroutesend" selected="false">
                <xccdf:title>TCP/IP Tuning - ipsrcroutesend </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The ipsrcroutesend parameter determines whether or not the system can send source-routed packets.  <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The ipsrcroutesend parameter will be set to 0, to ensure that any local applications cannot send source routed packets.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In /etc/tunables/nextboot, add the ipsrcroutesend entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>no -p -o ipsrcroutesend=0<br/><br/>This makes the change permanent by adding the entry into /etc/tunables/nextboot<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>no -a |grep "ipsrcroutesend[[:space:]]=[[:space:]]0" <br/><br/>The above command should yield the following output:<br/><br/>ipsrcroutesend = 0<br/><br/><b>Reversion:</b><br/>If there is a requirement have this parameter enabled, edit the customized XML file prior to implementing:<br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 <br/><br/>AIX 5.3<br/><br/>Replace:<br/> &lt;AIXPertArgs&gt;ipsrcroutesend=0 s ipsrcroutesendhls&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;ipsrcroutesend=0 s ipsrcroutesendhls&lt;/AIXPertArgs&gt; --&gt;<br/><br/>AIX 6.1<br/><br/>Replace:<br/> &lt;AIXPertArgs&gt;ipsrcroutesend=0 s hls_ipsrcroutesend&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;ipsrcroutesend=0 s hls_ipsrcroutesend&lt;/AIXPertArgs&gt; --&gt;<br/><br/><b>Default Value:</b> 1<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	0<br/>Medium Level policy 1<br/>Low Level policy 	1<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'ipsrcroutesend' is set to '0'" success="pass">
                            <ecl:command>no -a |grep "ipsrcroutesend[[:space:]]=[[:space:]]0" </ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="tcp-ip-tuning-ipforwarding" selected="false">
                <xccdf:title>TCP/IP Tuning - ipforwarding </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The ipforwarding parameter determines whether or not the system forwards TCP/IP packets.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The ipforwarding parameter will be set to 0, to ensure that redirected packets do not reach remote networks. This should only be enabled if the system is performing the function of an IP router. This is typically handled by a dedicated network device. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In /etc/tunables/nextboot, add the ipforwarding entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>no -p -o ipforwarding=0<br/><br/>This makes the change permanent by adding the entry into /etc/tunables/nextboot<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>no -a |grep "ipforwarding[[:space:]]=[[:space:]]0" <br/><br/>The above command should yield the following output:<br/><br/>ipforwarding = 0<br/><br/><b>Reversion:</b><br/>If there is a requirement have this parameter enabled, edit the customized XML file prior to implementing:<br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 <br/><br/>AIX 5.3<br/><br/>Replace:<br/> &lt;AIXPertArgs&gt;ipforwarding=0 s ipforwardinghls&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;ipforwarding=0 s ipforwardinghls&lt;/AIXPertArgs&gt; --&gt;<br/><br/>AIX 6.1<br/><br/>Replace:<br/> &lt;AIXPertArgs&gt;ipforwarding=0 s hls_ipforwarding&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;ipforwarding=0 s hls_ipforwarding&lt;/AIXPertArgs&gt; --&gt;<br/><br/><b>Default Value:</b> 1<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	0<br/>Medium Level policy 1<br/>Low Level policy 	1<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'ipforwarding' is set to '0'" success="pass">
                            <ecl:command>no -a |grep "ipforwarding[[:space:]]=[[:space:]]0" </ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="tcp-ip-tuning-ipsendredirects" selected="false">
                <xccdf:title>TCP/IP Tuning - ipsendredirects </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The ipsendredirects parameter determines whether or not the system forwards re-directed TCP/IP packets.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The ipsendredirects parameter will be set to 0, to ensure that redirected packets do not reach remote networks. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In /etc/tunables/nextboot, add the ipsendredirects entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>no -p -o ipsendredirects=0<br/><br/>This makes the change permanent by adding the entry into /etc/tunables/nextboot<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>no -a |grep "ipsendredirects[[:space:]]=[[:space:]]0"<br/><br/>The above command should yield the following output:<br/><br/>ipsendredirects = 0<br/><br/><b>Reversion:</b><br/>If there is a requirement have this parameter enabled, edit the customized XML file prior to implementing:<br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 <br/><br/>AIX 5.3<br/><br/>Replace:<br/> &lt;AIXPertArgs&gt;ipsendredirects=0 s ipsendredirectshls&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;ipsendredirects=0 s ipsendredirectshls&lt;/AIXPertArgs&gt; --&gt;<br/><br/>AIX 6.1<br/><br/>Replace:<br/> &lt;AIXPertArgs&gt;ipsendredirects=0 s hls_ipsendredirects&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;ipsendredirects=0 s hls_ipsendredirects&lt;/AIXPertArgs&gt; --&gt;<br/><br/><b>Default Value:</b> 1<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	0<br/>Medium Level policy 1<br/>Low Level policy 	1<br/>References:<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'ipsendredirects' is set to '0'" success="pass">
                            <ecl:command>no -a |grep "ipsendredirects[[:space:]]=[[:space:]]0"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="tcp-ip-tuning-ip6srcrouteforward" selected="false">
                <xccdf:title>TCP/IP Tuning - ip6srcrouteforward </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The ip6srcrouteforward parameter determines whether or not the system forwards IPV6 source-routed packets.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The ip6srcrouteforward parameter will be set to 0, to prevent source-routed packets being forwarded by the system. This would prevent a hacker from using source-routed packets to bridge an external facing server to an internal LAN, possibly even through a firewall. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In /etc/tunables/nextboot, add the ip6srcrouteforward entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>no -p -o ip6srcrouteforward=0<br/><br/>This makes the change permanent by adding the entry into /etc/tunables/nextboot<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>no -a |grep "ip6srcrouteforward[[:space:]]=[[:space:]]0"<br/><br/>The above command should yield the following output:<br/><br/>ip6srcrouteforward = 0<br/><br/><b>Reversion:</b><br/>If there is a requirement have this parameter enabled, edit the customized XML file prior to implementing:<br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 <br/><br/>AIX 5.3<br/><br/>Replace:<br/> &lt;AIXPertArgs&gt;ip6srcrouteforward=0 s ip6srcrouteforwardhls&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;ip6srcrouteforward=0 s ip6srcrouteforwardhls&lt;/AIXPertArgs&gt; --&gt;<br/><br/>AIX 6.1<br/><br/>Replace:<br/> &lt;AIXPertArgs&gt;ip6srcrouteforward=0 s hls_ip6srcrouteforward &lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;ip6srcrouteforward=0 s hls_ip6srcrouteforward&lt;/AIXPertArgs&gt; --&gt;<br/><br/><b>Default Value:</b> 1<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	0<br/>Medium Level policy 1<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'ip6srcrouteforward' is set to '0'" success="pass">
                            <ecl:command>no -a |grep "ip6srcrouteforward[[:space:]]=[[:space:]]0"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="tcp-ip-tuning-directed-broadcast" selected="false">
                <xccdf:title>TCP/IP Tuning - directed_broadcast </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The directed_broadcast parameter determines whether or not the system allows a directed broadcast to a network gateway.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The directed_broadcast parameter will be set to 0, to prevent directed broadcasts being sent network gateways. This would prevent a redirected packet from reaching a remote network. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In /etc/tunables/nextboot, add the directed_broadcast entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>no -p -o directed_broadcast=0<br/><br/>This makes the change permanent by adding the entry into /etc/tunables/nextboot<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>no -a |grep "directed_broadcast[[:space:]]=[[:space:]]0"<br/><br/>The above command should yield the following output:<br/><br/>directed_broadcast = 0<br/><br/><b>Reversion:</b><br/>If there is a requirement have this parameter enabled, edit the customized XML file prior to implementing:<br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 <br/><br/>AIX 5.3<br/><br/>Replace:<br/> &lt;AIXPertArgs&gt;directed_broadcast=0 s directed_broadcasthls&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;directed_broadcast=0 s directed_broadcasthls&lt;/AIXPertArgs&gt; --&gt;<br/><br/>AIX 6.1<br/><br/>Replace:<br/> &lt;AIXPertArgs&gt;directed_broadcast=0 s hls_directed_broadcast&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;directed_broadcast=0 s hls_directed_broadcast&lt;/AIXPertArgs&gt; --&gt;<br/><br/><b>Default Value:</b> 1<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	0<br/>Medium Level policy 0<br/>Low Level policy 	0<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'directed_broadcast' is set to '0'" success="pass">
                            <ecl:command>no -a |grep "directed_broadcast[[:space:]]=[[:space:]]0"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="tcp-ip-tuning-tcp-pmtu-discover" selected="false">
                <xccdf:title>TCP/IP Tuning - tcp_pmtu_discover </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The tcp_pmtu_discover parameter controls whether TCP MTU discovery is enabled.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The tcp_pmtu_discover parameter will be set to 0. The idea of MTU discovery is to avoid packet fragmentation between remote networks.  This is achieved by discovering the network route and utilizing the smallest MTU size within that path when transmitting packets. When tcp_pmtu_discover is enabled, it leaves the system vulnerable to source routing attacks.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In /etc/tunables/nextboot, add the tcp_pmtu_discover entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>no -p -o tcp_pmtu_discover=0<br/><br/>This makes the change permanent by adding the entry into /etc/tunables/nextboot<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>no -a |grep "tcp_pmtu_discover[[:space:]]=[[:space:]]0"<br/><br/>The above command should yield the following output:<br/><br/>tcp_pmtu_discover = 0<br/><br/><b>Reversion:</b><br/>If there is a requirement have this parameter enabled, edit the customized XML file prior to implementing:<br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 <br/><br/>AIX 5.3<br/><br/>Replace:<br/> &lt;AIXPertArgs&gt;tcp_pmtu_discover=0 s tcp_pmtu_discoverhls&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;tcp_pmtu_discover=0 s tcp_pmtu_discoverhls&lt;/AIXPertArgs&gt; --&gt;<br/><br/>AIX 6.1<br/><br/>Replace:<br/> &lt;AIXPertArgs&gt;tcp_pmtu_discover=0 s hls_tcp_pmtu_discover&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;tcp_pmtu_discover=0 s hls_tcp_pmtu_discover&lt;/AIXPertArgs&gt; --&gt;<br/><br/><b>Default Value:</b> 1<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	0<br/>Medium Level policy 0<br/>Low Level policy 	0<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'tcp_pmtu_discover' set to '0'" success="pass">
                            <ecl:command>no -a |grep "tcp_pmtu_discover[[:space:]]=[[:space:]]0"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="tcp-ip-tuning-bcastping" selected="false">
                <xccdf:title>TCP/IP Tuning - bcastping </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The bcastping parameter determines whether the system responds to ICMP echo packets sent to the broadcast address.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The bcastping parameter will be set to 0. This means that the system will not respond to ICMP packets sent to the broadcast address. By default, when this is enabled the system is susceptible to smurf attacks, where a hacker utilizes this tool to send a small number of ICMP echo packets. These packets can generate huge numbers of ICMP echo replies and seriously affect the performance of the targeted host and network. This parameter will be disabled to ensure protection from this type of attack.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In /etc/tunables/nextboot, add the bcastping entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>no -p -o bcastping=0<br/><br/>This makes the change permanent by adding the entry into /etc/tunables/nextboot<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>no -a |grep "bcastping[[:space:]]=[[:space:]]0"<br/><br/>The above command should yield the following output:<br/><br/>bcastping = 0<br/><br/><b>Reversion:</b><br/>If there is a requirement have this parameter enabled, edit the customized XML file prior to implementing:<br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 <br/><br/>AIX 5.3<br/><br/>Replace:<br/> &lt;AIXPertArgs&gt;bcastping=0 s bcastpinghls&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;bcastping=0 s bcastpinghls&lt;/AIXPertArgs&gt; --&gt;<br/><br/>AIX 6.1<br/><br/>Replace:<br/> &lt;AIXPertArgs&gt;bcastping=0 s hls_bcastping&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;bcastping=0 s hls_bcastping&lt;/AIXPertArgs&gt; --&gt;<br/><br/><b>Default Value:</b> 1<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	0<br/>Medium Level policy 0<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'bcastping' set to '0'" success="pass">
                            <ecl:command>no -a |grep "bcastping[[:space:]]=[[:space:]]0"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="tcp-ip-tuning-icmpaddressmask" selected="false">
                <xccdf:title>TCP/IP Tuning - icmpaddressmask </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The icmpaddressmask parameter determines whether the system responds to an ICMP address mask ping.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The icmpaddressmask parameter will be set to 0, This means that the system will not respond to ICMP address mask request pings. By default, when this is enabled the system is susceptible to source routing attacks. This is typically a feature performed by a device such as a network router and should not be enabled within the operating system.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In /etc/tunables/nextboot, add the icmpaddressmask entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>no -p -o icmpaddressmask=0<br/><br/>This makes the change permanent by adding the entry into /etc/tunables/nextboot<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>no -a |grep "icmpaddressmask[[:space:]]=[[:space:]]0"<br/><br/>The above command should yield the following output:<br/><br/>icmpaddressmask = 0<br/><br/><b>Reversion:</b><br/>If there is a requirement have this parameter enabled, edit the customized XML file prior to implementing:<br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 <br/><br/>AIX 5.3<br/><br/>Replace:<br/> &lt;AIXPertArgs&gt;icmpaddressmask=0 s icmpaddressmaskhls&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;icmpaddressmask=0 s icmpaddressmaskhls&lt;/AIXPertArgs&gt; --&gt;<br/><br/>AIX 6.1<br/><br/>Replace:<br/> &lt;AIXPertArgs&gt;icmpaddressmask=0 s hls_icmpaddressmask&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;icmpaddressmask=0 s hls_icmpaddressmask&lt;/AIXPertArgs&gt; --&gt;<br/><br/><b>Default Value:</b> 1<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	0<br/>Medium Level policy 0<br/>Low Level policy 	0<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'icmpaddressmask' set to '0'" success="pass">
                            <ecl:command>no -a |grep "icmpaddressmask[[:space:]]=[[:space:]]0"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="tcp-ip-tuning-udp-pmtu-discover" selected="false">
                <xccdf:title>TCP/IP Tuning - udp_pmtu_discover </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The udp_pmtu_discover parameter controls whether MTU discovery is enabled.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The udp_pmtu_discover parameter will be set to 0. The idea of MTU discovery is to avoid packet fragmentation between remote networks.  This is achieved by discovering the network route and utilizing the smallest MTU size within that path when transmitting packets. When udp_pmtu_discover is enabled, it leaves the system vulnerable to source routing attacks.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In /etc/tunables/nextboot, add the udp_pmtu_discover entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>no -p -o udp_pmtu_discover=0<br/><br/>This makes the change permanent by adding the entry into /etc/tunables/nextboot<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>no -a |grep "udp_pmtu_discover[[:space:]]=[[:space:]]0"<br/><br/>The above command should yield the following output:<br/><br/>udp_pmtu_discover = 0<br/><br/><b>Reversion:</b><br/>If there is a requirement have this parameter enabled, edit the customized XML file prior to implementing:<br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml<br/><br/>AIX 5.3<br/><br/>Replace:<br/> &lt;AIXPertArgs&gt;udp_pmtu_discover=0 s udp_pmtu_discoverhls&lt;/AIXPertArgs&gt; <br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;udp_pmtu_discover=0 s udp_pmtu_discoverhls&lt;/AIXPertArgs&gt; --&gt;<br/><br/>AIX 6.1<br/><br/>Replace:<br/> &lt;AIXPertArgs&gt;udp_pmtu_discover=0 s hls_udp_pmtu_discover&lt;/AIXPertArgs&gt; <br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;udp_pmtu_discover=0 s hls_udp_pmtu_discover&lt;/AIXPertArgs&gt; --&gt;<br/><br/><b>Default Value:</b> 1<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	0<br/>Medium Level policy 0<br/>Low Level policy 	0<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'udp_pmtu_discover' set to '0'" success="pass">
                            <ecl:command>no -a |grep "udp_pmtu_discover[[:space:]]=[[:space:]]0"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="tcp-ip-tuning-ipsrcrouterecv" selected="false">
                <xccdf:title>TCP/IP Tuning - ipsrcrouterecv </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The ipsrcrouterecv parameter determines whether the system accepts source routed packets.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The ipsrcrouterecv parameter will be set to 0, This means that the system will not accept source routed packets. By default, when this is enabled the system is susceptible to source routing attacks. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In /etc/tunables/nextboot, add the ipsrcrouterecv entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>no -p -o ipsrcrouterecv=0<br/><br/>This makes the change permanent by adding the entry into /etc/tunables/nextboot<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>no -a |grep "ipsrcrouterecv[[:space:]]=[[:space:]]0"<br/><br/>The above command should yield the following output:<br/><br/>ipsrcrouterecv = 0<br/><br/><b>Reversion:</b><br/>If there is a requirement have this parameter enabled, edit the customized XML file prior to implementing:<br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 <br/><br/>AIX 5.3<br/><br/>Replace:<br/> &lt;AIXPertArgs&gt;ipsrcrouterecv=0 s ipsrcrouterecvhls&lt;/AIXPertArgs&gt; <br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;ipsrcrouterecv=0 s ipsrcrouterecvhls&lt;/AIXPertArgs&gt; --&gt;<br/><br/>AIX 6.1<br/><br/>Replace:<br/> &lt;AIXPertArgs&gt;ipsrcrouterecv=0 s hls_ipsrcrouterecv&lt;/AIXPertArgs&gt; <br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;ipsrcrouterecv=0 s hls_ipsrcrouterecv&lt;/AIXPertArgs&gt; --&gt;<br/><br/><b>Default Value:</b> 1<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	0<br/>Medium Level policy No effect<br/>Low Level policy 	No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'ipsrcrouterecv' set to '0'" success="pass">
                            <ecl:command>no -a |grep "ipsrcrouterecv[[:space:]]=[[:space:]]0"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="tcp-ip-tuning-nonlocsrcroute" selected="false">
                <xccdf:title>TCP/IP Tuning - nonlocsrcroute </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The nonlocsrcroute parameter determines whether the system allows source routed packets to be addressed to hosts outside of the LAN. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The nonlocsrcroute parameter will be set to 0. This means that the system will not allow source routed packets to be addressed to hosts outside of the LAN. By default, when this is enabled the system is susceptible to source routing attacks. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In /etc/tunables/nextboot, add the nonlocsrcroute entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>no -p -o nonlocsrcroute=0<br/><br/>This makes the change permanent by adding the entry into /etc/tunables/nextboot<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>no -a |grep "nonlocsrcroute[[:space:]]=[[:space:]]0"<br/><br/>The above command should yield the following output:<br/><br/>nonlocsrcroute = 0<br/><br/><b>Reversion:</b><br/>If there is a requirement have this parameter enabled, edit the customized XML file prior to implementing:<br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 <br/><br/>AIX 5.3<br/><br/>Replace:<br/> &lt;AIXPertArgs&gt;nonlocsrcroute=0 s nonlocsrcroutehls&lt;/AIXPertArgs&gt; <br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;nonlocsrcroute=0 s nonlocsrcroutehls&lt;/AIXPertArgs&gt; --&gt;<br/><br/>AIX 6.1<br/><br/>Replace:<br/> &lt;AIXPertArgs&gt;nonlocsrcroute=0 s hls_nonlocsrcroute&lt;/AIXPertArgs&gt; <br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;nonlocsrcroute=0 s hls_nonlocsrcroute&lt;/AIXPertArgs&gt; --&gt;<br/><br/><b>Default Value:</b> 1<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	0<br/>Medium Level policy No effect<br/>Low Level policy 	No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'nonlocsrcroute' set to '0'" success="pass">
                            <ecl:command>no -a |grep "nonlocsrcroute[[:space:]]=[[:space:]]0"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="tcp-ip-tuning-tcp-tcpsecure" selected="false">
                <xccdf:title>TCP/IP Tuning -tcp_tcpsecure </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The tcp_tcpsecure parameter value determines if the system is protected from three specific vulnerabilities:<br/>Fake SYN - This is used to terminate an established connection. A tcp_tcpsecure value of 1 protects the system from this vulnerability. <br/>Fake RST - As above, this is used to terminate an established connection. A tcp_tcpsecure value of  2 protects the system from this vulnerability.<br/>Fake data - A hacker may inject fake data into an established connection. A tcp_tcpsecure value of 4 protects the system from this vulnerability.<br/><br/>The tcp_tcpsecure parameter is, by default, only managed within the AIX 6.1 Security Expert framework. The parameter will also be set for AIX 5.3 as it has been added as a customized entry in the XML file. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The tcp_tcpsecure parameter will be set to 7. This means that the system will be protected from any connection reset and data integrity attacks. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In /etc/tunables/nextboot, add the tcp_tcpsecure entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>no -p -o tcp_tcpsecure=7<br/><br/>This makes the change permanent by adding the entry into /etc/tunables/nextboot<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>no -a |grep "tcp_tcpsecure[[:space:]]=[[:space:]]7"<br/><br/>The above command should yield the following output:<br/><br/>tcp_tcpsecure = 7<br/><br/><b>Reversion:</b><br/>If there is a requirement have this parameter set to the default, edit the customized XML file prior to implementing:<br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 <br/><br/>AIX 5.3<br/><br/>Replace:<br/> &lt;AIXPertArgs&gt;"no -p -o tcp_tcpsecure=7"&lt;/AIXPertArgs&gt; <br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;"no -p -o tcp_tcpsecure=7"&lt;/AIXPertArgs&gt; --&gt;<br/><br/>AIX 6.1<br/><br/>Replace:<br/>&lt;AIXPertArgs&gt; tcp_tcpsecure=7 s hls_tcp_tcpsecure &lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;tcp_tcpsecure=7 s hls_tcp_tcpsecure&lt;/AIXPertArgs&gt; --&gt;<br/><br/><b>Default Value:</b> 0<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	7<br/>Medium Level policy 7<br/>Low Level policy 	5<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'tcp_tcpsecure' set to '7'" success="pass">
                            <ecl:command>no -a |grep "tcp_tcpsecure[[:space:]]=[[:space:]]7"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="tcp-ip-tuning-sockthresh" selected="false">
                <xccdf:title>TCP/IP Tuning - sockthresh </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The sockthresh parameter value determines what percentage of the total memory allocated to networking, set via thewall, can be used for sockets. <br/><br/>The sockthresh parameter is, by default, only managed within the AIX 6.1 Security Expert framework. The parameter will also be set for AIX 5.3 as it has been added as a customized entry in the XML file. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The sockthresh parameter will be set to 60. This means that 60% of network memory can be used to service new socket connections, the remaining 40% is reserved for existing sockets. This ensures a quality of service for existing connections.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In /etc/tunables/nextboot, add the sockthresh entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>no -p -o sockthresh=60<br/><br/>This makes the change permanent by adding the entry into /etc/tunables/nextboot<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>no -a |grep "sockthresh[[:space:]]=[[:space:]]60"<br/><br/>The above command should yield the following output:<br/><br/>sockthresh = 60<br/><br/><b>Reversion:</b><br/>If there is a requirement have this parameter enabled, edit the customized XML file prior to implementing:<br/><br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 <br/><br/>AIX 5.3<br/><br/>Replace:<br/> &lt;AIXPertArgs&gt;"no -p -o sockthresh=60"&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;"no -p -o sockthresh=60"&lt;/AIXPertArgs&gt; --&gt;<br/><br/><br/>AIX 6.1<br/><br/>Replace:<br/> &lt;AIXPertArgs&gt;sockthresh=60 s hls_sockthresh&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;sockthresh=60 s hls_sockthresh&lt;/AIXPertArgs&gt; --&gt;<br/><br/><b>Default Value:</b> No limit<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	60<br/>Medium Level policy 70<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'sockthresh' set to '60'" success="pass">
                            <ecl:command>no -a |grep "sockthresh[[:space:]]=[[:space:]]60"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="tcp-ip-tuning-rfc1323" selected="false">
                <xccdf:title>TCP/IP Tuning - rfc1323 </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The rfc1323 parameter determines whether the TCP window sizes (tcp_sendspace and tcp_recvspace) can be greater than 64KB. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The rfc1323 parameter will be set to 1. This means that the system will allow the TCP windows sizes to exceed 64KB. This is a requirement for high performance networks, particularly those which utilize large MTU sizes.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In /etc/tunables/nextboot, add the rfc1323 entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>no -p -o rfc1323=1<br/><br/>This makes the change permanent by adding the entry into /etc/tunables/nextboot<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>no -a |grep "rfc1323[[:space:]]=[[:space:]]1"<br/><br/>The above command should yield the following output:<br/><br/>rfc1323 = 1<br/><br/><b>Reversion:</b><br/>If there is a requirement have this parameter enabled, edit the customized XML file prior to implementing:<br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 <br/><br/>AIX 5.3<br/><br/>Replace:<br/>&lt;AIXPertArgs&gt;rfc1323=1 s rfc1323hls&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;rfc1323=1 s rfc1323hls&lt;/AIXPertArgs&gt; --&gt;<br/><br/>AIX 6.1<br/><br/>Replace:<br/>&lt;AIXPertArgs&gt;rfc1323=1 s hls_rfc1323&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;rfc1323=1 s hls_rfc1323&lt;/AIXPertArgs&gt; --&gt;<br/><br/><b>Default Value:</b> 0<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	1<br/>Medium Level policy 1<br/>Low Level policy 	1<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'rfc1323' set to '1'" success="pass">
                            <ecl:command>no -a |grep "rfc1323[[:space:]]=[[:space:]]1"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="tcp-ip-tuning-tcp-sendspace" selected="false">
                <xccdf:title>TCP/IP Tuning - tcp_sendspace </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The tcp_sendspace parameter sets the socket buffer size for sending data. This recommendation changes the default size, but many adapters have specific buffer sizes implemented within the device driver. These are typically 64KB or greater.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The tcp_sendspace parameter will be set to 262144. This means that the system default socket buffer size for sending data will be 262KB. This is the minimum recommendation for modern high performance networks.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In /etc/tunables/nextboot, add the tcp_sendspace entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>no -p -o tcp_sendspace=262144<br/><br/>This makes the change permanent by adding the entry into /etc/tunables/nextboot<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>no -a |grep "tcp_sendspace[[:space:]]=[[:space:]]262144"<br/><br/>The above command should yield the following output:<br/><br/>tcp_sendspace = 262144<br/><br/><b>Reversion:</b><br/>If there is a requirement to leave this parameter at the default value, edit the customized XML file prior to implementing:<br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 <br/><br/>AIX 5.3<br/><br/>Replace:<br/>&lt;AIXPertArgs&gt;tcp_sendspace=262144 s tcp_sendspacehls&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;tcp_sendspace=262144 s tcp_sendspacehls&lt;/AIXPertArgs&gt; --&gt;<br/><br/>AIX 6.1<br/><br/>Replace:<br/>&lt;AIXPertArgs&gt;tcp_sendspace=262144 s hls_tcp_sendspace&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;tcp_sendspace=262144 s hls_tcp_sendspace&lt;/AIXPertArgs&gt; --&gt;<br/><br/><b>Default Value:</b> 16384<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	262144<br/>Medium Level policy 262144<br/>Low Level policy 	262144<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'tcp_sendspace' set to '262144'" success="pass">
                            <ecl:command>no -a |grep "tcp_sendspace[[:space:]]=[[:space:]]262144"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="tcp-ip-tuning-tcp-recvspace" selected="false">
                <xccdf:title>TCP/IP Tuning - tcp_recvspace </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The tcp_recvspace parameter sets the socket buffer size for receiving data. This recommendation changes the default size, but many adapters have specific buffer sizes implemented within the device driver. These are typically 64KB or greater.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The tcp_recvspace parameter will be set to 262144. This means that the system default socket buffer size for receiving data will be 262KB. This is the minimum recommendation for modern high performance networks.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In /etc/tunables/nextboot, add the tcp_recvspace entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>no -p -o tcp_recvspace=262144<br/><br/>This makes the change permanent by adding the entry into /etc/tunables/nextboot<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>no -a |grep "tcp_recvspace[[:space:]]=[[:space:]]262144"<br/><br/>The above command should yield the following output:<br/><br/>tcp_recvspace = 262144<br/><br/><b>Reversion:</b><br/>If there is a requirement to leave this parameter at the default value, edit the customized XML file prior to implementing:<br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 <br/><br/>AIX 5.3<br/><br/>Replace:<br/>&lt;AIXPertArgs&gt;tcp_recvspace=262144 s tcp_recvspacehls&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;tcp_recvspace=262144 s tcp_recvspacehls&lt;/AIXPertArgs&gt; --&gt;<br/>AIX 6.1<br/><br/>Replace:<br/>&lt;AIXPertArgs&gt;tcp_recvspace=262144 s hls_tcp_recvspace&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;tcp_recvspace=262144 s hls_tcp_recvspace&lt;/AIXPertArgs&gt; --&gt;<br/><br/><b>Default Value:</b> 16384<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	262144<br/>Medium Level policy 262144<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'tcp_recvspace' set to '262144'" success="pass">
                            <ecl:command>no -a |grep "tcp_recvspace[[:space:]]=[[:space:]]262144"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="tcp-ip-tuning-tcp-mssdflt" selected="false">
                <xccdf:title>TCP/IP Tuning - tcp_mssdflt </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The tcp_mssdflt parameter sets the maximum segment size for communication to a remote network. This parameter is only relevant if MTU discovery is disabled, which is recommended in this benchmark.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The tcp_mssdflt parameter will be set to 1448 . This value reflects the packet size minus the TCP/IP headers.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In /etc/tunables/nextboot, add the tcp_mssdflt entry.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>no -p -o tcp_mssdflt=1448<br/><br/>This makes the change permanent by adding the entry into /etc/tunables/nextboot<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>no -a |grep "tcp_mssdflt[[:space:]]=[[:space:]]1448"<br/><br/>The above command should yield the following output:<br/><br/>tcp_mssdflt = 1448<br/><br/><b>Reversion:</b><br/>If there is a requirement to leave this parameter at the default value, edit the customized XML file prior to implementing:<br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 <br/><br/>AIX 5.3<br/><br/>Replace:<br/>&lt;AIXPertArgs&gt;tcp_mssdflt=1448 s tcp_mssdflthls&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;tcp_mssdflt=1448 s tcp_mssdflthls&lt;/AIXPertArgs&gt; --&gt;<br/><br/>AIX 6.1<br/><br/>Replace:<br/>&lt;AIXPertArgs&gt;tcp_mssdflt=1448 s hls_tcp_mssdflt&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;tcp_mssdflt=1448 s hls_tcp_mssdflt&lt;/AIXPertArgs&gt; --&gt;<br/><br/><b>Default Value:</b> 1460<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	1448<br/>Medium Level policy 1448<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'tcp_mssdflt' set to '1448'" success="pass">
                            <ecl:command>no -a |grep "tcp_mssdflt[[:space:]]=[[:space:]]1448"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="tcp-ip-tuning-nfs-use-reserved-ports" selected="false">
                <xccdf:title>TCP/IP Tuning - nfs_use_reserved_ports </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The portcheck and nfs_use_reserved_ports parameters force the NFS server process on the local system to ignore NFS client requests that do not originate from the privileged ports range (ports less than 1024).<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The portcheck and nfs_use_reserved_ports parameters will both be set to 1. This value means that NFS client requests that do not originate from the privileged ports range (ports less than 1024) will be ignored by the local system.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>In /etc/tunables/nextboot, add the portcheck and nfs_use_reserved_ports entries.<br/><br/>Please note the command below is for information only, as this setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>nfso -p -o portcheck=1 <br/>nfso -p -o nfs_use_reserved_ports=1<br/><br/>This makes the change permanent by adding the entry into /etc/tunables/nextboot<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>nfso -a |egrep "(portcheck|nfs_use_reserved_ports)[[:space:]]=[[::space::]]1"<br/><br/>The above command should yield the following output:<br/><br/>portcheck = 1<br/>nfs_use_reserved_ports = 1<br/><br/><b>Reversion:</b><br/>If there is a requirement to leave this parameter at the default value, edit the customized XML file prior to implementing:<br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 <br/><br/>Replace:<br/><br/>&lt;AIXPertArgs&gt;"nfso -p -o portcheck=1; nfso -p -o nfs_use_reserved_ports=1"&lt;/AIXPertArgs&gt;<br/><br/>With:<br/><br/>&lt;!-- &lt;AIXPertArgs&gt;"nfso -p -o portcheck=1; nfso -p -o nfs_use_reserved_ports=1"&lt;AIXPertArgs&gt; --&gt;<br/><br/><b>Default Value:</b>  0<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure 'portcheck' set to '1'" success="pass">
                                <ecl:command>nfso -a |grep "portcheck[[:space:]]=[[:space:]]1"</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure 'nfs_use_reserved_ports' set to '1'" success="pass">
                                <ecl:command>nfso -a |grep "nfs_use_reserved_ports[[:space:]]=[[:space:]]1"</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="aix-security-expert-miscellaneous-enhancements">
            <xccdf:title>AIX Security Expert - Miscellaneous Enhancements</xccdf:title>
            
            <xccdf:Rule id="miscellaneous-enhancements-crontab-access" selected="false">
                <xccdf:title>Miscellaneous Enhancements - crontab access </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This change creates a cron.allow file with a root user entry and removes the cron.deny file, if it exists. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>This ensures that only the root user has the ability to create a crontab. A hacker may exploit use of the crontab to execute programs or processes automatically. Limiting access to the root account only reduces this risk.<br/><br/>NOTE: The adm user may also be added, particularly if system accounting is to be implemented.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Create the /var/adm/cron/cron.allow file<br/><br/>Please note the command below is for information only, as the setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>print "root\ntadm" &gt;&gt; /var/adm/cron/cron.allow<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>egrep "root|adm" /var/adm/cron/cron.allow<br/><br/>The above command should yield the following output:<br/><br/>root<br/>adm <br/><br/><b>Reversion:</b><br/>If there is a requirement to leave cron access at the default level, edit the customized XML file prior to implementing:<br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 <br/><br/>AIX 5.3<br/><br/>Replace:<br/> &lt;AIXPertArgs&gt;h limitsysacchls&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;h limitsysacchls&lt;/AIXPertArgs&gt; --&gt;<br/><br/>AIX 6.1<br/><br/>Replace:<br/> &lt;AIXPertArgs&gt;h hls_limitsysacc&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;h hls_limitsysacc&lt;/AIXPertArgs&gt; --&gt;<br/><br/><b>Default Value:</b> No effect<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	File created<br/>Medium Level policy No effect<br/>Low Level policy	No effect<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure only 'root' and 'adm' exist in /var/adm/cron/cron.allow" success="fail">
                            <ecl:command>egrep -v "root|adm" /var/adm/cron/cron.allow</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="miscellaneous-enhancements-at-access" selected="false">
                <xccdf:title>Miscellaneous Enhancements - at access </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This change creates an at.allow file with a root user entry and removes the at.deny file, if it exists.<br/><br/>Controlling at access is not a managed process within the default AIX Security Expert framework. This change is managed as a customized entry in the XML files.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>This ensures that only the root user has the ability to schedule jobs through the at command. A hacker may exploit use of at to execute programs or processes automatically. Limiting access to the root account only reduces this risk.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Create the /var/adm/cron/at.allow file<br/><br/>Please note the command below is for information only, as the setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>echo "root" &gt; /var/adm/cron/at.allow<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>grep "root" /var/adm/cron/at.allow<br/><br/>The above command should yield the following output:<br/><br/>root <br/><br/><b>Reversion:</b><br/>If there is a requirement to leave at access at the default level, edit the customized XML file prior to implementing:<br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 <br/><br/>Replace:<br/><br/> &lt;AIXPertArgs&gt;"echo root &gt; /var/adm/cron/at.allow; rm /var/adm/cron/at.deny"&lt;/AIXPertArgs&gt;<br/><br/>With:<br/><br/>&lt;!-- &lt;AIXPertArgs&gt;"echo root &gt; /var/adm/cron/at.allow; rm /var/adm/cron/at.deny"&lt;/AIXPertArgs&gt; --&gt;<br/><br/><b>Default Value:</b> No effect<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure only 'root' exists in /var/adm/cron/at.allow" success="fail">
                            <ecl:command>egrep -v "root" /var/adm/cron/at.allow</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="miscellaneous-enhancements-etc-ftpusers" selected="false">
                <xccdf:title>Miscellaneous Enhancements - /etc/ftpusers </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This change adds the root user to the /etc/ftpusers file, which disables ftp for root.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>This change ensures that direct root ftp access is disabled. As detailed previously, ftp as a service should be disabled. If the service has to be enabled then this change must be implemented to ensure that remote root file transfer access is not enabled. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Add root to the /etc/ftpusers file<br/><br/>Please note the command below is for information only, as the setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>echo "root" &gt;&gt; /etc/ftpusers<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>[[ $(grep -c "root" /etc/ftpusers) -lt "1" ]] &amp;&amp; print "WARNING root has not been added into /etc/ftpusers" || RC=0<br/><br/>The above command should yield the following output:<br/><br/>root <br/><br/><b>Default Value:</b> No effect<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Entry added<br/>Medium Level policy Entry added<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'root' has been added into /etc/ftpusers" success="pass">
                            <ecl:command>grep -x "root" /etc/ftpusers</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="miscellaneous-enhancements-login-herald" selected="false">
                <xccdf:title>Miscellaneous Enhancements - login herald </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This change adds a default herald to <xhtml:code>/etc/security/login.cfg</xhtml:code>.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>This change puts into place a suggested login herald to replace the default entry. As the herald is presented to a user prior to logon, it should not provide any information about the operating system or version. Instead, it should detail a company standard acceptable use policy. This herald can be subsequently tailored to reflect a corporate standard policy.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Add a default login herald to <xhtml:code>/etc/security/login.cfg</xhtml:code><br/><br/>Please note the command below is for information only, as the setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>chsec -f /etc/security/login.cfg -s default -a herald="Unauthorized use of \<br/> this system is prohibited.\nlogin:"<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>lssec -f /etc/security/login.cfg -s default -a herald |grep '^default[[::space::]]herald="Unauthorized use of this system is prohibited.'<br/><br/>The above command should yield the following output:<br/><br/>default herald="Unauthorized use of this system is prohibited.\nlogin:" <br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Herald configured<br/>Medium Level policy Herald configured<br/>Low Level policy 	Herald configured <br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure login herald is set" success="pass">
                            <ecl:command>lssec -f /etc/security/login.cfg -s default -a herald |grep '^default[[::space::]]herald="Unauthorized use of this system is prohibited.'</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="miscellaneous-enhancements-guest-account-removal" selected="false">
                <xccdf:title>Miscellaneous Enhancements - guest account removal </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This change removes the guest user and home directory from the system.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>This change removes the guest user. If a user logs in with a generic username, audit trails are of limited value as it is not necessarily possible to identify who has accessed an account. The guest account should be removed and all users should be given specific logon ids to ensure traceability and accountability.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Remove the guest user<br/><br/>Please note the commands below are for information only, as these settings will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>rmuser -p guest<br/>rm -r /home/guest<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>lsuser guest<br/><br/>The above command should yield the following output:<br/><br/>3004-687 User "guest" does not exist.<br/><br/><b>Default Value:</b> Account exists<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Account removed<br/>Medium Level policy Account removed<br/>Low Level policy 	Account removed <br/><br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure guest user does not exist" success="fail">
                            <ecl:command>grep "guest" /etc/passwd</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="miscellaneous-enhancements-crontab-permissions" selected="false">
                <xccdf:title>Miscellaneous Enhancements - crontab permissions </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This script checks the permissions of all the root crontab entries, to ensure that they are owned and writable by the root user only.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>All root crontab entries must be owned and writable by the root user only. If a script had group or world writable access, it could be replaced or edited with malicious content, which would then subsequently run on the system with root authority.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Ensure that all root crontab entries are owned and writable by root only.<br/><br/>Please note the commands below are for information only, as these settings will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>crontab -l |awk '{print $6}' |grep "^/" |sort -u | while read DIR<br/>do<br/>DIR=${DIR:-$(pwd)}<br/>print "Checking ${DIR}"<br/>while [[ -a ${DIR} ]]<br/>do<br/>[[ "$(ls -ld ${DIR})" = @(????????w? *) ]] &amp;&amp; print " WARNING ${DIR} is world writable"<br/>[[ "$(ls -ld ${DIR})" = @(?????w???? *) ]] &amp;&amp; print " WARNING ${DIR} is group writable"<br/>[[ "$(ls -ld ${DIR} |awk '{print $3}')" != @(root|bin) ]] &amp;&amp; print " WARNING ${DIR} is not owned by root or bin"<br/>DIR=${DIR%/*}<br/>done<br/>done<br/><br/>NOTE: Review the output and manually change the directories, if possible. Directories which are group and/or world writable or not owned by root are marked with WARNING<br/><br/>To manually change permissions on the files or directories:<br/><br/>To remove group writable access:<br/><br/>chmod g-w &lt;name&gt;<br/><br/>To remove world writable access:<br/><br/>chmod o-w &lt;name&gt;<br/><br/>To remove both group and world writable access:<br/><br/>chmod go-w &lt;name&gt;<br/><br/>To change the owner of a file or directory:<br/><br/>chown &lt;new user&gt; &lt;name&gt;<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Execute the following code:<br/><br/>crontab -l |awk '{print $6}' |grep "^/" |sort -u | while read DIR<br/>do<br/>DIR=${DIR:-$(pwd)}<br/>while [[ -a ${DIR} ]]<br/>do<br/>[[ "$(ls -ld ${DIR})" = @(????????w? *) ]] &amp;&amp; print " WARNING ${DIR} is world writable"<br/>[[ "$(ls -ld ${DIR})" = @(?????w???? *) ]] &amp;&amp; print " WARNING ${DIR} is group writable"<br/>[[ "$(ls -ld ${DIR} |awk '{print $3}')" != @(root|bin) ]] &amp;&amp; print " WARNING ${DIR} is not owned by root or bin"<br/>DIR=${DIR%/*}<br/>done<br/>done<br/><br/><b>Default Value:</b> No effect<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Permissions checked<br/>Medium Level policy Permissions checked<br/>Low Level policy 	Permissions checked<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure all files executed by crontab lack group/other write permissions">
                            <ecl:command>find `crontab -l | awk {'print $6'} | grep "^/"` -type f \( -perm -g+w -o -perm -o+w \) -ls</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="miscellaneous-enhancements-default-umask" selected="false">
                <xccdf:title>Miscellaneous Enhancements - default umask </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This changes the default user umask in <xhtml:code>/etc/security/user</xhtml:code>.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The default user umask will be set to 027. This means that the default file creation permissions give read and write access to the user, read access to the group and no access to other. The default directory creation permissions give read, write and execute access to the user, read and execute to the group and no access to other. This is the recommended umask setting, as world access should be explicitly defined and not added during default creation. Where possible, access to files and directories should be managed via group membership and ACLs, rather than opening up directory structures for world access. In particular, world write access should be avoided. <br/><br/>Consideration should be given to further securing the default user umask by implementing 077. This means that only the user has read/write access to the files and directories they create. Group and/or world access would need to be explicitly defined.<br/><br/>As part of this change all explicitly defined umask user settings are removed.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Add the umask attribute to the default user stanza in <xhtml:code>/etc/security/user</xhtml:code>.<br/><br/>Please note the command below is for information only, as the setting will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>chsec -f /etc/security/user -s default -a umask=027<br/>If a umask of 077 is required, reflect the following changes in the AIX Security Expert XML files:<br/><br/>AIX 5.3<br/><br/>Replace:<br/>&lt;AIXPertArgs&gt;umask=27 ALL umaskmls&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;AIXPertArgs&gt;umask=77 ALL umaskmls&lt;/AIXPertArgs&gt;<br/><br/>AIX 6.1<br/><br/>Replace:<br/>&lt;AIXPertArgs&gt; umask=27 ALL hls_umask&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;AIXPertArgs&gt; umask=77 ALL hls_umask&lt;/AIXPertArgs&gt;<br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/>lssec -f /etc/security/user -s default -a umask<br/><br/>The above command should yield the following output:<br/><br/>default umask=27<br/><br/><b>Reversion:</b><br/>If there is a requirement to not change the default umask value, edit the customized XML file prior to implementing:<br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 <br/><br/>AIX 5.3<br/><br/>Replace:<br/>&lt;AIXPertArgs&gt;umask=27 ALL umaskmls&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;umask=27 ALL umaskmls&lt;/AIXPertArgs&gt; --&gt;<br/><br/>AIX 6.1<br/><br/>Replace:<br/>&lt;AIXPertArgs&gt; umask=27 ALL hls_umask&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt; umask=27 ALL hls_umask&lt;/AIXPertArgs&gt; --&gt;<br/><br/><b>Default Value:</b> 022<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	077<br/>Medium Level policy 027<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure default umask set to '027'">
                            <ecl:command>lssec -f /etc/security/user -s default -a umask</ecl:command>
                            <ecl:line-selection op="pm" value="^default\s+umask=27\s*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="miscellaneous-enhancements-disabling-core-dumps" selected="false">
                <xccdf:title>Miscellaneous Enhancements - disabling core dumps </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This change disables core dumps in the default user stanza of /etc/security/limits and also ensures the fullcore kernel parameter is set to false.<br/><br/>Disabling core dumps is not a managed process within the default AIX Security Expert framework. This change is managed as a customized entry in the XML files.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The creation of core dumps can reveal pertinent system information, potentially even passwords, within the core file. The ability to create a core dump is also a vulnerability to be exploited by a hacker. <br/><br/>The commands below disable core dumps by default, but they may be specifically enabled for a particular user in /etc/security/limits. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Change the default user stanza attributes core and core_hard in /etc/security/limits and the set the fullcore kernel parameter to false.<br/><br/>Please note the commands below are for information only, as the settings will be automatically applied when the customized AIX Security Expert XML file is implemented.<br/><br/>chsec -f /etc/security/limits -s default -a core=0 -a core_hard=0<br/>chdev -l sys0 -a fullcore=false<br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command to validate the /etc/security/limits changes:<br/><br/>lssec -f /etc/security/limits -s default -a core -a core_hard<br/><br/>The above command should yield the following output:<br/><br/>default core=0 core_hard=0<br/><br/>Ensure that the fullcore kernel parameter has been set to false: <br/><br/>lsattr -El sys0 -a fullcore<br/><br/>The above command should yield the following output:<br/><br/>fullcore false Enable full CORE dump True<br/><br/><b>Reversion:</b><br/>If there is a requirement to enable core dumps, edit the customized XML file prior to implementing:<br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 <br/><br/>Replace:<br/>&lt;AIXPertArgs&gt;"chsec -f /etc/security/limits -s default -a core=0 -a core_hard=0; chdev -l sys0 -a fullcore=false"&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;"chsec -f /etc/security/limits -s default -a core=0 -a core_hard=0; chdev -l sys0 -a fullcore=false"&lt;/AIXPertArgs&gt; --&gt;<br/><br/><b>Default Value:</b> Core dumps enabled<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	N/A<br/>Medium Level policy N/A<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure 'core' and 'core_hard' are set to '0''">
                                <ecl:command>lssec -f /etc/security/limits -s default -a core -a core_hard</ecl:command>
                                <ecl:line-selection op="pm" value="^default\s+core=0\s+core_hard=0\s*$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure 'fullcore' is disabled">
                                <ecl:command>lsattr -El sys0 -a fullcore</ecl:command>
                                <ecl:line-selection op="pm" value="^fullcore\s+false\s+Enable\s+full\s+CORE\s+dump\s+True\s*$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="miscellaneous-enhancements-aix-auditing" selected="false">
                <xccdf:title>Miscellaneous Enhancements - AIX Auditing </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This change configures AIX auditing in bin mode. If auditing is already configured, this enhancement is not implemented.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>AIX auditing provides a framework within which to capture pertinent system and security related information, such as failed login attempts, cron usage etc. It is recommended that auditing is enabled as part of a group of measures designed to provide enhanced logging of system and security changes.<br/> <br/>Further information regarding the setup and management of accounting and auditing can be found in the "Accounting and Auditing for AIX 5L Redbook":<br/><br/>http://www.redbooks.ibm.com/redbooks/pdfs/sg246396.pdf<br/>  <br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Configure AIX auditing in-line with the High Level AIX Security Expert policy.<br/><br/>Please note the commands below are for information only, as the commands will be automatically executed when the customized AIX Security Expert XML file is implemented.<br/><br/>Create a /audit filesystem, at least 100 MB in size. The script always creates a standard jfs filesystem. If the /audit filesystem exists, this step is skipped:<br/><br/>mklv -y &lt;LV name&gt; -t jfs -u 1 -c 1 rootvg 1 hdisk0<br/>crfs -v jfs -d auditlv -m /audit -A yes -t no<br/>mount /audit<br/>Reflect the following configuration in the /etc/security/audit/config file:<br/><br/>vi /etc/security/audit/config<br/><br/>Add in:<br/>start:<br/>            binmode = on<br/>            streammode = off<br/>bin:<br/>           	trail = /audit/trail<br/>            bin1 = /audit/bin1<br/>            bin2 = /audit/bin2<br/>            binsize = 10240<br/>            cmds = /etc/security/audit/bincmds<br/><br/>Add the auditing entries for root and all other users below the pre-defined audit classes:<br/><br/> users:<br/>        root = general,SRC,mail,cron,tcpip,ipsec,lvm      <br/>        &lt;user 1&gt; = general,SRC,cron,tcpip<br/>	  &lt;user 2&gt; = general,SRC,cron,tcpip<br/>        etc.<br/>Update the /usr/lib/security/mkuser.default auditclasses entry to ensure that auditing is set up for any newly created users:<br/><br/>chsec -f /usr/lib/security/mkuser.default -s user --a<br/>auditclasses=general,SRC,cron,tcpip<br/><br/>A cron job is implemented to monitor the free space in /audit, running hourly, to ensure that /audit does not fill up. If /audit is greater than 90% used, /audit/trail is moved to /audit/trailOneLevelBack:<br/><br/>crontab --e<br/>Add in:<br/><br/>0 * * * * /etc/security/aixpert/bin/cronaudit <br/><br/>NOTE: The implementation of a script to suit internal security policy is recommended to further enhance the log rotation process.<br/><br/>Add the audit startup command into <xhtml:code>/etc/inittab</xhtml:code>:<br/><br/>mkitab "audit:2:boot:audit start &gt; /dev/console 2&gt;&amp;1 # Start audit"<br/>Audit:<br/>Ensure that the /audit filesystem has been created and mounted:<br/><br/>df -k /audit<br/><br/>The above command should yield the following output:<br/><br/>/dev/auditlv       262144    261776    1%        4     1% /audit<br/><br/>Validate the configuration in the /etc/security/audit/config file, this should match the changes made in the remediation section:<br/><br/>cat /etc/security/audit/config<br/>Ensure that the /usr/lib/security/mkuser.default auditclasses entry has been updated:<br/><br/>lssec -f /usr/lib/security/mkuser.default -s user --a<br/>auditclasses<br/><br/>The above command should yield the following output:<br/><br/>user auditclasses=general,SRC,cron,tcpip<br/><br/>Ensure that the cron audit rotation script has been implemented:<br/><br/>crontab -l |grep "cronaudit"<br/>The above command should yield the following output:<br/><br/>0 * * * * /etc/security/aixpert/bin/cronaudit <br/><br/>Ensure that the audit startup line has been added into <xhtml:code>/etc/inittab</xhtml:code>:<br/><br/>lsitab audit<br/><br/>This should echo:<br/><br/>audit:2:boot:audit start &gt; /dev/console 2&gt;&amp;1 # Start audit<br/><br/><b>Reversion:</b><br/>If there is a requirement to not implement auditing, edit the customized XML file prior to implementing:<br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 <br/><br/>AIX 5.3<br/><br/>Replace:<br/>&lt;AIXPertArgs&gt;h hls_binaudit&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;h hls_binaudit/AIXPertArgs&gt; --&gt;<br/><br/>AIX 6.1<br/><br/>Replace:<br/>&lt;AIXPertArgs&gt;h binaudithls&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;h binaudithls&lt;/AIXPertArgs&gt; --&gt;<br/><br/><b>Default Value:</b> Auditing not configured<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Auditing configured <br/>Medium Level policy Auditing configured<br/>Low Level policy </xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that the /audit filesystem has been created and mounted:<br/><br/>df -k /audit<br/><br/>The above command should yield the following output:<br/><br/>/dev/auditlv       262144    261776    1%        4     1% /audit<br/><br/>Validate the configuration in the /etc/security/audit/config file, this should match the changes made in the remediation section:<br/><br/>cat /etc/security/audit/config<br/>Ensure that the /usr/lib/security/mkuser.default auditclasses entry has been updated:<br/><br/>lssec -f /usr/lib/security/mkuser.default -s user --a<br/>auditclasses<br/><br/>The above command should yield the following output:<br/><br/>user auditclasses=general,SRC,cron,tcpip<br/><br/>Ensure that the cron audit rotation script has been implemented:<br/><br/>crontab -l |grep "cronaudit"<br/>The above command should yield the following output:<br/><br/>0 * * * * /etc/security/aixpert/bin/cronaudit <br/><br/>Ensure that the audit startup line has been added into <xhtml:code>/etc/inittab</xhtml:code>:<br/><br/>lsitab audit<br/><br/>This should echo:<br/><br/>audit:2:boot:audit start &gt; /dev/console 2&gt;&amp;1 # Start audit<br/><br/><b>Reversion:</b><br/>If there is a requirement to not implement auditing, edit the customized XML file prior to implementing:<br/><br/>vi /etc/security/aixpert/custom/custom_aix&lt;OS&gt;.xml                                                 <br/><br/>AIX 5.3<br/><br/>Replace:<br/>&lt;AIXPertArgs&gt;h hls_binaudit&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;h hls_binaudit/AIXPertArgs&gt; --&gt;<br/><br/>AIX 6.1<br/><br/>Replace:<br/>&lt;AIXPertArgs&gt;h binaudithls&lt;/AIXPertArgs&gt;<br/><br/>With:<br/>&lt;!-- &lt;AIXPertArgs&gt;h binaudithls&lt;/AIXPertArgs&gt; --&gt;<br/><br/><b>Default Value:</b> Auditing not configured<br/><br/><b>Default AIX Security Expert policy values:</b><br/>High Level policy 	Auditing configured <br/>Medium Level policy Auditing configured<br/>Low Level policy 	Auditing configured<br/>2. Non AIX Security Expert Managed Recommendations<br/>This section of the benchmark will focus on the recommendations which are not automatically applied during the implementation of the AIX Security Expert customized XML file. A number of these recommendations are not scorable, in that the implementation needs to be tailored to suit the needs of a given environment, which also makes compliance checking impossible. <br/><br/>The following recommendations are detailed in this section:<br/><br/>	Configuring syslog<br/>	Secure remote access<br/>	Configuring sendmail<br/>	Configuring CDE<br/>	Configuring NFS<br/>	Configuring SNMP<br/>	TCP Wrappers<br/>	File and directory permissions and ownership<br/>	Privileged command management - Enhanced RBAC and sudo<br/>	Encrypted Filesystem (EFS) <br/>	Trusted Execution<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure '/audit' file system exists" success="pass">
                                <ecl:command>df -k /audit</ecl:command>
                                <ecl:line-selection op="pm" value="^\s*/dev/auditlv\s+\d+\s+\d+\s+\d+%\s+\d+\s+\d+%\s+/audit\s*$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:Rule>
        </xccdf:Group>
    </xccdf:Group>
    <xccdf:Group id="non-aix-security-expert-managed-recommendations">
        <xccdf:title>Non AIX Security Expert Managed Recommendations</xccdf:title>
        <xccdf:description>
            <xhtml:div>
                <xhtml:p>This section of the benchmark will focus on the recommendations which are not automatically applied during the implementation of the AIX Security Expert customized XML file. A number of these recommendations are not scorable, in that the implementation needs to be tailored to suit the needs of a given environment, which also makes compliance checking impossible.</xhtml:p>
                <xhtml:p>The following recommendations are detailed in this section:</xhtml:p>
                <ul>
                    <li>Configuring syslog</li>
                    <li>Secure remote access</li>
                    <li>Configuring sendmail</li>
                    <li>Configuring CDE</li>
                    <li>Configuring NFS</li>
                    <li>Configuring SNMP</li>
                    <li>TCP Wrappers</li>
                    <li>File and directory permissions and ownership</li>
                    <li>Privileged command management  Enhanced RBAC and sudo</li>
                    <li>Encrypted Filesystem (EFS)</li>
                    <li>Trusted Execution</li>
                    <li>General Permissions Management</li>
                </ul>
            </xhtml:div>
        </xccdf:description>
        
        <xccdf:Group id="configuring-syslog">
            <xccdf:title>Configuring syslog </xccdf:title>
            
            <xccdf:Rule id="configuring-syslog-local-logging" selected="false">
                <xccdf:title>Configuring syslog - local logging </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This recommendation implements a local syslog configuration.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>Establishing a logging process via syslog provides system and security administrators with pertinent information relating to: login, mail, daemon, user and kernel activity. The recommendation is to enable local syslog logging, with a weekly rotation policy in a four weekly cycle. The log rotation isolates historical data which can be reviewed retrospectively if an issue is uncovered at a later date.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Explicitly define a log file for the auth.info output in /etc/syslog.conf:<br/><br/>printf "auth.info\t\t/var/adm/authlog rotate time 1w files 4\n" &gt;&gt; /etc/syslog.conf<br/><br/>NOTE: This ensures that remote login, sudo or su attempts are logged separately <br/><br/>Create the authlog file and make it readable by root only:<br/><br/>touch /var/adm/authlog <br/>chown root:system /var/adm/authlog<br/>chmod u=rw,go= /var/adm/authlog<br/><br/>Create an entry in /etc/syslog.conf to capture all other output of level info or higher, excluding authentication information, as this is to be captured within /var/adm/authlog:<br/><br/>printf "*.info;auth.none\t/var/adm/syslog rotate time 1w files 4\n" &gt;&gt; /etc/syslog.conf<br/><br/>Create the syslog file:<br/><br/>touch /var/adm/syslog<br/>chmod u=rw,g=r,o= /var/adm/syslog<br/>Refresh syslogd to force the daemon to read the edited /etc/syslog.conf:<br/><br/>refresh -s syslogd<br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that the log entries have been added successfully:<br/><br/>tail -2 /etc/syslog.conf<br/><br/>The above command should yield the following output:<br/><br/>auth.info               /var/adm/authlog rotate time 1w files 4<br/>*.info;auth.none        /var/adm/syslog rotate time 1w files 4<br/><br/>Check that the authlog and syslog files have been created:<br/><br/>ls -l /var/adm/authlog /var/adm/syslog<br/><br/><b>Reversion:</b><br/>Edit the /etc/syslog.conf and the remove the authlog and syslog entries: <br/><br/>vi /etc/syslog.conf<br/><br/>Remove:<br/><br/>auth.info               /var/adm/authlog rotate time 1w files 4<br/>*.info;auth.none        /var/adm/syslog rotate time 1w files 4<br/>Refresh syslogd to force the daemon to read the edited /etc/syslog.conf:<br/><br/>refresh -s syslogd<br/><br/>Delete the authlog and syslog files:<br/><br/>rm /var/adm/authlog /var/adm/syslog<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure 'auth.info' rotation is configured" success="pass">
                                <ecl:command>egrep "^[[:space:]]*auth\.info[[:space:]]+/var/adm/authlog[[:space:]]+rotate[[:space:]]+time[[:space:]]+1w[[:space:]]+files[[:space:]]+4[[:space:]]*$" /etc/syslog.conf</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure '*.info;auth.none' rotation is configured" success="pass">
                                <ecl:command>egrep "^[[:space:]]*\*\.info;auth\.none[[:space:]]+/var/adm/syslog[[:space:]]+rotate[[:space:]]+time[[:space:]]+1w[[:space:]]+files[[:space:]]+4[[:space:]]*$" /etc/syslog.conf</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="configuring-syslog-remote-logging" selected="false">
                <xccdf:title>Configuring syslog - remote logging </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This recommendation implements a remote syslog configuration.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>To further enhance the local syslog logging process, it is recommended that syslog information, in particular that generated by the auth facility, is logged remotely. This recommendation assumes that a remote and secure syslog server is available on the network. If this is not the case, please skip to the next recommendation.<br/><br/>The primary reason for logging remotely is to provide an un-editable audit trail of system access. If a hacker were to access a system and gain super user authority it would be easy to edit local files and remove all traces of access, providing the system administrator with no way of identifying the individual or group responsible. If the log data is sent remotely at the point of access, these remote logs can then be reconciled with local data to identify tampered and altered files. The logs can also be used as evidence in any subsequent prosecution.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Explicitly define a remote host for auth.info data in /etc/syslog.conf (enter the remote host IP address in the example below):<br/><br/>printf "auth.info\t\t@&lt;IP address of remote syslog server&gt;\n" &gt;&gt; \ /etc/syslog.conf<br/><br/>NOTE: This ensures that remote login, sudo or su attempts are logged separately <br/><br/>Create a remote host entry in /etc/syslog.conf to capture all other output of level info or higher:<br/><br/>printf "*.info;auth.none\t@&lt;IP address of remote syslog server&gt;\n" &gt;&gt; \ /etc/syslog.conf<br/>Refresh syslogd to force the daemon to read the edited /etc/syslog.conf:<br/><br/>refresh -s syslogd<br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that the log entries have been added successfully:<br/><br/>tail -2 /etc/syslog.conf<br/><br/>The above command should yield the following output:<br/><br/>auth.info               @&lt;IP address of remote syslog server&gt;<br/>*.info;auth.none        @&lt;IP address of remote syslog server&gt;<br/><br/><b>Reversion:</b><br/>Edit the /etc/syslog.conf and the remove the remote syslog entries: <br/><br/>vi /etc/syslog.conf<br/><br/>Remove:<br/><br/>auth.info               @&lt;IP address of remote syslog server&gt;<br/>*.info;auth.none        @&lt;IP address of remote syslog server&gt;<br/>Refresh syslogd to force the daemon to read the edited /etc/syslog.conf:<br/><br/>refresh -s syslogd<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure 'auth.info' is sent to one or more remote hosts" success="pass">
                                <ecl:command>egrep "^[[:space:]]*auth\.info[[:space:]]+@.*[[:space:]]*$" /etc/syslog.conf</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure '*.info;auth.none' is sent to one or more remote hosts" success="pass">
                                <ecl:command>egrep "^[[:space:]]*\*\.info;auth\.none[[:space:]]+@.*[[:space:]]*$" /etc/syslog.conf</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="configuring-syslog-remote-messages" selected="false">
                <xccdf:title>Configuring syslog - remote messages </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This recommendation prevents the local syslogd daemon from accepting messages from other hosts on the network.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>Apart from a central syslog server, all other hosts should not accept remote syslog messages. By default the syslogd daemon accepts all remote syslog messages as no authentication is required. This means that a hacker could flood a server with syslog messages and potentially fill up the /var filesystem. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>If the server does not act as a central syslog server, suppress the logging of messages originating from remote servers:<br/><br/>chssys -s syslogd -a "-r"<br/>Re-cycle syslogd to activate the configuration change:<br/><br/>stopsrc -s syslogd<br/>startsrc -s syslogd<br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that daemon is running with the newly updated configuration:<br/><br/>ps -ef |grep "syslogd"<br/><br/>The above command should yield the following output:<br/><br/>  root  57758  70094   0 10:22:08      -  0:00 /usr/sbin/syslogd -r<br/><br/>NOTE: The -r flag should be present at the end out of the output. <br/><br/><b>Reversion:</b><br/>Remove the suppression of remote syslog messages:<br/><br/>chssys -s syslogd -a ""<br/>Re-cycle syslogd to activate the configuration change:<br/><br/>stopsrc -s syslogd<br/>startsrc -s syslogd<br/><br/><b>Default Value:</b> Not Configured<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'syslogd' is running with remote messages disabled" success="pass">
                            <ecl:command>ps -ef | grep -v grep | grep "syslogd -r"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
        </xccdf:Group>
        
        <xccdf:Group id="secure-remote-access">
            <xccdf:title>Secure Remote Access</xccdf:title>
            
            <xccdf:Rule id="configuring-ssh-installation" selected="false">
                <xccdf:title>Configuring SSH - installation </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommendation is to install OpenSSH and OpenSSL libraries from the expansion pack media, or the IBM supported packages downloaded from the internet.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>This is the preferred mechanism for remote client access as it provides socket level encryption, via OpenSSL. If any clear text password service is required for legacy connections the two services may sit side by side, with SSH utilized wherever possible. Ideally, SSH should be the only available remote access mechanism.<br/><br/>If the software is not available from the expansion pack media, download from the following locations.<br/><br/>OpenSSH:<br/><br/>http://sourceforge.net/projects/openssh-aix/<br/><br/>OpenSSL:<br/><br/>https://www14.software.ibm.com/webapp/iwm/web/preLogin.do?source=aixbp<br/><br/>NOTE: A login is required to download OpenSSL.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Place the OpenSSH and OpenSSL software into a convenient location, such as /tmp and install via:<br/><br/>/usr/lib/instl/sm_inst installp_cmd -a -Q -d /tmp -f openssl,openssh.license,openssh.base,openssh.man.en_US,openssh.msg.en_US -c -N -g -X -G -Y<br/>NOTE: If the software is not located in /tmp, reflect the actual location in the command above.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the installation of the software:<br/><br/>lslpp -L |egrep "openssh|ssl"<br/><br/>The above command should yield the following output:<br/><br/>  openssh.base.client     4.3.0.5300    C     F    Open Secure Shell Commands<br/>  openssh.base.server     4.3.0.5300    C     F    Open Secure Shell Server<br/>  openssh.license         4.3.0.5300    C     F    Open Secure Shell License<br/>  openssh.msg.en_US       4.3.0.5300    C     F    Open Secure Shell Messages <br/>  openssl.base             0.9.8.601    C     F    Open Secure Socket Layer<br/>  openssl.license          0.9.8.601    C     F    Open Secure Socket License<br/>  openssl.man.en_US        0.9.8.601    C     F    Open Secure Socket Layer<br/>  openssl                   0.9.7g-1    C     R    Secure Sockets Layer and<br/>NOTE: The version numbers may differ based on the source of the software<br/>Ensure that the SSH daemon is set to automatically start during system IPL:<br/><br/>ls -l /etc/rc.d/rc2.d/Ssshd | awk '{print $1 " " $3 " " $4 " " $9}'<br/><br/>The above command should yield the following output:<br/><br/>-r-xr-xr-x   root     system          Ssshd<br/><br/><b>Reversion:</b><br/>De-install the OpenSSL and OpenSSH software:<br/><br/>installp -u openssh* openssl<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure permissions on '/etc/rc.d/rc2.d/Ssshd' are u+rx,g-r,o-r or more restrictive" success="pass">
                            <ecl:command>ls -l /etc/rc.d/rc2.d/Ssshd | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                            <ecl:line-selection op="pm" value="^-r(w|-)x(r|-)-(x|-)(r|-)-(x|-)\s+root\s+system\s*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="configuring-ssh-disabling-direct-root-access" selected="false">
                <xccdf:title>Configuring SSH - disabling direct root access </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommendation is to edit the /etc/ssh/sshd_config file to disable direct root login. By default direct root login via SSH is enabled.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>All root access should be facilitated through a local logon with a unique and identifiable user ID and then via the su command once locally authenticated. Direct root login is extremely insecure and offers little in the way of audit trailing for accountability. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Edit the /etc/ssh/sshd_config file and disable direct root login for SSH:<br/><br/>vi /etc/ssh/sshd_config<br/><br/>Replace:<br/><br/><xhtml:code>#PermitRootLogin yes<br/><br/>With:<br/><br/>PermitRootLogin no<br/><br/>Re-cycle the sshd daemon to pick up the configuration changes:<br/><br/>stopsrc -s sshd<br/>startsrc -s sshd<br/><br/></xhtml:code></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that the PermitRootLogin parameter has been changed:<br/><br/>grep "^PermitRootLogin[[::blank::]]" /etc/ssh/sshd_config<br/><br/>The above command should yield the following output:<br/><br/>PermitRootLogin no<br/><br/><b>Default Value:</b> PermitRootLogin yes <br/>References:<br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'PermitRootLogin' is set to 'no' in /etc/ssh/sshd_config" success="pass">
                            <ecl:command>egrep '^PermitRootLogin[[:space:]]+no[[:space:]]*$' /etc/ssh/sshd_config</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="configuring-ssh-server-protocol-2" selected="false">
                <xccdf:title>Configuring SSH - server protocol 2 </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommendation is to edit the /etc/ssh/sshd_config file and allow the SSH2 protocol only. By default the SSH1 protocol is also available. This is the SSH server configuration file.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>There are publicly known vulnerabilities in SSH1 protocol, because of which the SSH1 protocol was deprecated in early 2001. SSH2 is a complete re-write of SSH1 with additional security features. All SSH connections should communicate over the SSH2 protocol. There are numerous benefits of utilizing SSH2 over SSH1, these include: an enhanced and stronger crypto integrity check and support for RSA and DSA keys, rather than just RSA key support in SSH1. The recommendation is to edit the /etc/ssh/sshd_config file and allow the SSH2 protocol only. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Edit the /etc/ssh/sshd_config file and explicitly define the SSH2 protocol:<br/><br/>vi /etc/ssh/sshd_config<br/><br/>Replace:<br/><br/><xhtml:code>#Protocol 2,1<br/><br/>With:<br/><br/>Protocol 2<br/><br/>Re-cycle the sshd daemon to pick up the configuration changes:<br/><br/>stopsrc -s sshd<br/>startsrc -s sshd<br/><br/></xhtml:code></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that the Protocol parameter has been changed:<br/><br/>grep "^Protocol[[::blank::]]" /etc/ssh/sshd_config<br/><br/>The above command should yield the following output:<br/><br/>Protocol 2<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'Protocol' is set to '2' in /etc/ssh/sshd_config" success="pass">
                            <ecl:command>egrep '^Protocol[[:space:]]+2[[:space:]]*$' /etc/ssh/sshd_config</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="configuring-ssh-client-protocol-2" selected="false">
                <xccdf:title>Configuring SSH - client protocol 2 </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommendation is to edit the /etc/ssh/ssh_config file and allow the SSH2 protocol only. By default the SSH1 protocol is also available. This is the SSH client configuration file. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>There are publicly known vulnerabilities in SSH1 protocol, because of which the SSH1 protocol was deprecated in early 2001. SSH2 is a complete re-write of SSH1 with additional security features. All SSH connections should communicate over the SSH2 protocol. There are numerous benefits of utilizing SSH2 over SSH1, these include: an enhanced and stronger crypto integrity check and support for RSA and DSA keys, rather than just RSA key support in SSH1. The recommendation is to edit the /etc/ssh/ssh_config file and allow the SSH2 protocol only. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Edit the /etc/ssh/ssh_config file and explicitly define the SSH2 protocol:<br/><br/>vi /etc/ssh/ssh_config<br/><br/>Replace:<br/><br/><xhtml:code># Protocol 2,1<br/><br/>With:<br/><br/>Protocol 2<br/><br/>Re-cycle the sshd daemon to pick up the configuration changes:<br/><br/>stopsrc -s sshd<br/>startsrc -s sshd<br/><br/></xhtml:code></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that the Protocol parameter has been changed:<br/><br/>grep "^Protocol[[::blank::]]" /etc/ssh/ssh_config<br/><br/>The above command should yield the following output:<br/><br/>Protocol 2<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'Protocol' is set to '2' in /etc/ssh/ssh_config" success="pass">
                            <ecl:command>egrep '^Protocol[[:space:]]+2[[:space:]]*$' /etc/ssh/ssh_config</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="configuring-ssh-banner-configuration" selected="false">
                <xccdf:title>Configuring SSH - banner configuration </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommendation is to edit the /etc/ssh/sshd_config file and configure a path to a login herald message.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The login herald configured previously is not displayed during the initiation of a new SSH connection. Prior to a password being entered the user should accept the terms and conditions of the corporate acceptable usage policy. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Create an SSH banner file:<br/><br/>printf "Unauthorized use of this system is prohibited.\n" &gt; /etc/ssh/ssh_banner<br/><br/>NOTE: The content of the banner file can reflect any internal acceptable usage policy standards<br/><br/>Edit the /etc/ssh/sshd_config file and customize the Banner parameter:<br/><br/>vi /etc/ssh/sshd_config<br/><br/>Replace:<br/><br/><xhtml:code>#Banner /some/path<br/><br/>With:<br/><br/>Banner /etc/ssh/ssh_banner<br/><br/>Re-cycle the sshd daemon to pick up the configuration changes:<br/><br/>stopsrc -s sshd<br/>startsrc -s sshd<br/><br/></xhtml:code></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that the Banner parameter has been changed:<br/><br/>grep "^Banner[[::blank::]]" /etc/ssh/sshd_config<br/><br/>The above command should yield the following output:<br/><br/>Banner /etc/ssh/ssh_banner<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'Banner' is set to '/etc/ssh/ssh_banner' in /etc/ssh/sshd_config" success="pass">
                            <ecl:command>egrep '^Banner[[:space:]]+/etc/ssh/ssh_banner[[:space:]]*$' /etc/ssh/sshd_config</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="configuring-ssh-ignore-shosts-and-rhosts" selected="false">
                <xccdf:title>Configuring SSH - ignore .shosts and .rhosts </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommendation is to edit the /etc/ssh/sshd_config file and set the IgnoreRhosts parameter to ignore .shosts and .rhosts files<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>A user can logon to a remote system without authenticating themselves if .rhosts or .shosts files exist in the remote home directory and if the client machine name and user name are present in these files. This method is fundamentally insecure as the local system can be exploited by IP, DNS (Domain Name Server) and routing spoofing attacks. Additionally, this authentication method relies on the integrity of the client machine. These weaknesses have been known and exploited for a long time. Since this authentication method is not secure, it must be disabled.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Edit the /etc/ssh/sshd_config file to disable the .shosts and .rhosts authentication parameter:<br/><br/>vi /etc/ssh/sshd_config<br/><br/>Replace:<br/><br/><xhtml:code>#IgnoreRhosts yes<br/><br/>With:<br/><br/>IgnoreRhosts yes<br/><br/>Re-cycle the sshd daemon to pick up the configuration changes:<br/><br/>stopsrc -s sshd<br/>startsrc -s sshd<br/><br/></xhtml:code></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that the IgnoreRhosts parameter has been changed:<br/><br/>grep "^IgnoreRhosts[[::blank::]]" /etc/ssh/sshd_config<br/><br/>The above command should yield the following output:<br/><br/>IgnoreRhosts yes<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'IgnoreRhosts' is set to 'yes' in /etc/ssh/sshd_config" success="pass">
                            <ecl:command>egrep '^IgnoreRhosts[[:space:]]+yes[[:space:]]*$' /etc/ssh/sshd_config</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="configuring-ssh-disable-null-passwords" selected="false">
                <xccdf:title>Configuring SSH - disable null passwords </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommendation is to edit the /etc/ssh/sshd_config file to ensure that the SSH daemon does not authenticate users with a null password.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>If password authentication is used and an account has an empty password, the SSH server must be configured to disallow access to the account. Permitting empty passwords could create an easy path of access for hackers to enter the system.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Edit the /etc/ssh/sshd_config file to disable the acceptance null passwords:<br/><br/>vi /etc/ssh/sshd_config<br/><br/>Replace:<br/><br/><xhtml:code>#PermitEmptyPasswords no<br/><br/>With:<br/><br/><br/>PermitEmptyPasswords no<br/><br/>Re-cycle the sshd daemon to pick up the configuration changes:<br/><br/>stopsrc -s sshd<br/>startsrc -s sshd<br/><br/></xhtml:code></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that the PermitEmptyPasswords parameter has been changed:<br/><br/>grep "^PermitEmptyPasswords[[::blank::]]" /etc/ssh/sshd_config<br/><br/>The above command should yield the following output:<br/><br/>PermitEmptyPasswords no<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'PermitEmptyPasswords' is set to 'no' in /etc/ssh/sshd_config" success="pass">
                            <ecl:command>egrep '^PermitEmptyPasswords[[:space:]]+no[[:space:]]*$' /etc/ssh/sshd_config</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="configuring-ssh-disallow-host-based-authentication" selected="false">
                <xccdf:title>Configuring SSH - disallow host based authentication </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommendation is to edit the /etc/ssh/sshd_config file to ensure that host-based authentication is disallowed.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>Using host-based authentication, any user on a trusted host can log into another host on which this feature is enabled. Since this feature depends only on system authentication and not on user authentication, it must be disabled.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Edit the /etc/ssh/sshd_config file to ensure that host based authentication is disallowed:<br/><br/>vi /etc/ssh/sshd_config<br/><br/>Replace:<br/><br/><xhtml:code>#HostbasedAuthentication no<br/><br/>With:<br/><br/>HostbasedAuthentication no<br/><br/>Re-cycle the sshd daemon to pick up the configuration changes:<br/><br/>stopsrc -s sshd<br/>startsrc -s sshd<br/><br/></xhtml:code></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that the HostbasedAuthentication parameter has been changed:<br/><br/>grep "^HostbasedAuthentication[[::blank::]]" /etc/ssh/sshd_config<br/><br/>The above command should yield the following output:<br/><br/>HostbasedAuthentication no<br/><br/><b>Reversion:</b><br/>Revert to the default setting for the HostBasedAuthentication parameter:<br/><br/>vi /etc/ssh/sshd_config<br/><br/>Replace:<br/><br/>HostbasedAuthentication no<br/><br/>With:<br/><br/><xhtml:code># HostbasedAuthentication no<br/>	<br/>Re-cycle the sshd daemon to pick up the configuration changes:<br/><br/>stopsrc -s sshd<br/>startsrc -s sshd<br/><br/></xhtml:code></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'HostbasedAuthentication' is set to 'no' in /etc/ssh/sshd_config" success="pass">
                            <ecl:command>egrep '^HostbasedAuthentication[[:space:]]+no[[:space:]]*$' /etc/ssh/sshd_config</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="configuring-ssh-set-privilege-separation" selected="false">
                <xccdf:title>Configuring SSH - set privilege separation </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommendation is to edit the /etc/ssh/sshd_config file to ensure that privilege separation is enabled.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>Setting privilege separation helps to secure remote ssh access. Once a user is authenticated the sshd daemon creates a child process which has the privileges of the authenticated user and this then handles incoming network traffic. The aim of this is to prevent privilege escalation through the initial root process. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Edit the /etc/ssh/sshd_config file to ensure that privilege separation is enabled:<br/><br/>vi /etc/ssh/sshd_config<br/><br/>Replace:<br/><br/><xhtml:code>#UsePrivilegeSeparation yes<br/><br/>With:<br/><br/>UsePrivilegeSeparation yes<br/><br/>Re-cycle the sshd daemon to pick up the configuration changes:<br/><br/>stopsrc -s sshd<br/>startsrc -s sshd<br/><br/></xhtml:code></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that the UsePrivilegeSeparation parameter has been changed:<br/><br/>grep "^UsePrivilegeSeparation[[::blank::]]" /etc/ssh/sshd_config<br/><br/>The above command should yield the following output:<br/><br/>UsePrivilegeSeparation yes<br/><br/><b>Default Value:</b> UsePrivilegeSeparation yes <br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'UsePrivilegeSeparation' is set to 'yes' in /etc/ssh/sshd_config" success="pass">
                            <ecl:command>egrep '^UsePrivilegeSeparation[[:space:]]+yes[[:space:]]*$' /etc/ssh/sshd_config</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="configuring-ssh-sshd_config-permissions-lockdown" selected="false">
                <xccdf:title>Configuring SSH - sshd_config permissions lockdown </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The /etc/ssh/sshd_config file defines SSH server behavior.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The SSH daemon reads the configuration information from this file and includes the authentication mode and cryptographic levels to use during SSH communication. The recommended value is not to provide any access rights for any user, other than the owner of the file.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Change the permissions of the /etc/ssh/sshd_config file to ensure that only the owner can read and write to the file:<br/><br/>chmod u=rw,go= /etc/ssh/sshd_config<br/><br/>Note: Removing other read permissions on /etc/ssh/sshd_config will break SFTP functionality.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that the /etc/ssh/sshd_config permissions have been successfully changed:<br/><br/>ls -l /etc/ssh/sshd_config | awk '{print $1 " " $3 " " $4 " " $9}'<br/><br/>The above command should yield the following output:<br/><br/>-rw-------   root     system         /etc/ssh/sshd_config<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure group/other have no read/write/execute permissions on '/etc/ssh/sshd_config'" success="pass">
                            <ecl:command>ls -l /etc/ssh/sshd_config | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                            <ecl:line-selection op="pm" value="^-r(w|-)-------\s+root\s+system\s*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="configuring-ssh-ssh_config-permissions-lockdown" selected="false">
                <xccdf:title>Configuring SSH - ssh_config permissions lockdown </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The /etc/ssh/ssh_config file defines SSH client behavior.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The etc/ssh/ssh_config file is the system-wide client configuration file for OpenSSH, which allows you to set options that modify the operation of the client programs. The recommended value is not to provide any writable access rights for any user, other than the owner of the file.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Change the permissions of the /etc/ssh/ssh_config file to ensure that only the owner can read and write to the file:<br/><br/>chmod u=rw,go=r /etc/ssh/ssh_config<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that the /etc/ssh/ssh_config permissions have been successfully changed:<br/><br/>ls -l /etc/ssh/ssh_config | awk '{print $1 " " $3 " " $4 " " $9}'<br/><br/>The above command should yield the following output:<br/><br/>-rw-r--r--   root     system         /etc/ssh/ssh_config<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure group/other have no read/write/execute permissions on '/etc/ssh/ssh_config'" success="pass">
                            <ecl:command>ls -l /etc/ssh/ssh_config | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                            <ecl:line-selection op="pm" value="^-r(w|-)-r--r--\s+root\s+system\s*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="configuring-ssh-removal-of-shosts-files" selected="false">
                <xccdf:title>Configuring SSH - removal of .shosts files </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommendation is to remove any existing .shosts files from all user home directories. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The existence of .shosts files in a user home directory, combined with the correct SSH parameter can allow passwordless authentication between servers. As previous recommendations in this section disable this authentication method, these files, if they exist, should be removed. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>List out all of the existing .shost files:<br/><br/>find / -name ".shosts" -print<br/><br/>Review the list of .shost files and remove them individually, or all at once:<br/><br/>Individually:<br/><br/>rm (full pathname)<br/><br/>All at once: <br/><br/>find / -name ".shosts" --exec rm {} \;<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that the all of the .shost files have been successfully removed:<br/><br/>find / -name ".shosts" -print<br/><br/>The above command should yield no output.<br/><br/><b>Reversion:</b><br/>Any deleted files would need to be restored from a backup.<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure no .shost files exist" success="pass">
                            <ecl:command>find / -name ".shosts" -print</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="configuring-ssh-removal-of-etc-shosts-equiv" selected="false">
                <xccdf:title>Configuring SSH - removal of /etc/shosts.equiv </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommendation is to remove the/etc/shosts.equiv file. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The existence of a /etc/shosts.equiv file, combined with the correct SSH parameter can allow passwordless authentication between servers. As previous recommendations in this section disable this authentication method these files, if they exist, should be removed. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Review the content of the etc/shosts.equiv file:<br/><br/>cat /etc/shosts.equiv<br/><br/>If the file exists:<br/><br/>rm /etc/shosts.equiv<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that the /etc/shosts.equiv file has been successfully removed:<br/><br/>ls /etc/shosts.equiv<br/><br/>The above command should yield no output.<br/><br/><b>Reversion:</b><br/>The /etc/shosts.equiv file would need to be restored from a backup.<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure /etc/shosts.equiv has been removed" success="fail">
                            <ecl:command>ls /etc/shosts.equiv</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="sendmail-configuration">
            <xccdf:title>Sendmail Configuration</xccdf:title>
            
            <xccdf:Rule id="etc-mail-sendmail-cf-smtpgreetingmessage" selected="false">
                <xccdf:title>/etc/mail/sendmail.cf - SmtpGreetingMessage </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommendation is to change the default sendmail greeting string to not display the sendmail version and other related information. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The sendmail deamon has a history of being associated with security vulnerabilities. The recommendation is to change the default sendmail greeting string so as not to display the sendmail version and other related information, which can be used by an attacker for fingerprinting purposes.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Create a backup copy of /etc/mail/sendmail.cf:<br/><br/>cp -p /etc/mail/sendmail.cf /etc/mail/sendmail.cf.pre_cis<br/><br/>Edit:<br/><br/>vi /etc/mail/sendmail.cf<br/><br/>Change:<br/><br/>O SmtpGreetingMessage=$j Sendmail $b<br/><br/>To:<br/><br/>O SmtpGreetingMessage=mailerready	<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the installation of the software:<br/><br/>grep "SmtpGreetingMessage=mailerready" /etc/mail/sendmail.cf<br/><br/>The above command should yield the following output:<br/><br/>O SmtpGreetingMessage=mailerready	<br/><br/><b>Reversion:</b><br/>Copy back the original /etc/sendmail.cf file:<br/><br/>cp -p /etc/mail/sendmail.cf.pre_cis /etc/mail/sendmail.cf<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:complex-check operator="OR">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="Ensure 'sendmail' is disabled in '/etc/rc.tcpip'">
                                <ecl:command>egrep '^[^#].*sendmail' /etc/rc.tcpip</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="'SmtpGreetingMessage' set to 'mailerready' in /etc/mail/sendmail.cf" success="pass">
                                <ecl:command>egrep '^\s*O[[::space::]]SmtpGreetingMessage=mailerready\s*$' /etc/mail/sendmail.cf</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="etc-mail-sendmail-cf-permissions-and-ownership" selected="false">
                <xccdf:title>/etc/mail/sendmail.cf - permissions and ownership </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommended permissions and ownership for /etc/mail/sendmail.cf are applied.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The /etc/mail/sendmail.cf file is used by the sendmail daemon to determine its default configuration. This file must be protected from unauthorized access and modifications.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Set the recommended permissions and ownership to /etc/mail/sendmail.cf:<br/><br/>chmod u=rw,g=r,o= /etc/mail/sendmail.cf<br/>chown root /etc/mail/sendmail.cf<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/>ls -l /etc/mail/sendmail.cf | awk '{print $1 " " $3 " " $4 " " $9}'<br/><br/>The above command should yield the following output:<br/><br/>-rw-r-----    root     system        sendmail.cf<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure permissions '/etc/mail/sendmail.cf' are u+r,g-wx,o-rwx or more restrictive" success="pass">
                            <ecl:command>ls -l /etc/mail/sendmail.cf | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                            <ecl:line-selection op="pm" value="^-r(w|-)-(r|-)-----\s+root\s+system\s*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="var-spool-mqueue-permissions-and-ownership" selected="false">
                <xccdf:title>/var/spool/mqueue - permissions and ownership </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommended permissions and ownership for the /var/spool/mqueue directory are applied.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The sendmail daemon generally stores its queued mail in the /var/spool/mqueue directory. Queued messages are the messages that have not yet reached their final destination. To ensure the integrity of the messages during storage, the mail queue directory must be secured from unauthorized access. <br/><br/>NOTE: It is possible to specify an alternate spool directory in the /etc/mail/sendmail.cf file via the QueueDirectory parameter.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Set the recommended permissions and ownership to /var/spool/mqueue:<br/><br/>chmod u=rwx,go= /var/spool/mqueue<br/>chown root /var/spool/mqueue<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>From the command prompt, execute the following command:<br/><br/>ls --ld /var/spool/mqueue | awk '{print $1 " " $3 " " $4 " " $9}'<br/><br/>The above command should yield the following output:<br/><br/>drwx------    root     system          /var/spool/mqueue<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure permissions '/var/spool/mqueue' are u+rwx,g-wrx,o-rwx or more restrictive" success="pass">
                            <ecl:command>ls -ld /var/spool/mqueue | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                            <ecl:line-selection op="pm" value="^drwx------\s+root\s+system\s*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="common-desktop-environment-cde">
            <xccdf:title>Common Desktop Environment (CDE)</xccdf:title>
            
            <xccdf:Rule id="cde-de-installing-cde" selected="false">
                <xccdf:title>CDE - de-installing CDE </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommendation is to de-install CDE from the system, assuming that it is not required and is already installed. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The CDE has a history of security problems and should be disabled. <br/><br/>NOTE: If CDE is required, it is vital to patch the software and consider TCP Wrappers to further enhance security. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Identity if CDE is already installed:<br/><br/>lslpp -L |grep -i CDE<br/><br/>If there are CDE filesets installed - de-install them if CDE is not required.<br/><br/>For each fileset preview the de-installation:<br/><br/>installp --up &lt;fileset name&gt;<br/><br/>Review the fileset removal preview output, paying particular attention to the other pre-requisites that will also be removed. Typically only X11.Dt filesets should be de-installed as pre-requisites.<br/><br/>Once reviewed, de-install the fileset and pre-requisites:<br/><br/>installp --ug &lt;fileset name&gt;<br/><br/>NOTE: Repeat until all CDE filesets are de-installed<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the de-installation of the software:<br/><br/>lslpp -L |grep -i CDE<br/><br/>The above command should yield no output.<br/><br/><b>Reversion:</b><br/>Re-install the CDE software from the AIX media.<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure all CDE components are uninstalled" success="fail">
                            <ecl:command>lslpp -L | grep -i "CDE"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="cde-disabling-dtlogin" selected="false">
                <xccdf:title>CDE - disabling dtlogin </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Do not start CDE automatically on system boot. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The implementation of the customized aixpert XML file disables CDE if there is not a graphical console attached to the system. If there is a graphical console consider disabling CDE anyway.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Disable CDE start up:<br/><br/>/usr/dt/bin/dtconfig -d<br/><br/>NOTE: If CDE is not installed the command will not be found<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the de-installation of the software:<br/><br/>lsitab dt<br/><br/>The above command should yield no output.<br/><br/><b>Reversion:</b><br/>To re-configure the auto-start of the CDE software:<br/><br/>/usr/dt/bin/dtconfig -e<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:complex-check operator="OR">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="Ensure all CDE components are uninstalled" success="fail">
                                <ecl:command>lslpp -L | grep -i "CDE"</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="Ensure 'dt' is disabled" success="fail">
                                <ecl:command>lsitab dt</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="cde-sgid-suid-binary-lockdown" selected="false">
                <xccdf:title>CDE - sgid/suid binary lockdown </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>CDE buffer overflow vulnerabilities may be exploited by a local user to obtain root privilege via suid/sgid programs owned by root:bin or root:sys.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>CDE has been associated with major security risks, most of which are buffer overflow vulnerabilities. These vulnerabilities may be exploited by a local user to obtain root privilege via suid/sgid programs owned by root:bin or root:sys. It is recommended that the CDE binaries have the suid/sgid removed.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Remove the suid/sgid from the following CDE binaries:<br/><br/>chmod ug-s /usr/dt/bin/dtaction <br/>chmod ug-s /usr/dt/bin/dtappgather <br/>chmod ug-s /usr/dt/bin/dtprintinfo<br/>chmod ug-s /usr/dt/bin/dtsession<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the permissions of the binaries:<br/><br/>ls -l /usr/dt/bin/dtaction | awk '{print $1 " " $3 " " $4 " " $9}' <br/>ls -l /usr/dt/bin/dtappgather | awk '{print $1 " " $3 " " $4 " " $9}'<br/>ls -l /usr/dt/bin/dtprintinfo | awk '{print $1 " " $3 " " $4 " " $9}'<br/>ls -l /usr/dt/bin/dtsession | awk '{print $1 " " $3 " " $4 " " $9}'<br/><br/>The above command should yield the following output:<br/><br/>-r-xr-xr-x    root     sys          /usr/dt/bin/dtaction<br/>-r-xr-xr-x    root     bin          /usr/dt/bin/dtappgather<br/>-r-xr-xr-x    root     bin          /usr/dt/bin/dtprintinfo<br/>-r-xr-xr-x    root     bin          /usr/dt/bin/dtsession<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:complex-check operator="OR">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="Ensure all CDE components are uninstalled" success="fail">
                                <ecl:command>lslpp -L | grep -i "CDE"</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:complex-check operator="AND">
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="Ensure no setuid bit on '/usr/dt/bin/dtaction'" success="pass">
                                    <ecl:command>ls -l /usr/dt/bin/dtaction | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                                    <ecl:line-selection op="pm" value="^-(r|-)(w|-)(x|-)(r|-)-(x|-)(r|-)-(x|-)\s+root\s+sys\s*$"/>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="Ensure no setuid bit on '/usr/dt/bin/dtappgather'" success="pass">
                                    <ecl:command>ls -l /usr/dt/bin/dtappgather | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                                    <ecl:line-selection op="pm" value="^-(r|-)(w|-)(x|-)(r|-)-(x|-)(r|-)-(x|-)\s+root\s+bin\s*$"/>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="Ensure no setuid bit on '/usr/dt/bin/dtprintinfo'" success="pass">
                                    <ecl:command>ls -l /usr/dt/bin/dtprintinfo | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                                    <ecl:line-selection op="pm" value="^-(r|-)(w|-)(x|-)(r|-)-(x|-)(r|-)-(x|-)\s+root\s+bin\s*$"/>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="Ensure no setuid bit on '/usr/dt/bin/dtsession'" success="pass">
                                    <ecl:command>ls -l /usr/dt/bin/dtsession | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                                    <ecl:line-selection op="pm" value="^-(r|-)(w|-)(x|-)(r|-)-(x|-)(r|-)-(x|-)\s+root\s+bin\s*$"/>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                    </xccdf:complex-check>
                </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="cde-remote-gui-login-disabled" selected="false">
                <xccdf:title>CDE - remote GUI login disabled </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The XDMCP service allows remote systems to start local  X login sessions.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The XDMCP service should be disabled unless there is a requirement to allow remote X servers to start login sessions. If the ability to host remote X servers is not required, disable the service. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Copy /usr/dt/config/Xconfig to /etc/dt/config if it does not already exist:<br/><br/>ls -l /etc/dt/config/Xconfig<br/>   <br/>If the file does not exist, create it:<br/><br/>mkdir -p /etc/dt/config <br/>cp /usr/dt/config/Xconfig /etc/dt/config <br/><br/>Disable remote X sessions from being started:<br/><br/>vi /etc/dt/config/Xconfig<br/><br/>Replace:<br/><br/><xhtml:code>#  Dtlogin.requestPort:       0<br/><br/>With:<br/><br/>Dtlogin.requestPort:       0<br/><br/></xhtml:code></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the change:<br/><br/>grep "^Dtlogin.requestPort:[[::space::]]" /etc/dt/config/Xconfig<br/><br/>The command above should yield the following output:<br/><br/>Dtlogin.requestPort:       0<br/><br/><b>Reversion:</b><br/>Comment out the option:<br/><br/>vi /etc/dt/config/Xconfig<br/><br/>Reflect:<br/><br/><xhtml:code>#  Dtlogin.requestPort:       0<br/><br/></xhtml:code></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:complex-check operator="OR">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="Ensure all CDE components are uninstalled" success="fail">
                                <ecl:command>lslpp -L | grep -i "CDE"</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure 'requestPort' is set to '0' in '/etc/dt/config/Xconfig'" success="pass">
                                <ecl:command>egrep "^[[:space:]]*Dtlogin.requestPort:[[:space:]]+0[[:space:]]*$" /etc/dt/config/Xconfig </ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="cde-screensaver-lock" selected="false">
                <xccdf:title>CDE - screensaver lock </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The default timeout is 30 minutes of keyboard and mouse inactivity before a password protected screensaver is invoked by the CDE session manager.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The default timeout of 30 minutes prior to a password protected screensaver being invoked is too long. The recommendation is to set this to 10 minutes to protect from unauthorized access on unattended systems. <br/><br/>Individual users are able to over ride this default setting. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Set the default timeout parameters dtsession*saverTimeout: and dtsession*lockTimeout:<br/><br/>for file in /usr/dt/config/*/sys.resources; do<br/>   dir=`dirname $file | sed -e s/usr/etc/`<br/>   mkdir -p $dir<br/>   echo 'dtsession*saverTimeout: 10' &gt;&gt; $dir/sys.resources<br/>   echo 'dtsession*lockTimeout: 10' &gt;&gt; $dir/sys.resources<br/>done<br/>   <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the changes to the sys.resources files:<br/><br/>egrep "dtsession\*saverTimeout:|dtsession\*lockTimeout:" /etc/dt/config/*/sys.resources<br/><br/>The above command should yield a similar output to the following:<br/><br/>/etc/dt/config/en_US/sys.resources:dtsession*saverTimeout:  10 <br/>/etc/dt/config/en_US/sys.resources:dtsession*lockTimeout:   10 <br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:complex-check operator="OR">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="Ensure all CDE components are uninstalled" success="fail">
                                <ecl:command>lslpp -L | grep -i "CDE"</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
            		 <xccdf:complex-check operator="AND">
                         <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="Ensure the Default Screen Lock Time is set for CDE Users" success="pass">
                                    <ecl:command>find `ls /etc/dt/config/*/sys.resources` -exec egrep "dtsession\*saverTimeout:[[:space:]]" {} \;</ecl:command>
                                    <ecl:line-selection op="pm" value="^.*:\s+(\d+)\s*$">
                                        <ecl:regex-group dt="xs:integer" group="1" op="le" value="10"/>
                                    </ecl:line-selection>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                    	<xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="Ensure the Default Screen Lock Time is set for CDE Users">
                                    <ecl:command>egrep "dtsession\*lockTimeout:" /etc/dt/config/*/sys.resources</ecl:command>
                                    <ecl:line-selection op="pm" value="^.*:\s+(\d+)\s*$">
                                        <ecl:regex-group dt="xs:integer" group="1" op="le" value="10"/>
                                    </ecl:line-selection>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
        	       </xccdf:complex-check>
               </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="cde-etc-dt-config-xconfig-permissions-and-ownership" selected="false">
                <xccdf:title>CDE - /etc/dt/config/Xconfig permissions and ownership </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The /etc/dt/config/Xconfig file is used to customize CDE DT login attributes.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The /etc/dt/config/Xconfig file can be used to customize CDE DT login attributes. The default file, /usr/dt/config/Xconfig, is unconditionally overwritten upon subsequent installation. It is recommended that the appropriate permissions and ownership are applied to secure the file. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Check to see if the /etc/dt/config/Xconfig exists:<br/><br/>ls -l /etc/dt/config/Xconfig<br/><br/>Apply the appropriate ownership and permissions to /etc/dt/config/Xconfig:<br/><br/>chown root:bin /etc/dt/config/Xconfig<br/>chmod ugo=r /etc/dt/config/Xconfig<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the ownership and permissions:<br/><br/>ls -l /etc/dt/config/Xconfig | awk '{print $1 " " $3 " " $4 " " $9}'<br/><br/>The above command should yield the following output:<br/><br/>-r--r--r--  root      bin            /etc/dt/config/Xconfig<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:complex-check operator="OR">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="Ensure all CDE components are uninstalled" success="fail">
                                <ecl:command>lslpp -L | grep -i "CDE"</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure permissions on '/etc/dt/config/Xconfig' are g-wx,o-wx or more restrictive" success="pass">
                                <ecl:command>ls -l /etc/dt/config/Xconfig | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                                <ecl:line-selection op="pm" value="^-r(w|-)-(r|-)--(r|-)--\s+root\s+bin\s*$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="cde-etc-dt-config-xservers-permissions-and-ownership" selected="false">
                <xccdf:title>CDE - /etc/dt/config/Xservers permissions and ownership </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The /etc/dt/config/Xservers contains entries to start the Xserver on the local display.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The /etc/dt/config/Xservers contains entries to start the Xserver on the local display. The default file, /usr/dt/config/Xservers, is unconditionally overwritten upon subsequent installation. It is recommended that the appropriate permissions and ownership are applied to secure the file. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Check to see if the /etc/dt/config/Xservers exists:<br/><br/>ls -l /etc/dt/config/Xservers<br/><br/>If it exists ensure that it is explicitly defined in /etc/dt/config/Xconfig:<br/><br/>vi /etc/dt/config/Xconfig<br/><br/>Replace:<br/><br/>Dtlogin.servers:               Xservers<br/><br/>With:<br/><br/>Dtlogin*servers: /etc/dt/config/Xservers<br/><br/>Apply the appropriate ownership and permissions to /etc/dt/config/Xservers:<br/><br/>chown root:bin /etc/dt/config/Xservers<br/>chmod ugo=r /etc/dt/config/Xservers<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the ownership and permissions:<br/><br/>ls -l /etc/dt/config/Xservers | awk '{print $1 " " $3 " " $4 " " $9}'<br/><br/>The above command should yield the following output:<br/><br/>-r--r--r--  root      bin            /etc/dt/config/Xservers<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:complex-check operator="OR">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="Ensure all CDE components are uninstalled" success="fail">
                                <ecl:command>lslpp -L | grep -i "CDE"</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure permissions on '/etc/dt/config/Xservers' are g-wx,o-wx or more restrictive" success="pass">
                                <ecl:command>ls -l /etc/dt/config/Xservers | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                                <ecl:line-selection op="pm" value="^-r(w|-)-(r|-)--(r|-)--\s+root\s+bin\s*$"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="cde-login-screen-hostname-masking" selected="false">
                <xccdf:title>CDE - login screen hostname masking </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The Dtlogin*greeting.labelString parameter is the message displayed in the first dialogue box on the CDE login screen. This is where the username is entered. <br/><br/>The Dtlogin*greeting.persLabelString is the message displayed in the second dialogue box on the CDE login screen. This is where the password is entered.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>Potential hackers may gain access to valuable information such as the hostname and the version of the operating system from the default AIX login screen. This information would assist hackers in choosing the exploitation methods to break into the system. For security reasons, change the login screen default messages. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Copy the files from /usr/dt/config/*/Xresources to /etc/dt/config/*/Xresources and add the Dtlogin*greeting.labelString and Dtlogin*greeting.persLabelString parameters to all copied Xresources files:<br/><br/>for file in /usr/dt/config/*/Xresources; do<br/>dir=`dirname $file | sed s/usr/etc/`<br/>mkdir -p $dir<br/>if [ ! -f $dir/Xresources ]; then<br/>cp $file $dir/Xresources<br/>fi<br/>WARN="Authorized uses only. All activity may be monitored and<br/>reported."<br/>echo "Dtlogin*greeting.labelString: $WARN" &gt;&gt;$dir/Xresources<br/>echo "Dtlogin*greeting.persLabelString: $WARN" &gt;&gt;$dir/Xresources<br/>done<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the changes to the Xresources files:<br/><br/>egrep "Dtlogin\*greeting.labelString|Dtlogin\*greeting.persLabelString:" /etc/dt/config/*/Xresources<br/><br/>The above command should yield a similar output to the folllowing:<br/><br/>/usr/dt/config/en_US/Xresources:!! Dtlogin*greeting.labelString: Authorized uses only. All activity may be monitored and reported.<br/>/usr/dt/config/en_US/Xresources:!! Dtlogin*greeting.persLabelString: Authorized uses only. All activity may be monitored and reported.<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:complex-check operator="OR">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="Ensure all CDE components are uninstalled" success="fail">
                                <ecl:command>lslpp -L | grep -i "CDE"</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure login screen updated">
                                <ecl:command>[[ $(egrep "^Dtlogin\*greeting.labelString: Authorized uses only. All activity may be monitored and reported.|^Dtlogin\*greeting.persLabelString: Authorized uses only. All activity may be monitored and reported." /etc/dt/config/*/Xresources |wc -l) -eq $(egrep "^Dtlogin\*greeting.labelString:|^Dtlogin\*greeting.persLabelString:" /etc/dt/config/*/Xresources |wc -l) ]] &amp;&amp; print "all Xresources files have been sucessfully updated"</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="cde-etc-dt-config-xresources-permissions-and-ownership" selected="false">
                <xccdf:title>CDE - /etc/dt/config/*/Xresources permissions and ownership </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The /etc/dt/config/*/Xresources file contains appearance and behavior resources for the Dtlogin login screen.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The /etc/dt/config/*/Xresources file defines the customization of the Dtlogin screen. The default file, /usr/dt/config/*/Xresources, is unconditionally overwritten upon subsequent installation. It is recommended that the appropriate permissions and ownership are applied to secure the file. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Set the appropriate permissions and ownership on all Xresources files:<br/><br/>chown root:sys /etc/dt/config/*/Xresources<br/>chmod u=rw,go=r /etc/dt/config/*/Xresources<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the ownership and permissions:<br/><br/>ls -l /etc/dt/config/*/Xresources | awk '{print $1 " " $3 " " $4 " " $9}'<br/><br/>The above command should yield a similar output to the folllowing:<br/><br/>-r--r--r--    root      sys            /etc/dt/config/en_GB/Xresources<br/>-r--r--r--    root      sys            /etc/dt/config/en_US/Xresources<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:complex-check operator="OR">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="Ensure all CDE components are uninstalled" success="fail">
                                <ecl:command>lslpp -L | grep -i "CDE"</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="Ensure no Xresources files have group/other write permissions" success="pass">
                                <ecl:command>find /etc/dt/config -name "Xresources" \( -perm -g+w -o -perm -o+w \)</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="nfs">
            <xccdf:title>NFS</xccdf:title>
            
            <xccdf:Rule id="nfs-de-install-nfs" selected="false">
                <xccdf:title>NFS - de-install NFS </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Remove /etc/exports and de-install NFS. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>NFS is frequently exploited to gain unauthorized access to file and directories. Unless the server needs to act as an NFS server or client, the filesets should be de-installed. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Ensure that there are no current NFS client mounts:<br/><br/>mount |grep "nfs"<br/>cat /etc/filesystems |grep "nfs"<br/><br/>The above commands should yield no output.<br/><br/>De-install the NFS client software:<br/><br/>installp -u bos.net.nfs.client<br/><br/>Ensure that there are no current NFS exports:<br/><br/>cat /etc/exports<br/><br/>The above command should yield no output. Or the file should not exist. <br/><br/>De-install the NFS sever software:<br/><br/>installp -u bos.net.nfs.server<br/><br/>If there was an empty /etc/exports file, remove it:<br/><br/>rm /etc/exports<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that the software has been successfully de-installed:<br/><br/>lslpp -L |grep -i nfs<br/><br/>The above command should yield no output.<br/><br/><b>Reversion:</b><br/>Re-install the software from the product DVDs <br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure all NFS components are uninstalled" success="fail">
                            <ecl:command>lslpp -L | grep -i "bos.net.nfs"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="nfs-nosuid-on-nfs-client-mounts" selected="false">
                <xccdf:title>NFS - nosuid on NFS client mounts </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Disable suid/sgid program execution within any mounted NFS filesystem. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>Setting the nosuid option means that on the NFS server the root user cannot make an suid-root program within an exported filesystem. Then log onto an NFS client as a standard user and use the suid-root program to effectively become root on that client. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>For each NFS mount, disable suid programs.<br/><br/>List the current NFS mounts:<br/><br/>mount |grep "nfs"<br/><br/>For each NFS filesystem add the nosuid option, this change should be made via an edit to the /etc/filesystems file.<br/><br/>Create a copy of /etc/filesystems:<br/><br/>cp -p /etc/filesystems /etc/filesystems.pre_cis <br/><br/>For each NFS mount edit the options line to reflect the nosuid option:<br/><br/>vi /etc/filesystems<br/><br/>Reflect in each NFS options line:<br/><br/>options         = rw,bg,hard,intr,nosuid,sec=sys<br/><br/>NOTE: The above options line is an example, the nosuid should be added to the existing options<br/><br/>The NFS mount needs to be re-mounted to reflect this change<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>For each NFS filesystem, ensure that the options have been changed to reflect the nosuid option:<br/><br/>mount |grep "nfs" |wc -l<br/>mount |grep "nfs" |grep "nosuid" |wc -l<br/><br/>Both commands should yield the same output.<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure all 'nfs' mounts have 'nosuid' option set">
                            <ecl:command>[[ $(mount |grep nfs |wc -l) = $(mount |grep nfs |grep nosuid |wc -l) ]] || print "nosuid not set on all NFS mounts"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="nfs-localhost-removal" selected="false">
                <xccdf:title>NFS - localhost removal </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Remove any reference to localhost or localhost aliases from /etc/exports.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>If the RPC portmapper has proxy forwarding enabled, which is a default setting in many vendor versions. You must not export your local filesytems back to the localhost, either by name or to the alias localhost, and you must not export to any netgroups of which your host is a member. If proxy forwarding is enabled, an attacker may carefully craft NFS packets and send them to the portmapper, which in turn, forwards them to the NFS server. As the packets come from the portmapper process, which runs as root, they appear to be coming from a trusted system. This configuration may allow anyone to alter and delete files at will. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Remove any reference to localhost or localhost aliases in /etc/exports:<br/><br/>Review the content of /etc/exports and check for localhost or localhost aliases:<br/><br/>cat /etc/exports<br/><br/>NOTE: If instances of localhost or localhost aliases are found, edit the file and remove them.<br/><br/>Create a copy of /etc/exports:<br/><br/>cp -p /etc/exports /etc/exports.pre_cis<br/><br/>Edit the file:<br/><br/>vi /etc/exports<br/><br/>Edit the relevant NFS exports to remove the localhost access, for example:<br/><br/>/nfsexport  sec=sys,rw,access=localhost:testserver<br/><br/>If /etc/exports is updated, as localhost references have been removed, update the current NFS export options:<br/><br/>exportfs -a <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Re-review /etc/exports if the file was updated, to validate the changes:<br/><br/>cat /etc/exports<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure no references to 'localhost' exists in /etc/exports">
                            <ecl:command>grep "localhost" /etc/exports</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="nfs-restrict-nfs-access" selected="false">
                <xccdf:title>NFS - restrict NFS access </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Only allow explicitly defined host access to NFS exported filesystems and directories.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The NFS server should be configured to only allow explicitly defined hosts to mount filesystems from the server. If an unauthorized host is denied the permission to mount a filesystem, then the unauthorized users on that host will not be able to access the server's files. <br/><br/>The default value of access allows any machine to mount any exported filesystems/directories.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Ensure that all exports defined in /etc/exports have explicit client access options which clearly define the host or hosts allowed access:<br/><br/>Review the content of /etc/exports and that all exports have explicit access lists:<br/><br/>cat /etc/exports<br/><br/>Ensure that each NFS export has an explicit access line, for example:<br/><br/>/usr/spool/mail -access=symmachine<br/><br/>If the file is updated, to reflect client access changes, update the current NFS export options:<br/><br/>exportfs -a <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Re-review /etc/exports if the file was updated, to validate the changes:<br/><br/>cat /etc/exports<br/><br/><b>Reversion:</b><br/>Copy back the original /etc/exports:<br/><br/>cp -p /etc/exports.pre_cis /etc/exports<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure all 'nfs' mounts have the 'access' option set">
                            <ecl:command>[[ $(cat /etc/exports | wc -l) = $(cat /etc/exports |grep "\-access=" |wc -l) ]] || print "access is not explicitly defined for all NFS exports"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="nfs-no-root-squash-option" selected="false">
                <xccdf:title>NFS - no_root_squash option </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>For each NFS export, ensure that the root_squash option is set to -2 or -1.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>Each NFS export on the server should have the anon=-2 option set. Without this, an NFS export could be at risk, where the remote root user effectively has root access on the NFS mount.  By setting the export option anon=-2 , when the client attempts to access (read, write, or delete) the NFS mount, the server substitutes the UID to the server's nobody account, which is -2. This means that the root user on the client cannot access or change files that only root on the server can access or change. It is therefore recommended that root_squash is set on all exported filesystems. <br/><br/>The default value of any exported filesystem or directory is -2, another value has to be explicitly set.<br/><br/>As a more secure option you can set the option to anon=-1, which disables anonymous access. By default, secure NFS accepts non-secure requests as anonymous.<br/><br/>NOTE: The root user on the client can still use su to become any other user and access and change that users files, assuming that the same user exists on the NFS server and owns files and/or directories in the NFS export. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Use smitty to change/validate this value for all NFS exported filesystems:<br/><br/>smitty chnfsexp<br/><br/>For each filesystem, as defined in the F4 list, set the following option:<br/><br/>Anonymous UID                                      [-2]<br/><br/>NOTE: Press enter to accept the change<br/><br/>Once all exported filesystems have been successfully validated or changed, re-export the filesystems and directories to activate the new options:<br/><br/>exportfs -a<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>As -2 is the default NFS export value, ensure that there are no explicit anon= options set in /etc/exports:<br/><br/>grep "anon=" /etc/exports<br/><br/>The above should command should yield no output.<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure no 'nfs' mounts have 'anon' option set">
                            <ecl:command>grep "anon=" /etc/exports</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="nfs-secure-nfs" selected="false">
                <xccdf:title>NFS - secure NFS </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>For each NFS export, ensure that the secure option is selected.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>Secure NFS uses DES encryption or Kerberos to authenticate hosts involved in RPC transactions. RPC is a protocol used by NFS to communicate requests between hosts. Secure NFS mitigates attempts by an attacker to spoof RPC requests by encrypting the time stamp in the RPC requests. A receiver successfully decrypts the time stamp and confirms that it is correct. This serves as a confirmation that the RPC request came from a trusted host. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Use smitty to change/validate this value for all NFS exported filesystems:<br/><br/>smitty chnfsexp<br/><br/>For each filesystem, as defined in the F4 list. There are five security methods which can be used to define different security access methods for different clients:<br/><br/>Security method 1                                  [sys,krb5p,krb5i,krb5,d&gt; +<br/>*     Mode to export directory                        read-write              +<br/>      Hostname list. If exported read-mostly         []                       <br/>      Hosts &amp; netgroups allowed client access        []                       <br/>      Hosts allowed root access                      []                       <br/><br/>The security method options are:<br/><br/>sys 	- UNIX authentication<br/>dh	- DES authentication<br/>none	 - Use the anonymous ID if it has a value other than -1     <br/>krb5	- Kerberos. Authentication only<br/>krb5i - Kerberos. Authentication and integrity<br/>krb5p - Authentication, integrity, and privacy<br/><br/>Once all exported filesystems have been successfully validated or changed, re-export the filesystems and directories to activate the new options:<br/><br/>exportfs -a<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that the relevant sec= options set in /etc/exports:<br/><br/>grep "sec=" /etc/exports <br/><br/>The above should command should return each export and the security mode of the export.<br/><br/><b>Reversion:</b><br/>Copy back the original /etc/exports:<br/><br/>cp -p /etc/exports.pre_cis /etc/exports<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure all 'nfs' mounts have the 'sec' option set">
                            <ecl:command>[[ $(cat /etc/exports | wc -l) = $(cat /etc/exports |grep "sec=" |wc -l) ]] || print "security methods are explicitly defined for all NFS exports"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="nis">
            <xccdf:title>NIS </xccdf:title>
            
            <xccdf:Rule id="nis-disable-nis-client" selected="false">
                <xccdf:title>NIS - disable NIS client </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>If NIS is not used in the environment, disable the NIS client and de-install the software.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>As NIS is extremely insecure, the NIS client packages must be removed from the system unless absolutely needed. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Ensure that all of the NIS daemons are inactive:<br/><br/>stopsrc -g yp<br/><br/>De-install the NIS client software:<br/><br/>installp -u bos.net.nis.client                   <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that the software has been successfully de-installed:<br/><br/>lslpp -L |grep "bos.net.nis.client"<br/><br/>The above should command yield no output<br/><br/><b>Reversion:</b><br/>Re-install the software from the product DVDs:<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'bos.net.nis.client' is uninstalled" success="fail">
                            <ecl:command>lslpp -L |grep "bos.net.nis.client"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="nis-disable-nis-server" selected="false">
                <xccdf:title>NIS - disable NIS server </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>If NIS is not used in the environment, disable the NIS server and de-install the software.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>As NIS is extremely insecure, the NIS server packages must be removed from the system unless absolutely needed. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Ensure that all of the NIS daemons are inactive:<br/><br/>stopsrc -g yp<br/><br/>De-install the NIS server software:<br/><br/>installp -u bos.net.nis.server                   <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that the software has been successfully de-installed:<br/><br/>lslpp -L |grep "bos.net.nis.server"<br/><br/>The above should command should yield no output<br/><br/><b>Reversion:</b><br/>Re-install the software from the product DVDs:<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'bos.net.nis.server' is uninstalled" success="fail">
                            <ecl:command>lslpp -L |grep "bos.net.nis.server"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="nis-remove-nis-markers-from-password-and-group-files" selected="false">
                <xccdf:title>NIS - remove NIS markers from password and group files </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>If NIS has been de-installed in the environment, or has historically been used, ensure the + markers are removed from /etc/passwd and /etc/group. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The + entries in /etc/passwd and /etc/group were used as markers to insert data from a NIS map. These entries may provide an avenue for attackers to gain privileged access on the system. The + entries must be deleted if they still exist.  <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Examine the /etc/passwd and /etc/group files:<br/><br/>grep "^+" /etc/passwd /etc/group<br/><br/>If the above command yields output, delete the + line:<br/><br/>vi /etc/passwd<br/>vi /etc/group<br/><br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Re-run the command:<br/><br/>grep "^+" /etc/passwd /etc/group<br/><br/>The command above should yield no output.<br/><br/><b>Reversion:</b><br/>Add the + line back to the same point in the file/s:<br/><br/>vi /etc/passwd<br/>vi /etc/group<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure no legacy '+' entries exist in /etc/passwd and /etc/group">
                            <ecl:command>grep "^+" /etc/passwd /etc/group </ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="nis-restrict-nis-server-communication" selected="false">
                <xccdf:title>NIS - restrict NIS server communication </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>If NIS must be used in the environment, limit access to the NIS data to specific subnets. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>By default the NIS server will authenticate all IP addresses if the /var/yp/securenets file does not exist, or exists without any subnets defined.  The /var/yp/securenets file contains a list of subnets that are considered trusted and are allowed to access NIS data using the ypserv and ypxfrd daemons. This is a user-created file that resides on a NIS master server and any slave servers. Without configuring this file, anyone with knowledge of the NIS server address and the domain name, can obtain NIS served data, including the contents of the /etc/passwd file. Hence, it is recommended that the /var/yp/securenets file is configured to restrict access. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Create and secure the /var/yp/securenets file (if it does not already exist):<br/><br/>touch /var/yp/securenets<br/>chmod u=rw,go= /var/yp/securenets<br/><br/>Edit the file:<br/><br/>vi /var/yp/securenets<br/><br/>Add the allowed subnets:<br/><br/>255.255.255.0 128.311.10.0<br/><br/>NOTE: The format of the file is netmask netaddr as shown in the example above. Explicitly define all valid network subnets (one entry per line).<br/><br/>Stop and start NIS to implement the configuration changes:<br/><br/>stopsrc -g yp<br/>startsrc -g yp<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Review the content of the /var/yp/securenets file:<br/><br/>cat /var/yp/securenets<br/><br/>NOTE: A test should be performed from an allowed client and non-allowed subnet to validate the securenets configuration<br/><br/><b>Reversion:</b><br/>Remove the /var/yp/securenets file:<br/><br/>rm /var/yp/securenets<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure subnets exist in /var/yp/securenets">
                            <ecl:command>lssrc -g yp&gt; /dev/null || print "NIS server not configured - skipping" &amp;&amp; [[ -s /var/yp/securenets ]] &amp;&amp; grep '[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}' /var/yp/securenets</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="snmp">
            <xccdf:title>SNMP</xccdf:title>
            
            <xccdf:Rule id="snmp-disable-private-community" selected="false">
                <xccdf:title>SNMP - disable private community string </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>If snmpd is required within the environment, disable the private community string. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>In AIX, two SNMP community names, private and system, are enabled with read/write privileges, but are allowed access only from localhost connections. As these SNMP names are the default, they must not be used. Any SNMP community name should be a combination of letters, numbers and special characters to enhance security. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Create a backup of /etc/snmpd.conf:<br/><br/>cp -p /etc/snmpd.conf /etc/snmpd.conf.pre_cis<br/><br/>Edit the file:<br/><br/>vi /etc/snmpd.conf<br/><br/>Comment out the private entry:<br/><br/><xhtml:code>#community       private 127.0.0.1 255.255.255.255 readWrite<br/><br/></xhtml:code></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure the private entry has been commented out from /etc/snmpd.conf:<br/><br/>grep "^<xhtml:code>#community[[:space:]]*private" /etc/snmpd.conf <br/><br/>The above command should yield the following output:<br/><br/>#community       private 127.0.0.1 255.255.255.255 readWrite<br/><br/><b>Reversion:</b><br/>Copy back the original /etc/snmpd.conf file:<br/><br/>cp -p /etc/snmpd.conf.pre_cis /etc/snmpd.conf<br/><br/></xhtml:code></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure no 'private' community lines exist" success="fail">
                            <ecl:command>egrep "^[[:space:]]*community[[:space:]]+private" /etc/snmpd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="snmp-disable-system-community" selected="false">
                <xccdf:title>SNMP - disable system community string</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>If snmpd is required within the environment, disable the system community string<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>In AIX, two SNMP community names, private and system, are enabled with read/write privileges, but are allowed access only from localhost connections. As these SNMP names are the default, they must not be used. Any SNMP community name should be a combination of letters, numbers and special characters to enhance security. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Edit the file:<br/><br/>vi /etc/snmpd.conf<br/><br/>Comment out the system entry:<br/><br/><xhtml:code>#community       system  127.0.0.1 255.255.255.255 readWrite 1.17.2<br/><br/></xhtml:code></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure the system entry has been commented out from /etc/snmpd.conf:<br/><br/>grep "^<xhtml:code>#community[[:space:]]*system" /etc/snmpd.conf <br/><br/>The above command should yield the following output:<br/><br/>#community       system  127.0.0.1 255.255.255.255 readWrite 1.17.2<br/><br/><b>Reversion:</b><br/>Copy back the original /etc/snmpd.conf file:<br/><br/>cp -p /etc/snmpd.conf.pre_cis /etc/snmpd.conf<br/><br/></xhtml:code></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure no 'system' community lines exist" success="fail">
                            <ecl:command>egrep "^[[:space:]]*community[[:space:]]+system" /etc/snmpd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
	    <xccdf:Rule id="snmp-disable-public-community" selected="false">
                <xccdf:title>SNMP - disable public community string</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>If snmpd is required within the environment, disable the public community string<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The public community string can be polled by remote SNMP devices and pertinent information can be read or changed on the host. The public community string should but commented out, or if SNMP is a required service the public community name should be changed to be a combination of letters, numbers and special characters to enhance security.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Edit the file:<br/><br/>vi /etc/snmpd.conf<br/><br/>Comment out the public entry:<br/><br/><xhtml:code>#community       public<br/><br/></xhtml:code></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure the public entry has been commented out from /etc/snmpd.conf:<br/><br/>grep "^<xhtml:code>#community[[:space:]]*public" /etc/snmpd.conf<br/><br/>The above command should yield the following output:<br/><br/>#community       system  127.0.0.1 255.255.255.255 readWrite 1.17.2<br/><br/><b>Reversion:</b><br/>Copy back the original /etc/snmpd.conf file:<br/><br/>cp -p /etc/snmpd.conf.pre_cis /etc/snmpd.conf<br/><br/></xhtml:code></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure no 'system' community lines exist" success="fail">
                            <ecl:command>egrep "^[[:space:]]*community[[:space:]]+public" /etc/snmpd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>            
<xccdf:Rule id="snmp-restrict-community-access" selected="false">
                <xccdf:title>SNMP - restrict community access </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>If snmpd is required within the environment, implement IP access restrictions on the available community strings. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>If SNMP is required, IP access restrictions should be put into place to limit which hosts or networks subnets are able to remotely poll the server.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Identify if there are any currently configured community strings:<br/><br/>grep "^community[[::space::]]" /etc/snmpd.conf<br/><br/>If there are active community strings, edit the configuration file:<br/><br/>vi /etc/snmpd.conf<br/><br/>Implement IP access restrictions to ALL of the available community names:<br/><br/>community       public  192.132.10.0 255.255.255.0 readOnly<br/><br/>The format of each line should reflect:<br/><br/>community &lt;community name&gt; &lt;IP addresses&gt; &lt;netmask&gt; [ &lt;permissions&gt; &lt;view&gt;]<br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Review the available community strings IP access control configuration:<br/><br/>grep "^community[[::space::]]" /etc/snmpd.conf<br/><br/>NOTE: validate the allowed IP address and netmasks<br/><br/><b>Reversion:</b><br/>Copy back the original /etc/snmpd.conf file:<br/><br/>cp -p /etc/snmpd.conf.pre_cis /etc/snmpd.conf<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure all active community strings should have IP restrictions">
                            <ecl:command>grep "^community[[::space::]]" /etc/snmpd.conf &gt; /dev/null || print "No community strings are configured" &amp;&amp; grep "^community[[::space::]]*[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}" /etc/snmpd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="snmp-disable-readwrite-community" selected="false">
                <xccdf:title>SNMP - disable Readwrite community access </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>If snmpd is required within the environment, disable readWrite permissions for all active community strings.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>If SNMP is required, none of the available community strings should have global readWrite permissions defined. This would allow any remote client to query and to set system configuration parameters. SNMP readWrite communities must be disabled unless absolutely necessary. If a readWrite community is enabled, then access must be granted to only trusted machines in your network. As SNMP uses community names as part of authentication, you must ensure that all community names are greater than six characters and is a mix of characters, numbers, and special characters.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Identify if there are any currently configured community strings:<br/><br/>grep "^community[[::space::]]" /etc/snmpd.conf<br/><br/>If there are active community strings, edit the configuration file:<br/><br/>vi /etc/snmpd.conf<br/><br/>Replace all instances of:<br/><br/>community &lt;community name&gt; &lt;IP addresses&gt; &lt;netmask&gt; [ readWrite &lt;view&gt;]<br/><br/>With:<br/><br/>community &lt;community name&gt; &lt;IP addresses&gt; &lt;netmask&gt; [ readOnly &lt;view&gt;]<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Review the community lines in /etc/snmpd.conf:<br/><br/>grep "^community[[::space::]]" /etc/snmpd.conf<br/><br/>NOTE: ensure that there is no readWrite access.<br/><br/><b>Reversion:</b><br/>Copy back the original /etc/snmpd.conf file:<br/><br/>cp -p /etc/snmpd.conf.pre_cis /etc/snmpd.conf<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure no 'readWrite' community lines exist" success="fail">
                            <ecl:command>egrep "^[[:space:]]*community[[:space:]]+.*readWrite.*" /etc/snmpd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
        </xccdf:Group>
	<xccdf:Group id="securing-inetd">
            <xccdf:title>Securing inetd</xccdf:title>
            
            <xccdf:Rule id="inetd-disabling-inetd" selected="false">
                <xccdf:title>inetd - disabling inetd </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>If all of services run and managed by inetd are disabled, disable the inetd daemon itself. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>If all inetd services are disabled, then there is no need to start the daemon at boot time. An administrator can manually start the inetd service post-IPL, if any of the inetd controlled <br/>services are required. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Review any active inetd services:<br/><br/>refresh -s inetd<br/>lssrc --ls inetd<br/><br/>NOTE: If there are active services and the services are required, do not disable inetd. Skip to the next section and consider the implementation of TCP Wrappers to secure access to these active services.  If the active services are not required disable them via the chsubserver command.<br/><br/>Disable inetd if there are no active services:<br/><br/>chrctcp -d inetd <br/>stopsrc -s inetd<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that inetd startup has been commented out of <xhtml:code>/etc/rc.tcpip</xhtml:code>:<br/><br/>grep "^#start[[::space::]]/usr/sbin/inetd" /etc/rc.tcpip<br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#start /usr/sbin/inetd "$src_running"<br/><br/><b>Reversion:</b><br/>Comment in inetd startup in <xhtml:code>/etc/rc.tcpip</xhtml:code>:<br/><br/>chrctcp -a inetd <br/><br/></xhtml:code></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'inetd' is disabled in '/etc/rc.tcpip'">
                            <ecl:command>egrep '^start[^#].*inetd' /etc/rc.tcpip</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="portmap-lockdown">
            <xccdf:title>Portmap Lockdown</xccdf:title>
            
            <xccdf:Rule id="etc-rc-tcpip-portmap" selected="false">
                <xccdf:title>/etc/rc.tcpip - portmap </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>If all RPC services are disabled, disable the portmap daemon itself. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>If all RPC services are disabled, then there is no need to start the portmap daemon at boot time. An administrator can manually start portmap post-IPL, if any of the RPC services are required. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Review any active RPC services:<br/><br/>rpcinfo -p localhost<br/><br/>NOTE: If there are active RPC services and the services are required, do not disable portmap. <br/><br/>Disable portmap if there are no active RPC services:<br/><br/>chrctcp -d portmap<br/>stopsrc -s portmap<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that portmap startup has been commented out of <xhtml:code>/etc/rc.tcpip</xhtml:code>:<br/><br/>grep "^#start[[::space::]]/usr/sbin/portmap" /etc/rc.tcpip<br/><br/>The above command should yield the following output:<br/><br/><xhtml:code>#start /usr/sbin/portmap "$src_running"<br/><br/><b>Reversion:</b><br/>Comment in portmap startup in <xhtml:code>/etc/rc.tcpip</xhtml:code>:<br/><br/>chrctcp -a portmap<br/><br/></xhtml:code></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'portmap' is disabled in '/etc/rc.tcpip'">
                            <ecl:command>egrep '^start[^#].*portmap' /etc/rc.tcpip</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="tcp-wrappers">
            <xccdf:title>TCP Wrappers</xccdf:title>
            
            <xccdf:Rule id="tcp-wrappers-installing-tcp-wrappers" selected="false">
                <xccdf:title>TCP Wrappers - installing TCP Wrappers </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommendation is to install and configure TCP Wrappers if there are active inetd controlled services on the system.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>TCP Wrappers is a freely available IP packet filtering facility. It provides for greater and more specific control over local network services and the hosts that are allowed to access them. It also makes use of the standard syslog facility to track local network use.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Identity any active inetd services:<br/><br/>refresh -s inetd<br/>lssrc --ls inetd<br/><br/>If there are any active TCP or UDP services, download and install the TCP Wrappers software:<br/><br/>TCP Wrappers is bundled on the AIX media expansion cdrom.<br/><br/>Alternatively, the source code may be downloaded and compiled from:<br/><br/>TCP Wrappers Source Code<br/><br/>NOTE: Ensure that the latest version is downloaded. <br/><br/>The installation example below assumes that the AIX media expansion pack cdrom has been used as the source of the software.<br/><br/>Place the TCP Wrappers software into a convenient location, such as /tmp and install via:<br/><br/>/usr/lib/instl/sm_inst installp_cmd -a -Q -d /tmp -f netsec.options.tcpwrapper,netsec.options.idprotocol -c -N -g -X -G -Y<br/>NOTE: If the software is not located in /tmp, reflect the actual location in the command above.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the installation of the software:<br/><br/>lslpp -L |grep "netsec.options"<br/><br/>The above command should yield the following output:<br/><br/>netsec.options.idprotocol  1.1.0.0    C     F    Authentication daemon(RFC1413)  netsec.options.tcpwrapper.base<br/>netsec.options.tcpwrapper.license<br/>netsec.options.tcpwrapper.man.en_US<br/>netsec.options.tcpwrapper.msg.en_US<br/>NOTE: The version numbers may differ based on the source of the software<br/><br/><b>Reversion:</b><br/>De-install the TCP Wrappers software:<br/><br/>installp -u netsec.options*<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'tcpwrappers' is installed" success="pass">
                            <ecl:command>lslpp -L | grep "netsec.options.tcpwrappers"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="tcp-wrappers-creating-a-hosts-deny-file" selected="false">
                <xccdf:title>TCP Wrappers - creating a hosts.deny file </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Once TCP Wrappers are installed a /etc/hosts.deny file should be created and be configured. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The /etc/hosts.deny  file describes the names of the hosts which are not allowed to access the local inetd services, as decided by the /usr/sbin/tcpd server. All access should be denied by default unless explicitly authorized. <br/><br/>Access is granted when a (daemon,client) pair matches an entry in the /etc/hosts.allow file. Access is denied when a (daemon,client) pair matches an entry in the /etc/hosts.deny file. However, access is granted if matching entry does not exist in both the files. This is why, by default, all access must be denied. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Create a /etc/hosts.deny  file:<br/><br/>touch /etc/hosts.deny<br/>chown root:system /etc/hosts.deny<br/>chmod u=rw,go= /etc/hosts.deny<br/><br/>Deny all traffic by default, explicit access will be defined in the /etc/hosts.allow file:<br/><br/>vi /etc/hosts.deny<br/><br/>Add:<br/><br/>ALL: ALL<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the content of the /etc/hosts.deny  file:<br/><br/>cat /etc/hosts.deny<br/><br/>The above command should yield the following output:<br/><br/>ALL: ALL<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'hosts.deny' denies all users" success="pass">
                            <ecl:command>egrep '^ALL[[:space:]]*:[[:space:]]*ALL$' /etc/hosts.deny</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="tcp-wrappers-creating-a-hosts-allow-file" selected="false">
                <xccdf:title>TCP Wrappers - creating a hosts.allow file </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Once TCP Wrappers are installed a /etc/hosts.allow file should be created and be configured. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>This file describes the names of the hosts which are allowed to access the local inetd services as decided by the /usr/sbin/tcpd server. Access is granted when a (daemon,client) pair matches an entry in the /etc/hosts.allow file. Access is denied when a (daemon,client) pair matches an entry in the /etc/hosts.deny file. However, access is granted if matching entry does not exist in both the files. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Create a /etc/hosts.allow file:<br/><br/>touch /etc/hosts.allow<br/>chown root:system /etc/hosts.allow<br/>chmod u=rw,go= /etc/hosts.allow<br/><br/>Define explicit access to the local inetd services:<br/><br/>vi /etc/hosts.allow<br/><br/>An example configuration:<br/><br/>ALL: LOCAL @some_netgroup<br/>ALL: .foobar.edu EXCEPT terminalserver.foobar.edu<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the content of the /etc/hosts.allow  file:<br/><br/>cat /etc/hosts.allow<br/><br/>The above command should reflect the defined configuration file.<br/><br/>NOTE:- Since the /etc/hosts.allow file is processed before /etc/hosts.deny , ensure that there are no entries in /etc/hosts.allow that may accidentally grant access to a system which are then subsequently  denied in /etc/hosts.deny.<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure 'hosts.allow' allows some users" success="pass">
                            <ecl:command>egrep '^ALL[[:space:]]*:[[:space:]]*.*' /etc/hosts.allow</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="tcp-wrappers-wrapping-inetd-services" selected="false">
                <xccdf:title>TCP Wrappers - wrapping inetd services </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>If TCP Wrappers have been installed because there are active inetd services, these services must utilize TCP Wrappers to restrict host access. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>By limiting access to the server, you reduce your exposure to threats from attackers on<br/>remote systems. Therefore any active inetd controlled service which cannot be disabled should be restricted so that it can only be used by trusted hosts.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Prior to implementing this recommendation it is important that hosts.deny and hosts.allow files have been created.<br/><br/>For each active TCP and UDP inetd service, change the entry in <xhtml:code>/etc/inetd.conf</xhtml:code>, so that tcpd is executed. <br/><br/>Copy the current <xhtml:code>/etc/inetd.conf</xhtml:code> file for reversion purposes:<br/><br/>cp -p /etc/inetd.conf /etc/inetd.conf.pre_tcp_wrappers<br/><br/>For example, to utilize TCP Wrappers on the telnet service:<br/><br/>Edit:<br/><br/>vi /etc/inetd.conf<br/><br/>Change:<br/><br/>telnet stream tcp6 nowait root /usr/sbin/telnetd telnetd<br/><br/>To:<br/><br/>telnet stream tcp nowait root /usr/sbin/tcpd telnetd	<br/><br/>Repeat the change for other services. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that the amended service line reflects the tcpd path:<br/><br/>grep "^&lt;service name&gt;[[:blank::]]" /etc/inetd.conf |grep "tcpd"<br/><br/>The above command should yield output.<br/><br/><b>Reversion:</b><br/>Copy back the original <xhtml:code>/etc/inetd.conf</xhtml:code> file:<br/><br/>cp -p /etc/inetd.conf.pre_tcp_wrappers /etc/inetd.conf<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure active inetd services are tcp wrapped">
                            <ecl:command>egrep -v "^#|[[:space:]]/usr/sbin/tcpd[[:space:]]" /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="permissions-and-ownership">
            <xccdf:title>Permissions and Ownership</xccdf:title>
            
            <xccdf:Rule id="permissions-and-ownership-etc-security" selected="false">
                <xccdf:title>Permissions and Ownership - /etc/security </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This /etc/security directory contains the user and group configuration files and the encrypted passwords. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The /etc/security directory contains sensitive files such as /etc/security/passwd , /etc/security/group. It must be secured from unauthorized access and modifications. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Remove world read, write and execute access and  group write access from /etc/security :<br/><br/>chown -R root:security /etc/security <br/>chmod u=rwx,g=rx,o= /etc/security <br/>chmod -R go-w,o-rx /etc/security<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the permissions of /etc/security:<br/><br/>ls --ld /etc/security | awk '{print $1 " " $3 " " $4 " " $9}'<br/><br/>The above command should yield the following output:<br/><br/>drwxr-x---    root     security       /etc/security<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure group/other have no write permissions on '/etc/security' and other has no read/execute" success="pass">
                            <ecl:command>ls -ld /etc/security | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                            <ecl:line-selection op="pm" value="^dr(w|-)x(r|-)-(x|-)---\s+root\s+security\s*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="permissions-and-ownership-etc-group" selected="false">
                <xccdf:title>Permissions and Ownership - /etc/group </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The /etc/group file contains a list of the groups defined within the system. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The /etc/group file defines basic group attributes. Since the file contains sensitive information, it must be properly secured. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Ensure correct ownership and permissions are in place for /etc/group :<br/><br/>chown root:security /etc/group <br/>chmod u=rw,go=r /etc/group<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the permissions of /etc/group:<br/><br/>ls -l /etc/group | awk '{print $1 " " $3 " " $4 " " $9}'<br/><br/>The above command should yield the following output:<br/><br/>-rw-r--r--    root     security       /etc/group<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure group/other have no write/execute permissions on '/etc/group'" success="pass">
                            <ecl:command>ls -l /etc/group | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                            <ecl:line-selection op="pm" value="^-r(w|-)-(r|-)--(r|-)--\s+root\s+security\s*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="permissions-and-ownership-etc-passwd" selected="false">
                <xccdf:title>Permissions and Ownership - /etc/passwd </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The /etc/passwd file contains a list of the users defined within the system. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The /etc/passwd file defines all users within the system. Since the file contains sensitive information, it must be properly secured. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Ensure correct ownership and permissions are in place for /etc/passwd :<br/><br/>chown root:security /etc/passwd <br/>chmod u=rw,go=r /etc/passwd<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the permissions of /etc/passwd:<br/><br/>ls -l /etc/passwd | awk '{print $1 " " $3 " " $4 " " $9}'<br/><br/>The above command should yield the following output:<br/><br/>-rw-r--r--    root     security       /etc/passwd<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure group/other have no write/execute permissions on '/etc/passwd'" success="pass">
                            <ecl:command>ls -l /etc/passwd | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                            <ecl:line-selection op="pm" value="^-r(w|-)-(r|-)--(r|-)--\s+root\s+security\s*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="permissions-and-ownership-etc-security-audit" selected="false">
                <xccdf:title>Permissions and Ownership - /etc/security/audit </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The /etc/security/audit directory contains the system audit configuration files. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The /etc/security/audit directory stores the audit configuration files. This directory must have adequate access controls to prevent unauthorized access. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Ensure correct ownership and permissions are in place for /etc/security/audit :<br/><br/>chown -R root:audit /etc/security/audit <br/>chmod u=rwx,g=rx,o= /etc/security/audit <br/>chmod -R u=rw,g=r,o= /etc/security/audit/* <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the permissions of /etc/security/audit:<br/><br/>ls -ld /etc/security/audit | awk '{print $1 " " $3 " " $4 " " $9}'<br/><br/>The above command should yield the following output:<br/><br/>drwxr-x---    root     audit           /etc/security/audit<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure group/other have no write permissions on '/etc/security/audit' and other has no read/execute" success="pass">
                            <ecl:command>ls -ld /etc/security/audit | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                            <ecl:line-selection op="pm" value="^dr(w|-)x(r|-)-(x|-)---\s+root\s+audit\s*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="permissions-and-ownership-audit" selected="false">
                <xccdf:title>Permissions and Ownership - /audit </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The /audit directory holds the output produced from the audit subsystem. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The /audit directory stores the audit output files. This directory must have adequate access controls to prevent unauthorized access.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Ensure correct ownership and permissions are in place for /audit:<br/><br/>chown root:audit /audit <br/>chmod u=rwx,g=rx,o= /audit <br/>chmod -R u=rw,g=r,o= /audit/*<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the permissions of /audit:<br/><br/>ls --ld /audit | awk '{print $1 " " $3 " " $4 " " $9}'<br/><br/>The above command should yield the following output:<br/><br/>drwxr-x---    root     audit           /audit<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure group/other have no write permissions on '/audit' and other has no read/execute" success="pass">
                            <ecl:command>ls -ld /audit | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                            <ecl:line-selection op="pm" value="^dr(w|-)x(r|-)-(x|-)---\s+root\s+audit\s*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="permissions-and-ownership-smit.log" selected="false">
                <xccdf:title>Permissions and Ownership - /smit.log </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The/smit.log file maintains a history of all smit commands run as root. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The /smit.log  file may contain sensitive information regarding system configuration, which may be of interest to an attacker. This log file must be secured from unauthorized access and modifications.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Remove world read and write access to /smit.log :<br/><br/>chmod o-rw /smit.log<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the permissions of /smit.log :<br/><br/>ls -l /smit.log | awk '{print $1 " " $3 " " $4 " " $9}'<br/><br/>The above command should yield the following output:<br/><br/>-rw-r-----    root     system        /smit.log<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure group/other have no write permissions on '/smit.log' and other has no read/execute" success="pass">
                            <ecl:command>ls -l /smit.log | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                            <ecl:line-selection op="pm" value="^-r(w|-)-(r|-)-----\s+root\s+system\s*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="permissions-and-ownership-var-adm-cron-log" selected="false">
                <xccdf:title>Permissions and Ownership - /var/adm/cron/log </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The /var/adm/cron file contains a log of all cron jobs run on the system. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The /var/adm/cron/log, records all cron jobs run on the system. The file permissions must ensure that it is accessible only to its owner and group. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Remove world read and write access to /var/adm/cron/log :<br/><br/>chmod o-rw /var/adm/cron/log  <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the permissions of /var/adm/cron/log:<br/><br/>ls -l /var/adm/cron/log | awk '{print $1 " " $3 " " $4 " " $9}'<br/><br/>The above command should yield the following output:<br/><br/>-rw-rw----    root     cron         /var/adm/cron/log<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure group/other have no execute permissions on '/var/adm/cron/log' and other has no read/write" success="pass">
                            <ecl:command>ls -l /var/adm/cron/log | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                            <ecl:line-selection op="pm" value="^-r(w|-)-(r|-)(w|-)----\s+root\s+cron\s*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="permissions-and-ownership-var-spool-cron-crontabs" selected="false">
                <xccdf:title>Permissions and Ownership - /var/spool/cron/crontabs </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The /var/spool/cron/crontabs directory contains all of the crontabs for the users on the system. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The /var/spool/cron/crontabs directory contains all of the crontabs for the users on the system.  Crontab files present a security problem because they are run by the cron daemon, which runs with super user rights. Allowing other users to have read/write permissions on these files may allow them to escalate their privileges. To negate this risk, the directory and all the files that it contains must be secured. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Apply the appropriate permissions to /var/spool/cron/crontabs:<br/><br/>chmod -R o= /var/spool/cron/crontabs <br/>chmod ug=rwx,o= /var/spool/cron/crontabs<br/>chgrp -R cron /var/spool/cron/crontabs<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the permissions of /var/spool/cron/crontabs:<br/><br/>ls -ld /var/spool/cron/crontabs | awk '{print $1 " " $3 " " $4 " " $9}'<br/><br/>The above command should yield the following output:<br/><br/>drwxrwx---    root     cron         /var/spool/cron/crontabs<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure other has no read/write/execute permissions on '/var/adm/cron/crontabs'" success="pass">
                            <ecl:command>ls -ld /var/spool/cron/crontabs | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                            <ecl:line-selection op="pm" value="^dr(w|-)(x|-)(r|-)(w|-)(x|-)---\s+root\s+cron\s*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="permissions-and-ownership-var-adm-cron-at.allow" selected="false">
                <xccdf:title>Permissions and Ownership - /var/adm/cron/at.allow </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The /var/adm/cron/at.allow file contains a list of users who can schedule jobs via the at command. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The /var/adm/cron/at.allow file controls which users can schedule jobs via the at command. Only the root user should have permissions to create, edit, or delete this file. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Apply the appropriate permissions to /var/adm/cron/at.allow:<br/><br/>chown root:sys /var/adm/cron/at.allow <br/>chmod u=r,go= /var/adm/cron/at.allow<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the permissions of /var/adm/cron/at.allow:<br/><br/>ls -l /var/adm/cron/at.allow | awk '{print $1 " " $3 " " $4 " " $9}'<br/><br/>The above command should yield the following output:<br/><br/>-r--------    root     sys         /var/adm/cron/at.allow<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure group/other has no read/write/execute permissions on '/var/adm/cron/at.allow'" success="pass">
                            <ecl:command>ls -l /var/adm/cron/at.allow | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                            <ecl:line-selection op="pm" value="^-r(w|-)-------\s+root\s+sys\s*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="permissions-and-ownership-var-adm-cron-cron.allow" selected="false">
                <xccdf:title>Permissions and Ownership - /var/adm/cron/cron.allow </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The /var/adm/cron/cron.allow file contains a list of users who can schedule jobs via the cron command. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The /var/adm/cron/cron.allow file controls which users can schedule jobs via cron. Only the root user should have permissions to create, edit, or delete this file. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Apply the appropriate permissions to /var/adm/cron/cron.allow:<br/><br/>chown root:sys /var/adm/cron/cron.allow <br/>chmod u=r,go= /var/adm/cron/cron.allow<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the permissions of /var/adm/cron/cron.allow:<br/><br/>ls -l /var/adm/cron/cron.allow | awk '{print $1 " " $3 " " $4 " " $9}' theone <br/><br/>The above command should yield the following output:<br/><br/>-r--------    root     sys         /var/adm/cron/cron.allow<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure group/other has no read/write/execute permissions on '/var/adm/cron/cron.allow'" success="pass">
                            <ecl:command>ls -l /var/adm/cron/cron.allow | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                            <ecl:line-selection op="pm" value="^-r(w|-)-------\s+root\s+sys\s*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="permissions-and-ownership-etc-motd" selected="false">
                <xccdf:title>Permissions and Ownership - /etc/motd </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The /etc/motd file contains the message of the day, shown after successful initial login. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The /etc/motd file contains the message of the day, shown after successful initial login. The file should only be editable by its owner. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Apply the appropriate permissions to /etc/motd:<br/><br/>chown bin:bin /etc/motd <br/>chmod u=rw,go=r /etc/motd<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the permissions of /etc/motd:<br/><br/>ls -l /etc/motd | awk '{print $1 " " $3 " " $4 " " $9}'<br/><br/>The above command should yield the following output:<br/><br/>-rw-r--r--    bin     bin         /etc/motd<br/><br/><b>Reversion:</b><br/>Revert to the previous permissions<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure group/other has no write/execute permissions on '/etc/motd'" success="pass">
                            <ecl:command>ls -l /etc/motd | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                            <ecl:line-selection op="pm" value="^-r(w|-)-(r|-)--(r|-)--\s+bin\s+bin\s*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="permissions-and-ownership-var-adm-ras" selected="false">
                <xccdf:title>Permissions and Ownership - /var/adm/ras </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The /var/adm/ras directory contains log files which contain sensitive information such as login times and IP addresses. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The log files in the /var/adm/ras directory can contain sensitive information such as login times and IP addresses, which may be altered by an attacker when removing traces of system access. All files in this directory must be secured from unauthorized access and modifications. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Remove world read and write access from all files in /var/adm/ras :<br/><br/>chmod o-rw /var/adm/ras/*<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the permissions of the files in /var/adm/ras:<br/><br/>ls -l /var/adm/ras | awk '{print $1 " " $3 " " $4 " " $9}'<br/><br/>NOTE: The output from the command above will contain numerous files. No files should have read or write permission for other<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure other has no read/write/execute permissions on files in '/var/adm/ras'" success="fail">
                            <ecl:command>ls -l /var/adm/ras | egrep -v '^(d|-)r(w|-)(x|-)(r|-)(w|-)(x|-)---|total'</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="permissions-and-ownership-var-ct-rmstart-log" selected="false">
                <xccdf:title>Permissions and Ownership - /var/ct/RMstart.log </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The /var/ct/RMstart.log is the logfile used by RMC and can contain sensitive data that must be secured.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>RMC provides a single monitoring and management infrastructure for both RSCT peer domains and management domains. Its generalized framework is used by cluster management tools to monitor, query, modify, and control cluster resources, /var/ct/RMstart.log is the logfile used by RMC and can contain sensitive data that must be secured. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Remove world read and write from /var/ct/RMstart.log:<br/><br/>chmod o-rw /var/ct/RMstart.log <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the permissions of /var/ct/RMstart.log:<br/><br/>ls -l /var/ct/RMstart.log | awk '{print $1 " " $3 " " $4 " " $9}'<br/><br/>The above command should yield the following output:<br/><br/>-rw-r-----    root     system       /var/ct/RMstart.log<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure group/other has no write/execute permissions on  '/var/ct/RMstart.log' and other has no read permission" success="pass">
                            <ecl:command>ls -l /var/ct/RMstart.log | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                            <ecl:line-selection op="pm" value="^-r(w|-)-(r|-)-----\s+root\s+system\s*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="permissions-and-ownership-var-tmp-dpid2-log" selected="false">
                <xccdf:title>Permissions and Ownership - /var/tmp/dpid2.log </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The /var/tmp/dpid2.log is the logfile used by dpid2 daemon, and contains SNMP information.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The /var/tmp/dpid2.log logfile is used by the dpid2 daemon and can contain sensitive SNMP information. This file must be secured from unauthorized access and modifications. <br/><br/>As part of the default implementation of the customized XML file, dpid2 will have been disabled. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Remove world read and write from /var/tmp/dpid2.log:<br/><br/>chmod o-rw /var/tmp/dpid2.log <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the permissions of /var/tmp/dpid2.log:<br/><br/>ls -l /var/tmp/dpid2.log | awk '{print $1 " " $3 " " $4 " " $9}'<br/><br/>The above command should yield the following output:<br/><br/>-rw-r-----    root     system       /var/tmp/dpid2.log<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure group/other has no write/execute permissions on  '/var/tmp/dpid2.log' and other has no read permission" success="pass">
                            <ecl:command>ls -l /var/tmp/dpid2.log | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                            <ecl:line-selection op="pm" value="^-r(w|-)-(r|-)-----\s+root\s+system\s*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="permissions-and-ownership-var-tmp-hostmibd-log" selected="false">
                <xccdf:title>Permissions and Ownership - /var/tmp/hostmibd.log </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The /var/tmp/hostmibd.log is the logfile used by hostmibd daemon, and contains network and machine related information.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The /var/tmp/hostmibd.log logfile can contain network and machine related statistics logged by the daemon. This file must be secured from unauthorized access and modifications.<br/><br/>As part of the default implementation of the customized XML file, hostmibd will have been disabled. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Remove world read and write from /var/tmp/hostmibd.log:<br/><br/>chmod o-rw /var/tmp/hostmibd.log <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the permissions of /var/tmp/hostmibd.log:<br/><br/>ls -l /var/tmp/hostmibd.log | awk '{print $1 " " $3 " " $4 " " $9}'<br/><br/>The above command should yield the following output:<br/><br/>-rw-r-----    root     system       /var/tmp/hostmibd.log<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure group/other has no write/execute permissions on  '/var/tmp/hostmibd.log' and other has no read permission" success="pass">
                            <ecl:command>ls -l /var/tmp/hostmibd.log | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                            <ecl:line-selection op="pm" value="^-r(w|-)-(r|-)-----\s+root\s+system\s*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="permissions-and-ownership-var-tmp-snmpd-log" selected="false">
                <xccdf:title>Permissions and Ownership - /var/tmp/snmpd.log </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The /var/tmp/snmpd.log is the logfile used by snmpd daemon, and contains network and machine related information.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The /var/tmp/snmpd.log logfile contains sensitive information through which an attacker can find out about the SNMP deployment architecture in your network. This log file must be secured from unauthorized access.<br/><br/>As part of the default implementation of the customized XML file, snmpd will have been disabled. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Remove world read and write from /var/tmp/snmpd.log:<br/><br/>chmod o-rw /var/tmp/snmpd.log <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the permissions of /var/tmp/snmpd.log:<br/><br/>ls -l /var/tmp/snmpd.log | awk '{print $1 " " $3 " " $4 " " $9}'<br/><br/>The above command should yield the following output:<br/><br/>-rw-r-----    root     system       /var/tmp/snmpd.log<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure group/other has no write/execute permissions on  '/var/tmp/snmpd.log' and other has no read permission" success="pass">
                            <ecl:command>ls -l /var/tmp/snmpd.log | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                            <ecl:line-selection op="pm" value="^-r(w|-)-(r|-)-----\s+root\s+system\s*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="permissions-and-ownership-var-adm-sa" selected="false">
                <xccdf:title>Permissions and Ownership --/var/adm/sa </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The /var/adm/sa directory holds the performance data produced by the sar utility.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The /var/adm/sa directory contains the report files produced by the sar utility. This directory must be secured from unauthorized access.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Set the recommended ownership and permissions on /var/adm/sa:<br/><br/>chown adm:adm /var/adm/sa <br/>chmod u=rwx,go=rx /var/adm/sa<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the permissions of /var/adm/sa:<br/><br/>ls --ld /var/adm/sa | awk '{print $1 " " $3 " " $4 " " $9}'<br/><br/>The above command should yield the following output:<br/><br/>rwxr-xr-x    adm     adm       /var/adm/sa<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure group/other has no write permissions on  '/var/adm/sa'" success="pass">
                            <ecl:command>ls -ld /var/adm/sa | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                            <ecl:line-selection op="pm" value="^dr(w|-)x(r|-)-(x|-)(r|-)-(x|-)\s+adm\s+adm\s*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="permissions-and-ownership-world-writable-directory-in-root-path" selected="false">
                <xccdf:title>Permissions and Ownership - world/group writable directory in root PATH </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>To secure the root users executable PATH, all directories must not be group and world writable. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>There should not be group or world writable directories in the root users executable path. This may allow an attacker to gain super user access by forcing an administrator operating as root to execute a Trojan horse program. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
			<xhtml:p>Search and report on group or world writable directories in roots PATH. The command must be run as the root user.  The script below traverses up each individual directory PATH, ensuring that all directories are not group/world writable and that they are owned by root or the bin user<br/><br/>su - root -c "echo /:${PATH}" | tr ':' '\n' | while read DIR <br/>do<br/>DIR=${DIR:-$(pwd)}<br/>print "Checking ${DIR}"<br/>while [[ -d ${DIR} ]]<br/>do<br/>[[ "$(ls -ld ${DIR})" = @(????????w? *) ]] &amp;&amp; print " WARNING ${DIR} is world writable"<br/>[[ "$(ls -ld ${DIR})" = @(?????w???? *) ]] &amp;&amp; print " WARNING ${DIR} is group writable"<br/>[[ "$(ls -ld ${DIR} |awk '{print $3}')" != @(root|bin) ]] &amp;&amp; print " WARNING ${DIR} is not owned by root or bin"<br/>DIR=${DIR%/*}<br/>done<br/>done<br/><br/>NOTE: Review the output and manually change the directories, if possible. Directories which are group and/or world writable are marked with WARNING<br/><br/>To manually change permissions on the files or directories:<br/><br/>To remove group writable access:<br/><br/>chmod g-w &lt;name&gt;<br/><br/>To remove world writable access:<br/><br/>chmod o-w &lt;name&gt;<br/><br/>To remove both group and world writable access:<br/><br/>chmod go-w &lt;name&gt;<br/><br/>To change the owner of a directory:<br/><br/>chown &lt;owner&gt; &lt;dir name&gt;  <br/><br/> To fully automate the PATH directory permission changes:<br/><br/>su - root -c "echo /:${PATH}" | tr ':' '\n' | while read DIR <br/>do<br/>DIR=${DIR:-$(pwd)}<br/>print "Checking ${DIR}"<br/>while [[ -d ${DIR} ]]<br/>do<br/>[[ "$(ls -ld ${DIR})" = @(????????w? *) ]] &amp;&amp; chmod o-w ${DIR} &amp;&amp; print "Removing world write from ${DIR}"<br/>[[ "$(ls -ld ${DIR})" = @(?????w???? *) ]] &amp;&amp; chmod g-w ${DIR} &amp;&amp; print "Removing group write from ${DIR}"<br/>DIR=${DIR%/*}<br/>done<br/>done<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Execute the following code:<br/><br/>su - root -c "echo /:${PATH}" | tr ':' '\n' | while read DIR <br/>do<br/>DIR=${DIR:-$(pwd)}<br/>print "Checking ${DIR}"<br/>while [[ -d ${DIR} ]]<br/>do<br/>[[ "$(ls -ld ${DIR})" = @(????????w? *) ]] &amp;&amp; print " WARNING ${DIR} is world writable"<br/>[[ "$(ls -ld ${DIR})" = @(?????w???? *) ]] &amp;&amp; print " WARNING ${DIR} is group writable"<br/>[[ "$(ls -ld ${DIR} |awk '{print $3}')" != @(root|bin) ]] &amp;&amp; print " WARNING ${DIR} is not owned by root or bin"<br/>DIR=${DIR%/*}<br/>done<br/>done<br/><br/>The above command should yield no output<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <!-- this assumes CISCAT is run by root which it should be -->
                        <ecl:shell-command check="none exist" comment="Ensure root PATH has no world-writable directories" success="pass">
                            <ecl:command>find `echo "/:$PATH" | tr ':' ' '` -type d -prune \( -perm -002 -o -perm -020 \) -ls</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="permissions-and-ownership-home-directory-configuration-files" selected="false">
                <xccdf:title>Permissions and Ownership - home directory configuration files </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The user configuration files in each home directory e.g. $HOME/.profile, must not be group or world writable.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>Group or world-writable user configuration files may enable malicious users to steal or modify other user's data, or to gain elevated privileges.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Search and remediate any user configuration files which have group or world writable access:<br/><br/>lsuser -a home ALL |cut -f2 -d= | while read HOMEDIR; do<br/>echo "Examining $HOMEDIR"<br/>if [ -d $HOMEDIR ]; then<br/>ls -a $HOMEDIR | grep -Ev "^.$|^..$" | \<br/>while read FILE; do<br/>if [ -f $FILE ]; then<br/>ls -l $FILE<br/>chmod go-w $FILE<br/>fi<br/>done<br/>else<br/>echo "No home dir for $HOMEDIR"<br/>fi<br/>done<br/><br/>NOTE: The permission change is automatically applied<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Re-execute the remediation script and all listed files in each user directory, should not have group or world writable permissions.<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure no group/other writable .profile files exist">
                            <ecl:command>find `lsuser -a home ALL | cut -f2 -d= |sort -u` -type f -name '.profile' \( -perm -g+w -o -perm -o+w \) -ls</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="permissions-and-ownership-home-directory-permissions" selected="false">
                <xccdf:title>Permissions and Ownership - home directory permissions </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>All user home directories must not have group write or world writable access.  <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>Group or world-writable user home directories may enable malicious users to steal or modify data, or to gain other user's system privileges. Disabling read and execute access for users, who are not members of the same group, allows for appropriate use of discretionary access control by each user.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Change any home directories which have group or world writable access:<br/><br/>NEW_PERMS=750 <br/>lsuser -c ALL | grep -v ^<xhtml:code>#name | cut -f1 -d: | while read NAME; do <br/>if [ `lsuser -f $NAME | grep id | cut -f2 -d=` -ge 200 ]; then <br/>HOME=`lsuser -a home $NAME | cut -f 2 -d =` <br/>echo "Changing $NAME homedir $HOME" <br/>chmod $NEW_PERMS $HOME <br/>fi <br/>done<br/><br/>NOTE: The permission change is automatically applied to all user directories with a user ID over 200.<br/><br/>Modify /usr/lib/security/mkuser.sys to ensure that all new user home directories will be created with a default permission of 750:<br/><br/>vi /usr/lib/security/mkuser.sys<br/><br/>Replace:<br/><br/>mkdir $1<br/><br/>With:<br/><br/>mkdir $1 &amp;&amp; chmod u=rwx,g=rx,g= $1<br/><br/></xhtml:code></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the permissions of all of the directories changed:<br/><br/>lsuser -c ALL | grep -v ^<xhtml:code>#name | cut -f1 -d: | while read NAME; do <br/>if [ `lsuser -f $NAME | grep id | cut -f2 -d=` -ge 200 ]; then <br/>HOME=`lsuser -a home $NAME | cut -f 2 -d =` <br/>ls -ld $HOME<br/>fi <br/>done<br/><br/>NOTE: All listed directories should have drwxr-x--- permissions<br/><br/>Ensure that the change has been made to /usr/lib/security/mkuser.sys to reflect permissions setting:<br/><br/>grep -c 'mkdir $1 &amp;&amp; chmod u=rwx,g=rx,g= $1' /usr/lib/security/mkuser.sys<br/> <br/>NOTE: The output from the command above should be 1<br/><br/></xhtml:code></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure no group/other writable home directories files exist">
                            <ecl:command>find `lsuser -a home ALL | cut -f2 -d= |sort -u` -type d -prune \( -perm -g+w -o -perm -o+w \) -ls</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="miscellaneous-configuration-changes">
            <xccdf:title>Miscellaneous Configuration Changes</xccdf:title>
            
            <xccdf:Rule id="miscellaneous-config-serial-port-restriction" selected="false">
                <xccdf:title>Miscellaneous Config - serial port restriction </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommendation is to disable the login capability of all connected tty devices.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>It is recommended that the login capability for all serial ports is disabled, so that unauthorized users cannot attach modems or remote access devices to these ports and bypass any network access control.<br/><br/>If the environment utilizes tty devices to facilitate user connections. This recommendation may be ignored.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Create a list of active tty ports:<br/><br/>lsitab -a |grep "on:/usr/sbin/getty"<br/><br/>If any tty devices are returned from the previous output, lock down each one via:<br/><br/>chitab "tty2:2:off:/usr/sbin/getty /dev/tty2"<br/><br/>NOTE: Replace tty2 with the relevant port<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that all tty devices are now disabled:<br/><br/>lsitab -a |grep "on:/usr/sbin/getty"<br/><br/>The above command should yield no output:<br/><br/><b>Reversion:</b><br/>Re-enable login for the tty port/s:<br/><br/>chitab "tty2:2:on:/usr/sbin/getty /dev/tty2"<br/><br/>NOTE: Replace tty2 with the relevant port<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure all tty devices disabled" success="fail">
                            <ecl:command>lsitab -a | grep "on:/usr/sbin/getty"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="miscellaneous-config-disable-i4ls" selected="false">
                <xccdf:title>Miscellaneous Config - disable i4ls </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommendation is to disable the i4ls license manager. This is typically used for C and Cobol license management. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>It is recommended that the i4ls license manager is disabled. The license manager is needed for C and Cobol compilers etc. If the environment supports NCS and a license server is required, a node locked license server should be used instead.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Identify if i4ls is enabled:<br/><br/>lsitab i4ls<br/><br/>If the command above yields output, remove via:<br/><br/>rmitab i4ls<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that i4ls is now disabled:<br/><br/>lsitab i4ls<br/><br/>The above command should yield no output.<br/><br/><b>Reversion:</b><br/>Re-add the i4ls startup line to <xhtml:code>/etc/inittab</xhtml:code>:<br/><br/>mkitab "i4ls:2:wait:/etc/i4ls.rc &gt; /dev/null 2&gt;&amp;1 <xhtml:code># Start i4ls"<br/><br/></xhtml:code></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'i4ls' is disabled" success="fail">
                            <ecl:command>lsitab i4ls</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="miscellaneous-config-disable-ncs" selected="false">
                <xccdf:title>Miscellaneous Config - disable NCS </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommendation is to disable Network Computing System (NCS). It provide tools for designing, implementing, and supporting applications requiring distributed data and distributed computing.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>NCS is an implementation of the Network Computing Architecture developed to provide tools for designing, implementing, and supporting applications requiring distributed data and distributed computing. It is recommended that NCS is disabled, unless it is required within the environment. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Identify if NCS is enabled:<br/><br/>lsitab -a |grep "/etc/rc.ncs" | cut -f1 -d:<br/><br/>If the command above yields output, remove via:<br/><br/>rmitab rcncs<br/><br/>NOTE: If the output from the lsitab command was not rcncs, substitute that above.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that NCS is now disabled:<br/><br/>lsitab rcncs<br/><br/>NOTE: If the output from the lsitab command was not rcncs, substitute that above.<br/><br/>The above command should yield no output.<br/><br/><b>Reversion:</b><br/>Re-add the NCS startup line to <xhtml:code>/etc/inittab</xhtml:code>:<br/><br/>mkitab "rcncs:2:wait:/etc/rc.ncs &gt; /dev/console 2&gt;&amp;1 <xhtml:code>#Start NCS"<br/><br/></xhtml:code></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'ncs' is disabled" success="fail">
                            <ecl:command>lsitab ncs</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="miscellaneous-config-disable-httpdlite" selected="false">
                <xccdf:title>Miscellaneous Config - disable httpdlite </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommendation is to disable httpdlite. This is a web server which provides on-line documentation.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>httpdlite is the Lite NetQuestion Web server software for online documentation. It is recommended that this software is disabled, unless it is required in the environment.<br/><br/>NOTE: The man command does not need this to work correctly.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Identify if httpdlite is enabled:<br/><br/>lsitab httpdlite<br/><br/>If the command above yields output, remove via:<br/><br/>rmitab httpdlite<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that httpdlite is now disabled:<br/><br/>lsitab httpdlite<br/><br/>The above command should yield no output.<br/><br/><b>Reversion:</b><br/>Re-add the httpdlite startup line to <xhtml:code>/etc/inittab</xhtml:code>:<br/><br/>mkitab "httpdlite:2:once:/usr/IMNSearch/httpdlite/httpdlite -r /etc/IMNSearch/httpdlite/httpdlite.conf &amp; &gt;/dev/console 2&gt;&amp;1" <br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'httpdlite' is disabled" success="fail">
                            <ecl:command>lsitab httpdlite</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="miscellaneous-config-disable-pmd" selected="false">
                <xccdf:title>Miscellaneous Config - disable pmd </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommendation is to disable pmd. This is the power management service that turns the machine off if it has been idle for a specific amount of time. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>pmd is the power management service that turns the machine off if it has been idle for a specific amount of time. This recommendation is to disable this service.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Identify if pmd is enabled:<br/><br/>lsitab pmd<br/><br/>If the command above yields output, remove via:<br/><br/>rmitab pmd<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that pmd is now disabled:<br/><br/>lsitab pmd<br/><br/>The above command should yield no output.<br/><br/><b>Reversion:</b><br/>Readd the pmd startup line to <xhtml:code>/etc/inittab</xhtml:code>:<br/><br/>mkitab "pmd:2:wait:/usr/bin/pmd &gt; /dev/console 2&gt;&amp;1 <xhtml:code># Start PM daemon" <br/><br/></xhtml:code></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'pmd' is disabled" success="fail">
                            <ecl:command>lsitab pmd</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="miscellaneous-config-disable-writesrv" selected="false">
                <xccdf:title>Miscellaneous Config - disable writesrv </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommendation is to disable writesrv. This allows users to chat using the system write facility on a terminal. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>writesrv allows users to chat using the system write facility on a terminal. The recommendation is that this service must be disabled.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Identify if writesrv is enabled:<br/><br/>lsitab writesrv<br/><br/>If the command above yields output, remove via:<br/><br/>rmitab writesrv<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that writesrv is now disabled:<br/><br/>lsitab writesrv<br/><br/>The above command should yield no output.<br/><br/><b>Reversion:</b><br/>Readd the writesrv startup line to <xhtml:code>/etc/inittab</xhtml:code>:<br/><br/>mkitab "writesrv:2:wait:/usr/bin/startsrc -swritesrv"  <br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'writesrv' is disabled" success="fail">
                            <ecl:command>lsitab writesrv</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="miscellaneous-config-block-talk-write-" selected="false">
                <xccdf:title>Miscellaneous Config - block talk/write  </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommendation is to block talk and write. This allows connected users to chat within terminal sessions.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The recommendation is to block attempts to use the write or talk commands. This improves the security of the tty device. <br/><br/>However, there are two exceptions: <br/><br/>1)	The super user can write to anyone<br/>2)	If you are logged in as the same user who has turned the messages off, you can write to the super user<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Disable talk and write for ALL shells:<br/><br/>echo "mesg n" &gt;&gt; /etc/profile <br/>echo "mesg n" &gt;&gt; /etc/csh.login <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that talk and write have been disabled:<br/><br/>grep -c "mesg n" /etc/profile <br/>grep -c "mesg n" /etc/csh.login<br/><br/>NOTE: Both commands should return a value of 1<br/><br/><b>Reversion:</b><br/>Remove the mesg entries from /etc/profile and /etc/csh.login:<br/><br/>vi /etc/profile<br/>vi /etc/csh.login<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure 'write' and 'talk' are disabled" success="pass">
                            <ecl:command>[[ $(grep -c "mesg n" /etc/profile) -eq "1" ]] &amp;&amp; [[ $(grep -c "mesg n" /etc/csh.login) -eq "1" ]] &amp;&amp; RC=0</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="miscellaneous-config-enable-sar-accounting" selected="false">
                <xccdf:title>Miscellaneous Config - enable sar accounting </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommendation is to enable sar performance accounting. This will provide a normal performance baseline which will help identify unusual performance patterns, created through potential attacks via a password cracking program being executed or through a DoS attack etc.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>System accounting gathers periodic baseline system data, such as CPU utilization and disk I/O. Once a normal baseline for the system has been established, unauthorized activities, such as a password cracking being executed and activity outside of normal usage hours may be detected due to departure from the normal system performance baseline. It is recommended that the  collection script is run on an hourly basis, every day, to help to detect any anomalies. It is also important to generate and review the system activity report on a daily basis. <br/><br/>There may be 3rd party tools, or in-house written scripts in place which perform a similar function. In this instance this recommendation can be ignored. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Prior to configuring sar reporting, ensure that the bos.acct fileset is installed:<br/><br/>lslpp -l bos.acct<br/><br/>NOTE: The bos.acct fileset should be listed, along with the currently installed version<br/><br/>If the software is not installed, install from the relevant AIX media pack:<br/> <br/>/usr/lib/instl/sm_inst installp_cmd -a -Q -d /tmp -f bos.acct -c -N -g -X -G -Y<br/>NOTE: If the software is not located in /tmp, reflect the actual location in the command above.<br/><br/>Edit the adm user crontab:<br/><br/>vi /var/spool/cron/crontabs/adm<br/><br/>NOTE: There are commented out example system activity report lines. Review and tailor to the needs of the environment:<br/><br/><xhtml:code>#=================================================================<br/>#      SYSTEM ACTIVITY REPORTS<br/>#  8am-5pm activity reports every 20 mins during weekdays.<br/>#  activity reports every an hour on Saturday and Sunday.<br/>#  6pm-7am activity reports every an hour during weekdays.<br/>#  Daily summary prepared at 18:05.<br/>#=================================================================<br/>#0 8-17 * * 1-5 /usr/lib/sa/sa1 1200 3 &amp;<br/>#0 * * * 0,6 /usr/lib/sa/sa1 &amp;<br/>#0 18-7 * * 1-5 /usr/lib/sa/sa1 &amp;<br/>#5 18 * * 1-5 /usr/lib/sa/sa2 -s 8:00 -e 18:01 -i 3600 -ubcwyaqvm &amp;<br/><br/>NOTE: Change and uncomment the lines where appropriate. Refer to the sar documentation for further guidance<br/><br/>Create the reporting directory structure and apply the appropriate permissions:<br/><br/>mkdir -p /var/adm/sa <br/>chown adm:adm /var/adm/sa <br/>chmod u=rwx,go=rx /var/adm/sa<br/><br/></xhtml:code></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Review the adm user crontab:<br/><br/>cat /var/spool/cron/crontabs/adm<br/><br/>The above command should yield output which reflects the changes made in the remediation section. <br/><br/><b>Reversion:</b><br/>Comment out the entries in the adm user crontab:<br/><br/>vi /var/spool/cron/crontabs/adm<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>

                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure system auditing is enabled in crontab" success="pass">
                            <ecl:command>cat /var/spool/cron/crontabs/adm | grep "^[^#].*/usr/lib/sa/.*</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="miscellaneous-config-etc-ftpusers" selected="false">
                <xccdf:title>Miscellaneous Config - /etc/ftpusers </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The /etc/ftpusers is a configuration file used by ftp daemon. It contains a list of users who are not allowed to access the system via ftp.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The /etc/ftpusers file contains a list of users who are not allowed to access the system via ftp. All users with a UID less than 200 should be added into the file.<br/><br/>As part of the default implementation of the customized XML file the /etc/ftpusers file will have already been created with a root user entry. It also disables the ftp service. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>List all users with a UID less than 200 to the /etc/ftpusers file:<br/><br/>lsuser -c ALL | grep -v ^<xhtml:code>#name |grep -v root | cut -f1 -d: | while read NAME; do <br/>if [ `lsuser -f $NAME | grep id | cut -f2 -d=` -lt 200 ] &gt; /dev/null 2&gt;&amp;1; then <br/>echo "Would add $NAME to /etc/ftpusers" <br/>fi<br/>done<br/><br/>NOTE: Review the list of users<br/><br/>Add all users with a UID of less that 200 to the/etc/ftpusers file:<br/><br/>lsuser -c ALL | grep -v ^#name |grep -v root | cut -f1 -d: | while read NAME; do <br/>if [ `lsuser -f $NAME | grep id | cut -f2 -d=` -lt 200 ] &gt; /dev/null 2&gt;&amp;1; then <br/>echo $NAME &gt;&gt; /etc/ftpusers<br/>fi<br/>done      <br/><br/></xhtml:code></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Review the content /etc/ftpusers, ensure there are no duplicate entries:<br/><br/>cat /etc/ftpusers<br/><br/><b>Reversion:</b><br/>Edit /etc/ftpusers and leave only the root entry:<br/><br/>vi /etc/ftpusers<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure /etc/ftpusers contains more than root" success="pass">
                            <ecl:command>egrep -v "root" /etc/ftpusers</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="miscellaneous-config-ftp-umask" selected="false">
                <xccdf:title>Miscellaneous Config - ftp umask </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The umask of the ftp service should be set to at least 027 in order to prevent the FTP daemon process from creating world-writable files by default. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The umask of the ftp service should be set to at least 027 in order to prevent the FTP daemon process from creating world-writable files by default. These files could then be transferred over the network which could result in compromise of the critical information. <br/><br/>During the implementation of the default customized aixpert XML file the ftp daemon will have been disabled. However, if ftp is active and required in the environment, the recommendations in this section should be applied. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Set the default umask of the ftp daemon:<br/><br/>[[ $(grep -c "^ftp[[:blank:]]" /etc/inetd.conf) -gt 0 ]] &amp;&amp; chsubserver -c -v ftp -p tcp "ftpd -l -u077" &amp;&amp; refresh s inetd || RC=0<br/><br/>NOTE: The umask above restricts read/write permissions for both group and other<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the umask setting:<br/><br/>[[ $(grep -c "^ftp[[:blank:]]" /etc/inetd.conf) -gt 0 ]] &amp;&amp; grep "^ftp[[:blank:]]" /etc/inetd.conf |awk '{print $6 " " $7 " " $8 " " $9}' || RC=0<br/><br/>The above command should yield the following output (only if the ftp daemon is not disabled):<br/><br/><xhtml:code>/usr/sbin/ftpd ftpd -l -u077<br/><br/></xhtml:code></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure ftpd umask is set (if enabled)">
                            <ecl:command>[[ $(grep -c "^ftp[[:blank:]]" /etc/inetd.conf) -gt 0 ]] || print "ftp is disabled - skipping" &amp;&amp; grep "^ftp[[:blank:]]*.*-u077" /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="miscellaneous-config-ftp-banner" selected="false">
                <xccdf:title>Miscellaneous Config - ftp banner </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Set an ftp login banner which displays the acceptable usage policy. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The message in banner.msg is displayed for FTP logins. Banners display necessary warnings to users trying to gain unauthorized access to the system and are required for legal purposes. The recommendation is to set the banner as:<br/> <br/>"Authorized uses only. All activity will be monitored and reported". <br/><br/>The content may be changed to reflect any corporate AUP.<br/><br/>During the implementation of the default customized aixpert XML file the ftp daemon will have been disabled. However, if ftp is active and required in the environment, the recommendations in this section should be applied. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Ensure that the bos.msg.en_US.net.tcp.client fileset installed:<br/><br/>lslpp -L "bos.msg.en_US.net.tcp.client"<br/><br/>NOTE: If the fileset is not installed, install it from the AIX media or another software repository. The fileset should reflect the language used on the server.<br/><br/>Once installed set the ftp AUP banner:<br/><br/>dspcat -g /usr/lib/nls/msg/en_US/ftpd.cat &gt; /tmp/ftpd.tmp <br/>sed "s/\"\%s FTP server (\%s) ready.\"/\"\%s Authorized uses only. All activity may be monitored and reported\"/" /tmp/ftpd.tmp &gt; /tmp/ftpd.msg <br/>gencat /usr/lib/nls/msg/en_US/ftpd.cat /tmp/ftpd.msg<br/><br/>rm /tmp/ftpd.tmp /tmp/ftpd.msg<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Open a session to the localhost and validate the banner:<br/><br/>dspcat -g /usr/lib/nls/msg/en_US/ftpd.cat | grep "^9[[:blank:]]"<br/><br/>The above command should yield the following output:<br/><br/>9       "%s Authorized uses only. All activity may be monitored and reported"<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:complex-check operator="OR">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="Ensure 'ftp' is disabled in '/etc/inetd.conf'">
                                <ecl:command>egrep '^[^#].*ftp' /etc/inetd.conf</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure ftp banner message is set" success="pass">
                                <ecl:command>dspcat -g /usr/lib/nls/msg/en_US/ftpd.cat | grep '^9[[:blank:]]"%s .*Authorized'</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    
                </xccdf:complex-check>
            </xccdf:Rule>
            <xccdf:Rule id="miscellaneous-config-etc-motd" selected="false">
                <xccdf:title>Miscellaneous Config - /etc/motd </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Create a /etc/motd file which displays, post initial logon, a statutory warning message.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The creation of a /etc/motd file which contains a statutory warning message could aid in the prosecution of offenders guilty of unauthorized system access. The /etc/motd is displayed after successful logins from the console, SSH and other system access protocols. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Create a /etc/motd file:<br/><br/>touch /etc/motd<br/>chmod u=rw,go=r /etc/motd<br/>chown bin:bin /etc/motd<br/><br/>Below is a sample banner:<br/><br/>*************************************************************************** <br/>NOTICE TO USERS <br/>This computer system is the private property of its owner, whether individual, corporate or government. It is for authorized use only. Users (authorized or unauthorized) have no explicit or implicit expectation of privacy. Any or all uses of this system and all files on this system may be intercepted, monitored, recorded, copied, audited, inspected, and disclosed to your employer, to authorized site, government, and law enforcement personnel, as well as authorized officials of government agencies, both domestic and foreign. &lt;p&gt; By using this system, the user consents to such interception, monitoring,recording, copying, auditing, inspection, and disclosure at the discretion of such personnel or officials. Unauthorized or improper use of this system may result in civil and criminal penalties and administrative or disciplinary action, as appropriate. By continuing to &lt;p&gt; use this system you indicate your awareness of and consent to these terms and conditions of use. LOG OFF IMMEDIATELY if you do not agree to the conditions stated in this warning.  ****************************************************************************<br/><br/>NOTE: Replace "its owner" with the relevant company name<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Log back into the system via SSH:<br/><br/>ssh localhost<br/><br/>NOTE: The /etc/motd file will now be displayed<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure group/other has no write/execute permissions on  '/etc/motd'" success="pass">
                            <ecl:command>[[ -s /etc/motd ]] &amp;&amp; ls -l /etc/motd | awk '{print $1 " " $3 " " $4 '}</ecl:command>
                            <ecl:line-selection op="pm" value="^-r(w|-)-(r|-)--(r|-)--\s+bin\s+bin\s*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="miscellaneous-config-authorized-users-in-at-allow" selected="false">
                <xccdf:title>Miscellaneous Config - authorized users in at.allow </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The /var/adm/cron/at.allow file defines which users on the system are able to schedule jobs via at.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The /var/adm/cron/at.allow file defines which users are able to schedule jobs via at. Review the current at files and add any relevant users to the /var/adm/cron/at.allow file.<br/><br/>As part of the default implementation of the customized XML file the /var/adm/cron/at.allow file will have been created with a root user entry. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Review the current at files:<br/><br/>ls -l /var/spool/cron/atjobs<br/>cat /var/spool/cron/atjobs/*<br/><br/>NOTE: Review the list of at schedules and remove any files which should not be there, or have no content<br/><br/>Add the recommended system users to the at.allow list:<br/><br/>echo sys &gt;&gt; /var/adm/cron/at.allow <br/>echo adm &gt;&gt; /var/adm/cron/at.allow<br/><br/>Add any other users who require permissions to use the at scheduler:<br/><br/>echo &lt;user&gt; &gt;&gt; /var/adm/cron/at.allow <br/><br/>NOTE: Where &lt;user&gt; is the username <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Review the content /var/adm/cron/at.allow, ensure that the content reflects the changes made:<br/><br/>cat /var/adm/cron/at.allow<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure only 'root' exists in /var/adm/cron/at.allow" success="fail">
                            <ecl:command>egrep -v "root|sys|adm" /var/adm/cron/at.allow</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="miscellaneous-config-authorized-users-in-cron-allow" selected="false">
                <xccdf:title>Miscellaneous Config - authorized users in cron.allow </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The /var/adm/cron/cron.allow file defines which users on the system are able to schedule jobs via cron.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The /var/adm/cron/cron.allow file defines which users are able to schedule jobs via cron. Review the current cron files and add any relevant users to the /var/adm/cron/cron.allow file.<br/><br/>As part of the default implementation of the customized XML file the /var/adm/cron/at.allow file will have been created with a root user entry. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Review the current cron files:<br/><br/>ls -l /var/spool/cron/crontabs<br/>cat /var/spool/cron/crontabs/*<br/><br/>NOTE: Review the list of cron schedules and remove any files which should not be there, or have no content<br/><br/>Add the recommended system users to the cron.allow list:<br/><br/>echo sys &gt;&gt; /var/adm/cron/cron.allow <br/>echo adm &gt;&gt; /var/adm/cron/cron.allow<br/><br/>Add any other users who require permissions to use the cron scheduler:<br/><br/>echo &lt;user&gt; &gt;&gt; /var/adm/cron/cron.allow <br/><br/>NOTE: Where &lt;user&gt; is the username <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Review the content /var/adm/cron/cron.allow, ensure that the content reflects the changes made:<br/><br/>cat /var/adm/cron/cron.allow<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure only 'root' and 'adm' exist in /var/adm/cron/cron.allow" success="fail">
                            <ecl:command>egrep -v "root|adm" /var/adm/cron/cron.allow</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="miscellaneous-config-all-unlocked-accounts-must-have-a-password" selected="false">
                <xccdf:title>Miscellaneous Config - all unlocked accounts must have a password </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>All unlocked accounts on the server must have a password.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>An account password is a secret code word that must be entered to gain access to the account. If an account exists that has a blank password, multiple users may access the account without authentication and leave a weak audit trail. An attacker may gain unauthorized system access or perform malicious actions, which then cannot be attributed to any specific individual. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Check for empty passwords:<br/><br/>pwdck -n ALL<br/><br/>If the command above yields output, set up a password on the account:<br/><br/>passwd &lt;username&gt;<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Re-run the command:<br/><br/>pwdck -n ALL<br/><br/>The command should not yield output<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure all user accounts have password" success="pass">
                            <ecl:command>pwdck -n ALL</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="miscellaneous-config-all-user-id-must-be-unique" selected="false">
                <xccdf:title>Miscellaneous Config - all user id must be unique </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>All users should have a unique UID. In particular the only user on the system to have a UID of 0 should be the root user.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The only user with a UID of 0 on the system must be the root user. Any account with a UID of 0 has super user privileges on the system and is effectively root. All access to the root account should be via su or sudo to provide an audit trail. All other users must also have a unique UID to ensure that file and directory security is not compromised. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Examine the user IDs of all configured users:<br/><br/>cut -d: -f 3 /etc/passwd |sort -n |uniq -d<br/><br/>If a number, or numbers are returned from the command above, these are UID which are not unique within the /etc/passwd file. Determine the effected username/s:<br/><br/>cut -f "1 3" -d : /etc/passwd |grep ":&lt;UID&gt;$"<br/><br/>NOTE: Any user names returned should either be deleted or have the UID changed<br/><br/>To remove:<br/><br/>rmuser &lt;username&gt; <br/><br/>To change the UID:<br/><br/>chuser id=&lt;id&gt; &lt;username&gt;<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Re-run the command:<br/><br/>cut -d: -f 3 /etc/passwd |sort -n |uniq -d<br/><br/>The command above should not yield output<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure all users have unique IDs" success="pass">
                            <ecl:command>cut -d: -f 3 /etc/passwd |sort -n |uniq -d</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="miscellaneous-config-all-group-id-must-be-unique" selected="false">
                <xccdf:title>Miscellaneous Config - all group id must be unique </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>All groups should have a unique GID on the system.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>All groups should have an individual and unique GID. If GID numbers are shared this could lead to undesirable file and directory access.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Ensure that all group IDs are unique:<br/><br/>cut -d: -f 3 /etc/group |sort -n | uniq -d<br/><br/>If a number, or numbers are returned from the command above, these are GID which are not unique within the /etc/group file. Determine the effected group names:<br/><br/>cut -f "1 3" -d : /etc/group |grep ":&lt;GID&gt;$"<br/><br/>NOTE: Any group names returned should either be deleted or have the UID changed<br/><br/>To remove:<br/><br/>rmgroup &lt;groupname&gt; <br/><br/>To change the UID:<br/><br/>chgroup id=&lt;id&gt; &lt;groupname&gt;<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Re-run the command:<br/><br/>cut -d: -f 3 /etc/group |sort -n |uniq -d<br/><br/>The command above should not yield output<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure all groups have unique IDs" success="pass">
                            <ecl:command>cut -d: -f 3 /etc/group |sort -n |uniq -d</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="miscellaneous-config-unnecessary-user-and-group-removal" selected="false">
                <xccdf:title>Miscellaneous Config - unnecessary user and group removal </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>Remove unnecessary administrative user accounts to further enhance security.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>Remove unnecessary administrative user accounts and groups, if possible. Generic administrative user accounts are targeted by hackers in an attempt to gain unauthorized access to a server.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Remove the uucp, nuucp, lpd, and printq user accounts and respective groups, if possible:<br/><br/><xhtml:code># Remove users<br/>LIST="uucp nuucp lpd printq"<br/>for USERS in $LIST; do<br/>rmuser -p $USERS<br/>rmgroup $USERS<br/>done<br/><br/># Remove groups<br/>LIST="uucp printq"<br/>for USERS in $LIST; do<br/>rmgroup $USERS<br/>done<br/><br/>NOTE:- Other users and groups can be added to the list if required<br/><br/></xhtml:code></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that the user accounts have been removed:<br/><br/>egrep "uucp|nuucp|lpd|printq" /etc/passwd<br/><br/>The command should not yield output<br/><br/>Ensure that the groups have been removed:<br/><br/>egrep "uucp|printq" /etc/group<br/><br/>The command should not yield output<br/><br/><b>Reversion:</b><br/>Re-create the user accounts.<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="Ensure unnecessary users are removed from /etc/passwd" success="fail">
                                <ecl:command>egrep "uucp|nuucp|lpd|printq" /etc/passwd</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="Ensure unnecessary groups are removed from /etc/group" success="fail">
                                <ecl:command>egrep "uucp|printq" /etc/group</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:Rule>   
	    <xccdf:Rule id="miscellaneous-config-removing-current-working-directory-from-roots-PATH" selected="false">
                <xccdf:title>Miscellaneous Enhancements -  removing current working directory from roots PATH </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This change removes any . or :: entries from the root PATH. If a . or :: is present the current working directory is included in the search path..<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>Any . and :: will be removed from the root PATH. This means that any harmful programs placed in common PATH locations, would never be automatically executed. All directories must be explicitly defined within the PATH variable.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Examine roots PATH to see if it contains any .  or :: entries:<br/><br/>su - root -c "echo ${PATH}" |awk '/((:[ \t]*:)|(:[ \t]*$)|(^[ \t]*:)|(^.:)|(:.$)|(:.:))/'<br/><br/>If the command above yields output, remove the . and :: entries from the relevant initialization files. The files to examine are dependant on the root users shell definition in /etc/passwd. Once the file or files have been identified remove the . and :: from the PATH variable <br/><br/>vi  &lt;filename&gt; <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p><br/><br/>su - root -c "echo ${PATH}" |awk '/((:[ \t]*:)|(:[ \t]*$)|(^[ \t]*:)|(^.:)|(:.$)|(:.:))/' <br/><br/>The above command should yield no output. <br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure root's PATH, as defined in .profile, does not contain '.' or '::' entry" success="pass">
                            <ecl:command>echo $PATH |awk '/((:[ \t]*:)|(:[ \t]*$)|(^[ \t]*:)|(^.:)|(:.$)|(:.:))/'</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="miscellaneous-config-removing-current-working-directory-from-default-etc-environment-PATH" selected="false">
                <xccdf:title>Miscellaneous Enhancements - removing current working directory from default /etc/environment PATH</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 1</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>This change removes any . or :: entries from /etc/environment. If a . or :: is present the current working directory is included in the default search path. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>Any . and :: will be removed from /etc/environment . This means that any harmful programs placed in common PATH locations, would never be automatically executed. All directories must be explicitly defined within the PATH variable.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Examine PATH in /etc/environment  to see if it contains any .  or :: entries:<br/><br/>grep "^PATH=" /etc/environment |awk '/((:[ \t]*:)|(:[ \t]*$)|(^[ \t]*:)|(^.:)|(:.$)|(:.:))/' <br/><br/>If the command above yields output, remove the . and :: entries from /etc/environment <br/><br/>vi /etc/environment <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>grep "^PATH=" /etc/environment |awk '/((:[ \t]*:)|(:[ \t]*$)|(^[ \t]*:)|(^.:)|(:.$)|(:.:))/'<br/><br/>The above command should yield no output. </xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure root's PATH, as defined in /etc/environment, does not contain '.' or '::' entry" success="pass">
                            <ecl:command>grep "^PATH=" /etc/environment |awk '/((:[ \t]*:)|(:[ \t]*$)|(^[ \t]*:)|(^.:)|(:.$)|(:.:))/'</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="privileged-command-management">
            <xccdf:title>Privileged Command Management</xccdf:title>
            
            <xccdf:Rule id="pcm-sudo" selected="false">
                <xccdf:title>PCM - sudo </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommendation is to install and configure sudo, to reflect the privileged command access requirements of all users of the system. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>Privileged command access should be limited to and defined by a users individual needs. Access to a root command prompt should limited, wherever possible, to minimize the risk of inadvertent or deliberate misuse of the account.<br/><br/>If the system is AIX 5.3 based, enhanced RBAC is not an available option. If the system is AIX 6.1 based, the choice between sudo and enhanced RBAC revolves around whether or not the environment is heterogeneous in nature, running different flavors of UNIX, or perhaps different versions of AIX. It may be that sudo is the standard tool of choice for managing privileged command access across an entire UNIX estate. However, if the environment is AIX 6.1 only, it is recommended that enhanced RBAC is used as the tool of choice.  Some implementations however may benefit from a combined approach, utilizing both sudo and enhanced RBAC. <br/><br/>The sudo software is packaged as an RPM by IBM and is available on the AIX Toolbox for LINUX media, or via download from the following location:<br/><br/>http://www-03.ibm.com/systems/power/software/aix/linux/toolbox/download.html<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Place the sudo software into a convenient location, such as /tmp and install via:<br/><br/>/usr/lib/instl/sm_inst installp_cmd -a -Q -d /tmp -f sudo -c -N -g -X -G -Y<br/>NOTE: If the software is not located in /tmp, reflect the actual location in the command above.<br/><br/>Once installed refer to the sudo man page for information regarding the creation of a custom /etc/sudoers file. It is recommended that, to reduce rule complexity, privileges are assigned at a group level wherever possible:<br/><br/>http://www.gratisoft.us/sudo/man/sudo.html<br/><br/>NOTE: The configuration of sudo is completely dependant on the unique requirements of a given environment.<br/><br/>All editing of the /etc/sudoers file must be performed by the following command:<br/><br/>visudo<br/><br/>Once the /etc/sudoers file has been successfully created, validate the syntax of the file:<br/><br/>visudo -c<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the sudo installation:<br/><br/>rpm -q sudo<br/><br/>The above command should yield the following output:<br/><br/>sudo-1.6.9p15-2noldap<br/><br/>NOTE: The version reflected above may differ from the one installed.<br/><br/><b>Reversion:</b><br/>De-install the sudo software:<br/><br/>rpm -e sudo<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure the 'sudo' package is installed" success="pass">
                            <ecl:command>rpm -q sudo | grep sudo</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="pcm-enhanced-rbac-aix-6-1-only-" selected="false">
                <xccdf:title>PCM - enhanced RBAC (AIX 6.1 only)  </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Not Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommendation is to configure RBAC to reflect the privileged command access  requirements for all users of the system. RBAC is a default component of AIX 6.1.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>Privileged command access should be limited to and defined by a users individual needs. Access to a root command prompt should limited, wherever possible, to minimize the risk of inadvertent or deliberate misuse of the account.<br/><br/>If the system is AIX 6.1 based, the choice between sudo and enhanced RBAC revolves around whether or not the environment is heterogeneous in nature, running different flavors of UNIX, or perhaps different versions of AIX. It may be that sudo is the standard tool of choice for managing privileged command access across an entire UNIX estate. However, if the environment is AIX 6.1 only, it is recommended that enhanced RBAC is used as the tool of choice. Some implementations however may benefit from a combined approach, utilizing both sudo and enhanced RBAC.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>Enhanced RBAC improves on its legacy implementation by allowing greater flexibility around command lists and authorization definitions, which can be customized. The definitions are also saved to a kernel table rather than in flat files, which improves security. <br/><br/>The implementation of RBAC is role based, allowing users to be specifically granted access to the privileged commands they need to perform their day to day tasks. The tool can be used to replace sudo in many instances, or indeed to work alongside it. <br/><br/>A successful implementation may also allow the root account to be deprecated.<br/><br/>The RBAC definition files:<br/><br/>/etc/security/privcmds<br/>/etc/security/privfiles<br/>/etc/security/privdevs<br/> <br/>The command used to list the active RBAC definitions, i.e. those loaded into the kernel:<br/><br/>lskst<br/><br/>The command used to update RBAC definitions in the kernel table:<br/><br/>setkst<br/><br/>Further details regarding planning and implementation of RBAC can be found within the IBM AIX 6.1 Infocentre:<br/><br/>http://publib.boulder.ibm.com/infocenter/systems/index.jsp?topic=/com.ibm.aix.security/doc/security/rbac.htm<br/><br/>NOTE: The configuration of enhanced RBAC is completely dependant on the unique requirements of a given environment.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>N/A<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>

            </xccdf:Rule>
            <xccdf:Rule id="encrypted-filesystems-efs-aix-6-1-only" selected="false">
                <xccdf:title>Encrypted Filesystems (EFS) (AIX 6.1 only)</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommendation, if there is a requirement for file based encryption, is to utilize EFS. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>The use of EFS further enhances the file and directory security within AIX. If there are sensitive or confidential files, encryption provides that extra level of security in the event of an accidental chmod which may allow read or write access to other users. <br/><br/>The encryption operates at the filesystem level and each file is encrypted with a separate key. From a user perspective the encryption is transparent as the key can be automatically loaded during login. <br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>There are two pre-requisite requirements for EFS, it requires RBAC and the installation of the CLiC cryptographic fileset. The fileset is located on the expansion pack, shipped with the AIX media.<br/><br/>Place the CLiC software into a convenient location, such as /tmp and install via:<br/><br/>/usr/lib/instl/sm_inst installp_cmd -a -Q -d /tmp -f clic.rte -c -N -g -X -G -Y<br/>NOTE: If the software is not located in /tmp, reflect the actual location in the command above.<br/><br/>Load the CLiC kernel extension:<br/><br/>/usr/lib/methods/loadkclic<br/><br/>As the EFS administrator, create the initial keystore. This is typically the root user:<br/><br/>efsenable -a<br/><br/>An EFS enabled filesystem can be created with the following command:<br/><br/>chfs -v jfs2 -g &lt;vg_name&gt; -m &lt;/filesystem&gt; -a size=&lt;size&gt; -a efs=yes<br/><br/>To enable EFS for an existing filesystem:<br/><br/>chfs -a efs=yes &lt;/filesystem&gt;<br/><br/>To encrypt a file, load your keystore via:<br/><br/>efskeymgr -o ksh<br/><br/>Then encrypt via:<br/><br/>efsmgr -c AES_192_ECB -e &lt;filename&gt;<br/><br/>To decrypt:<br/><br/>efsmgr -d &lt;filename&gt;<br/><br/>Further details regarding planning and implementation of EFS can be found within the IBM AIX 6.1 Infocentre:<br/><br/>http://publib.boulder.ibm.com/infocenter/systems/index.jsp?topic=/com.ibm.aix.security/doc/security/efs_efs.htm<br/><br/>NOTE: The configuration of EFS is completely dependant on the unique requirements of a given environment.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Validate the installation of the CLiC software:<br/><br/>lslpp -L |grep "clic"<br/><br/>The above command should yield the following output:<br/><br/>clic.rte.includes 	4.3.0.0 	C 	F 	CrytoLite for C Library<br/>								Include File<br/>clic.rte.kernext		4.3.0.0		C 	F	CrytpLite for C Kernel<br/>clic.rte.lib		4.3.0.0		C	F	CyrptoLite for C Library<br/>clic.rte.pkcs11		4.3.0.0		C	F	PKCS11 Software Token Support<br/>NOTE: The version numbers may differ based on the source of the software<br/><br/>Validate that the CLiC kernel extension has loaded:<br/><br/>genkex |grep crypt<br/><br/>The above command should yield the following output:<br/><br/>438b000 39000 /usr/lib/drivers/crypto/clickext<br/><br/><b>Reversion:</b><br/>De-install the CLiC fileset:<br/><br/>installp -u clic.rte<br/><br/>Decrypt all files:<br/><br/>efsmgr -d &lt;filename&gt;<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>

                <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure cryptographic fileset software installed" success="pass">
                            <ecl:command>lslpp -L | grep "clic.rte"</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure cryptographic fileset software loaded" success="pass">
                                <ecl:command>genkex | grep crypt</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="trusted-execution-te-aix-6-1-only">
            <xccdf:title>Trusted Execution (TE) (AIX 6.1 only)</xccdf:title>
            
            <xccdf:Rule id="te-implementation-aix-6-1-only-" selected="false">
                <xccdf:title>TE - implementation (AIX 6.1 only)  </xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The recommendation is to implement TE to protect the system from Trojan horse style attacks. TE provides a robust system integrity checking process.<br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>One of the common ways a hacker infiltrates a system is through file tampering or the use of a Trojan horse. The implementation of TE can provide a number of integrity checks prior to loading a program into memory, any deviations can also be highlighted when programs and files are validated offline. This ensures that the programs executed are those which are intended to be and not malicious code masquerading as a true program.<br/><br/>When a discrepancy is identified it is classified as either minor or major. A minor discrepancy is automatically reset to the value defined in the TSD. In the event of a major discrepancy the file access permissions are changed to make the file inaccessible. <br/><br/>There is a pre-requisite requirement to install CLiC and SSL software.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p>It is recommended that TE is configured in online mode. This provides real time protection against Trojan horse attacks.<br/><br/>The tsd.dat file contains the important security attributes relating to all of the managed files:<br/><br/>cat /etc/security/tsd/tsd.dat<br/><br/>NOTE: The trustchk command is used to manage the entries in this file.<br/><br/>To enable TE, firstly enable online checking of executables and shell scripts:<br/><br/>trustchk -p CHKEXEC=ON<br/>trustchk -p CHKSCRIPT=ON<br/><br/>Stop the execution or loading of binaries and files into memory when the integrity checks fail:<br/><br/>trustchk -p STOP_ON_CHKFAIL=ON<br/><br/>Enable online TE based on the policy selections above:<br/><br/>trustchk -p TE=ON<br/><br/>To set a Trusted Execution Path or TEP:<br/><br/>trustchk -p TEP=&lt;PATH variable&gt;<br/>
                            <br/>Enable the TEP:<br/><br/>trustchk -p TEP=ON<br/><br/>NOTE: Commands will not be executed if they reside outside of the TEP. <br/><br/>Further details regarding planning and implementation of TE can be found within the IBM AIX 6.1 Infocentre:<br/><br/>http://publib.boulder.ibm.com/infocenter/systems/index.jsp?topic=/com.ibm.aix.security/doc/security/bos_trusted_execution.htm&amp;tocNode=toc:front/front.cmb/0/0/11/0/0/1/<br/><br/>NOTE: The configuration of TE is dependant on the unique requirements of a given environment.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Ensure that TE is enabled:<br/><br/>trustchk -p TE<br/><br/>The above command should yield the following output:<br/><br/>TE=ON<br/><br/>Ensure that TEP is enabled:<br/><br/>trustchk -p TEP<br/><br/>The above command should yield the following output:<br/><br/>TEP=ON<br/><br/><b>Reversion:</b><br/>Disable TE:<br/><br/>trustchk -p TE=off<br/><br/>Disable TEP:<br/><br/>trustchk -p TEP=off<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure 'TE' mode is 'ON'" success="pass">
                                <ecl:command>trustchk -p TE | grep "TE=ON"</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Ensure 'TEP' mode is 'ON'" success="pass">
                                <ecl:command>trustchk -p TEP | grep "TEP=ON"</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:Rule>
        </xccdf:Group>
        <xccdf:Group id="file-permissions-manager-fpm">
            <xccdf:title>General Permissions Management</xccdf:title>
            
            <xccdf:Rule id="fpm-suid-sgid-files" selected="false">
                <xccdf:title>General Permissions Management - suid and sgid files and programs</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The system is audited for both suid and sgid files and programs.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>An audit should be performed on the system to search for the presence of both suid and sgid files and programs. In order to prevent these files from being potentially exploited the suid and sgid permissions should be removed wherever possible.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
			<xhtml:p>Review the currently mounted filesystems:<br/><br/>mount<br/><br/>Un-mount all non-local filesystems and cdrom media:<br/><br/>unmount &lt;mount point &gt;<br/><br/>If there are non-local filesystems which cannot be un-mounted, use the following to find all suid and sgid files on local JFS/JFS2 filesystems only:<br/><br/>find / \( -fstype jfs -o -fstype jfs2 \) \( -perm -04000 -o -perm -02000 \) -type f -ls<br/><br/>If all non-local filesystems have been un-mounted:<br/><br/>find / \( -perm -04000 -o -perm -02000 \) -type f -ls<br/><br/>Review the files and where possible, use the chmod command to remove the appropriate suid or sgid bits:<br/><br/>chmod u-s &lt;file&gt;&gt;<br/><br/>chmod g-s &lt;file&gt;&gt;<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p>Re-execute the appropriate find command and review the output. This should reflect the changes made in the remediation section.<br/><br/>If there are non-local filesystems which cannot be un-mounted, use the following to find all suid and sgid files on local JFS/JFS2 filesystems only:<br/><br/>find / \( -fstype jfs -o -fstype jfs2 \) \( -perm -04000 -o -perm -02000 \) -type f -ls<br/><br/>If all non-local filesystems are un-mounted:<br/><br/>find / \( -perm -04000 -o -perm -02000 \) -type f -ls<br/><br/>Reversion<br/><br/>Use the chmod command to re-instate the suid and sgid bits to the relevant files:<br/><br/>chmod u+s &lt;file&gt;<br/><br/>chmod g+s &lt;file&gt;<br/><br/>Default Value: N/A<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Check for setuid/setguid files" success="pass">
                            <ecl:command>find / \( -perm 04000 -o -perm -02000 \) -type f -ls</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="fpm-un-owned-files-and-directories" selected="false">
                <xccdf:title>General Permissions Management - un-owned files and directories</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The system is audited for un-owned files and directories. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>An audit should be performed on the system to search for the presence of un-owned files and directories. All files and directories should have a valid owner and group.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p> Review the currently mounted filesystems:<br/><br/>mount<br/><br/>Un-mount all non-local filesystems and cdrom media:<br/><br/>unmount &lt;mount point&gt;<br/><br/>If there are non-local filesystems which cannot be un-mounted, use the following to find all un-owned files and directories on local JFS/JFS2 filesystems only:<br/><br/>find / \( -fstype jfs -o -fstype jfs2 \) \( -type d -o -type f \) \( -nouser -o -nogroup \) -ls<br/><br/>If all non-local filesystems have been un-mounted:<br/><br/>find / \( -type d -o -type f \) \( -nouser -o -nogroup \) -ls<br/><br/>NOTE: An un-owned file or directory is referred to via the GID or UID as it cannot be translated to a user or group name in /etc/group or /etc/passwd. This is typically caused by removing users or groups from the system.<br/><br/>Remediate the un-owned file and directory list:<br/><br/> chown &lt;owner&gt; &lt;file&gt; <br/><br/>chgrp &lt;group&gt; &lt;file&gt;<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p> Re-execute the appropriate find command.<br/><br/>If there are non-local filesystems which cannot be un-mounted, use the following to find all un-owned files and directories on local JFS/JFS2 filesystems only:<br/><br/>find / \( -fstype jfs -o -fstype jfs2 \) \( -type d -o -type f \) \( -nouser -o -nogroup \) -ls<br/><br/>If all non-local filesystems have been un-mounted:<br/><br/>find / \( -type d -o -type f \) \( -nouser -o -nogroup \) -ls<br/><br/>The find command should yield not yield output <br/><br/>Reversion: N/A<br/><br/>Default Value: N/A<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
			<xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="Ensure all files and directories have an user/group owner" success="pass">
                                <ecl:command>find / \( -type d -o -type f \) \( -nouser -o -nogroup \) -ls</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
		</xccdf:Rule>
		<xccdf:Rule id="fpm-world-writable-files-and-directories" selected="false">
                <xccdf:title>General Permissions Management - world writable files and directories</xccdf:title>
                <xccdf:description>
                    <xhtml:div>
                        <xhtml:p class="bold">Scoring Status: Scorable</xhtml:p>
                        <xhtml:p class="bold">Scoring Level: Level 2</xhtml:p>
                        <xhtml:p class="bold">Description:</xhtml:p>
                        <xhtml:p>The system is audited for world writable files and directories. <br/></xhtml:p>
                        <xhtml:p class="bold">Rationale:</xhtml:p>
                        <xhtml:p>An audit should be performed on the system to search for the presence of world writable files and directories. Files and directories should only be world writable when absolutely necessary.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Remediation:</xhtml:p>
                        <xhtml:p> Review the currently mounted filesystems:<br/><br/>mount<br/><br/>Un-mount all non-local filesystems and cdrom media:<br/><br/>unmount &lt;mount point&gt;<br/><br/>If there are non-local filesystems which cannot be un-mounted, use the following to find all world writable files and directories on local JFS/JFS2 filesystems only:<br/><br/>find / \( -fstype jfs -o -fstype jfs2 \) \( -type d -o -type f \) -perm -o+w -ls <br/><br/>If all non-local filesystems have been un-mounted:<br/><br/>find / \( -type d -o -type f \) -perm -o+w -ls<br/><br/>Review the world writable files and directories and where possible, if the application configuration allows, remove access via:<br/><br/> chmod o-w &lt;dir or file&gt; <br/><br/>If a directory must retain world writable access, ensure that sticky bit is set so that users can only remove the files they create:<br/><br/>chmod o+t &lt;dir&gt; <br/><br/>NOTE: This will retain world writable permissions, but add a sticky bit to the directory.<br/><br/></xhtml:p>
                        <xhtml:p class="bold">Audit:</xhtml:p>
                        <xhtml:p> Re-execute the appropriate find command.<br/><br/>If there are non-local filesystems which cannot be un-mounted, use the following to find all world writable files and directories on local JFS/JFS2 filesystems only:<br/><br/>find / \( -fstype jfs -o -fstype jfs2 \) \( -type d -o -type f \) -perm -o+w -ls<br/><br/>If all non-local filesystems have been un-mounted:<br/><br/>find / \( -type d -o -type f \) -perm -o+w -ls<br/><br/>NOTE: Review the output based on the performed remediation<br/><br/>Reversion:<br/><br/>To reinstate world writable permission:<br/><br/>chmod o+w &lt;dir or file&gt;<br/><br/>Default Value: N/A<br/><br/></xhtml:p>
                    </xhtml:div>
                </xccdf:description>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="Check for world-writable files and directories" success="pass">
                                <ecl:command>find / \( -type d -o -type f \) -perm -o+w -ls</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
            </xccdf:Rule>
        </xccdf:Group>
    </xccdf:Group>
<xccdf:signature><ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
<ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
<ds:Reference URI="">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
<ds:DigestValue>MZdJDYXn8nwV2SE3/qhUqgm2Dig=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>
Tg6NvTUskH0bsX1BbEhClwcRD9/qLfd8OoyvrrUvZEc5xbIwlfg9hAZr9K9yd6QSqslLu9xkWoY8
Nd9jJLZe13RmTf1631M1FMhveIE+BciijvFR4NQJOuhEDm/TSl3OhbiwwWMj46J40krgoHGyojjh
4s9XvlTHxsoR9m7pqI64yCdbvi4cYk8pMiB40/uV+oOxIBys1/5nv5bY7J16MvQkDJXDScj+7+c2
wLHWt1Ntr8pRoEZtpeFZhQChAe5RM1m/fz/8MQO4PWpEVKcXgcIBUH8uyeIeLTe7MsF3kMoQtaQC
GV0f03e/TbeekgISHeEYRjSjjR8m3d3VUa56UA==
</ds:SignatureValue>
<ds:KeyInfo>
<ds:X509Data>
<ds:X509Certificate>
MIIFUjCCBDqgAwIBAgIIYySGQYnuNVswDQYJKoZIhvcNAQELBQAwgbQxCzAJBgNVBAYTAlVTMRAw
DgYDVQQIEwdBcml6b25hMRMwEQYDVQQHEwpTY290dHNkYWxlMRowGAYDVQQKExFHb0RhZGR5LmNv
bSwgSW5jLjEtMCsGA1UECxMkaHR0cDovL2NlcnRzLmdvZGFkZHkuY29tL3JlcG9zaXRvcnkvMTMw
MQYDVQQDEypHbyBEYWRkeSBTZWN1cmUgQ2VydGlmaWNhdGUgQXV0aG9yaXR5IC0gRzIwHhcNMTcx
MDIzMTQ1ODAwWhcNMjAxMDIwMTg1NzQ0WjCBkzELMAkGA1UEBhMCVVMxETAPBgNVBAgTCE5ldyBZ
b3JrMRcwFQYDVQQHEw5FYXN0IEdyZWVuYnVzaDErMCkGA1UEChMiQ2VudGVyIGZvciBJbnRlcm5l
dCBTZWN1cml0eSwgSW5jLjErMCkGA1UEAxMiQ2VudGVyIGZvciBJbnRlcm5ldCBTZWN1cml0eSwg
SW5jLjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANDBp4+sl9kB5JRmnQH0wcbLLz/t
n2HoD6TRl3xJj12V61njBNgaiGzvoSl07sFLnESukb0CU44MzYDoUMdx3HJUcEAeMY/9eITqGUnk
N4WsP145eFqH7FoszOY/4NYlgYMYt8ZP2kRHyim9LpQTLT/1mBaUkY2f2e5uUCootH3iT8W3/sK2
flLzWfLgXTvkhJm4Uvw1RErBFs15+krW0KWtnZ6NmiDhmV0CnFGNnd1meGZPs2sBXEVGLJVSKzoT
G9Ht/oWyRLRcJuXpHoXTYpkqM2MsixmSaJy5b6/D35r0NXHru3p1gkX2a0VgJQxxWqLi3bVPzpl3
PlJu3C8M/FUCAwEAAaOCAYUwggGBMAwGA1UdEwEB/wQCMAAwEwYDVR0lBAwwCgYIKwYBBQUHAwMw
DgYDVR0PAQH/BAQDAgeAMDUGA1UdHwQuMCwwKqAooCaGJGh0dHA6Ly9jcmwuZ29kYWRkeS5jb20v
Z2RpZzJzNS0zLmNybDBdBgNVHSAEVjBUMEgGC2CGSAGG/W0BBxcCMDkwNwYIKwYBBQUHAgEWK2h0
dHA6Ly9jZXJ0aWZpY2F0ZXMuZ29kYWRkeS5jb20vcmVwb3NpdG9yeS8wCAYGZ4EMAQQBMHYGCCsG
AQUFBwEBBGowaDAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuZ29kYWRkeS5jb20vMEAGCCsGAQUF
BzAChjRodHRwOi8vY2VydGlmaWNhdGVzLmdvZGFkZHkuY29tL3JlcG9zaXRvcnkvZ2RpZzIuY3J0
MB8GA1UdIwQYMBaAFEDCvSeOzDSDMKIz1/tss/C0LIDOMB0GA1UdDgQWBBT7fOf4ISDprbE+qUFe
+friFTKgHjANBgkqhkiG9w0BAQsFAAOCAQEAs5SDIMcr3jwOwgKipP7NWsWyAO0zfpmHGaU2C/gW
Kz6DZuwhTLPbn015ZlvjRZ27Jd7rjg3WK2Qs9xaRYn2yb1s4mx/NtlVUBsNpL0CDOrdOgt/ZEweI
uoknr5gPlsFPXmsxEQoFb3KKt/Al1YbjcKHhHZ7BtEL3MGnSOAyItdodtLzxFuLOJKpvEk2OOVoW
BgHAteWAvlKd6exCvfWKHipJ5DTC9eM859tpW0xM+f12CycvrkQVI2lyEHMzDFaHkBO0URjhySSu
SkWLBywIIM02d+Ud7bbC60nXfuxIjayeDJLvDxyMJ/bx12X75w1frT1oKTuifL1bmeualQHKXw==
</ds:X509Certificate>
</ds:X509Data>
<ds:KeyValue>
<ds:RSAKeyValue>
<ds:Modulus>
0MGnj6yX2QHklGadAfTBxssvP+2fYegPpNGXfEmPXZXrWeME2BqIbO+hKXTuwUucRK6RvQJTjgzN
gOhQx3HcclRwQB4xj/14hOoZSeQ3haw/Xjl4WofsWizM5j/g1iWBgxi3xk/aREfKKb0ulBMtP/WY
FpSRjZ/Z7m5QKii0feJPxbf+wrZ+UvNZ8uBdO+SEmbhS/DVESsEWzXn6StbQpa2dno2aIOGZXQKc
UY2d3WZ4Zk+zawFcRUYslVIrOhMb0e3+hbJEtFwm5ekehdNimSozYyyLGZJonLlvr8PfmvQ1ceu7
enWCRfZrRWAlDHFaouLdtU/OmXc+Um7cLwz8VQ==
</ds:Modulus>
<ds:Exponent>AQAB</ds:Exponent>
</ds:RSAKeyValue>
</ds:KeyValue>
</ds:KeyInfo>
</ds:Signature></xccdf:signature></xccdf:Benchmark>