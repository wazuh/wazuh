<?xml version="1.0" encoding="UTF-8" standalone="no"?><xccdf:Benchmark xmlns:xccdf="http://checklists.nist.gov/xccdf/1.1" xmlns:dsig="http://www.w3.org/2000/09/xmldsig#" xmlns:ecl="http://cisecurity.org/check" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="cis_hp_ux_11i_benchmark" xml:lang="en" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.1 ../misc/xsd/xccdf-1.1.4.xsd http://cisecurity.org/check ../misc/xsd/ecl.xsd">
    <xccdf:status>accepted</xccdf:status>
    <xccdf:title>CIS HP-UX 11i v3 Update 2 Benchmark</xccdf:title>
    <xccdf:description>This document, Security Configuration Benchmark for HP-UX 11i, provides
        prescriptive guidance for establishing a secure configuration posture for HP-UX 11i v2 and
        v3 through Update 4. When appropriate, additional notes are provided for HP-UX 11i v1,
        however this document does not directly address that version. This guide was tested against
        HP-UX 11i v2 and v3 as installed with the Data Center Operating Environment
        (OE).</xccdf:description>
    <xccdf:front-matter>
        <xhtml:p>HP-UX Benchmark v1.4.1 September 7, 2007</xhtml:p>
        <xhtml:p>Edited by Chris Calabrese and Robert Fritz</xhtml:p>
        <xhtml:p>Copyright 2001-2007, The Center for Internet Security<xhtml:a href="http://www.CISecurity.org/">http://www.CISecurity.org/</xhtml:a>
        </xhtml:p>
        <xhtml:p>TERMS OF USE AGREEMENT</xhtml:p>
        <xhtml:p>Background.</xhtml:p>
        <xhtml:p>The Center for Internet Security ("CIS") provides benchmarks, scoring tools,
            software, data, information, suggestions, ideas, and other services and materials from
            the CIS website or elsewhere (“Products”) as a public service to Internet users
            worldwide. Recommendations contained in the Products (“Recommendations”) result from a
            consensus-building process that involves many security experts and are generally generic
            in nature. The Recommendations are intended to provide helpful information to
            organizations attempting to evaluate or improve the security of their networks, systems,
            and devices. Proper use of the Recommendations requires careful analysis and adaptation
            to specific user requirements. The Recommendations are not in any way intended to be a
            “quick fix” for anyone’s information security needs.</xhtml:p>
        <xhtml:p>No Representations, Warranties, or Covenants.</xhtml:p>
        <xhtml:p>CIS makes no representations, warranties, or covenants whatsoever as to (i) the
            positive or negative effect of the Products or the Recommendations on the operation or
            the security of any particular network, computer system, network device, software,
            hardware, or any component of any of the foregoing or (ii) the accuracy, reliability,
            timeliness, or completeness of the Products or the Recommendations. CIS is providing the
            Products and the Recommendations “as is” and “as available” without representations,
            warranties, or covenants of any kind. </xhtml:p>
        <xhtml:p>User Agreements.</xhtml:p>
        <xhtml:p>By using the Products and/or the Recommendations, I and/or my organization (“We”)
            agree and acknowledge that:</xhtml:p>
        <xhtml:ol>
            <xhtml:li>
                <xhtml:p>No network, system, device, hardware, software, or component can be made
                    fully secure;</xhtml:p>
            </xhtml:li>
            <xhtml:li>
                <xhtml:p>We are using the Products and the Recommendations solely at our own
                    risk;</xhtml:p>
            </xhtml:li>
            <xhtml:li>
                <xhtml:p>We are not compensating CIS to assume any liabilities associated with our
                    use of the Products or the Recommendations, even risks that result from CIS’s
                    negligence or failure to perform;</xhtml:p>
            </xhtml:li>
            <xhtml:li>
                <xhtml:p>We have the sole responsibility to evaluate the risks and benefits of the
                    Products and Recommendations to us and to adapt the Products and the
                    Recommendations to our particular circumstances and requirements;</xhtml:p>
            </xhtml:li>
            <xhtml:li>
                <xhtml:p>Neither CIS, nor any CIS Party (defined below) has any responsibility to
                    make any corrections, updates, upgrades, or bug fixes; or to notify us of the
                    need for any such corrections, updates, upgrades, or bug fixes; and</xhtml:p>
            </xhtml:li>
            <xhtml:li>
                <xhtml:p>Neither CIS nor any CIS Party has or will have any liability to us
                    whatsoever (whether based in contract, tort, strict liability or otherwise) for
                    any direct, indirect, incidental, consequential, or special damages (including
                    without limitation loss of profits, loss of sales, loss of or damage to
                    reputation, loss of customers, loss of software, data, information or emails,
                    loss of privacy, loss of use of any computer or other equipment, business
                    interruption, wasted management or other staff resources or claims of any kind
                    against us from third parties) arising out of or in any way connected with our
                    use of or our inability to use any of the Products or Recommendations (even if
                    CIS has been advised of the possibility of such damages), including without
                    limitation any liability associated with infringement of intellectual property,
                    defects, bugs, errors, omissions, viruses, worms, backdoors, Trojan horses or
                    other harmful items.</xhtml:p>
            </xhtml:li>
        </xhtml:ol>
        <xhtml:p>Grant of Limited Rights.</xhtml:p>
        <xhtml:p>CIS hereby grants each user the following rights, but only so long as the user
            complies with all of the terms of these Agreed Terms of Use:</xhtml:p>
        <xhtml:ol>
            <xhtml:li>
                <xhtml:p>Except to the extent that we may have received additional authorization
                    pursuant to a written agreement with CIS, each user may download, install and
                    use each of the Products on a single computer;</xhtml:p>
            </xhtml:li>
            <xhtml:li>
                <xhtml:p>Each user may print one or more copies of any Product or any component of a
                    Product that is in a .txt, .pdf, .doc, .mcw, or .rtf format, provided that all
                    such copies are printed in full and are kept intact, including without
                    limitation the text of this Agreed Terms of Use in its entirety.</xhtml:p>
            </xhtml:li>
        </xhtml:ol>
        <xhtml:p>Retention of Intellectual Property Rights; Limitations on Distribution.</xhtml:p>
        <xhtml:p>The Products are protected by copyright and other intellectual property laws and by
            international treaties. We acknowledge and agree that we are not acquiring title to any
            intellectual property rights in the Products and that full title and all ownership
            rights to the Products will remain the exclusive property of CIS or CIS Parties. CIS
            reserves all rights not expressly granted to users in the preceding section entitled
            “Grant of limited rights.”</xhtml:p>
        <xhtml:p>Subject to the paragraph entitled “Special Rules” (which includes a waiver, granted
            to some classes of CIS Members, of certain limitations in this paragraph), and except as
            we may have otherwise agreed in a written agreement with CIS, we agree that we will not
            (i) decompile, disassemble, reverse engineer, or otherwise attempt to derive the source
            code for any software Product that is not already in the form of source code; (ii)
            distribute, redistribute, encumber, sell, rent, lease, lend, sublicense, or otherwise
            transfer or exploit rights to any Product or any component of a Product; (iii) post any
            Product or any component of a Product on any website, bulletin board, ftp server,
            newsgroup, or other similar mechanism or device, without regard to whether such
            mechanism or device is internal or external, (iv) remove or alter trademark, logo,
            copyright or other proprietary notices, legends, symbols or labels in any Product or any
            component of a Product; (v) remove these Agreed Terms of Use from, or alter these Agreed
            Terms of Use as they appear in, any Product or any component of a Product; (vi) use any
            Product or any component of a Product with any derivative works based directly on a
            Product or any component of a Product; (vii) use any Product or any component of a
            Product with other products or applications that are directly and specifically dependent
            on such Product or any component for any part of their functionality, or (viii)
            represent or claim a particular level of compliance with a CIS Benchmark, scoring tool
            or other Product. We will not facilitate or otherwise aid other individuals or entities
            in any of the activities listed in this paragraph.</xhtml:p>
        <xhtml:p>We hereby agree to indemnify, defend, and hold CIS and all of its officers,
            directors, members, contributors, employees, authors, developers, agents, affiliates,
            licensors, information and service providers, software suppliers, hardware suppliers,
            and all other persons who aided CIS in the creation, development, or maintenance of the
            Products or Recommendations (“CIS Parties”) harmless from and against any and all
            liability, losses, costs, and expenses (including attorneys' fees and court costs)
            incurred by CIS or any CIS Party in connection with any claim arising out of any
            violation by us of the preceding paragraph, including without limitation CIS’s right, at
            our expense, to assume the exclusive defense and control of any matter subject to this
            indemnification, and in such case, we agree to cooperate with CIS in its defense of such
            claim. We further agree that all CIS Parties are third-party beneficiaries of our
            undertakings in these Agreed Terms of Use. </xhtml:p>
        <xhtml:p>Special Rules.</xhtml:p>
        <xhtml:p>The distribution of the NSA Security Recommendations is subject to the terms of the
            NSA Legal Notice and the terms contained in the NSA Security Recommendations themselves
                (<xhtml:a href="http://nsa2.www.conxion.com/cisco/notice.htm">http://nsa2.www.conxion.com/cisco/notice.htm</xhtml:a>).</xhtml:p>
        <xhtml:p>CIS has created and will from time to time create, special rules for its members
            and for other persons and organizations with which CIS has a written contractual
            relationship. Those special rules will override and supersede these Agreed Terms of Use
            with respect to the users who are covered by the special rules.</xhtml:p>
        <xhtml:p>CIS hereby grants each CIS Security Consulting or Software Vendor Member and each
            CIS Organizational User Member, but only so long as such Member remains in good standing
            with CIS and complies with all of the terms of these Agreed Terms of Use, the right to
            distribute the Products and Recommendations within such Member’s own organization,
            whether by manual or electronic means. Each such Member acknowledges and agrees that the
            foregoing grant is subject to the terms of such Member’s membership arrangement with CIS
            and may, therefore, be modified or terminated by CIS at any time.</xhtml:p>
        <xhtml:p>Choice of Law; Jurisdiction; Venue</xhtml:p>
        <xhtml:p>We acknowledge and agree that these Agreed Terms of Use will be governed by and
            construed in accordance with the laws of the State of Maryland, that any action at law
            or in equity arising out of or relating to these Agreed Terms of Use shall be filed only
            in the courts located in the State of Maryland, that we hereby consent and submit to the
            personal jurisdiction of such courts for the purposes of litigating any such action. If
            any of these Agreed Terms of Use shall be determined to be unlawful, void, or for any
            reason unenforceable, then such terms shall be deemed severable and shall not affect the
            validity and enforceability of any remaining provisions.</xhtml:p>
        <xhtml:p>Terms of Use Agreement Version 2.1 - 02/20/04</xhtml:p>
    </xccdf:front-matter>
    <xccdf:plain-text id="bastille-item">(Bastille Item) </xccdf:plain-text>
    <xccdf:version>1.4.2.11</xccdf:version>
    <xccdf:Profile id="base">
        <xccdf:title>Level 1 Profile</xccdf:title>
        <xccdf:description>Recommendations are intended to: be practical and prudent; provide a
            clear security benefit; and not negatively inhibit the utility of the technology beyond
            acceptable means.</xccdf:description>
        <xccdf:select idref="apply-latest-OS-patches" selected="true"/>
        <xccdf:select idref="configure-SSH" selected="true"/>
        <xccdf:select idref="use-bastille" selected="true"/>
        <xccdf:select idref="disable-standard-services" selected="true"/>
        <xccdf:select idref="disable-telnet" selected="true"/>
        <xccdf:select idref="disable-FTP" selected="true"/>
        <xccdf:select idref="disable-r-commands" selected="true"/>
        <xccdf:select idref="disable-TFTP-server" selected="true"/>
        <xccdf:select idref="disable-printer-service" selected="true"/>
        <xccdf:select idref="disable-rquotad" selected="true"/>
        <xccdf:select idref="disable-CDE" selected="true"/>
        <xccdf:select idref="disable-Kerberos" selected="true"/>
        <xccdf:select idref="disable-DHCP-server" selected="true"/>
        <xccdf:select idref="disable-serial-port-login" selected="true"/>
        <xccdf:select idref="disable-NISplus" selected="true"/>
        <xccdf:select idref="disable-printer-daemons" selected="true"/>
        <xccdf:select idref="disable-GUI" selected="true"/>
        <xccdf:select idref="disable-sendmail" selected="true"/>
        <xccdf:select idref="disable-SNMP-server" selected="true"/>
        <xccdf:select idref="disable-HPUX-boot-services" selected="true"/>
        <xccdf:select idref="disable-CIFS-server" selected="true"/>
        <xccdf:select idref="disable-CIFS-client" selected="true"/>
        <xccdf:select idref="disable-NFS-server" selected="true"/>
        <xccdf:select idref="disable-NFS-client" selected="true"/>
        <xccdf:select idref="disable-RPC" selected="true"/>
        <xccdf:select idref="disable-web-server" selected="true"/>
        <xccdf:select idref="disable-DNS-server" selected="true"/>
        <xccdf:select idref="enable-stack-protection" selected="true"/>
        <xccdf:select idref="network-parameter-modifications" selected="true"/>
        <xccdf:select idref="TCP-sequence-numbers" selected="true"/>
        <xccdf:select idref="network-parameter-modifications-2" selected="true"/>
        <xccdf:select idref="enable-system-accounting" selected="true"/>
        <xccdf:select idref="enable-kernel-level-auditing" selected="true"/>
        <xccdf:select idref="enable-inetd-logging" selected="true"/>
        <xccdf:select idref="enable-ftpd-logging" selected="true"/>
        <xccdf:select idref="system-log-file-permissions" selected="true"/>
        <xccdf:select idref="world-writeable-directories-sticky" selected="false"/>
        <xccdf:select idref="world-writeable-files_AND_suid-sgid-executables" selected="false"/>
        <xccdf:select idref="unowned-nodes" selected="false"/>
        <xccdf:select idref="patch-backup-permissions" selected="true"/>
        <xccdf:select idref="Rule-7.1" selected="true"/>
        <xccdf:select idref="create-ftpusers" selected="true"/>
        <xccdf:select idref="disable-syslog-remote" selected="true"/>
        <xccdf:select idref="disable-XDMCP" selected="true"/>
        <xccdf:select idref="locking-screensaver-timeout" selected="true"/>
        <xccdf:select idref="inetd-access-control" selected="true"/>
        <xccdf:select idref="restrict-at-cron" selected="true"/>
        <xccdf:select idref="restrict-crontab-permissions" selected="true"/>
        <xccdf:select idref="restrict-root-logins" selected="true"/>
        <xccdf:select idref="account-lockout" selected="true"/>
        <xccdf:select idref="disable-secure-RPC-nobody" selected="true"/>
        <xccdf:select idref="block-system-accounts" selected="true"/>
        <xccdf:select idref="empty-passwords" selected="true"/>
        <xccdf:select idref="account-expiration-parameters" selected="true"/>
        
        <xccdf:select idref="strong-password-enforcement-min-pass-len" selected="true"/>       
        <xccdf:select idref="strong-password-enforcement-pass-hist-depth" selected="true"/>
        <xccdf:select idref="strong-password-enforcement-pass-min-digits" selected="true"/>
        <xccdf:select idref="strong-password-enforcement-pass-min-upper" selected="true"/>
        <xccdf:select idref="strong-password-enforcement-pass-min-special" selected="true"/>
        <xccdf:select idref="strong-password-enforcement-pass-min-lower" selected="true"/>
   
        
        
        <xccdf:select idref="remove-NIS-password-extension" selected="true"/>
        <xccdf:select idref="protected-root-path" selected="true"/>
        <xccdf:select idref="user-home-permissions" selected="true"/>
        <xccdf:select idref="user-dotfile-permissions" selected="true"/>
        <xccdf:select idref="user-netrc-permissions" selected="true"/>
        <xccdf:select idref="default-user-umask" selected="true"/>
        <xccdf:select idref="mesg-n" selected="true"/>
        <xccdf:select idref="login-banners" selected="true"/>
        <xccdf:select idref="login-banners-GUI" selected="true"/>
        <xccdf:select idref="login-banners-ftp" selected="true"/>
    </xccdf:Profile>
    <xccdf:Profile extends="base" id="extended">
        <xccdf:title>Level 2 Profile</xccdf:title>
        <xccdf:description>
            <xhtml:p>Contains base profile plus items more "expensive" to check.</xhtml:p>
        </xccdf:description>
        <xccdf:select idref="apply-latest-OS-patches" selected="true"/>
        <xccdf:select idref="configure-SSH" selected="true"/>
        <xccdf:select idref="use-bastille" selected="true"/>
        <xccdf:select idref="disable-standard-services" selected="true"/>
        <xccdf:select idref="disable-telnet" selected="true"/>
        <xccdf:select idref="disable-FTP" selected="true"/>
        <xccdf:select idref="disable-r-commands" selected="true"/>
        <xccdf:select idref="disable-TFTP-server" selected="true"/>
        <xccdf:select idref="disable-printer-service" selected="true"/>
        <xccdf:select idref="disable-rquotad" selected="true"/>
        <xccdf:select idref="disable-CDE" selected="true"/>
        <xccdf:select idref="disable-Kerberos" selected="true"/>
        <xccdf:select idref="disable-DHCP-server" selected="true"/>
        <xccdf:select idref="disable-serial-port-login" selected="true"/>
        <xccdf:select idref="disable-NISplus" selected="true"/>
        <xccdf:select idref="disable-printer-daemons" selected="true"/>
        <xccdf:select idref="disable-GUI" selected="true"/>
        <xccdf:select idref="disable-sendmail" selected="true"/>
        <xccdf:select idref="disable-SNMP-server" selected="true"/>
        <xccdf:select idref="disable-HPUX-boot-services" selected="true"/>
        <xccdf:select idref="disable-CIFS-server" selected="true"/>
        <xccdf:select idref="disable-CIFS-client" selected="true"/>
        <xccdf:select idref="disable-NFS-server" selected="true"/>
        <xccdf:select idref="disable-NFS-client" selected="true"/>
        <xccdf:select idref="disable-RPC" selected="true"/>
        <xccdf:select idref="disable-web-server" selected="true"/>
        <xccdf:select idref="disable-DNS-server" selected="true"/>
        <xccdf:select idref="enable-stack-protection" selected="true"/>
        <xccdf:select idref="network-parameter-modifications" selected="true"/>
        <xccdf:select idref="TCP-sequence-numbers" selected="true"/>
        <xccdf:select idref="network-parameter-modifications-2" selected="true"/>
        <xccdf:select idref="enable-system-accounting" selected="true"/>
        <xccdf:select idref="enable-kernel-level-auditing" selected="true"/>
        <xccdf:select idref="enable-inetd-logging" selected="true"/>
        <xccdf:select idref="enable-ftpd-logging" selected="true"/>
        <xccdf:select idref="system-log-file-permissions" selected="true"/>
        <xccdf:select idref="world-writeable-directories-sticky" selected="false"/>
        <xccdf:select idref="world-writeable-files_AND_suid-sgid-executables" selected="false"/>
        <xccdf:select idref="unowned-nodes" selected="false"/>
        <xccdf:select idref="patch-backup-permissions" selected="true"/>
        <xccdf:select idref="Rule-7.1" selected="true"/>
        <xccdf:select idref="create-ftpusers" selected="true"/>
        <xccdf:select idref="disable-syslog-remote" selected="true"/>
        <xccdf:select idref="disable-XDMCP" selected="true"/>
        <xccdf:select idref="locking-screensaver-timeout" selected="true"/>
        <xccdf:select idref="inetd-access-control" selected="true"/>
        <xccdf:select idref="restrict-at-cron" selected="true"/>
        <xccdf:select idref="restrict-crontab-permissions" selected="true"/>
        <xccdf:select idref="restrict-root-logins" selected="true"/>
        <xccdf:select idref="account-lockout" selected="true"/>
        <xccdf:select idref="disable-secure-RPC-nobody" selected="true"/>
        <xccdf:select idref="block-system-accounts" selected="true"/>
        <xccdf:select idref="empty-passwords" selected="true"/>
        <xccdf:select idref="account-expiration-parameters" selected="true"/>
        <xccdf:select idref="strong-password-enforcement-min-pass-len" selected="true"/>       
        <xccdf:select idref="strong-password-enforcement-pass-hist-depth" selected="true"/>
        <xccdf:select idref="strong-password-enforcement-pass-min-digits" selected="true"/>
        <xccdf:select idref="strong-password-enforcement-pass-min-upper" selected="true"/>
        <xccdf:select idref="strong-password-enforcement-pass-min-special" selected="true"/>
        <xccdf:select idref="strong-password-enforcement-pass-min-lower" selected="true"/>
        <xccdf:select idref="remove-NIS-password-extension" selected="true"/>
        <xccdf:select idref="protected-root-path" selected="true"/>
        <xccdf:select idref="user-home-permissions" selected="true"/>
        <xccdf:select idref="user-dotfile-permissions" selected="true"/>
        <xccdf:select idref="user-netrc-permissions" selected="true"/>
        <xccdf:select idref="default-user-umask" selected="true"/>
        <xccdf:select idref="mesg-n" selected="true"/>
        <xccdf:select idref="login-banners" selected="true"/>
        <xccdf:select idref="login-banners-GUI" selected="true"/>
        <xccdf:select idref="login-banners-ftp" selected="true"/>

        <!-- security notes checks -->
        <xccdf:select idref="Rule-12.1" selected="true"/>
        <xccdf:select idref="Rule-12.2" selected="true"/>
        <xccdf:select idref="Rule-12.3" selected="true"/>
        <xccdf:select idref="disable-inetd" selected="true"/>
        <xccdf:select idref="Rule-12.5" selected="true"/>
        <xccdf:select idref="Rule-12.6" selected="true"/>
        <xccdf:select idref="remove-compilers" selected="true"/>
        <xccdf:select idref="uid-0-accounts" selected="true"/>
        <xccdf:select idref="Rule-12.9" selected="true"/>

    </xccdf:Profile>
    <xccdf:Group id="Group-1">
        <xccdf:title><xccdf:sub idref="bastille-item"/>Patches and Additional Software</xccdf:title>
        <xccdf:description>This group specifies how patches should be applied on HP-UX systems.</xccdf:description>
        <xccdf:Rule id="apply-latest-OS-patches" role="unscored" selected="false" weight="0.0">
            <xccdf:title>Apply latest OS patches</xccdf:title>
            <xccdf:description>
                <xhtml:div><xhtml:p> Action (HP-UX 11i):</xhtml:p>(HP-UX 11i)<xhtml:ol>
                        <xhtml:li>
                            <xhtml:p>Download and install HP-UX Software Assistant from <xhtml:a href="https://www.hp.com/go/swa">https://www.hp.com/go/swa</xhtml:a> if not already installed on
                                the system. Follow the installation instructions available the above
                                page.</xhtml:p>
                        </xhtml:li>
                        <xhtml:li>
                            <xhtml:p>Run Software Assistant (SWA) asswa reportNote that the above
                                command assumes direct network connectivity from the system you are
                                running SWA on to HP’s servers. See the swa(1M) man page for dealing
                                with issues such as specifying proxy servers, etc.</xhtml:p>
                        </xhtml:li>
                        <xhtml:li>
                            <xhtml:p>Perform the actions specified by Software Assistant. This may
                                involve:</xhtml:p>
                        </xhtml:li>
                    </xhtml:ol>
                    <xhtml:ol>
                        <xhtml:li>
                            <xhtml:p>Manual actions such as removing files or changing file
                                permissions. This is typically done by reading the HP Security
                                Bulletin specified by the SWA tool and implementing the recommended
                                actions if they apply to this system’s configuration. If they do not
                                apply, update the $HOME/.swa/ignore file to suppress this issue in
                                future reports as directed in the swa(1M) man page. </xhtml:p>
                        </xhtml:li>
                        <xhtml:li>
                            <xhtml:p>Installing updated versions of software applications such as
                                the Apache HTTP server, SAMBA software, etc. This is done by
                                downloading the software updates from locations specified in the HP
                                Security Bulletin, such as: <xhtml:a href="http://software.hp.com/">http://software.hp.com</xhtml:a>, <xhtml:a href="http://support.openview.hp.com/">http://support.openview.hp.com</xhtml:a>, or <xhtml:a href="http://www.hp.com/go/java">http://www.hp.com/go/java</xhtml:a> and then installing with
                                swinstall.</xhtml:p>
                        </xhtml:li>
                        <xhtml:li>
                            <xhtml:p>Installing patches: This is typically done by downloading the
                                specified patches, plus any patches those patches depend upon. The
                                easiest way to do this is to create a depot and then install its
                                contents:swa get –t &lt;directory to make depots&gt;after un-sharing
                                the patches:swinstall –s &lt;depot location&gt; \*Alternatively, you
                                may consider swcopying the depots together and installing
                                once.</xhtml:p>
                        </xhtml:li>
                        <xhtml:li>
                            <xhtml:p>Removing obsolete software: In some cases, an HP security
                                bullet may recommend replacing vulnerable software with an updated
                                version or an equivalent but different product, such as replacing
                                Netscape with Mozilla. This is typically done using the swremove
                                command.</xhtml:p>
                        </xhtml:li>
                    </xhtml:ol></xhtml:div>
                <xhtml:div><xhtml:p> Action (older HP-UX releases):</xhtml:p>(older
                    HP-UX releases)<xhtml:p>Strongly consider upgrading to HP-UX
                    11i.</xhtml:p></xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>Installing up-to-date vendor patches and developing a procedure for
                        keeping up with vendor patches is critical for the security and reliability
                        of the system. Vendors will issue operating system updates when they become
                        aware of security vulnerabilities and other serious functionality issues,
                        but it is up to their customers to actually download and install these
                        patches.</xhtml:p>
                    <xhtml:p>During the patch installation process, some patches may not be
                        installed. Administrators may ignore individual patch installations that
                        fail because they patch a software sub-system that is not installed on the
                        system. If a patch installation fails for any other reason, the
                        administrator should consult the patch installation log in
                        /var/adm/sw/swagentd.log.</xhtml:p>
                    <xhtml:p>Additionally, consider installing HP’s quarterly patch updates
                        available from HP’s IT Resource Center (<xhtml:a href="http://itrc.hp.com/service/patch/releaseIndexPage.do">http://itrc.hp.com/service/patch/releaseIndexPage.do</xhtml:a>), and/or
                        using the “swa get” command. Similarly, HP-UX administrators should run SWA
                        daily and/or subscribe to HP’s Security Bulletins Digest, which directs you
                        to install specific security patches and other updates as they come out.
                        Using SWA to analyze relevance of security bulletins and partially automate
                        their application is much easier and more reliable than performing that
                        analysis manually, so SWA is by far the easier option in most
                        cases.</xhtml:p>
                    <xhtml:p>Information on how to subscribe to the Security Bulletins Digest is
                        available from the HP IT Resource Center (<xhtml:a href="http://itrc.hp.com/">http://itrc.hp.com</xhtml:a>).</xhtml:p>
                    <xhtml:p>Note that much of this benchmark assumes the system is current with
                        respect to security-bulletin-announced patches, and that the applicable
                        Quality Packs are installed.</xhtml:p>
                    <xhtml:p>Finally, security patches are no longer available for HP-UX 11.00 and
                        earlier releases, HP-UX 11.00 having reached its official End of Life on
                        December 31st 2006. Sites running HP-UX 11.00 and earlier releases should
                        strongly consider upgrading to HP-UX 11i.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10010</xccdf:ident>
        </xccdf:Rule>
        <xccdf:Rule id="configure-SSH" role="full" selected="false" weight="1.0">
            <xccdf:title>Install and configure SSH</xccdf:title>
            <xccdf:description>
                <xhtml:div><xhtml:p> Action (HP-UX 11i):</xhtml:p>(HP-UX 11i)<xhtml:ol>
                        <xhtml:li>
                            <xhtml:p>Download and install the pre-compiled OpenSSH software from
                                    <xhtml:a href="http://software.hp.com/cgi-bin/%0Bswdepot_parser.cgi/cgi/%0BdisplayProductInfo.pl?productNumber=T1471AA">http://software.hp.com/cgi-bin/swdepot_parser.cgi/cgi/displayProductInfo.pl?productNumber=T1471AA</xhtml:a>
                                if not already installed on the system. Installation instructions
                                can be found at <xhtml:a href="http://h20293.www2.hp.com/portal/swdepot/displayInstallInfo.do?productNumber=T1471AA">http://h20293.www2.hp.com/portal/swdepot/displayInstallInfo.do?productNumber=T1471AA</xhtml:a>.
                                Note that the OpenSSH is installed by default on HP-UX 11iv2 and
                                later.</xhtml:p>
                        </xhtml:li>
                        <xhtml:li>
                            <xhtml:p>Perform the following post-installation action:</xhtml:p>
                        </xhtml:li>
                    </xhtml:ol>
                    <xhtml:p>
                        <xhtml:code>cd /opt/ssh/etc</xhtml:code>
                        <xhtml:code>cp -p sshd_config sshd_config.tmp</xhtml:code>
                        <xhtml:code>awk '</xhtml:code>
                        <xhtml:code> /^Protocol/ { $2 = "2" };</xhtml:code>
                        <xhtml:code> /^X11Forwarding/ { $2 = "yes" };</xhtml:code>
                        <xhtml:code> /^IgnoreRhosts/ { $2 = "yes" };</xhtml:code>
                        <xhtml:code> /^RhostsAuthentication/ { $2 = "no" };</xhtml:code>
                        <xhtml:code> /^RhostsRSAAuthentication/ { $2 = "no" };</xhtml:code>
                        <xhtml:code> /(^#|^)PermitRootLogin/ { $1 = "PermitRootLogin";</xhtml:code>
                        <xhtml:code> $2 = "no" };</xhtml:code>
                        <xhtml:code> /^PermitEmptyPasswords/ { $2 = "no" };</xhtml:code>
                        <xhtml:code> /^#Banner/ { $1 = "Banner";</xhtml:code>
                        <xhtml:code> $2 = "/etc/issue" }</xhtml:code>
                        <xhtml:code> { print }' sshd_config.tmp &gt; sshd_config</xhtml:code>
                        <xhtml:code>rm -f sshd_config.tmp</xhtml:code>
                        <xhtml:code> chown root:sys ssh_config sshd_config</xhtml:code>
                        <xhtml:code>chmod go-w ssh_config sshd_config</xhtml:code>
                    </xhtml:p></xhtml:div>
                <xhtml:div><xhtml:p> Action (older HP-UX releases):</xhtml:p>(older
                    HP-UX releases)<xhtml:p>Consider upgrading to HP-UX 11i, or see <xhtml:a href="http://www.openssh.org/">http://www.openssh.org/</xhtml:a> for
                        information on building OpenSSH from source.</xhtml:p></xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>OpenSSH is a popular free distribution of the standards-track SSH
                        protocols, which allows secure encrypted network logins and file transfers.
                        However, compilation of OpenSSH is complicated by the fact that it is
                        dependent upon several other freely-available software libraries that also
                        need to be built before OpenSSH itself can be compiled. In order to simplify
                        the installation process, we make use of a pre-compiled version of OpenSSH,
                        available from Hewlett-Packard. Note, however, this pre-compiled version is
                        only available for HP-UX 11.x releases. Sites running HP-UX 10.20 or earlier
                        must build OpenSSH from source.</xhtml:p>
                    <xhtml:p>For more information on building OpenSSH from source, see <xhtml:a href="http://www.openssh.org/">http://www.openssh.org/</xhtml:a>.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10030</xccdf:ident>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <!--/opt/ssh/etc/sshd_config Protocol 2-->
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="command test «egrep '^Protocol[[:space:]]+2[[:space:]]*$' /opt/ssh/etc/sshd_config»" success="pass">
                            <ecl:command>egrep '^Protocol[[:space:]]+2[[:space:]]*$'
                                /opt/ssh/etc/sshd_config</ecl:command>
                            <ecl:line-selection op="pm" value="^.*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <!--/opt/ssh/etc/sshd_config X11Forwarding yes-->
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="command test «egrep '^X11Forwarding[[:space:]]+yes[[:space:]]*$' /opt/ssh/etc/sshd_config»" success="pass">
                            <ecl:command>egrep '^X11Forwarding[[:space:]]+yes[[:space:]]*$'
                                /opt/ssh/etc/sshd_config</ecl:command>
                            <ecl:line-selection op="pm" value="^.*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <!--/opt/ssh/etc/sshd_config IgnoreRhosts yes-->
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="command test «egrep '^IgnoreRhosts[[:space:]]+yes[[:space:]]*$' /opt/ssh/etc/sshd_config»" success="pass">
                            <ecl:command>egrep '^IgnoreRhosts[[:space:]]+yes[[:space:]]*$'
                                /opt/ssh/etc/sshd_config</ecl:command>
                            <ecl:line-selection op="pm" value="^.*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <!--/opt/ssh/etc/sshd_config RhostsAuthentication yes == fail-->
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="command test «egrep '^RhostsAuthentication[[:space:]]+no[[:space:]]*$' /opt/ssh/etc/sshd_config»" success="fail">
                            <ecl:command>egrep '^RhostsAuthentication[[:space:]]+yes[[:space:]]*$'
                                /opt/ssh/etc/sshd_config</ecl:command>
                            <ecl:line-selection op="pm" value="^.*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <!--/opt/ssh/etc/sshd_config RhostsRSAAuthentication no-->
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="command test «egrep '^RhostsRSAAuthentication[[:space:]]+no[[:space:]]*$' /opt/ssh/etc/sshd_config»" success="pass">
                            <ecl:command>egrep '^RhostsRSAAuthentication[[:space:]]+no[[:space:]]*$'
                                /opt/ssh/etc/sshd_config</ecl:command>
                            <ecl:line-selection op="pm" value="^.*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <!--/opt/ssh/etc/sshd_config PermitRootLogin no-->
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="command test «egrep '^PermitRootLogin[[:space:]]+no[[:space:]]*$' /opt/ssh/etc/sshd_config»" success="pass">
                            <ecl:command>egrep '^PermitRootLogin[[:space:]]+no[[:space:]]*$'
                                /opt/ssh/etc/sshd_config</ecl:command>
                            <ecl:line-selection op="pm" value="^.*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <!--/opt/ssh/etc/sshd_config PermitEmptyPasswords no-->
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="command test «egrep '^PermitEmptyPasswords[[:space:]]+no[[:space:]]*$' /opt/ssh/etc/sshd_config»" success="pass">
                            <ecl:command>egrep '^PermitEmptyPasswords[[:space:]]+no[[:space:]]*$'
                                /opt/ssh/etc/sshd_config</ecl:command>
                            <ecl:line-selection op="pm" value="^.*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <!--/opt/ssh/etc/sshd_config Banner /etc/issue-->
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="command test «egrep '^Banner[[:space:]]+/etc/issue[[:space:]]*$' /opt/ssh/etc/sshd_config»" success="pass">
                            <ecl:command>egrep '^Banner[[:space:]]+/etc/issue[[:space:]]*$'
                                /opt/ssh/etc/sshd_config</ecl:command>
                            <ecl:line-selection op="pm" value="^.*$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="use-bastille" role="unscored" selected="false" weight="0.0">
            <xccdf:title>
                <xccdf:sub idref="bastille-item"/>Install and Run Bastille </xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action (HP-UX 11.x):</xhtml:p> HP-UX 11.x
                        <xhtml:p>Download and install Bastille HP-UX from https://
                        www.hp.com/go/bastille </xhtml:p>
                    <xhtml:p>After Bastille is installed, copy the bastille_hpux.CIS.conf file
                        provided in the archive containing the PDF version of this document (and in
                        Appendix C) to /etc/Bastille/config. Run Bastille in batch mode as
                        shown:</xhtml:p>
                    <xhtml:p>cp /path/to/bastille.CIS.conf config
                        /opt/sec_mgmt/bastille/bin/bastille -b </xhtml:p>
                    <xhtml:p>At this point, Bastille commits the changes.</xhtml:p></xhtml:div>
                <xhtml:div><xhtml:p> Action (HP-UX 10.20):</xhtml:p>HP-UX
                        10.20<xhtml:p>Strongly consider upgrading to HP-UX
                    11i.</xhtml:p></xhtml:div>
                <xhtml:div>
                    <xccdf:title>Discussion: </xccdf:title>
                    <xhtml:p>Bastille is a series of Perl scripts that ask you questions and hardens
                        your machine based on the answers. The Benchmark will then walk you through
                        opening up your system for the services that have a legitimate Business
                        need.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10040</xccdf:ident>
        </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="Group-2">
        <xccdf:title><xccdf:sub idref="bastille-item"/>Minimize inetd network services</xccdf:title>
        <xccdf:description>This group holds the recommendations for configuring inetd network services.</xccdf:description>
        <xccdf:Rule id="disable-standard-services" role="full" selected="false" weight="1.0">
            <xccdf:title>Disable Standard Services</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>cd /etctouch /var/adm/inetd.secfor svc in echo discard daytime chargen
                        dtspc \ exec ntalk finger uucp ident auth \ instl_boots registrar recserv;
                        do awk "(\$1 == \"$svc\") { \$1 = \"#\" \$1 }; {print}" \ inetd.conf &gt;
                        inetd.conf.new cp inetd.conf.new inetd.conf grep -E -q "^$svc[ ]+deny[ ]*$"
                        /var/adm/inetd.sec \ || echo "$svc deny" &gt;&gt; /var/adm/inetd.secdonefor
                        svc in rpc.rstatd rpc.rusersd rpc.rwalld \ rpc.sprayd rpc.cmsd kcms_server;
                        do awk "/\\/$svc/ { \$1 = \"#\" \$1 }; { print }" \ inetd.conf &gt;
                        inetd.conf.new cp inetd.conf.new inetd.confdonefor svc in printer shell
                        login telnet ftp tftp \ bootps kshell klogin; do awk "(\$1 == \"$svc\") {
                        \$1 = \"#\" \$1 }; {print}" \ inetd.conf &gt; inetd.conf.new cp
                        inetd.conf.new inetd.conf grep -E -q "^$svc[ ]+deny[ ]*$" /var/adm/inetd.sec
                        \ || echo "$svc deny" &gt;&gt; /var/adm/inetd.secdonefor svc in rpc.rquotad
                        rpc.ttdbserver; do awk "/^$svc\\// { \$1 = \"#\" \$1 }; { print }" \
                        /etc/inetd.conf &gt; /etc/inetd.conf.new cp inetd.conf.new
                        inetd.confdone</xhtml:p>
                    <xhtml:p>chown root:sys inetd.confchmod go-w,a-xs inetd.confrm -f
                        /etc/inetd.conf.new</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>The stock /etc/inetd.conf file shipped with HP-UX contains many
                        services which are rarely used, or which have more secure alternatives.
                        Indeed, after enabling SSH (see item 1.2) it may be possible to completely
                        do away with all inetd-based services, since SSH provides both a secure
                        login mechanism and a means of transferring files to and from the system. In
                        fact, the actions above will disable all services normally enabled in the
                        HP-UX inetd.conf file.</xhtml:p>
                    <xhtml:p>The rest of the actions in this section give the administrator the
                        option of re-enabling certain services—in particular, the services that are
                        disabled in the last two loops in the Action section above.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xccdf:title>Bastille Notes:</xccdf:title>
                    <xhtml:p>Rather than disabling and then re-enabling these services, Bastille
                        operates by disabling only those services that are unnecessary for the
                        systems.</xhtml:p>
                    <xhtml:p>Also note that Bastille only disables those inetd services that are
                        enabled by default, so it is possible that a service that has been turned on
                        manually will not be turned off when using Bastille. </xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10060</xccdf:ident>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist">
                            <ecl:command>egrep
                                '^(echo|discard|daytime|chargen|dtspc|exec|ntalk|finger|uucp|ident|auth|instl_boots|registrar|recserv)[[:space:]]+'
                                /etc/inetd.conf</ecl:command>
                            <ecl:line-selection op="pm" value="^.+$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist">
                            <ecl:command>egrep '^(rpc.rstatd|rpc.rusersd|rpc.rwalld|rpc.sprayd|rpc.cmsd|kcms_server)' /etc/inetd.conf</ecl:command>
                            <ecl:line-selection op="pm" value="^.+$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist">
                            <ecl:command>egrep
                                '^(printer|shell|login|telnet|ftp|tftp|bootps|kshell|klogin)[[:space:]]+'
                                /etc/inetd.conf</ecl:command>
                            <ecl:line-selection op="pm" value="^.+$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist">
                            <ecl:command>egrep '^rpc.*(rpc.rquotad|rpc.ttdbserver)' /etc/inetd.conf</ecl:command>
                            <ecl:line-selection op="pm" value="^.+$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="disable-telnet" role="full" selected="false" weight="1.0">
            <xccdf:title>
                <xccdf:sub idref="bastille-item"/>Only enable telnet if absolutely
                necessary</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p class="question">Question</xhtml:p>
                    <xhtml:p>Is there a mission-critical reason that requires users to access this
                        system via telnet, rather than the more secure SSH protocol?</xhtml:p>
                    <xhtml:p>If the answer to this question is yes, perform the actions
                        below.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>awk '/^#telnet/ { $1 = "telnet" print $0 " -b /etc/issue"; next} {
                        print }' inetd.conf &gt; /etc/inetd.conf.newcp inetd.conf.new inetd.confgrep
                        -Ev '^telnet[ ]+deny[ ]*$' \ /var/adm/inetd.sec &gt;
                        /var/adm/inetd.sec.newcp /var/adm/inetd.sec.new /var/adm/inetd.secrm -f
                        /etc/inetd.conf.new /etc/inetd.sec.new</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>telnet uses an unencrypted network protocol, which means data from the
                        login session (such as passwords and all other data transmitted during the
                        session) can be stolen by eavesdroppers on the network, and also that the
                        session can be hijacked by outsiders to gain access to the remote system.
                        The freely-available SSH utilities (see item1.2– Install SSH) provides an
                        encrypted alternative to telnet (and other utilities) and should be used
                        instead.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10290</xccdf:ident>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Service «telnet» does not exist">
                            <ecl:command>egrep '^(telnet)[[:space:]]+' /etc/inetd.conf</ecl:command>
                            <ecl:line-selection op="pm" value=".+"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Service «telnet» is denied in inetd.sec">
                            <ecl:command>egrep '^(telnet)[[:space:]]+deny[[:space:]]*$'
                                /var/adm/inetd.sec</ecl:command>
                            <ecl:line-selection op="pm" value=".+"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="disable-FTP" role="full" selected="false" weight="1.0">
            <xccdf:title>
                <xccdf:sub idref="bastille-item"/>Only enable FTP if absolutely
                necessary</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p class="question">Question</xhtml:p>
                    <xhtml:p>Is this machine an (anonymous) FTP server, or is there a
                        mission-critical reason why data must be transferred to and from this system
                        via ftp, rather than scp?</xhtml:p>
                    <xhtml:p>If the answer to this question is yes, perform the actions
                        below.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>awk ' /^#ftp/ { $1 = "ftp"; print $0 "-l" ; next} { print }' inetd.conf
                        &gt; inetd.conf.newcp inetd.conf.new inetd.confgrep -Ev '^ftp[ ]+deny[ ]*$'
                        \ /var/adm/inetd.sec &gt; /var/adm/inetd.sec.newcp /var/adm/inetd.sec.new
                        /var/adm/inetd.secrm -f /etc/inetd.conf.new /etc/inetd.sec.new</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>Like telnet, the FTP protocol is unencrypted, which means passwords and
                        other data transmitted during the session can captured by sniffing the
                        network, and that the FTP session itself can be hijacked by an external
                        attacker. SSH provides two different encrypted file transfer mechanisms—scp
                        and sftp—and should be used instead. Even if FTP is required because the
                        local system is an anonymous FTP server, consider requiring non-anonymous
                        users on the system to transfer files via SSH-based protocols. For further
                        information on restricting FTP access to the system, see Item 6.2
                        below.</xhtml:p>
                    <xhtml:p>Sites may also consider augmenting the “ftpd -l” above with '-v' (10.x
                        and 11.x) or '-L' (11.x only) for additional logging of FTP transactions, or
                        with '-a' (11.x only) for fine grain FTP access control through the use of a
                        configuration file – see the ftpd(1M) man page on your systems for
                        details.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10300</xccdf:ident>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Service «ftp» does not exist">
                            <ecl:command>egrep '^(ftp)[[:space:]]+' /etc/inetd.conf</ecl:command>
                            <ecl:line-selection op="pm" value=".+"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Service «ftp» is denied in inetd.sec">
                            <ecl:command>egrep '^(ftp)[[:space:]]+deny[[:space:]]*$'
                                /var/adm/inetd.sec</ecl:command>
                            <ecl:line-selection op="pm" value=".+"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="disable-r-commands" role="full" selected="false" weight="1.0">
            <xccdf:title>
                <xccdf:sub idref="bastille-item"/>Only enable rlogin/remsh/rcp if absolutely
                necessary</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p class="question">Question</xhtml:p>
                    <xhtml:p>Is there a mission-critical reason why rlogin/remsh/rcp must be used
                        instead of the more secure ssh/scp?</xhtml:p>
                    <xhtml:p>If the answer to this question is yes, perform the actions
                        below.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>sed 's/^#shell/shell/; s/^#login/login/' \ inetd.conf &gt;
                        inetd.conf.newcp inetd.conf.new inetd.confgrep -Ev '^(shell|login)[ ]+deny[
                        ]*$' \ /var/adm/inetd.sec &gt; /var/adm/inetd.sec.newcp
                        /var/adm/inetd.sec.new /var/adm/inetd.secrm -f /etc/inetd.conf.new
                        /etc/inetd.sec.new</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>SSH was designed to be a drop-in replacement for these protocols. Given
                        the wide availability of free SSH implementations, there are few cases where
                        these tools cannot be replaced with SSH (again, see item 1.2 – Install
                        SSH).</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10310</xccdf:ident>
            <xccdf:complex-check operator="AND">
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="Service «shell» does not exist">
                                <ecl:command>egrep '^(shell)[[:space:]]+'
                                    /etc/inetd.conf</ecl:command>
                                <ecl:line-selection op="pm" value=".+"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Service «shell» is denied in inetd.sec">
                                <ecl:command>egrep '^(shell)[[:space:]]+deny[[:space:]]*$'
                                    /var/adm/inetd.sec</ecl:command>
                                <ecl:line-selection op="pm" value=".+"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="Service «login» does not exist">
                                <ecl:command>egrep '^(login)[[:space:]]+'
                                    /etc/inetd.conf</ecl:command>
                                <ecl:line-selection op="pm" value=".+"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Service «login» is denied in inetd.sec">
                                <ecl:command>egrep '^(login)[[:space:]]+deny[[:space:]]*$'
                                    /var/adm/inetd.sec</ecl:command>
                                <ecl:line-selection op="pm" value=".+"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="disable-TFTP-server" role="full" selected="false" weight="1.0">
            <xccdf:title>
                <xccdf:sub idref="bastille-item"/>Only enable TFTP if absolutely
                necessary</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p class="question">Question</xhtml:p>
                    <xhtml:p>Is this system a boot server or is there some other mission-critical
                        reason why data must be transferred to and from this system via
                        TFTP?</xhtml:p>
                    <xhtml:p>If the answer to this question is yes, perform the actions
                        below.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>sed 's/^#tftp/tftp/' inetd.conf &gt;inetd.conf.newcp inetd.conf.new
                        inetd.confgrep -Ev '^tftp[ ]+deny[ ]*$' \ /var/adm/inetd.sec &gt;
                        /var/adm/inetd.sec.newcp /var/adm/inetd.sec.new /var/adm/inetd.secrm -f
                        /etc/inetd.conf.new /etc/inetd.sec.newmkdir -p /var/opt/ignite</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>TFTP is typically used for network booting of diskless workstations,
                        X-terminals, and other similar devices. TFTP is also used during network
                        installs of systems via the HP-UX Ignite facility. Routers and other network
                        devices may copy configuration data to remote systems via TFTP for backup.
                        However, unless this system is needed in one of these roles, it is best to
                        leave the TFTP service disabled.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10380</xccdf:ident>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Service «tftp» does not exist">
                            <ecl:command>egrep '^(tftp)[[:space:]]+' /etc/inetd.conf</ecl:command>
                            <ecl:line-selection op="pm" value=".+"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Service «tftp» is denied in inetd.sec">
                            <ecl:command>egrep '^(tftp)[[:space:]]+deny[[:space:]]*$'
                                /var/adm/inetd.sec</ecl:command>
                            <ecl:line-selection op="pm" value=".+"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="disable-printer-service" role="full" selected="false" weight="1.0">
            <xccdf:title>
                <xccdf:sub idref="bastille-item"/>Only enable printer service if absolutely
                necessary</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p class="question">Question</xhtml:p>
                    <xhtml:p>Is this machine a print server for your network?</xhtml:p>
                    <xhtml:p>If the answer to this question is yes, perform the actions
                        below.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>sed 's/^#printer/printer/' inetd.conf &gt;inetd.conf.newcp
                        inetd.conf.new inetd.confgrep -Ev '^printer[ ]+deny[ ]*$' \
                        /var/adm/inetd.sec &gt; /var/adm/inetd.sec.newcp /var/adm/inetd.sec.new
                        /var/adm/inetd.secrm -f /etc/inetd.conf.new /etc/inetd.sec.new</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>rlpdaemon provides a BSD-compatible print server interface. Even
                        machines that are print servers may wish to leave this service disabled if
                        they do not need to support BSD-style printing.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10420</xccdf:ident>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Service «printer» does not exist">
                            <ecl:command>egrep '^(printer)[[:space:]]+'
                                /etc/inetd.conf</ecl:command>
                            <ecl:line-selection op="pm" value=".+"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Service «printer» is denied in inetd.sec">
                            <ecl:command>egrep '^(printer)[[:space:]]+deny[[:space:]]*$'
                                /var/adm/inetd.sec</ecl:command>
                            <ecl:line-selection op="pm" value=".+"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="disable-rquotad" role="full" selected="false" weight="1.0">
            <xccdf:title>Only enable rquotad if absolutely necessary</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p class="question">Question</xhtml:p>
                    <xhtml:p>Is this system an NFS file server that requires the use of disk
                        quotas?</xhtml:p>
                    <xhtml:p>If the answer to this question is yes, perform the actions
                        below.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>awk ' $6 ~ /\/rpc.rquotad$/ { sub(/^#/, "") } { print }' inetd.conf
                        &gt; inetd.conf.newcp inetd.conf.new inetd.confrm -f
                        /etc/inetd.conf.new</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>rquotad allows NFS clients to enforce disk quotas on file systems that
                        are mounted from the local system. If your site does not use disk quotas,
                        then you may leave the rquotad service disabled.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10240</xccdf:ident>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Service «rpc.rquotad» does not exist">
                            <ecl:command>egrep '^rpc.*(rpc.rquotad)[[:space:]]+'
                                /etc/inetd.conf</ecl:command>
                            <ecl:line-selection op="pm" value=".+"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="disable-CDE" role="full" selected="false" weight="1.0">
            <xccdf:title>
                <xccdf:sub idref="bastille-item"/>Only enable CDE-related daemons if absolutely
                necessary</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p class="question">Question</xhtml:p>
                    <xhtml:p>Is there a mission-critical reason to run a CDE GUI on this
                        system?</xhtml:p>
                    <xhtml:p>If the answer to this question is yes, perform the actions
                        below.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>awk ' $6 ~ /\/rpc.ttdbserver$/ { sub(/^#/, "") } { print }' inetd.conf
                        &gt; inetd.conf.newcp inetd.conf.new inetd.confrm -f
                        /etc/inetd.conf.new</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>The rpc.ttdbserver service supports HP's CDE windowing environment.
                        This service has a history of security problems. Not only is it vital to
                        keep up to date on vendor patches, but also never enable this service on any
                        system which is not well protected by a complete network security
                        infrastructure (including network and host-based firewalls, packet filters,
                        and intrusion detection infrastructure).</xhtml:p>
                    <xhtml:p>
                        <xccdf:sub idref="bastille-item"/>Note that since this service uses ONC RPC
                        mechanisms, it is important that the system's RPC portmapper (rpcbind) also
                        be enabled when this service is turned on. For more information see Item
                        3.12 below.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10250</xccdf:ident>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Service «rpc.ttdbserver» does not exist">
                            <ecl:command>egrep '^rpc.*(rpc.ttdbserver)[[:space:]]+'
                                /etc/inetd.conf</ecl:command>
                            <ecl:line-selection op="pm" value=".+"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="disable-Kerberos" role="full" selected="false" weight="1.0">
            <xccdf:title>Only enable Kerberos-related daemons if absolutely necessary</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p class="question">Question</xhtml:p>
                    <xhtml:p>Is the Kerberos security system in use at this site and is there a
                        mission-critical reason that requires users to access this system via
                        Kerberized rlogin/remsh, rather than the more secure SSH protocol?</xhtml:p>
                    <xhtml:p>If the answer to this question is yes, perform the actions
                        below.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>sed 's/^#kshell/kshell/; s/^#klogin/klogin/' \ inetd.conf &gt;
                        inetd.conf.newcp inetd.conf.new inetd.confgrep -Ev '^(kshell|klogin)[
                        ]+deny[ ]*$' \ /var/adm/inetd.sec &gt; /var/adm/inetd.sec.newcp
                        /var/adm/inetd.sec.new /var/adm/inetd.secrm -f /etc/inetd.conf.new
                        /etc/inetd.sec.new</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>Kerberized rlogin/remsh offers a higher degree of security than
                        traditional rlogin, remsh, or telnet by eliminating many clear-text password
                        exchanges from the network. However it is still not as secure as SSH, which
                        encrypts all traffic. Given the wide availability of free SSH
                        implementations, there are few cases where these tools cannot be replaced
                        with SSH (again, see item 1.2– Install SSH). For more information on
                        Kerberos see <xhtml:a href="http://web.mit.edu/kerberos/www/">http://web.mit.edu/kerberos/www/</xhtml:a>.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10150</xccdf:ident>
            <xccdf:complex-check operator="AND">
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="Service «kshell» does not exist">
                                <ecl:command>egrep '^(kshell)[[:space:]]+'
                                    /etc/inetd.conf</ecl:command>
                                <ecl:line-selection op="pm" value=".+"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Service «kshell» is denied in inetd.sec">
                                <ecl:command>egrep '^(kshell)[[:space:]]+deny[[:space:]]*$'
                                    /var/adm/inetd.sec</ecl:command>
                                <ecl:line-selection op="pm" value=".+"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="Service «klogin» does not exist">
                                <ecl:command>egrep '^(klogin)[[:space:]]+'
                                    /etc/inetd.conf</ecl:command>
                                <ecl:line-selection op="pm" value=".+"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Service «klogin» is denied in inetd.sec">
                                <ecl:command>egrep '^(klogin)[[:space:]]+deny[[:space:]]*$'
                                    /var/adm/inetd.sec</ecl:command>
                                <ecl:line-selection op="pm" value=".+"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="disable-DHCP-server" role="full" selected="false" weight="1.0">
            <xccdf:title>
                <xccdf:sub idref="bastille-item"/>Only enable BOOTP/DHCP daemon if absolutely
                necessary</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p class="question">Question</xhtml:p>
                    <xhtml:p>Is this server a BOOTP/DHCP server for the network?</xhtml:p>
                    <xhtml:p>If the answer to this question is yes, perform the actions
                        below.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>sed 's/^#bootps/bootps/' \ inetd.conf &gt; inetd.conf.newcp
                        inetd.conf.new inetd.confgrep -Ev '^bootps[ ]+deny[ ]*$' \
                        /var/adm/inetd.sec &gt; /var/adm/inetd.sec.newcp /var/adm/inetd.sec.new
                        /var/adm/inetd.secrm -f /etc/inetd.conf.new /etc/inetd.sec.new</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>BOOTP/DHCP is a popular protocol for dynamically assigning IP addresses
                        and other network information to systems on the network (rather than having
                        administrators manually manage this information on each host). However, if
                        this system is not a BOOTP/DHCP server for the network, there is no need to
                        be running this service.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10360</xccdf:ident>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Service «bootps» does not exist">
                            <ecl:command>egrep '^(bootps)[[:space:]]+' /etc/inetd.conf</ecl:command>
                            <ecl:line-selection op="pm" value=".+"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Service «bootps» is denied in inetd.sec">
                            <ecl:command>egrep '^(bootps)[[:space:]]+deny[[:space:]]*$'
                                /var/adm/inetd.sec</ecl:command>
                            <ecl:line-selection op="pm" value=".+"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="Group-3">
        <xccdf:title>Minimize boot services</xccdf:title>
        <xccdf:description>
            <xhtml:p>Minimizing the number of running services also minimizes potential
                vulnerabilities, especially with respect to network services. For network services
                that cannot be eliminated, the local administrator should consider minimizing access
                to them with external firewalls or host-based firewalls such as HP's
                IPFilter/9000.</xhtml:p>
        </xccdf:description>
        <xccdf:Rule id="disable-serial-port-login" role="full" selected="false" weight="1.0">
            <xccdf:title>Disable login: prompts on serial ports</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p class="question">Question</xhtml:p>
                    <xhtml:p>Is there a mission-critical need to provide login capability from any
                        serial ports (such as for a modem)?</xhtml:p>
                    <xhtml:p>If the answer to this question is yes, then do not perform the actions
                        below.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>cp -p /etc/inittab /etc/inittab.tmpsed 's/^[^#].*getty.*tty.*$/#&amp;/'
                        \ /etc/inittab.tmp &gt; /etc/inittabrm -f /etc/inittab.tmpchown root:sys
                        /etc/inittabchmod go-w,ug-s /etc/inittab</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>By disabling the login: prompt on the system serial devices, we make it
                        more difficult for unauthorized users to attach modems, terminals, and other
                        remote access devices to these ports. Note that this action may safely be
                        performed even if console access to the system is provided via the serial
                        ports, as the line in the /etc/inittab file that corresponds to the console
                        does not match the supplied pattern (i.e., it doesn’t contain the string
                        ‘tty’).</xhtml:p>
                    <xhtml:p>Note that when serial port connectivity is needed, /etc/dialups and
                        /etc/d_passwd can be set to require an extra password for serial port
                        access. See the dialups(4) manual page for more information.</xhtml:p>
                    <xhtml:p>
                        <xccdf:sub idref="bastille-item"/>Note: By default, in HP-UX 11i, only the
                        console has a getty instance running on it.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11110</xccdf:ident>
            <xccdf:check system="http://cisecurity.org/check">
                <xccdf:check-content>
                    <ecl:shell-command check="none exist">
                        <ecl:command>egrep '^[^#].*getty.*tty.*$' /etc/inittab</ecl:command>
                        <ecl:line-selection op="pm" value=".+"/>
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>
        </xccdf:Rule>
        <xccdf:Rule id="disable-NISplus" role="full" selected="false" weight="1.0">
            <xccdf:title>Disable NIS/NIS+ related processes, if possible</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p class="question">Question</xhtml:p>
                    <xhtml:p>Does this machine need NIS/NIS+ facilities (as a client or
                        server)?</xhtml:p>
                    <xhtml:p>If the answer is yes, then do not perform the actions below..</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>ch_rc -a -p NIS_MASTER_SERVER=0 -p NIS_SLAVE_SERVER=0 \ -p NIS_CLIENT=0
                        -p NISPLUS_SERVER=0 \ -p NISPLUS_CLIENT=0
                        /etc/rc.config.d/namesvrs</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>Clearly there is no need to run the NIS/NIS+ related daemons on hosts
                        that are not NIS/NIS+ servers or clients.</xhtml:p>
                    <xhtml:p>Bastille Note: </xhtml:p>
                    <xhtml:p>Bastille disables NIS processes, but not NIS+.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10110</xccdf:ident>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" success="fail">
                            <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*NIS(PLUS)?_(MASTER|SLAVE)_SERVER=1' /etc/rc.config.d/namesvrs</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" success="fail">
                            <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*NIS(PLUS)?_CLIENT=1' /etc/rc.config.d/namesvrs</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="disable-printer-daemons" role="full" selected="false" weight="1.0">
            <xccdf:title>
                <xccdf:sub idref="bastille-item"/>Disable printer daemons, if possible</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p class="question">Question</xhtml:p>
                    <xhtml:p>Is this system a print server, or is there a mission-critical reason
                        why users must submit print jobs from this system? </xhtml:p>
                    <xhtml:p>If the answer to this question is yes, then do not perform the actions
                        below.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>ch_rc -a -p XPRINTSERVERS="''" /etc/rc.config.d/tpsch_rc -a -p LP=0
                        /etc/rc.config.d/lpch_rc -a -p PD_CLIENT=0 /etc/rc.config.d/pd</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>If users will never print files from this machine and the system will
                        never be used as a print server by other hosts on the network, then it is
                        safe to disable these services and remove this software. The Unix print
                        service has generally had a poor security record—be sure to keep up-to-date
                        on vendor patches. The administrator may wish to consider converting to the
                        LPRng print system (see <xhtml:a href="http://www.lprng.org/">http://www.lprng.org/</xhtml:a>) which was designed with security in
                        mind and is widely portable across many different Unix platforms. Note,
                        however, that LPRng is not supported by Hewlett-Packard.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xccdf:title>Bastille Notes:</xccdf:title>
                    <xhtml:p>Bastille disables only lp. Xprintservers and pd_client are not shipped
                        with all versions of HP-UX. </xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10410</xccdf:ident>
            <xccdf:complex-check operator="AND">
                
                <xccdf:complex-check operator="OR">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" success="fail">
                                <ecl:command>ls /etc/rc.config.d/tps</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" success="pass">
                                <ecl:command>egrep "^XPRINTSERVERS=''$" /etc/rc.config.d/tps</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" success="fail">
                            <ecl:command>egrep "^LP=1$" /etc/rc.config.d/lp</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" success="fail">
                            <ecl:command>egrep "^PD_CLIENT=1$" /etc/rc.config.d/pd</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="disable-GUI" role="full" selected="false" weight="1.0">
            <xccdf:title>Disable GUI login, if possible</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p class="question">Question</xhtml:p>
                    <xhtml:p>Is there a mission-critical reason to run a GUI on this system? </xhtml:p>
                    <xhtml:p>If the answer to this question is yes, then do not perform the actions
                        below.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>ch_rc -a -p DESKTOP="" /etc/rc.config.d/desktopchmod go-w,ug-s
                        /usr/dt/bin/dtaction \ /usr/dt/bin/dtappgather /usr/dt/bin/dtprintinfo \
                        /usr/dt/bin/dtsession</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>The X Windows-based CDE GUI on HP-UX systems has had a history of
                        security issues. Never run any GUI-oriented service or application on a
                        system unless that machine is protected by a strong network security
                        infrastructure.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10180</xccdf:ident>
            <xccdf:complex-check operator="OR">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" success="fail">
                            <ecl:command>ls /etc/rc.config.d/desktop</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" success="pass">
                                <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*DESKTOP=$' /etc/rc.config.d/desktop</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <!--chmod go-w,ug-s /usr/dt/bin/dtaction /usr/dt/bin/dtappgather /usr/dt/bin/dtprintinfo /usr/dt/bin/dtsession-->
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist">
                                <ecl:command>(cd /usr/dt/bin;for f in dtaction dtappgather dtprintinfo dtsession; do find $f -local \( -perm -go=w -o -perm -u=s -o -perm -g=s \) -exec ls -l {} \; ; done)</ecl:command>
                                <ecl:line-selection op="pm" value=".+"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="disable-sendmail" role="full" selected="false" weight="1.0">
            <xccdf:title>
                <xccdf:sub idref="bastille-item"/>Disable email server, if possible</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p class="question">Question</xhtml:p>
                    <xhtml:p>Is this system a mail server—that is, does this machine receive and
                        process email from other hosts? </xhtml:p>
                    <xhtml:p>If the answer to this question is yes, then do not perform the actions
                        below.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>ch_rc -a -p SENDMAIL_SERVER=0 /etc/rc.config.d/mailservs cd
                        /var/spool/cron/crontabscrontab -l &gt;root.tmpecho '0 * * * *
                        /usr/lib/sendmail -q' &gt;&gt;root.tmpcrontab root.tmprm -f
                        root.tmp</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>It is possible to run a Unix system with the Sendmail daemon disabled
                        and still allow users on that system to send email out from that machine.
                        Running Sendmail in "daemon mode" (with the -bd command-line option) is only
                        required on machines that act as mail servers, receiving and processing
                        email from other hosts on the network. The actions above will result in a
                        machine that can send email but not receive it.</xhtml:p>
                    <xhtml:p>Note that after disabling the –bd option on the local mail server on
                        systems running Sendmail v8.12 or later (8.13 is currently shipped as part
                        of HP-UX 11iv3), it is also necessary to modify the /etc/mail/submit.cf
                        file. Find the line that reads "D{MTAHost}localhost" and change localhost to
                        the name of some other local mail server for the organization. This will
                        cause email generated on the local system to be relayed to that mail server
                        for further processing and delivery.</xhtml:p>
                    <xhtml:p>Note that if the system is an email server, the administrator is
                        encouraged to search the Web for additional documentation on Sendmail
                        security issues. Some information is available at <xhtml:a href="http://www.deer-run.com/~hal/dns-sendmail/DNSandSendmail.pdf">http://www.deer-run.com/~hal/dns-sendmail/DNSandSendmail.pdf</xhtml:a>
                        and at <xhtml:a href="http://www.sendmail.org/">http://www.sendmail.org/</xhtml:a>.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10630</xccdf:ident>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" success="fail">
                            <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*SENDMAIL_SERVER=1$' /etc/rc.config.d/mailservs</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" sucess="fail">
                            <ecl:command>crontab -l | egrep '^[^#]' | egrep '.*sendmail[[:space:]]+.*'</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="disable-SNMP-server" role="full" selected="false" weight="1.0">
            <xccdf:title>
                <xccdf:sub idref="bastille-item"/>Disable SNMP and OpenView Agents</xccdf:title>
            <xccdf:description>
                <xhtml:p>(If remote management or monitoring is not needed)</xhtml:p>
                <xhtml:div>
                    <xhtml:p class="question">Question</xhtml:p>
                    <xhtml:p>Are hosts at this site remotely monitored by Openview or another tool
                        that relies on SNMP such as MRTG or Cricket? </xhtml:p>
                    <xhtml:p>If the answer to this question is yes, then do not perform the actions
                        below.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:ol>
                        <xhtml:li>
                            <xhtml:p>cd /sbin/rc2.dfor file in S565OspfMib S941opcagt S570SnmpFddido
                                mv -f $file .NO$filedonech_rc -a -p SNMP_HPUNIX_START=0 \
                                /etc/rc.config.d/SnmpHpunixch_rc -a -p SNMP_MASTER_START=0 \
                                /etc/rc.config.d/SnmpMasterch_rc -a -p SNMP_MIB2_START=0 \
                                /etc/rc.config.d/SnmpMib2 -a -p SNMP_TRAPDEST_START=0 \
                                /etc/rc.config.d/SnmpTrpDst</xhtml:p>
                        </xhtml:li>
                        <xhtml:li>
                            <xhtml:p>Remove any software packages related to HP OpenView NNM using
                                swremove. These are designated as packages that begin with
                                OVOPC.</xhtml:p>
                        </xhtml:li>
                    </xhtml:ol>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>If you are using SNMP to monitor the hosts on your network, experts
                        recommend changing the default community string used to access data via
                        SNMP. On HP-UX systems, this parameter can be changed by modifying the
                        get-community and set-community parameters in
                        /etc/SnmpAgent.d/snmpd.conf</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xccdf:title>Bastille Notes:</xccdf:title>
                    <xhtml:p>Bastille does not disable the OV agents</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10440</xccdf:ident>
            <xccdf:complex-check operator="OR">              
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure SNMP is not running">
                            <ecl:command>ps -ef | grep -i snmpdm | grep -v grep</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="Ensure SNMP startup scripts are removed" success="pass">
                            <ecl:command>find /sbin/rc2.d -local  \( -name S565OspfMib -o -name S941opcagt -o -name S570SnmpFddido \) 2&gt;/dev/null</ecl:command>
                            <ecl:line-selection op="pm" value=".+"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure SNMP_HPUNIX_START is set to 0" success="pass">
                            <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*SNMP_HPUNIX_START=0$' /etc/rc.config.d/SnmpHpunix</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure SNMP_MASTER_START is set to 0" success="pass">
                            <ecl:command>egrep '^SNMP_MASTER_START=0$' /etc/rc.config.d/SnmpMaster</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure SNMP_MIB2_START is set to 0" success="pass">
                            <ecl:command>egrep '^SNMP_MIB2_START=0$'
                                /etc/rc.config.d/SnmpMib2</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure SNMP_TRAPDEST_START is set to 0" success="pass">
                            <ecl:command>egrep '^SNMP_TRAPDEST_START=0$' /etc/rc.config.d/SnmpTrpDst</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                </xccdf:complex-check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="disable-HPUX-boot-services" role="full" selected="false" weight="1.0">
            <xccdf:title>
                <xccdf:sub idref="bastille-item"/>Disable other standard boot services</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>ch_rc -a -p START_SNAPLUS=0 -p START_SNANODE=0 \ -p START_SNAINETD=0
                        /etc/rc.config.d/snaplus2ch_rc -a -p MROUTED=0 -p RWHOD=0 \-p DDFA=0 \ -p
                        START_RBOOTD=0 /etc/rc.config.d/netdaemonsch_rc -a -p DCE_KRPC=0 -p
                        DFS_CORE=0 -p DFS_CLIENT=0 \ -p DFS_SERVER=0 -p DFS_EPISODE=0 -p EPIINIT=0 \
                        -p DFSEXPORT=0 -p BOSSERVER=0 -p DFSBIND=0 \ -p FXD=0 -p MEMCACHE=0 -p
                        DFSGWD=0 \ -p DISKCACHEFORDFS=0 /etc/rc.config.d/dfs ch_rc -a -p RARPD=0 -p
                        RDPD=0 /etc/rc.config.d/netconfch_rc -a -p PTYDAEMON_START=0
                        /etc/rc.config.d/ptydaemonch_rc -a -p VTDAEMON_START=0
                        /etc/rc.config.d/vtch_rc -a -p NAMED=0 /etc/rc.config.d/namesvrsch_rc -a -p
                        PEER_SNMPD_START=0 \ /etc/rc.config.d/peer.snmpdch_rc -a -p START_I4LMD=0
                        /etc/rc.config.d/i4lmdch_rc -a -p RUN_X_FONT_SERVER=0
                        /etc/rc.config.d/xfsch_rc -a -p AUDIO_SERVER=0 /etc/rc.config.d/audioch_rc
                        -a -p SLSD_DAEMON=0 /etc/rc.config.d/slsd</xhtml:p>
                    <xhtml:p>ch_rc -a -p RUN_SAMBA=0 /etc/rc.config.d/sambach_rc -a -p
                        RUN_CIFSCLIENT=0 \ /etc/rc.config.d/cifsclientch_rc -a -p NFS_SERVER=0 \ -p
                        NFS_CLIENT=0 /etc/rc.config.d/nfsconfch_rc -a -p NS_FTRACK=0
                        /etc/rc.config.d/ns-ftrackch_rc -a -p APACHE_START=0
                        /etc/rc.config.d/apacheconfmv -f /sbin/rc2.d/S400nfs.core \
                        /sbin/rc2.d/.NOS400nfs.core</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>Setting these variables in the /etc/rc.config.d configuration files
                        will effectively disable a wide variety of infrequently used subsystems.
                        Variables are merely set (rather than renaming or removing startup scripts)
                        so that the local administrator can easily "restore" any of these services
                        if they discover a mission-critical need to have it. Additionally, HP-UX
                        patches tend to supply fresh copies of the startup scripts, so they may get
                        inadvertently re-enabled, whereas setting configuration variables usually
                        survives patch installs. Finally, setting configuration variables is the
                        method recommended and supported by HP. Note that not all of the
                        configuration files listed above will exist on all systems (some are only
                        valid for certain releases, others only exist if certain OEM vendor software
                        is installed).</xhtml:p>
                    <xhtml:p>The rest of the actions in this section give the administrator the
                        option of re-enabling certain services, in particular, the services that
                        are disabled in the second block of the Action section above. Rather than
                        disabling and then re-enabling these services, experienced administrators
                        may wish to simply disable only those services that they know are
                        unnecessary for their systems.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xccdf:title>Bastille Notes:</xccdf:title>
                    <xhtml:p>Bastille only disables those services listed above that are enabled by
                        default, so it is possible that a service that has been turned on manually
                        will not be turned off when using Bastille. </xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:complex-check operator="AND">
                    <xccdf:complex-check operator="AND">
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="Ensure START_SNAPLUS is set to 0" success="fail">
                                    <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*START_SNAPLUS=1$' /etc/rc.config.d/snaplus2</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="Ensure START_SNANODE is set to 0" success="fail">
                                    <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*START_SNANODE=1$' /etc/rc.config.d/snaplus2</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="Ensure START_SNAINETD is set to 0" success="fail">
                                    <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*START_SNAINETD=1$' /etc/rc.config.d/snaplus2</ecl:command>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                    </xccdf:complex-check>

                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" success="fail">
                                <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*MROUTED=1$' /etc/rc.config.d/netdaemons</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" success="fail">
                                <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*RWHOD=1$' /etc/rc.config.d/netdaemons</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" success="fail">
                                <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*DDFA=1$' /etc/rc.config.d/netdaemons</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" success="fail">
                                <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*START_RBOOTD=1$' /etc/rc.config.d/netdaemons</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
                <xccdf:complex-check operator="OR">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="DFS is not present">
                                <ecl:command>ls /etc/rc.config.d/dfs</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                   <xccdf:complex-check operator="AND">
                       <xccdf:check system="http://cisecurity.org/check">
                           <xccdf:check-content>
                               <ecl:shell-command check="none exist" success="fail">
                                   <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*DCE_KRPC=1$' /etc/rc.config.d/dfs</ecl:command>
                               </ecl:shell-command>
                           </xccdf:check-content>
                       </xccdf:check>
                       <xccdf:check system="http://cisecurity.org/check">
                           <xccdf:check-content>
                               <ecl:shell-command check="none exist" success="fail">
                                   <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*DFS_CORE=1$' /etc/rc.config.d/dfs</ecl:command>
                               </ecl:shell-command>
                           </xccdf:check-content>
                       </xccdf:check>
                       <xccdf:check system="http://cisecurity.org/check">
                           <xccdf:check-content>
                               <ecl:shell-command check="none exist" success="fail">
                                   <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*DFS_CLIENT=1$' /etc/rc.config.d/dfs</ecl:command>
                               </ecl:shell-command>
                           </xccdf:check-content>
                       </xccdf:check>
                       <xccdf:check system="http://cisecurity.org/check">
                           <xccdf:check-content>
                               <ecl:shell-command check="none exist" success="fail">
                                   <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*DFS_SERVER=1$' /etc/rc.config.d/dfs</ecl:command>
                               </ecl:shell-command>
                           </xccdf:check-content>
                       </xccdf:check>
                       <xccdf:check system="http://cisecurity.org/check">
                           <xccdf:check-content>
                               <ecl:shell-command check="none exist" success="fail">
                                   <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*DFS_EPISODE=1$' /etc/rc.config.d/dfs</ecl:command>
                               </ecl:shell-command>
                           </xccdf:check-content>
                       </xccdf:check>
                       <xccdf:check system="http://cisecurity.org/check">
                           <xccdf:check-content>
                               <ecl:shell-command check="none exist" success="fail">
                                   <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*EPIINIT=1$' /etc/rc.config.d/dfs</ecl:command>
                               </ecl:shell-command>
                           </xccdf:check-content>
                       </xccdf:check>
                       <xccdf:check system="http://cisecurity.org/check">
                           <xccdf:check-content>
                               <ecl:shell-command check="none exist" success="fail">
                                   <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*DFSEXPORT=1$' /etc/rc.config.d/dfs</ecl:command>
                               </ecl:shell-command>
                           </xccdf:check-content>
                       </xccdf:check>
                       <xccdf:check system="http://cisecurity.org/check">
                           <xccdf:check-content>
                               <ecl:shell-command check="none exist" success="fail">
                                   <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*BOSSERVER=1$' /etc/rc.config.d/dfs</ecl:command>
                               </ecl:shell-command>
                           </xccdf:check-content>
                       </xccdf:check>
                       <xccdf:check system="http://cisecurity.org/check">
                           <xccdf:check-content>
                               <ecl:shell-command check="none exist" success="fail">
                                   <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*DFSBIND=1$' /etc/rc.config.d/dfs</ecl:command>
                               </ecl:shell-command>
                           </xccdf:check-content>
                       </xccdf:check>
                       <xccdf:check system="http://cisecurity.org/check">
                           <xccdf:check-content>
                               <ecl:shell-command check="none exist" success="fail">
                                   <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*FXD=1$' /etc/rc.config.d/dfs</ecl:command>
                               </ecl:shell-command>
                           </xccdf:check-content>
                       </xccdf:check>
                       <xccdf:check system="http://cisecurity.org/check">
                           <xccdf:check-content>
                               <ecl:shell-command check="none exist" success="fail">
                                   <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*MEMCACHE=1$' /etc/rc.config.d/dfs</ecl:command>
                               </ecl:shell-command>
                           </xccdf:check-content>
                       </xccdf:check>
                       <xccdf:check system="http://cisecurity.org/check">
                           <xccdf:check-content>
                               <ecl:shell-command check="none exist" success="fail">
                                   <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*DFSGWD=1$' /etc/rc.config.d/dfs</ecl:command>
                               </ecl:shell-command>
                           </xccdf:check-content>
                       </xccdf:check>
                       <xccdf:check system="http://cisecurity.org/check">
                           <xccdf:check-content>
                               <ecl:shell-command check="none exist" success="fail">
                                   <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*DISKCACHEFORDFS=1$' /etc/rc.config.d/dfs</ecl:command>
                               </ecl:shell-command>
                           </xccdf:check-content>
                       </xccdf:check>
                   </xccdf:complex-check>
                </xccdf:complex-check>
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" success="fail">
                                <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*RARPD=1$' /etc/rc.config.d/netconf</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" success="fail">
                                <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*RDPD=1$' /etc/rc.config.d/netconf</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" success="fail">
                            <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*PTYDAEMON_START=1$' /etc/rc.config.d/ptydaemon</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" success="fail">
                            <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*VTDAEMON_START=1$' /etc/rc.config.d/vt</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" success="fail">
                            <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*PEER_SNMPD_START=1$' /etc/rc.config.d/peer.snmpd</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" success="fail">
                            <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*START_I4LMD=1$' /etc/rc.config.d/i4lmd</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" success="fail">
                            <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*RUN_X_FONT_SERVER=1$' /etc/rc.config.d/xfs</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" success="fail">
                            <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*AUDIO_SERVER=1$' /etc/rc.config.d/audio</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" success="fail">
                            <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*SLSD_DAEMON=1$' /etc/rc.config.d/slsd</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="disable-CIFS-server" role="full" selected="false" weight="1.0">
            <xccdf:title>Only enable Windows-compatibility server processes if absolutely
                necessary</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xccdf:title>OS Revisions:</xccdf:title>
                    <xhtml:p>This item only applies to HP-UX 11i servers.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="question">Question</xhtml:p>
                    <xhtml:p>Does this machine provide authentication, file sharing, or printer
                        sharing services to systems running Microsoft Windows operating
                        systems?</xhtml:p>
                    <xhtml:p>If the answer to this question is yes, then perform the actions
                        below.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>ch_rc -a -p RUN_SAMBA=1 /etc/rc.config.d/samba</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>HP-UX 11i now includes the popular Open Source Samba server for
                        providing file and print services to Windows-based systems. This allows an
                        HP-UX system to act as a file or print server on a Windows network, and even
                        act as a Domain Controller (authentication server) to older Windows
                        operating systems. However, if this functionality is not required by the
                        site, this service should be disabled.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10210</xccdf:ident>
            <xccdf:complex-check operator="OR">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" success="fail">
                            <ecl:command>ls /etc/rc.config.d/samba</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" success="pass">
                            <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*RUN_SAMBA=0$' /etc/rc.config.d/samba</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="disable-CIFS-client" role="full" selected="false" weight="1.0">
            <xccdf:title>Only enable Windows-compatibility client processes if absolutely
                necessary</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xccdf:title>OS Revisions:</xccdf:title>
                    <xhtml:p>This item only applies to HP-UX 11i servers.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="question">Question</xhtml:p>
                    <xhtml:p>Is there a mission-critical reason why this system must access file
                        systems from remote servers via SMB?</xhtml:p>
                    <xhtml:p>If the answer to this question is yes, then perform the actions
                        below.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>ch_rc -a -p RUN_CIFSCLIENT=1 /etc/rc.config.d/cifsclient</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>
                        <xccdf:sub idref="bastille-item"/>In addition to the Samba server, HP-UX 11i
                        now includes the popular Open Source Samba client for receiving file and
                        print services from Windows-based systems. However, if this functionality is
                        not required by the site, this service should be disabled.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10220</xccdf:ident>
            <xccdf:complex-check operator="OR">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" success="fail">
                            <ecl:command>ls /etc/rc.config.d/cifsclient</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" success="pass">
                            <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*RUN_CIFSCLIENT=0$' /etc/rc.config.d/cifsclient</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="disable-NFS-server" role="full" selected="false" weight="1.0">
            <xccdf:title>Only enable NFS server processes, if absolutely necessary</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p class="question">Question</xhtml:p>
                    <xhtml:p>Is this machine an NFS file server?</xhtml:p>
                    <xhtml:p>If the answer to this question is yes, then perform the action
                        below.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>ch_rc -a -p NFS_SERVER=1 /etc/rc.config.d/nfsconf</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>NFS is frequently exploited to gain unauthorized access to files and
                        systems. Clearly there is no need to run the NFS server-related daemons on
                        hosts that are not NFS servers. If the system is an NFS server, the admin
                        should take reasonable precautions when exporting file systems, including
                        restricting NFS access to a specific range of local IP addresses and
                        exporting file systems "read-only" and "nosuid" where appropriate. For more
                        information consult the exportfs(1M) manual page. Much higher levels of
                        security can be achieved by combining NFS with secure RPC or Kerberos,
                        although there is significant administrative overhead involved in this
                        transition.</xhtml:p>
                    <xhtml:p>Note that since this service uses ONC RPC mechanisms, it is important
                        that the system's RPC portmapper (rpcbind) also be enabled when this service
                        is turned on. For more information see Item 3.12 below.</xhtml:p>
                    <xhtml:p>Also note that some releases of Oracle software for HP-UX require NFS
                        services in order to install properly. Therefore, the NFS server process may
                        need to be started by hand on systems on which Oracle software is to be
                        installed/updated. This can be accomplished by temporarily setting
                        NFS_SERVER=1, NUM_NFSD=1, and NUM_NFSIOD=1 in /etc/rc.config.d/nfsconf and
                        then executing/sbin/init.d/nfs.core start/sbin/init.d/nfs.server startNFS
                        services can be turned back off by executing/sbin/init.d/nfs.core
                        stop/sbin/init.d/nfs.server stopand then resetting NFS_SERVER=0, NUM_NFSD=0,
                        and NUM_NFSIOD=0 in /etc/rc.config.d/nfsconf.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10230</xccdf:ident>
            <xccdf:check system="http://cisecurity.org/check">
                <xccdf:check-content>
                    <ecl:shell-command check="all" success="pass">
                        <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*NFS_SERVER=0$' /etc/rc.config.d/nfsconf</ecl:command>
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>
        </xccdf:Rule>
        <xccdf:Rule id="disable-NFS-client" role="full" selected="false" weight="1.0">
            <xccdf:title>
                <xccdf:sub idref="bastille-item"/>Only enable NFS client processes, if absolutely
                necessary</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p class="question">Question</xhtml:p>
                    <xhtml:p>Is there a mission-critical reason why this system must access file
                        systems from remote servers via NFS?</xhtml:p>
                    <xhtml:p>If the answer to this question is yes, then perform the action
                        below.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>ch_rc -a -p NFS_CLIENT=1 /etc/rc.config.d/nfsconf</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>Again, unless there is a significant need for this system to acquire
                        data via NFS, administrators should disable NFS-related services. Note that
                        other file transfer schemes (such as rdist via SSH) can often be more secure
                        than NFS for certain applications, although again the use of secure RPC or
                        Kerberos can significantly improve NFS security. Also note that if the
                        machine will be an NFS client, then the rpcbind process must be running (see
                        Item 3.12 below).</xhtml:p>
                    <xhtml:p>Note that since this service uses ONC RPC mechanisms, it is important
                        that the system's RPC portmapper (rpcbind) also be enabled when this service
                        is turned on. For more information see Item 3.12 below.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10260</xccdf:ident>
            <xccdf:check system="http://cisecurity.org/check">
                <xccdf:check-content>
                    <ecl:shell-command check="all" success="pass">
                        <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*NFS_CLIENT=0$' /etc/rc.config.d/nfsconf</ecl:command>
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>
        </xccdf:Rule>
        <xccdf:Rule id="disable-RPC" role="full" selected="false" weight="1.0">
            <xccdf:title>Only enable RPC-based services, if absolutely necessary</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p class="question">Question</xhtml:p>
                    <xhtml:p>Are any of the following statements true?</xhtml:p>
                    <xhtml:ol>
                        <xhtml:li>
                            <xhtml:p>This machine is an NFS client or server</xhtml:p>
                        </xhtml:li>
                        <xhtml:li>
                            <xhtml:p>This machine is an NIS (YP) or NIS+ client or server</xhtml:p>
                        </xhtml:li>
                        <xhtml:li>
                            <xhtml:p>This machine runs a GUI or GUI-based administration tool</xhtml:p>
                        </xhtml:li>
                        <xhtml:li>
                            <xhtml:p>The machine runs a third-party software application which is dependent on RPC support (example: FlexLM License managers)</xhtml:p>
                        </xhtml:li>
                    </xhtml:ol>
                    <xhtml:p>If the answer to this question is yes, then perform the action below.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>mv -f /sbin/rc2.d/.NOS400nfs.core \ /sbin/rc2.d/400nfs.core</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>
                        <xccdf:sub idref="bastille-item"/>RPC-based services typically use very weak or non-existent authentication and yet may share very sensitive information. Unless one of the services listed above is required on this machine, it is best to disable RPC-based tools completely. If you are unsure whether or not a particular third-party application requires RPC services, consult with the application vendor. Note that disabling this service by renaming the startup file may not survive the install of RPC-related patches.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10070</xccdf:ident>
            <!-- on HPUX 11.2, the second check should always return 2 (fail) -->
            <!-- on HPUX 11.3, the first check should always return 1 (fail) -->
            <xccdf:complex-check operator="OR">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="NFS Enabled (HPUX 11.2 and earlier)">
                            <ecl:command>find /sbin/rc2.d/S400nfs.core -local -print</ecl:command>
                            <ecl:line-selection op="pm" value=".+"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <!-- file will not be found (2) or the correct config value will not be found (1) -->
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="NFS Enabled (HPUX 11.3)" success="pass">
                            <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*NFS_CORE=0$' /etc/rc.config.d/nfsconf</ecl:command>
                            <ecl:line-selection op="pm" value=".+"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="disable-web-server" role="full" selected="false" weight="1.0">
            <xccdf:title>Only enable Web server suite, if absolutely necessary</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p class="question">Question</xhtml:p>
                    <xhtml:p>Is there a mission-critical reason why this system must run a Web
                        server? </xhtml:p>
                    <xhtml:p>If the answer to this question is yes, then perform the actions
                        below.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>ch_rc -a -p NS_FTRACK=1 /etc/rc.config.d/ns-ftrackch_rc -a -p
                        APACHE_START=1 /etc/rc.config.d/apacheconf</xhtml:p>
                    <xhtml:p>ch_rc -a -p HPWS_APACHE32_START=1
                        /etc/rc.config.d/hpws_apache32conf</xhtml:p>
                    <xhtml:p>ch_rc -a -p HPWS_TOMCAT_START=1
                        /etc/rc.config.d/hpws_tomcatconf</xhtml:p>
                    <xhtml:p>ch_rc -a -p NS_FTRACK=1 /etc/rc.config.d/ns-ftrack</xhtml:p>
                    <xhtml:p>ch_rc -a -p HPWS_WEBMIN_START=1
                        /etc/rc.config.d/hpws_webminconf</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>Even if this machine is a Web server, the local site may choose not to
                        use the Web server provided with HP-UX in favor of a locally developed and
                        supported Web environment. If the machine is a Web server, the administrator
                        is encouraged to search the Web for additional documentation on Web server
                        security. A good starting point is <xhtml:a href="http://httpd.apache.org/docs-2.0/misc/security_tips.html">http://httpd.apache.org/docs-2.0/misc/security_tips.html</xhtml:a>.</xhtml:p>
                    <xhtml:p>Note that this action only disables the default web server shipped with
                        the system. Other webservers instances may still be running..</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10430</xccdf:ident>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" success="fail">
                            <ecl:command>egrep '^APACHE_START=1$' /etc/rc.config.d/apacheconf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" success="fail">
                            <ecl:command>egrep '^HPWS_APACHE32_START=1$' /etc/rc.config.d/hpws_apache*2conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" success="fail">
                            <ecl:command>egrep '^NS_FTRACK=1$' /etc/rc.config.d/ns-ftrack</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" success="fail">
                            <ecl:command>egrep '^HPWS_WEBMIN_START=1$' /etc/rc.config.d/hpws_webminconf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="disable-DNS-server" role="full" selected="false" weight="1.0">
            <xccdf:title>Only enable BIND DNS server, if absolutely necessary</xccdf:title>
            <xccdf:description>
                <xhtml:p>Disabled by default in HP-UX 11i</xhtml:p>
                <xhtml:div>
                    <xhtml:p class="question">Question</xhtml:p>
                    <xhtml:p>Is there a mission-critical reason why this system must run a DNS
                        server? </xhtml:p>
                    <xhtml:p>If the answer to this question is yes, then perform the actions
                        below.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>ch_rc -a -p NAMED=1 /etc/rc.config.d/namesvrs</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>The BIND DNS server, or named, maps IP addresses to hostnames across
                        the Internet and supplies these services to other hosts on the local local
                        network. Though it has been widely implemented, BIND has a long history of
                        security flaws, especially in the BIND 8.x release tree generally shipped
                        with HP-UX 11.x systems. Therefore, if you are going to run BIND, you should
                        strongly consider moving to the BIND 9.x release-tree. HP has supported BIND
                        9 packages available from <xhtml:a href="http://software.hp.com/portal/swdepot/displayProductInfo.do?productNumber=BIND9.2">http://software.hp.com/portal/swdepot/displayProductInfo.do?productNumber=BIND9.2</xhtml:a>.
                        Or it is available directly from the Internet Software Consortium (the
                        developers of BIND), whose website is at <xhtml:a href="http://www.isc.org/">http://www.isc.org</xhtml:a>.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10370</xccdf:ident>
            <xccdf:complex-check operator="OR">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" success="fail">
                                <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*NAMED=1$' /etc/rc.config.d/namesvrs</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" success="fail">
                                <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*NAMED=1$' /etc/rc.config.d/namesvrs_dns</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="Group-4">
        <xccdf:title>Kernel Tuning</xccdf:title>
        <xccdf:description>This group has recommendations that modify the Kernel settings.</xccdf:description>
        <xccdf:Rule id="enable-stack-protection" role="full" selected="false" weight="1.0">
            <xccdf:title>
                <xccdf:sub idref="bastille-item"/>Enable stack protection</xccdf:title>
            <xccdf:description>
                <xhtml:div><xhtml:p> Action (HP-UX 11iv2 and later):</xhtml:p>(HP-UX
                    11iv2 and later)<xhtml:p>kctune -K executable_stack=0</xhtml:p></xhtml:div>
                <xhtml:div><xhtml:p> Action (older HP-UX 11i
                    releases):</xhtml:p>(older HP-UX 11i releases)<xhtml:p>/usr/sbin/kmtune -s
                        executable_stack=0 &amp;&amp;mk_kernel
                    &amp;&amp;kmupdate</xhtml:p></xhtml:div>
                <xhtml:div><xhtml:p> Action (older HP-UX releases):</xhtml:p>(older
                    HP-UX releases)<xhtml:p>Strongly consider upgrading to HP-UX
                    11i.</xhtml:p></xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>Buffer overflow exploits have been the basis for many of the recent
                        highly publicized compromises and defacements of large numbers of Internet
                        connected systems. Many of the automated tools in use by system crackers
                        exploit well-known buffer overflow problems in vendor-supplied and
                        third-party software. Enabling stack protection prevents certain classes of
                        buffer overflow attacks and is a significant security enhancement. Note that
                        HP-UX 11i is much more capable in this and other security areas than older
                        releases; therefore, administrators should strongly consider upgrading from
                        older releases.</xhtml:p>
                    <xhtml:p>
                        <xccdf:sub idref="bastille-item"/>Note that this action requires a
                        subsequent reboot to take effect in some versions of HP-UX.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10670</xccdf:ident>
            <xccdf:complex-check operator="OR">
            <xccdf:check system="http://cisecurity.org/check">                
                <xccdf:check-content>
                    <ecl:shell-command check="all" success="pass">
                        <ecl:command>kctune -q executable_stack | egrep "executable_stack[[:space:]]+0"</ecl:command>                        
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>
            <xccdf:check system="http://cisecurity.org/check">                
                <xccdf:check-content>
                    <ecl:shell-command check="all" success="pass">
                        <ecl:command>kmtune -q executable_stack | egrep "executable_stack[[:space:]]+0"</ecl:command>                        
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="network-parameter-modifications" role="full" selected="false" weight="1.0">
            <xccdf:title>Network parameter modifications</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action (for HP-UX 11.x systems):</xhtml:p>
                    <xhtml:p>cd /etc/rc.config.dcat &lt;&lt;EOF &gt; nddconf# Increase size of
                        half-open connection
                        queueTRANSPORT_NAME[0]=tcpNDD_NAME[0]=tcp_syn_rcvd_maxNDD_VALUE[0]=4096#
                        Reduce timeouts on ARP
                        cacheTRANSPORT_NAME[1]=arpNDD_NAME[1]=arp_cleanup_intervalNDD_VALUE[1]=60000#
                        Drop source-routed
                        packetsTRANSPORT_NAME[2]=ipNDD_NAME[2]=ip_forward_src_routedNDD_VALUE[2]=0#
                        Don't forward directed
                        broadcastsTRANSPORT_NAME[3]=ipNDD_NAME[3]=ip_forward_directed_broadcastsNDD_VALUE[3]=0#
                        Don't respond to unicast ICMP timestamp
                        requestsTRANSPORT_NAME[4]=ipNDD_NAME[4]=ip_respond_to_timestampNDD_VALUE[4]=0#
                        Don't respond to broadcast ICMP tstamp
                        reqsTRANSPORT_NAME[5]=ipNDD_NAME[5]=ip_respond_to_timestamp_broadcastNDD_VALUE[5]=0#
                        Don't respond to ICMP address mask
                        requestsTRANSPORT_NAME[6]=ipNDD_NAME[6]=ip_respond_to_address_mask_broadcastNDD_VALUE[6]=0#
                        Don’t respond to broadcast echo
                        requestsTRANSPORT_NAME[7]=ipNDD_NAME[7]=ip_respond_to_echo_broadcastNDD_VALUE[7]=0EOFchown
                        root:sys nddconfchmod go-w,ug-s nddconf</xhtml:p>
                </xhtml:div>
                <xhtml:div><xhtml:p> Action (for older HP-UX releases):</xhtml:p>(for
                    older HP-UX releases)<xhtml:p>Strongly consider upgrading to HP-UX
                        11i.</xhtml:p></xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>In HP-UX 11.x, we are modifying the configuration file that sets
                        network parameters at boot time. This is not supported in HP-UX 10.20, and
                        administrators should strongly consider upgrading to HP-UX 11i to take
                        advantage of this and other security features.</xhtml:p>
                    <xhtml:p>Note that HP-UX 11.11 systems require patch PHNE_25644 for ndd to set
                        arp_cleanup_interval from /etc/rc.config.d/nddconf, as required in the above
                        Action.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p>Bastille Notes:</xhtml:p>
                    <xhtml:p>Bastille performs a similar action but does not support the particular
                        changes in the above Action.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10700</xccdf:ident>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" success="pass">
                            <ecl:command>ndd -get /dev/tcp tcp_syn_rcvd_max|egrep
                                '^4096$'</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" success="pass">
                            <ecl:command>ndd -get /dev/arp arp_cleanup_interval|egrep
                                '^60000$'</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" success="pass">
                            <ecl:command>ndd -get /dev/ip ip_forward_src_routed|egrep
                                '^0$'</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" success="pass">
                            <ecl:command>ndd -get /dev/ip ip_forward_directed_broadcasts|egrep
                                '^0$'</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" success="pass">
                            <ecl:command>ndd -get /dev/ip ip_respond_to_timestamp|egrep
                                '^0$'</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" success="pass">
                            <ecl:command>ndd -get /dev/ip ip_respond_to_timestamp_broadcast|egrep
                                '^0$'</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" success="pass">
                            <ecl:command>ndd -get /dev/ip ip_respond_to_address_mask_broadcast|egrep
                                '^0$'</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" success="pass">
                            <ecl:command>ndd -get /dev/ip ip_respond_to_echo_broadcast|egrep
                                '^0$'</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="TCP-sequence-numbers" role="full" selected="false" weight="1.0">
            <xccdf:title>Use better TCP sequence numbers</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xccdf:title>OS Revisions:</xccdf:title>
                    <xhtml:p>This item applies to HP-UX 10.20 systems only. HP-UX 11.x releases use
                        high quality TCP sequence numbers by default and require no
                        action.</xhtml:p>
                </xhtml:div>
                <xhtml:div><xhtml:p> Action (HP-UX 10.x only):</xhtml:p>(HP-UX 10.x
                        only)<xhtml:p>echo "/usr/contrib/bin/nettune -s tcp_random_seq 2" &gt;&gt; \
                        /sbin/rc2.d/S339nettunechown root:sys /sbin/rc2.d/S339nettunechmod 555
                        /sbin/rc2.d/S339nettune</xhtml:p></xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>Setting this parameter causes the system to use a better randomization
                        algorithm for generating initial TCP sequence numbers. This makes remote
                        session hijacking attacks more difficult, as well as any other network-based
                        attack that relies on predicting TCP sequence number information. Note that
                        HP-UX 11i is much more capable in this and other security areas than older
                        releases; therefore, administrators should strongly consider upgrading from
                        older releases.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10690</xccdf:ident>
            <xccdf:check system="http://cisecurity.org/check">
                <xccdf:check-content>
                    <ecl:shell-command check="all" success="pass">
                        <ecl:command>ndd -get /dev/tcp tcp_isn_passphrase</ecl:command>
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>
        </xccdf:Rule>
        <xccdf:Rule id="network-parameter-modifications-2" role="full" selected="false" weight="1.0">
            <xccdf:title>
                <xccdf:sub idref="bastille-item"/>Additional network parameter modifications </xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p class="question">Question</xhtml:p>
                    <xhtml:p>Is this system going to be used as a firewall or gateway to pass
                        network traffic between different networks?</xhtml:p>
                    <xhtml:p>If the answer to this question is yes, then do not perform the actions
                        below.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p> Action (for HP-UX 11.x systems):</xhtml:p>
                    <xhtml:p>cat &lt;&lt;EOF &gt;&gt; /etc/rc.config.d/nddconf# Don’t act as a
                        routerTRANSPORT_NAME[8]=ipNDD_NAME[8]=ip_forwardingNDD_VALUE[8]=0TRANSPORT_NAME[9]=ipNDD_NAME[9]=ip_send_redirectsNDD_VALUE[9]=0EOF</xhtml:p>
                </xhtml:div>
                <xhtml:div><xhtml:p> Action (for older HP-UX releases):</xhtml:p>(for
                    older HP-UX releases)<xhtml:p>cat &lt;&lt; EOF &gt;
                        /sbin/rc2.d/S339nettune#!/sbin/sh -/usr/contrib/bin/nettune -s ip_forwarding
                        0EOF</xhtml:p></xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>The actions above will result in a machine that cannot forward TCP/IP
                        packets between multiple networks, even if the machine has multiple network
                        adapters connected to multiple networks.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10710</xccdf:ident>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" success="pass">
                            <ecl:command>ndd -get /dev/ip ip_forwarding|egrep '^0$'</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" success="pass">
                            <ecl:command>ndd -get /dev/ip ip_send_redirects|egrep
                                '^0$'</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="Group-5">
        <xccdf:title>Logging</xccdf:title>
        <xccdf:description>
            <xhtml:p>The items in this section cover enabling various different forms of system
                logging in order to keep track of activity on the system. Tools such as Swatch
                    (<xhtml:a href="http://www.oit.ucsb.edu/~eta/swatch/">http://www.oit.ucsb.edu/~eta/swatch</xhtml:a>), Logcheck (<xhtml:a href="http://sourceforge.net/projects/sentrytools/">http://sourceforge.net/projects/sentrytools</xhtml:a>), and HP's IDS/9000 for
                HP-UX 11 (<xhtml:a href="http://www.software.hp.com/ISS_products_list.html">http://www.software.hp.com/ISS_products_list.html</xhtml:a>) can be used to
                automatically monitor logs for intrusion attempts and other suspicious system
                behavior. Note that Swatch and Logcheck are not officially supported by
                HP.</xhtml:p>
            <xhtml:p>In addition to the local log files created by the steps in this section, it is
                also recommended that sites collect copies of their system logs on a secure,
                centralized log server. Not only does centralized logging help sites correlate
                events that may be occurring on multiple systems, but having a second copy of the
                system log information may be critical after a system compromise where the attacker
                has modified the local log files on the affected system(s).</xhtml:p>
            <xhtml:p>Log centralization is typically done in HP-UX environments using the standard
                Unix Syslog capability, though HP also supports the more secure and robust
                Systlog-NG as part of the HP Distributed Systems Administration Utilities (DSAU),
                shipped with later updates of HP-UX 11i v2.</xhtml:p>
            <xhtml:p>Because it is often necessary to correlate log information from many different
                systems (particularly after a security incident) experts recommend establishing some
                form of time synchronization among systems and devices connected to the local
                network. The standard Internet protocol for time synchronization is the Network Time
                Protocol (NTP), which is supported by most network-ready devices. More information
                on NTP can be found at <xhtml:a href="http://www.ntp.org/">http://www.ntp.org</xhtml:a>.</xhtml:p>
        </xccdf:description>
        <xccdf:Rule id="enable-system-accounting" role="full" selected="false" weight="1.0">
            <xccdf:title>Enable system accounting</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>cat &lt;&lt;END_SCRIPT
                        &gt;/sbin/init.d/newperf#!/sbin/shPATH=/usr/sbin:/usr/bin:/sbincase "$1" in
                        'start_msg') echo "Starting System Accounting"" ;; 'start') /usr/bin/su sys
                        -c \ "/usr/lbin/sa/sadc /var/adm/sa/sa\`date +%d\`" ;; *) echo "usage: $0
                        {start|start_msg}" exit 1 ;;esacexit 0END_SCRIPTchown root:sys
                        /sbin/init.d/newperfchmod 744 /sbin/init.d/newperfrm -f
                        /sbin/rc2.d/S21perfln -s /sbin/init.d/newperf /sbin/rc2.d/S21perfmkdir –p
                        /var/adm/sachown sys:sys /var/adm/sachmod 700 /var/adm/sa/usr/bin/su sys -c
                        crontab &lt;&lt;END_ENTRIES0,20,40 * * * * /usr/lbin/sa/sa145 23 * * *
                        /usr/lbin/sa/sa2 -s 0:00 -e 23:59 -i 1200 –AEND_ENTRIES</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>
                        <xccdf:sub idref="bastille-item"/>System accounting gathers baseline system
                        data (CPU utilization, disk I/O, etc.) every 20 minutes and archives this
                        data for one week (administrators may wish to archive the /var/adm/sa
                        directory on a regular basis to preserve this data for longer periods). The
                        data may be accessed with the sar command.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10820</xccdf:ident>
            <xccdf:complex-check operator="OR">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command comment="Check for fresh 'sa' logfiles" success="pass">
                            <ecl:command> find /var/adm/sa/ -local -type f -ctime 0</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command success="pass">
                                <ecl:command>cat /sbin/rc2.d/S21perf</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command success="pass">
                                <ecl:command>cat /var/spool/cron/crontabs/sys</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="enable-kernel-level-auditing" role="unscored" selected="false" weight="0.0">
            <xccdf:title>Enable kernel-level auditing</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p class="question">Question</xhtml:p>
                    <xhtml:p>Is this system running in HP-UX Trusted Mode (see item 7.1), or does it
                        have Standard-Mode security extensions enabled?</xhtml:p>
                    <xhtml:p>If yes, then perform the actions below.</xhtml:p>
                </xhtml:div>
                <xhtml:div><xhtml:p> Action (HP-UX 10.20):</xhtml:p>HP-UX
                        10.20<xhtml:p>Use SAM to turn on kernel level auditing (Auditing And
                        Security … Audited Events … Actions … Turn Auditing
                    On).</xhtml:p></xhtml:div>
                <xhtml:div><xhtml:p> Action (HP-UX 11.x):</xhtml:p>HP-UX
                        11.x<xhtml:p>Use Bastille to turn on kernel level auditing
                    </xhtml:p></xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>Kernel-level auditing provides information on commands and system calls
                        that are executed on the local system. The audit trail may be reviewed with
                        the audisp command.</xhtml:p>
                    <xhtml:p>Kernel-level auditing can consume large amounts of disk space and even
                        cause a system performance impact, particularly on heavily used machines.
                        Sites may wish to consider logging less information to help reduce the
                        amount of disk space and other system resources consumed by the auditing
                        process. See the audevent(1M) manual page for more information.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10830</xccdf:ident>
        </xccdf:Rule>
        <xccdf:Rule id="enable-inetd-logging" role="full" selected="false" weight="1.0">
            <xccdf:title>
                <xccdf:sub idref="bastille-item"/>Enable logging from inetd</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>ch_rc -a -p INETD_ARGS=-l /etc/rc.config.d/netdaemons</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>If inetd is running, it is a good idea to make use of the "logging"
                        (-l) feature of the HP-UX inetd that logs information about the source of
                        any network connections seen by the daemon, allowing the administrator (or
                        software) to scan the logs for unusual activity. This is especially powerful
                        when combined with the access control capabilities accessible through
                        inetd’s /var/adm/inetd.sec configuration file.</xhtml:p>
                    <xhtml:p>This information is logged via Syslog and by default HP-UX systems
                        deposit this logging information in var/adm/syslog/syslog.log with other
                        system log messages. Should the administrator wish to capture this
                        information in a separate file, simply modify /etc/syslog.conf to log
                        daemon.notice to some other log file destination.</xhtml:p>
                    <xhtml:p>IPFilter, which comes with HP-UX, can log inetd and other connections
                        or attempted connections with its “ipmon” daemon as either a compliment or
                        alternative to inetd logging.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10750</xccdf:ident>
            <xccdf:check system="http://cisecurity.org/check">
                <xccdf:check-content>
                    <ecl:shell-command check="all" success="pass">
                        <ecl:command>egrep '^INETD_ARGS=-l$'
                            /etc/rc.config.d/netdaemons</ecl:command>
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>
        </xccdf:Rule>
        <xccdf:Rule id="enable-ftpd-logging" role="full" selected="false" weight="1.0">
            <xccdf:title>Turn on additional logging for FTP daemon</xccdf:title>
            <xccdf:description>
                <xhtml:div><xhtml:p> Action (HP-UX 11.x):</xhtml:p>(HP-UX
                        11.x)<xhtml:p>cd /etcawk '/^ftpd/ &amp;&amp; !/-L/ { $NF = $NF " -L" }
                        /^ftpd/ &amp;&amp; !/-l/ { $NF = $NF " -l" } { print }' inetd.conf &gt;
                        inetd.conf.tmpcp inetd.conf.tmp inetd.confrm –f
                    inetd.conf.tmp</xhtml:p></xhtml:div>
                <xhtml:div><xhtml:p> Action (HP-UX 10.x):</xhtml:p>(HP-UX
                        10.x)<xhtml:p>cd /etcawk '/^ftpd/ &amp;&amp; !/-l/ { $NF = $NF " -l" } {
                        print }' inetd.conf &gt; inetd.conf.tmpcp inetd.conf.tmp inetd.confrm –f
                        inetd.conf.tmp</xhtml:p></xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>If the FTP daemon is left on, it is recommended that the command
                        logging (-L) and connection logging (-l) flags also be enabled to track FTP
                        activity on the system, allowing the administrator (or software) to scan the
                        logs for unusual activity. This is especially powerful when combined with
                        the access control capabilities accessible through inetd’s
                        /var/adm/inetd.sec configuration file.</xhtml:p>
                    <xhtml:p>Note that this setting has no effect if the FTP daemon remains
                        de-activated from item 2.1.</xhtml:p>
                    <xhtml:p>Also note that enabling command logging on the FTP daemon (HP-UX 11.x
                        only) can cause user passwords to appear in clear-text form in the system
                        logs, if the user accidentally types their password at the username
                        prompt.</xhtml:p>
                    <xhtml:p>Information about FTP sessions will be logged to Syslog and by default
                        HP-UX systems deposit this logging information in /var/adm/syslog/syslog.log
                        with other system log messages. Should the administrator wish to capture
                        this information in a separate file, simply modify /etc/syslog.conf to log
                        daemon.notice to some other log file destination.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10760</xccdf:ident>
            <xccdf:complex-check operator="OR">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="FTP server is not enabled" success="fail">
                            <ecl:command>egrep '^ftpd?' /etc/inetd.conf'</ecl:command>
                         </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="FTP server has additionally logging enabled" success="pass">
                            <ecl:command>egrep '^ftpd?' /etc/inetd.conf | egrep 'ftpd[[:space:]]-.*l.*L.*$'</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="system-log-file-permissions" role="full" selected="false" weight="1.0">
            <xccdf:title>Confirm permissions on system log files</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>awk &lt; /etc/syslog.conf ' $0 !~ /^#/ &amp;&amp; $2 ~ "^/" { print $2
                        }' | sort -u | while read filedo if [ -d "$file" -o -c "$file" -o \ -b
                        "$file" -o -p "$file" ] then : elif [ ! -f "$file" ] then mkdir -p
                        "$(dirname "$file")" touch "$file" chmod 640 "$file" else chmod o-w "$file"
                        fidonehostname=`uname -n`chmod o-w \ /tmp/snmpd.log \
                        /var/X11/Xserver/logs/X0.log \ /var/X11/Xserver/logs/X1.log \
                        /var/X11/Xserver/logs/X2.log \ /var/adm/automount.log \ /var/adm/snmpd.log \
                        /var/opt/dce/svc/error.log \ /var/opt/dce/svc/fatal.log \
                        /var/opt/dce/svc/warning.log \ /var/opt/dde/dde_error_log \
                        /var/opt/hppak/hppak_error_log \ /var/opt/ignite/logs/makrec.log1 \
                        /var/opt/ignite/recovery/fstab \ /var/opt/ignite/recovery/group.makrec \
                        /var/opt/ignite/recovery/passwd.makrec \ /var/opt/resmon/log \
                        /var/opt/scr/log/scrlog.log \ /var/opt/scr/log/scrlog.old \
                        /var/sam/hpbottom.dion \ /var/sam/hpbottom.iout \ /var/sam/hpbottom.iout.old
                        \ "/var/sam/$hostname.dion" \ "/var/sam/$hostname.iout" \
                        "/var/sam/$hostname.iout.old" \ /var/sam/lock \ /var/sam/log/samlog \
                        /var/sam/log/sam_tm_work \ /var/adm/sw \ /var/adm/sw/save \
                        /var/adm/sw/patch</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>It is critical to protect system log files from being modified by
                        unauthorized individuals. Also, certain logs contain sensitive data that
                        should only be available to the system administrator.</xhtml:p>
                    <xhtml:p>The first half of the Action above ensures that files created by the
                        HP-UX syslog system are so protected by reading /etc/syslog.conf to
                        determine what files syslog will log to, making sure those files exist, and
                        making sure they have proper permissions. The second half (starting with
                        “hostname=”) applies to other system log files. The files referenced above
                        are known to be created as world-writable under some circumstances in
                        HP-UX.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10840</xccdf:ident>
            <xccdf:check system="http://cisecurity.org/check">
                <xccdf:check-content>
                    <ecl:shell-command check="none exist">
                        <ecl:command>for f in /tmp/snmpd.log /var/X11/Xserver/logs/X0.log
                            /var/X11/Xserver/logs/X1.log /var/X11/Xserver/logs/X2.log
                            /var/adm/automount.log /var/adm/snmpd.log /var/opt/dce/svc/error.log
                            /var/opt/dce/svc/fatal.log /var/opt/dce/svc/warning.log
                            /var/opt/dde/dde_error_log /var/opt/hppak/hppak_error_log
                            /var/opt/ignite/logs/makrec.log1 /var/opt/ignite/recovery/fstab
                            /var/opt/ignite/recovery/group.makrec
                            /var/opt/ignite/recovery/passwd.makrec /var/opt/resmon/log
                            /var/opt/scr/log/scrlog.log /var/opt/scr/log/scrlog.old
                            /var/sam/hpbottom.dion /var/sam/hpbottom.iout /var/sam/hpbottom.iout.old
                            "/var/sam/$hostname.dion" "/var/sam/$hostname.iout"
                            "/var/sam/$hostname.iout.old" /var/sam/lock /var/sam/log/samlog
                            /var/sam/log/sam_tm_work /var/adm/sw /var/adm/sw/save /var/adm/sw/patch;
                            do find $f -local -perm -o=w -exec ls -l {} \; ; done</ecl:command>
                        <ecl:line-selection op="pm" value=".+"/>
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>
        </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="Group-6">
        <xccdf:title>File/Directory Permissions/Access</xccdf:title>
        <xccdf:description>This group has recommendations on file permissions.</xccdf:description>
        <xccdf:Rule id="world-writeable-directories-sticky" role="full" selected="false" weight="1.0">
            <xccdf:title>
                <xccdf:sub idref="bastille-item"/>Set Sticky Bit on World Writable Directories</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>Administrators who wish to obtain a list of world writable directories
                        that do not have the sticky bit set may execute the following
                        commands</xhtml:p>
                    <xhtml:p>find / \( -fstype nfs -o -fstype cdfs -o \</xhtml:p>
                    <xhtml:p>-fstype hfs \) -prune -o -type d -a \( -perm -0002 \</xhtml:p>
                    <xhtml:p>-a ! -perm -1000 \) –print</xhtml:p>
                    <xhtml:p>Notes:</xhtml:p>
                    <xhtml:p>When the so-called "sticky bit" is set on a directory, then only the
                        owner of a file may remove that file from the directory (as opposed to the
                        usual behavior where anybody with write access to that directory may remove
                        the file). Setting the sticky bit prevents users from overwriting each
                        other's files, whether accidentally or maliciously, and is generally
                        appropriate for most world-writable directories. However, consult
                        appropriate vendor documentation before blindly applying the sticky bit to
                        any world writable directories found in order to avoid breaking any
                        application dependencies on a given directory.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10980</xccdf:ident>
            <xccdf:check system="http://cisecurity.org/check">
                <!--World-Writable Directories Should Have Their Sticky Bit Set-->
                <xccdf:check-content>
                    <ecl:shell-command check="none exist">
                        <ecl:command>find / \( -fstype nfs -o -fstype cdfs -o -fstype hfs \)
                            -prune -o -type d -a \( -perm -0002 -a ! -perm -1000 \)
                            –print</ecl:command>
                        <ecl:line-selection op="pm" value=".+"/>
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>
        </xccdf:Rule>
        <xccdf:Rule id="world-writeable-files_AND_suid-sgid-executables" role="full" selected="false" weight="1.0">
            <xccdf:title>Find world-writable files and unauthorized SUID/SGID executables</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p>Action:</xhtml:p>
                    <xhtml:p>The automated testing tool supplied with this benchmark will flag
                        unexpected world-writable files and SUID/SGID files on the system.</xhtml:p>
                    <xhtml:p>Administrators who wish to obtain a list of the world-writable files
                        currently on the system may run the following command, delivered with the
                        benchmark. Note that this script uses the Installed-Product Database, which
                        is not protected against a malicious root user. Any operating system that
                        has been compromised can be manipulated to mask changes from the local
                        user.:</xhtml:p>
                    <xhtml:p>checkperms</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>Data in world-writable files can be modified and compromised by any
                        user on the system. World writable files may also indicate an incorrectly
                        written script or program that could potentially be the cause of a larger
                        compromise to the system's integrity. Generally removing write access for
                        the "other" category (chmod o-w &lt;filename&gt;) is advisable, but always
                        consult relevant vendor documentation in order to avoid breaking any
                        application dependencies on a given file.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10990</xccdf:ident>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11010</xccdf:ident>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <!--Unauthorized World-Writable Files-->
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist">
                            <ecl:command>for part in `mount | grep dev | awk '{print $1}' | grep -Ev
                                'cdrom|nfs'`; do find $part -xdev -type f \( -perm -0002 -a ! -perm
                                -1000 \) -exec ls -l {} \; ; done</ecl:command>
                            <ecl:line-selection op="pm" value=".+"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <!--Unauthorized SUID/SGID System Executables-->
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist">
                            <ecl:command>for part in `mount | grep dev | awk '{print $1}' | grep -Ev
                                'cdrom|nfs'`; do find $part \( -perm -04000 -a ! -perm -02000 \)
                                -xdev -type f -exec ls -l {} \; ; done</ecl:command>
                            <ecl:line-selection op="pm" value=".+"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="unowned-nodes" role="full" selected="false" weight="1.0">
            <xccdf:title>Find “unowned” files and directories</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>The automated testing tool supplied with this benchmark will flag files
                        and directories where the user or group owner of the file is not listed in
                        the system password or group databases such as /etc/passwd and
                        /etc/group.</xhtml:p>
                    <xhtml:p>Administrators who wish to locate these files on their may run the
                        following command:</xhtml:p>
                    <xhtml:p>find / -local \( -nouser –o -nogroup \) –print</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>Sometimes when administrators delete users from the system they neglect
                        to remove all files owned by those users from the system. A new user who is
                        assigned the deleted user's user ID or group ID may then end up "owning"
                        these files, and thus have more access on the system than was intended. It
                        is a good idea to locate files that are owned by users or groups not listed
                        in the system configuration files, and make sure to reset the ownership of
                        these files to some active user on the system as appropriate.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11020</xccdf:ident>
            <xccdf:check system="http://cisecurity.org/check">
                <!--Unowned Files-->
                <xccdf:check-content>
                    <ecl:shell-command check="none exist">
                        <ecl:command>find / \( -nouser -o -nogroup \) -exec ls -l {}
                            \;</ecl:command>
                        <ecl:line-selection op="pm" value=".+"/>
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>
        </xccdf:Rule>
        <xccdf:Rule id="patch-backup-permissions" role="full" selected="false" weight="1.0">
            <xccdf:title>Ensure patch backup directories are not accessible</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>chmod go-rwx /var/adm/sw/save</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>HP-UX systems save backup copies of system files into /var/adm/sw/save
                        when patches are installed. It is important that these old versions of the
                        system files not be accessible as they may have been replaced due to
                        security bugs.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11050</xccdf:ident>
            <xccdf:check system="http://cisecurity.org/check">
                <xccdf:check-content>
                    <ecl:shell-command check="none exist" comment="Check for group/other permissions being greater than 0">
                        <!-- "-perm -MODE" looks for permissions CONTAINING those bits. thus, 0011 matches 755, 555, 711
                             but not 700 or 500. -name flag added to try and prevent displaying contents of directory. -->
                        <ecl:command>find /var/adm/sw/save -local -name save -perm -0011</ecl:command>
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>
        </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="Group-7">
        <xccdf:title><xccdf:sub idref="bastille-item"/>System Access, Authentication, and Authorization</xccdf:title>
        <xccdf:description>This group specifies recommendations for system access, authentication and authorization.</xccdf:description>
        <xccdf:Rule id="Rule-7.1" role="unscored" selected="false" weight="0.0">
            <xccdf:title>Enable Password Hiding</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p class="question">Question</xhtml:p>
                    <xhtml:p>Does this system run applications that read the encrypted password
                        entries in /etc/passwd directly?</xhtml:p>
                    <xhtml:p>If the answer to this question is yes, then do not perform the actions
                        below.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>Use Bastille to convert to Shadowed Mode or Trusted Mode as
                        appropriate, by selecting the “password hiding” option in Bastille, or via
                        SAM/SMH.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>Without hidden passwords, an intruder could use any user’s account to
                        obtain hashed passwords and use crack or similar utilities to find easily
                        guessed passwords. Password aging (covered in item 8.3) ensures that users
                        change their passwords on a regular basis and helps stop the use of stolen
                        passwords.</xhtml:p>
                    <xhtml:p>Note that Trusted-Mode conversion on HP-UX 11iv1requires the HP-UX
                        Shadow Password package available from <xhtml:a href="http://www.software.hp.com/cgi-bin/swdepot_parser.cgi/cgi/displayProductInfo.pl?productNumber=ShadowPassword">http://www.software.hp.com/cgi-bin/swdepot_parser.cgi/cgi/displayProductInfo.pl?productNumber=ShadowPassword</xhtml:a>.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
        </xccdf:Rule>
        <xccdf:Rule id="create-ftpusers" role="full" selected="false" weight="1.0">
            <xccdf:title>
                <xccdf:sub idref="bastille-item"/>Create /etc[/ftpd]/ftpusers</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>if [[ "$(uname -r)" = B.10* ]];
                        thenftpusers=/etc/ftpuserselseftpusers=/etc/ftpd/ftpusersfifor name in root
                        daemon bin sys adm lp \uucp nuucp nobody hpdb useradmdoecho $namedone
                        &gt;&gt; $ftpuserssort –u $ftpusers &gt; $ftpusers.tmpcp $ftpusers.tmp
                        $ftpusersrm –f $ftpusers.tmpchown bin:bin $ftpuserschmod 600
                        $ftpusers</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>ftpusers contains a list of users who are not allowed to access the
                        system via FTP. Generally, only normal users should ever access the system
                        via FTP—there should be no reason for “system” type accounts to be
                        transferring information via this mechanism. Certainly, the root account
                        should never be allowed to transfer files directly via FTP.</xhtml:p>
                    <xhtml:p>Also note that more fine-grained FTP access controls can be placed in
                        /etc/ftpd/ftpaccess under HP-UX 11.x.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11180</xccdf:ident>
            <xccdf:complex-check operator="OR">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" success="fail">
                            <ecl:command>egrep '^ftpd?' /etc/inetd.conf'</ecl:command>
                         </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist">
                                <ecl:command>for u in root daemon bin sys adm lp uucp nuucp nobody hpdb
                                    useradm; do egrep -q "^$u" /etc/ftpd/ftpusers || echo $u "not
                                    present"; done</ecl:command>
                                <ecl:line-selection op="pm" value=".+"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" success="pass">
                                <ecl:command>find /etc/ftpd/ftpusers -local -follow -prune ! \( -user bin -group bin -perm 0600 \) -exec ls -l {} \;</ecl:command>
                                <ecl:line-selection op="pm" value=".+"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="disable-syslog-remote" role="full" selected="false" weight="1.0">
            <xccdf:title>
                <xccdf:sub idref="bastille-item"/>Prevent Syslog from accepting messages from the
                network</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xccdf:title>OS Revisions:</xccdf:title>
                    <xhtml:p>This item only applies to HP-UX 11i servers.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="question">Question</xhtml:p>
                    <xhtml:p>Is this machine a log server, or does it need to receive Syslog
                        messages via the network from other systems?</xhtml:p>
                    <xhtml:p>If the answer to this question is yes, then do not perform the actions
                        below.</xhtml:p>
                </xhtml:div>
                <xhtml:div><xhtml:p> Action (HP-UX 11.x):</xhtml:p>(HP-UX
                        11.x)<xhtml:p>SYSLOGD_OPTS="`sh -c '. /etc/rc.config.d/syslogd ; echo
                        "$SYSLOGD_OPTS"'`"if [[ "$SYSLOGD_OPTS" = *-N* ]]; then ch_rc -a -p
                        SYSLOGD_OPTS="-N $SYSLOGD_OPTS" \
                    /etc/rc.config.d/syslogdfi</xhtml:p></xhtml:div>
                <xhtml:div><xhtml:p> Action (older HP-UX releases):</xhtml:p>(older
                    HP-UX releases)<xhtml:p>Strongly consider upgrading to HP-UX
                    11i.</xhtml:p></xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>By default the system logging daemon, syslogd, listens for log messages
                        from other systems on network port 514/udp. Unfortunately, the protocol used
                        to transfer these messages does not include any form of authentication, so a
                        malicious outsider could simply barrage the local system's Syslog port with
                        spurious traffic—either as a denial-of-service attack on the system, or to
                        fill up the local system's logging file systems so that subsequent attacks
                        will not be logged.</xhtml:p>
                    <xhtml:p>Note that it is considered good practice to setup one or more machines
                        as central “log servers” to aggregate log traffic from all machines at a
                        site. However, unless a system is set up to be one of these “log server”
                        systems, it should not be listening on 514/udp for incoming log
                        messages.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11200</xccdf:ident>
            <xccdf:check system="http://cisecurity.org/check">
                <xccdf:check-content>
                    <ecl:shell-command check="all" success="pass">
                        <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*SYSLOGD_OPTS=.*?-.*N.*?' /etc/rc.config.d/syslogd</ecl:command>
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>
        </xccdf:Rule>
        <xccdf:Rule id="disable-XDMCP" role="full" selected="false" weight="1.0">
            <xccdf:title>
                <xccdf:sub idref="bastille-item"/>Disable XDMCP port</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>if [ ! -f /etc/dt/config/Xconfig ]; then mkdir -p /etc/dt/config cp -p
                        /usr/dt/config/Xconfig /etc/dt/configficd /etc/dt/configawk
                        '/Dtlogin.requestPort:/ \ { print "Dtlogin.requestPort: 0"; next } { print
                        }' Xconfig &gt; Xconfig.newcp Xconfig.new Xconfigrm -f Xconfig.new</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>The standard GUI login provided on most Unix systems can act as a
                        remote login server to other devices (including X terminals and other
                        workstations). Access control is handled via the Xaccess file—by default
                        under HP-UX, this file allows any system on the network to get a remote
                        login screen from the local system. We can override this behavior in the
                        /etc/dt/config/Xaccess file.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11210</xccdf:ident>
            <xccdf:complex-check operator="OR">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:file-content check="all" comment="Dtlogin.requestPort is set to 0 in /etc/dt/config/Xconfig">
                            <ecl:path>/etc/dt/config/Xconfig</ecl:path>
                            <ecl:line-selection op="pm" value="^[^#]?\s*Dtlogin.requestPort:\s+0"/>
                        </ecl:file-content>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:evaluate comment="/etc/dt/config/Xconfig does not exist" dt="xs:string" op="eq" value="false">
                            <ecl:FileExists file="/etc/dt/config/Xconfig"/>
                        </ecl:evaluate>
                    </xccdf:check-content>
                </xccdf:check>                
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="locking-screensaver-timeout" role="full" selected="false" weight="1.0">
            <xccdf:title>Set default locking screensaver timeout</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>for file in /usr/dt/config/*/sys.resources; do dir="$(dirname "$file" |
                        sed 's|^/usr/|/etc/|')" mkdir -p "$dir" echo 'dtsession*saverTimeout: 10'
                        &gt;&gt;"$dir/sys.resources" echo 'dtsession*lockTimeout: 10'
                        &gt;&gt;"$dir/sys.resources"done</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>The default timeout is between 10 and 30 minutes of keyboard/mouse
                        inactivity before a password-protected screen saver is invoked by the CDE
                        session manager depending on the OS release and the locale. The above Action
                        uniformly reduces this default timeout value to 10 minutes, though this
                        setting can still be overridden by individual users in their own
                        environment.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11280</xccdf:ident>
            <!-- if no files exist: PASS
                 else
                    check that #files == #files-containing-KEY
                    AND
                    check that all files contain correct KEY/VALUE pair -->
            <xccdf:complex-check operator="OR">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="sys.resources do not exist" success="fail">
                            <ecl:command>ls /etc/dt/config/*/sys.resources</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                 </xccdf:check>
                <xccdf:complex-check operator="AND">
                    <xccdf:complex-check operator="AND">
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="all sys.resources files contain 'saverTimeout' key" success="pass">
                                    <ecl:command>expr
                                    `ls -l /etc/dt/config/*/sys.resources  | wc -l` = 
                                    `egrep "^dtsession\*saverTimeout:[[:space:]]+([[:digit:]])[[:space:]]*" /etc/dt/config/*/sys.resources | wc -l`</ecl:command>
                                    <ecl:line-selection op="pm" value="(\d+)">
                                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="1"/>
                                    </ecl:line-selection>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="saverTimeout less than or equal to 10" success="pass">
                                    <ecl:command>egrep "^dtsession\*saverTimeout:[[:space:]]+([[:digit:]])[[:space:]]*" /etc/dt/config/*/sys.resources</ecl:command>
                                    <ecl:line-selection op="pm" value="dtsession\*saverTimeout:\s+(\d+)\s*">
                                        <ecl:regex-group dt="xs:integer" group="1" op="gt" value="10"/>
                                    </ecl:line-selection>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                    </xccdf:complex-check>
                    <xccdf:complex-check operator="AND">
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="all" comment="all sys.resources files contain 'lockTimeout' key" success="pass">
                                    <ecl:command>expr
                                        `ls -l /etc/dt/config/*/sys.resources  | wc -l` = 
                                        `egrep "^dtsession\*lockTimeout:[[:space:]]+([[:digit:]])[[:space:]]*" /etc/dt/config/*/sys.resources | wc -l`</ecl:command>
                                    <ecl:line-selection op="pm" value="(\d+)">
                                        <ecl:regex-group dt="xs:integer" group="1" op="eq" value="1"/>
                                    </ecl:line-selection>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                        <xccdf:check system="http://cisecurity.org/check">
                            <xccdf:check-content>
                                <ecl:shell-command check="none exist" comment="lockTimeout less than or equal to 10" success="pass">
                                    <ecl:command>egrep "^dtsession\*lockTimeout:[[:space:]]+([[:digit:]])[[:space:]]*" /etc/dt/config/*/sys.resources</ecl:command>
                                    <ecl:line-selection op="pm" value="dtsession\*lockTimeout:\s+(\d+)\s*">
                                        <ecl:regex-group dt="xs:integer" group="1" op="gt" value="10"/>
                                    </ecl:line-selection>
                                </ecl:shell-command>
                            </xccdf:check-content>
                        </xccdf:check>
                    </xccdf:complex-check>
                </xccdf:complex-check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="inetd-access-control" role="unscored" selected="false" weight="0.0">
            <xccdf:title>Configure inetd security</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>netblocks='&lt;system-or-network&gt; &lt;system-or-network&gt; ...'awk
                        &lt; /etc/inetd.conf ' /^[ ]*(#|$)/ { next } /^ / { next } /^rpc[ ]/ {
                        services[$9]=1; next } { services[$1]=1; next } END { for(service in
                        services) { print service " allow '"$netblocks"'" print service " deny" } }
                        ' &gt;&gt; /var/adm/inetd.sec</xhtml:p>
                    <xhtml:p>Where where each &lt;system-or-network&gt; represents one discrete
                        system or network block in use by your organization that requires access to
                        this system. For example, you might use ‘192.168.1.* 10.3.8.*
                        myserver.mycompany.com’. See the inetd.sec(4) manual page for
                        details.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>The HP-UX inetd security mechanism (inetd.sec) allows the administrator
                        to control who has access to various network services based on the IP
                        address or system name of the remote end of the connection.</xhtml:p>
                    <xhtml:p>Note: This is unnecessary if adequate IP-range limitations are created
                        in IPFilter, if inetd is disabled, or if all the services in inetd.conf are
                        disabled</xhtml:p>
                    <xhtml:p>Also note that the above actions will only provide filtering on
                        services spawned by inetd. To protect other system services, or to limit
                        what outbound network connections that the system can make, consider
                        implementing IPFilter as described in SN.9.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11270</xccdf:ident>
        </xccdf:Rule>
        <xccdf:Rule id="restrict-at-cron" role="full" selected="false" weight="1.0">
            <xccdf:title>Restrict at/cron to authorized users</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>cd /var/adm/cron</xhtml:p>
                    <xhtml:p>rm -f cron.deny at.denyecho root &gt;cron.allow</xhtml:p>
                    <xhtml:p>echo root &gt;at.allowchown root:sys cron.allow at.allowchmod 400
                        cron.allow at.allow</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>The cron.allow and at.allow files are a list of users who are allowed
                        to run the crontab and at commands to submit jobs to be run at scheduled
                        intervals. On many systems, only the system administrator needs the ability
                        to schedule jobs.</xhtml:p>
                    <xhtml:p>Note that even though a given user is not listed in cron.allow, cron
                        jobs can still be run as that user. cron.allow only controls administrative
                        access to the crontab command for scheduling and modifying cron
                        jobs.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11300</xccdf:ident>
            <xccdf:complex-check operator="AND">
                <xccdf:complex-check operator="OR">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="/var/adm/cron/cron.deny does not exist" success="fail">
                                <ecl:command>find /var/adm/cron/cron.deny -follow -prune -exec ls -l {} \; 2&gt;/dev/null</ecl:command>
                                <ecl:line-selection op="pm" value=".+"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="/var/adm/cron/cron.deny is not empty" success="pass">
                                <ecl:command>[ -s /var/adm/cron/cron.deny ]</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
                <xccdf:complex-check operator="OR">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="/var/adm/cron/at.deny does not exist" success="fail">
                                <ecl:command>find /var/adm/cron/at.deny -follow -prune -exec ls -l {} \; 2&gt;/dev/null</ecl:command>
                                <ecl:line-selection op="pm" value=".+"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="/var/adm/cron/at.deny is not empty" success="pass">
                                <ecl:command>[ -s /var/adm/cron/at.deny ]</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="ensure root is the only user in cron.allow">
                            <ecl:command>egrep -v root /var/adm/cron/cron.allow</ecl:command>
                            <ecl:line-selection op="pm" value="^.+$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="ensure root is the only user in at.allow">
                            <ecl:command>egrep -v root /var/adm/cron/at.allow</ecl:command>
                            <ecl:line-selection op="pm" value="^.+$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="/var/adm/cron/cron.allow ownership and permission">
                            <ecl:command>find /var/adm/cron/cron.allow -follow -prune ! \( -user
                                root -group sys -perm u=r,g=,o= \) -exec ls -l {} \; </ecl:command>
                            <ecl:line-selection op="pm" value=".+"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="/var/adm/cron/at.allow ownership and permission">
                            <ecl:command>find /var/adm/cron/at.allow -follow -prune ! \( -user root
                                -group sys -perm u=r,g=,o= \) -exec ls -l {} \; </ecl:command>
                            <ecl:line-selection op="pm" value=".+"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="restrict-crontab-permissions" role="full" selected="false" weight="1.0">
            <xccdf:title>Restrict crontab file permissions</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>cd /var/spool/cron/crontabs</xhtml:p>
                    <xhtml:p>chown root:sys *chmod 400 *</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>
                        <xccdf:sub idref="bastille-item"/>The system crontab files are accessed only
                        by the cron daemon (which runs with superuser privileges) and the crontab
                        command (which is set-UID to root). Allowing unprivileged users to read or
                        (even worse) modify system crontab files can create the potential for a
                        local user on the system to gain elevated privileges.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11290</xccdf:ident>
            <xccdf:check system="http://cisecurity.org/check">
                <xccdf:check-content>
                    <ecl:shell-command check="none exist">
                        <ecl:command>find /var/spool/cron/crontabs/* ! \( -perm 0400 \) -exec ls -l
                            {} \;</ecl:command>
                        <ecl:line-selection op="pm" value=".+"/>
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>
        </xccdf:Rule>
        <xccdf:Rule id="restrict-root-logins" role="full" selected="false" weight="1.0">
            <xccdf:title>Restrict root logins to system console</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>echo console &gt; /etc/securettychown root:sys /etc/securettychmod 600
                        /etc/securetty</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>Anonymous root logins should never be allowed, except on the system
                        console in emergency situations. At all other times, the administrator
                        should access the system via an unprivileged account and use some authorized
                        mechanism to gain additional privilege , such as the su command, the
                        freely-available sudo package discussed in item SN.6, or the HP Role Based
                        Authorization system also discussed in item SN.6. These mechanisms provide
                        at least some limited audit trail in event of problems</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11310</xccdf:ident>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command success="pass">
                            <ecl:command>cat /etc/securetty</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist">
                            <ecl:command>egrep -v "^console$" /etc/securetty</ecl:command>
                            <ecl:line-selection op="pm" value=".+"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="account-lockout" role="full" selected="false" weight="1.0">
            <xccdf:title>Set retry limit for account lockout</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>logins -ox | awk -F: '($8 != "LK" &amp;&amp; $1 != "root") { print $1
                        }' | while read logname; do /usr/lbin/modprpw -m umaxlntr=10
                        "$logname"donemodprdef -m umaxlntr=10echo AUTH_MAXTRIES=10 &gt;&gt;
                        /etc/default/security</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>The commands above set the number of failed login attempts a user is
                        allowed before their account is disabled. Setting this number to a
                        reasonably low value helps discourage brute force password guessing attacks.
                        Note that use of this setting may lead to a “Denial of Service” situation in
                        the event of a widespread password guessing attack, possibly caused by a
                        network security audit. However, choosing not to implement this setting
                        raises the risk of such an attack being successful unless passwords are made
                        harder to guess such as by increasing the minimum password length or
                        diversity requirements on the system as indicated in item 8.4. Note that
                        some other standards suggest fewer retries, in the range from three to five.
                        You may choose to weigh the helpdesk load versus brute-force-attack defense
                        in your own environment, favoring smaller values when password complexity
                        requirements are not implemented, and there are a large number of user
                        accounts on the server, in an LDAP/NIS-enabled environment, for example. In
                        all cases, CIS recommends no greater than 10 attempts for the Level 1
                        benchmark. </xhtml:p>
                    <xhtml:p>Note that the above /etc/default/security setting is only valid for
                        certain patch-levels. Also, use of modprpw assumes the use of “trusted
                        mode.” If trusted mode is not used, use of userdbset is recommended… see
                        userdbset man page for more detail.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xccdf:title>Bastille Notes:</xccdf:title>
                    <xhtml:p>Bastille sets the retry limit to ten (10) only when converting a system
                        to trusted mode.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11320</xccdf:ident>
            <xccdf:check system="http://cisecurity.org/check">
                <xccdf:check-content>
                    <ecl:shell-command check="all" comment="Ensure AUTH_MAXTRIES is less than 11" success="pass">
                        <ecl:command>egrep "^[[:space:]]*AUTH_MAXTRIES=" /etc/default/security</ecl:command>
                        <ecl:line-selection op="pm" value="AUTH_MAXTRIES=(\d+)">
                            <ecl:regex-group dt="xs:integer" group="1" op="lt" value="11"/>
                        </ecl:line-selection>
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>  
        </xccdf:Rule>
        <xccdf:Rule id="disable-secure-RPC-nobody" role="full" selected="false" weight="1.0">
            <xccdf:title>Disable “nobody” access for secure RPC</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>KEYSERV_OPTIONS="`sh -c '. /etc/rc.config.d/namesvrs ; echo
                        "$KEYSERV_OPTIONS"'`"ch_rc -a -p KEYSERV_OPTIONS="-d $KEYSERV_OPTIONS " \
                        /etc/rc.config.d/namesvrs</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>The keyserv process stores user keys that are utilized with the ONC
                        secure RPC mechanism. The above action prevents keyserv from using default
                        keys for the "nobody" user, effectively stopping this user from accessing
                        information via secure RPC.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11120</xccdf:ident>
            <xccdf:complex-check operator="OR">
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" success="fail">
                                <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*NIS_(MASTER|SLAVE)_SERVER=1' /etc/rc.config.d/namesvrs</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" success="fail">
                                <ecl:command>egrep '^[[:space:]]*(export)?[[:space:]]*NIS_CLIENT=1' /etc/rc.config.d/namesvrs</ecl:command>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist">
                            <ecl:command>egrep '^KEYSERV_OPTIONS' /etc/rc.config.d/namesvrs | egrep -v -e '-d'</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="Group-8">
        <xccdf:title>User Accounts and Environment</xccdf:title>
        <xccdf:description>
            <xhtml:p>Note that the items in this section are tasks that the local administrator
                should undertake on a regular, ongoing basis. The administrator can automate the
                auditing these items by running the host-based scanning tools provided from the
                Center for Internet Security on a regular basis—perhaps in an automated fashion via
                cron. These scanning tools are available for free download from <xhtml:a href="http://www.cisecurity.org/">http://www.CISecurity.org/</xhtml:a>.</xhtml:p>
            <xhtml:p>Also, note that the use of modprpw below is only for use with trusted system
                mode, userdbset and the equivalent parameters should be used on systems where
                trusted mode is not used. This command is only available if Standard Mode Security
                Extensions are installed or the HP-UX version is 11iv3 or greater.</xhtml:p>
        </xccdf:description>
        <xccdf:Rule id="block-system-accounts" role="unscored" selected="false" weight="0.0">
            <xccdf:title>Block system accounts</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>for user in www sys smbnull iwww owww sshd \hpsmh named uucp nuucp adm
                        daemon bin lp \nobody noaccess hpdb useradm; do passwd –l "$user"
                        /usr/sbin/usermod -s /bin/false "$user" if [[ "$(uname -r)" = B.10* ]]; then
                        /usr/lbin/modprpw -w "*" "$user" else /usr/lbin/modprpw -w "$user"
                        fidone</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>Accounts that are not being used by regular users should be locked. Not
                        only should the password field for the account be set to an invalid string,
                        but the shell field in the password file should contain an invalid
                        shell.</xhtml:p>
                    <xhtml:p>Access to the uucp and nuucp accounts is only needed when the
                        deprecated Unix to Unix Copy (UUCP) service is in use. The other listed
                        accounts should never require direct access. The above Action locks the
                        passwords to these accounts (on systems converted to Trusted Mode only) and
                        sets the login shell to /bin/false.</xhtml:p>
                    <xhtml:p>Note that the above is not an exhaustive list of possible
                        system/application accounts that could be installed on the system. An audit
                        of all users on the system is the only way to be sure that only authorized
                        accounts are in place.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11360</xccdf:ident>
        </xccdf:Rule>
        <xccdf:Rule id="empty-passwords" role="full" selected="false" weight="1.0">
            <xccdf:title>Verify that there are no accounts with empty password fields</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>The commandlogins -pshould return no lines of output.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>An account with an empty password field means that anybody may log in
                        as that user without providing a password at all. All accounts should have
                        strong passwords or should be locked by using a password string like "*",
                        "NP", or "*LOCKED*", such as supplied by the following for HP-UX 10.x:passwd
                        –l &lt;logname&gt;/usr/lbin/modprpw -w "*" &lt;logname&gt;</xhtml:p>
                    <xhtml:p>Or the following for HP-UX 11.x:passwd –l
                        &lt;logname&gt;/usr/lbin/modprpw -w &lt;logname&gt;</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11370</xccdf:ident>
            <xccdf:check system="http://cisecurity.org/check">
                <xccdf:check-content>
                    <ecl:shell-command check="none exist">
                        <ecl:command>logins -p</ecl:command>
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>
        </xccdf:Rule>
        <xccdf:Rule id="account-expiration-parameters" role="full" selected="false" weight="1.0">
            <xccdf:title>
                <xccdf:sub idref="bastille-item"/>Set account expiration parameters on active
                accounts</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>logins -ox | awk -F: '($8 != "LK" &amp;&amp; $1 != "root") { print $1
                        }' | while read logname; do passwd –x 91 –n 7 –w 28 "$logname"
                        /usr/lbin/modprpw -m exptm=90,mintm=7,expwarn=30 \ "$logname"doneecho
                        PASSWORD_MAXDAYS=91 &gt;&gt; /etc/default/securityecho PASSWORD_MINDAYS=7
                        &gt;&gt; /etc/default/security echo PASSWORD_WARNDAYS=28 &gt;&gt;
                        /etc/default/security /usr/lbin/modprdef -m
                        exptm=90,mintm=7,expwarn=30</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>It is a good idea to force users to change passwords on a regular
                        basis. The commands above will set all active accounts (except the root
                        account) to force password changes every 90 days (91 days when not running
                        in HP-UX Trusted Mode) and then prevent password changes for seven days (one
                        week) thereafter. Users will begin receiving warnings 30 days (28 days when
                        not running in HP-UX Trusted Mode) before their password expires. Sites also
                        have the option of expiring idle accounts after a certain number of days
                        (see the on-line manual page for the usermod command, particularly the -f
                        option).</xhtml:p>
                    <xhtml:p>
                        <xccdf:sub idref="bastille-item"/>These are recommended starting values, but
                        sites may choose to make them more restrictive depending on local
                        policies.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11380</xccdf:ident>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure PASSWORD_MAXDAYS is less than 91" success="pass">
                            <ecl:command>egrep "^[[:space:]]*PASSWORD_MAXDAYS=" /etc/default/security</ecl:command>
                            <ecl:line-selection op="pm" value="PASSWORD_MAXDAYS=(\d+)">
                                <ecl:regex-group dt="xs:integer" group="1" op="lt" value="91"/>
                            </ecl:line-selection>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure PASSWORD_MINDAYS is greater than 6" success="pass">
                            <ecl:command>egrep "^[[:space:]]*PASSWORD_MINDAYS=" /etc/default/security</ecl:command>
                            <ecl:line-selection op="pm" value="PASSWORD_MINDAYS=(\d+)">
                                <ecl:regex-group dt="xs:integer" group="1" op="gt" value="6"/>
                            </ecl:line-selection>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure PASSWORD_WARNDAYS is greater than 27" success="pass">
                            <ecl:command>egrep "^[[:space:]]*PASSWORD_WARNDAYS=" /etc/default/security</ecl:command>
                            <ecl:line-selection op="pm" value="PASSWORD_WARNDAYS=(\d+)">
                                <ecl:regex-group dt="xs:integer" group="1" op="gt" value="27"/>
                            </ecl:line-selection>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="remove-NIS-password-extension" role="full" selected="false" weight="1.0">
            <xccdf:title>Verify no legacy '+' entries exist in passwd and group files</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>The commandgrep '^+:' /etc/passwd /etc/groupshould return no lines of
                        output.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>'+' entries in various files used to be markers for systems to insert
                        data from NIS maps at a certain point in a system configuration file. These
                        entries are no longer required on HP-UX systems, but may exist in files that
                        have been imported from other platforms. These entries may provide an avenue
                        for attackers to gain privileged access on the system. They should be
                        deleted if they exist.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11430</xccdf:ident>
            <xccdf:check system="http://cisecurity.org/check">
                <xccdf:check-content>
                    <ecl:file-content check="none exist">
                        <ecl:path>/etc/^(passwd|group)$</ecl:path>
                        <ecl:line-selection op="pm" value="^+:.*$"/>
                    </ecl:file-content>
                </xccdf:check-content>
            </xccdf:check>
        </xccdf:Rule>
        <xccdf:Rule id="protected-root-path" role="full" selected="false" weight="1.0">
            <xccdf:title>No '.' or group/world-writable directory in root $PATH</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>The automated testing tool supplied with this benchmark will alert the
                        administrator if action is required.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>Including the current working directory ('.') or other writable
                        directory in root's executable path makes it likely that an attacker can
                        gain superuser access by forcing an administrator operating as root to
                        execute a Trojan horse program. To execute a file in the current directory
                        when ‘.’ is not in the $PATH, use the format “./filename”.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11460</xccdf:ident>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <!--command test «echo $PATH»-->
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="command test «echo $PATH»">
                            <ecl:command>echo $PATH</ecl:command>
                            <ecl:line-selection op="pm" value="^\.:|:\.:|:\.$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <!--command test «find `echo $PATH|sed "s/:/ /g"` -prune -type d \( -perm -g+w -o -perm -o+w \) 2>/dev/null»-->
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="command test «find `echo $PATH|sed &quot;s/:/ /g&quot;` -prune -type d \( -perm -g+w -o -perm -o+w \) 2&gt;/dev/null»">
                            <ecl:command>find `echo $PATH|sed "s/:/ /g"` -prune -type d \( -perm
                                -g+w -o -perm -o+w \) 2&gt;/dev/null</ecl:command>
                            <ecl:line-selection op="pm" value=".+"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="user-home-permissions" role="full" selected="false" weight="1.0">
            <xccdf:title>User home directories should be mode 750 or more restrictive</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>logins -ox | awk -F: '($8 == "PS" &amp;&amp; $1 != "root") { print $6
                        }' | grep /home/ | while read dirdo chmod g-w,o-rwx "$dir"done</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>Group or world-writable user home directories may enable malicious
                        users to steal or modify other users' data or to gain another user's system
                        privileges. While the above modifications are relatively benign, making
                        global modifications to user home directories without alerting your user
                        community can result in unexpected outages and unhappy users.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11470</xccdf:ident>
            <xccdf:check system="http://cisecurity.org/check">
                <xccdf:check-content>
                    <ecl:shell-command check="none exist">
                        <ecl:command>find `logins -ox | awk -F: '($8 == "PS" &amp;&amp; $1 !=
                            "root") { print $6 }'` -maxdepth 0 \( -perm -g+w -o -perm -o+r -o -perm -o+w -o
                            -perm -o+x \) -prune -exec ls -l {} \;</ecl:command>
                        <ecl:line-selection op="pm" value=".+"/>
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>
        </xccdf:Rule>
        <xccdf:Rule id="user-dotfile-permissions" role="full" selected="false" weight="1.0">
            <xccdf:title>No user dot-files should be group/world writable</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>logins -ox | awk -F: '($8 == "PS") { print $6 }' | while read dir do ls
                        -d "$dir/".[!.]* | while read file do if [ ! -h "$file" -a -f "$file" ] then
                        chmod go-w "$file" fi donedone</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>Group or world-writable user configuration files may enable malicious
                        users to steal or modify other users' data or to gain another user's system
                        privileges. While the above modifications are relatively benign, making
                        global modifications to user home directories without alerting your user
                        community can result in unexpected outages and unhappy users.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11480</xccdf:ident>
            <xccdf:check system="http://cisecurity.org/check">
                <xccdf:check-content>
                    <ecl:shell-command check="none exist">
                        <ecl:command>find `logins -ox | awk -F: '($8 == "PS" &amp;&amp; $1 !=
                            "root") { print $6 }'` -name "\.*" \( -perm -g+w -o -perm -o+w \) -prune -exec ls -l {} \;</ecl:command>
                        <ecl:line-selection op="pm" value=".+"/>
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>
        </xccdf:Rule>
        <xccdf:Rule id="user-netrc-permissions" role="full" selected="false" weight="1.0">
            <xccdf:title>Remove user .netrc, .rhosts and .shosts files</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>logins -ox | cut -f6 -d: | while read hdo for file in "$h/.netrc"
                        "$h/.rhosts" "$h/.shosts" do if [ -f "$file" ] then echo "removing $file" rm
                        -f "$file" fi donedone</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>
                        <xccdf:sub idref="bastille-item"/>.netrc files may contain unencrypted
                        passwords that may be used to attack other systems, while .rhosts files used
                        in conjunction with the BSD-style “r-commands” (rlogin, remsh, rcp)
                        implement a weak form of authentication based on the network address or host
                        name of the remote computer (which can be spoofed by a potential attacker to
                        exploit the local system). While the above modifications are relatively
                        benign, making global modifications to user home directories without
                        alerting your user community can result in unexpected outages and unhappy
                        users. </xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11490</xccdf:ident>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist">
                            <ecl:command>logins -ox | cut -f6 -d: | sort -u | while read DIR; do ls $DIR/.netrc 2&gt;/dev/null; done</ecl:command>
                            <ecl:line-selection op="pm" value="^.+$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist">
                            <ecl:command>logins -ox | cut -f6 -d: | sort -u | while read DIR; do ls $DIR/.rhosts 2&gt;/dev/null; done</ecl:command>
                            <ecl:line-selection op="pm" value="^.+$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist">
                            <ecl:command>logins -ox | cut -f6 -d: | sort -u | while read DIR; do ls $DIR/.shosts 2&gt;/dev/null; done</ecl:command>
                            <ecl:line-selection op="pm" value="^.+$"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="default-user-umask" role="full" selected="false" weight="1.0">
            <xccdf:title>Set default umask for users</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>cd /etcfor file in profile csh.login d.profile d.logindo echo umask 077
                        &gt;&gt; "$file"donech_rc –a -p UMASK=077 /etc/default/security</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>With a default umask setting of 077, files and directories created by
                        users will not be readable by any other user on the system. The user
                        creating the file has the discretion of making their files and directories
                        readable by others via the chmod command. Users who wish to allow their
                        files and directories to be readable by others by default may choose a
                        different default umask by inserting the umask command into the standard
                        shell configuration files (.profile, .cshrc, etc.) in their home
                        directories. A umask of 027 would make files and directories readable by
                        users in the same Unix group, while a umask of 022 would make files readable
                        by every user on the system.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xccdf:title>Bastille Notes:</xccdf:title>
                    <xhtml:p>Bastille also sets the default umask, but uses a umask of 027 rather
                        than the 077 in the Action above.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11500</xccdf:ident>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" success="pass">
                            <ecl:command>egrep '^[[:space:]]*umask 0?077' /etc/profile</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" success="pass">
                            <ecl:command>egrep '^[[:space:]]*umask 0?077' /etc/csh.login</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" success="pass">
                            <ecl:command>egrep '^[[:space:]]*umask 0?077' /etc/d.profile</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" success="pass">
                            <ecl:command>egrep '^[[:space:]]*umask 0?077' /etc/d.login</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" success="pass">
                            <ecl:command>egrep '^[[:space:]]*UMASK=0?077$' /etc/default/security</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="mesg-n" role="full" selected="false" weight="1.0">
            <xccdf:title>Set "mesg n" as default for all users</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>cd /etc for file in profile csh.login d.profile d.logindo echo mesg n
                        &gt;&gt; "$file"done</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>"mesg n" blocks attempts to use the write or talk commands to contact
                        the user at their terminal, but has the side effect of slightly
                        strengthening permissions on the user's tty device. Since write and talk are
                        no longer widely used at most sites, the incremental security increase is
                        worth the loss of functionality. Note that this setting is the default on
                        HP-UX 11i.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11520</xccdf:ident>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" success="pass">
                            <ecl:command>egrep '^[[:space:]]*mesg[[:space:]]+n([[:space:]]+2&gt;[[:space:]]+/dev/null)*' /etc/profile</ecl:command>
                            <ecl:line-selection op="pm" value=".+"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" success="pass">
                            <ecl:command>egrep '^[[:space:]]*mesg[[:space:]]+n([[:space:]]+2&gt;[[:space:]]+/dev/null)*' /etc/csh.login</ecl:command>
                            <ecl:line-selection op="pm" value=".+"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" success="pass">
                            <ecl:command>egrep '^[[:space:]]*mesg[[:space:]]+n([[:space:]]+2&gt;[[:space:]]+/dev/null)*' /etc/d.profile</ecl:command>
                            <ecl:line-selection op="pm" value=".+"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" success="pass">
                            <ecl:command>egrep '^[[:space:]]*mesg[[:space:]]+n([[:space:]]+2&gt;[[:space:]]+/dev/null)*' /etc/d.login</ecl:command>
                            <ecl:line-selection op="pm" value=".+"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Group id="grp-strong-password-enforcement">
            <xccdf:title>Strong Password Enforcement</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>ch_rc –a -p MIN_PASSWORD_LENGTH=7 /etc/default/securitych_rc –a -p
                        PASSWORD_HISTORY_DEPTH=10 \/etc/default/security</xhtml:p>
                    <xhtml:p>ch_rc –a –p PASSWORD_MIN_UPPER_CASE_CHARS=1 \</xhtml:p>
                    <xhtml:p>/etc/default/security</xhtml:p>
                    <xhtml:p>ch_rc –a –p PASSWORD_MIN_DIGIT_CHARS=1 \</xhtml:p>
                    <xhtml:p>/etc/default/security</xhtml:p>
                    <xhtml:p>ch_rc –a –p PASSWORD_MIN_SPECIAL_CHARS=1 \</xhtml:p>
                    <xhtml:p>/etc/default/security</xhtml:p>
                    <xhtml:p>ch_rc –a –p PASSWORD_MIN_LOWER_CASE_CHARS=1 \</xhtml:p>
                    <xhtml:p>/etc/default/security</xhtml:p>
                    <xhtml:p>modprdef -m nullpw=NOmodprdef -m rstrpw=YES</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>The policies set here are designed to force users to make better
                        password choices when changing their passwords. </xhtml:p>
                    <xhtml:p>Sites often have differing opinions on the optimal value of the
                        MIN_PASSWORD_LENGTH and PASSWORD_HISTORY_DEPTH parameters. A minimum
                        password length of seven is in line with industry standards, especially the
                        Payment Card Industry (PCI) Security Standard; however, a longer value may
                        be warranted if account locks are not enabled (item 7.10). A password
                        history depth of ten combined with passwords that expire four times per year
                        (item 8.3) means users will typically not re-use the same password in any
                        given year. </xhtml:p>
                    <xhtml:p>Requiring an upper/lowercase and special character password will
                        dramatically increase the password search space and lower the chances for
                        brute-force attack significantly. These settings are known to exist for
                        HP-UX 11iv2, 0512 and later. The man page for security(5) will indicate if
                        these exist on your particular system.</xhtml:p>
                    <xhtml:p>Be sure to consult your local security standards before adopting the
                        values given above.</xhtml:p>
                </xhtml:div>                
            </xccdf:description>
            <xccdf:Rule id="strong-password-enforcement-min-pass-len" role="full" selected="false" weight="1.0">
                <xccdf:title>Ensure minimum password length is greater than seven characters</xccdf:title>
		<xccdf:description/>
                <xccdf:ident system="http://benchmarks.cisecurity.org/">11390</xccdf:ident>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure MIN_PASSWORD_LENGTH is greater than 7" success="pass">
                            <ecl:command>egrep "^[[:space:]]*MIN_PASSWORD_LENGTH=" /etc/default/security</ecl:command>
                            <ecl:line-selection op="pm" value="MIN_PASSWORD_LENGTH=(\d+)">
                                <ecl:regex-group dt="xs:integer" group="1" op="gt" value="7"/>
                            </ecl:line-selection>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="strong-password-enforcement-pass-hist-depth" role="full" selected="false" weight="1.0">
                <xccdf:title>Ensure password history depth is greater than nine passwords</xccdf:title>
		<xccdf:description/>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure PASSWORD_HISTORY_DEPTH is greater than 9" success="pass">
                            <ecl:command>egrep "^[[:space:]]*PASSWORD_HISTORY_DEPTH=" /etc/default/security</ecl:command>
                            <ecl:line-selection op="pm" value="PASSWORD_HISTORY_DEPTH=(\d+)">
                                <ecl:regex-group dt="xs:integer" group="1" op="gt" value="9"/>
                            </ecl:line-selection>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="strong-password-enforcement-pass-min-upper" role="full" selected="false" weight="1.0">
                <xccdf:title>Ensure passwords contain at least one upper case character</xccdf:title>
		<xccdf:description/>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure PASSWORD_MIN_UPPER_CASE_CHARS is greater than 0" success="pass">
                            <ecl:command>egrep "^[[:space:]]*PASSWORD_MIN_UPPER_CASE_CHARS=" /etc/default/security</ecl:command>
                            <ecl:line-selection op="pm" value="PASSWORD_MIN_UPPER_CASE_CHARS=(\d+)">
                                <ecl:regex-group dt="xs:integer" group="1" op="gt" value="0"/>
                            </ecl:line-selection>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="strong-password-enforcement-pass-min-digits" role="full" selected="false" weight="1.0">
                <xccdf:title>Ensure passwords contain at least digit</xccdf:title>
		<xccdf:description/>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure PASSWORD_MIN_DIGIT_CHARS is greater than 0" success="pass">
                            <ecl:command>egrep "^[[:space:]]*PASSWORD_MIN_DIGIT_CHARS=" /etc/default/security</ecl:command>
                            <ecl:line-selection op="pm" value="PASSWORD_MIN_DIGIT_CHARS=(\d+)">
                                <ecl:regex-group dt="xs:integer" group="1" op="gt" value="0"/>
                            </ecl:line-selection>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="strong-password-enforcement-pass-min-special" role="full" selected="false" weight="1.0">
                <xccdf:title>Ensure passwords contain at least one special character</xccdf:title>
		<xccdf:description/>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure PASSWORD_MIN_SPECIAL_CHARS is greater than 0" success="pass">
                            <ecl:command>egrep "^[[:space:]]*PASSWORD_MIN_SPECIAL_CHARS=" /etc/default/security</ecl:command>
                            <ecl:line-selection op="pm" value="PASSWORD_MIN_SPECIAL_CHARS=(\d+)">
                                <ecl:regex-group dt="xs:integer" group="1" op="gt" value="0"/>
                            </ecl:line-selection>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
            <xccdf:Rule id="strong-password-enforcement-pass-min-lower" role="full" selected="false" weight="1.0">
                <xccdf:title>Ensure passwords contain at least one lower case character</xccdf:title>
	        <xccdf:description/>
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="all" comment="Ensure PASSWORD_MIN_LOWER_CASE_CHARS is greater than 0" success="pass">
                            <ecl:command>egrep "^[[:space:]]*PASSWORD_MIN_LOWER_CASE_CHARS=" /etc/default/security</ecl:command>
                            <ecl:line-selection op="pm" value="PASSWORD_MIN_LOWER_CASE_CHARS=(\d+)">
                                <ecl:regex-group dt="xs:integer" group="1" op="gt" value="0"/>
                            </ecl:line-selection>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:Rule>
        </xccdf:Group>
    </xccdf:Group>
    <xccdf:Group id="Group-9">
        <xccdf:title>Warning Banners</xccdf:title>
        <xccdf:description>
            <xhtml:p>Presenting some sort of statutory warning message prior to the normal user
                logon may</xhtml:p>
            <xhtml:p>assist the prosecution of trespassers on the computer system. Changing some of
                these login banners also has the side effect of hiding OS version information and
                other detailed system information from attackers attempting to target specific
                attacks at a system.</xhtml:p>
            <xhtml:p>Guidelines published by the US Department of Defense require that warning
                messages</xhtml:p>
            <xhtml:p>include at least the name of the organization that owns the system, the fact
                that the system is subject to monitoring and that such monitoring is in compliance
                with local statutes, and that use of the system implies consent to such monitoring.
                Clearly, the organization’s local legal counsel and/or site security administrator
                should review the content of all messages before any system modifications are made,
                as these warning messages are inherently site-specific. A more complete discussion
                of the topic can be found at <xhtml:a href="http://www.usdoj.gov/criminal/cybercrime/s&amp;sappendix2002.htm">http://www.usdoj.gov/criminal/cybercrime/s&amp;sappendix2002.htm</xhtml:a>.</xhtml:p>
            <xhtml:p>Note that if TCP Wrappers are being used to display warning banners for various
                inetd-based services, it is important that the banner messages be formatted properly
                so as not to interfere with the application protocol. The Banners.Makefile file
                provided with the TCP Wrappers source distribution (available from <xhtml:a href="ftp://ftp.porcupine.org/">ftp.porcupine.org</xhtml:a>) contains shell
                commands to help produce properly formatted banner messages.</xhtml:p>
        </xccdf:description>
        <xccdf:Rule id="login-banners" role="full" selected="false" weight="1.0">
            <xccdf:title>
                <xccdf:sub idref="bastille-item"/>Create warning banners for terminal-session
                logins</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>banner="Authorized users only. All activity may \be monitored and
                        reported."echo "$banner" &gt;&gt; /etc/motdecho "$banner" &gt;
                        /etc/issuechown root:sys /etc/motdchown root:root /etc/issuechmod 644
                        /etc/motd /etc/issue </xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>The contents of the /etc/issue file are displayed prior to the login
                        prompt on the system's console and serial devices, as well as for remote
                        terminal-session logins such as through SSH or Telnet.</xhtml:p>
                    <xhtml:p>/etc/motd is generally displayed after all successful logins, no matter
                        where the user is logging in from, but is thought to be less useful because
                        it only provides notification to the user after the machine has been
                        accessed. </xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11550</xccdf:ident>
            <xccdf:complex-check operator="AND">
                <xccdf:check system="http://cisecurity.org/check">
                    <!--/etc/motd content-->
                    <xccdf:check-content>
                        <ecl:shell-command check="all" success="pass">
                            <ecl:command>cat /etc/motd</ecl:command>
                            <ecl:line-selection op="pm" value=".+"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:check system="http://cisecurity.org/check">
                    <!--/etc/motd ownership and permissions-->
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" success="pass">
                            <ecl:command>find /etc/motd ! \( -user root -group sys -perm 644 \) </ecl:command>
                            <ecl:line-selection op="pm" value=".+"/>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="login-banners-GUI" role="full" selected="false" weight="1.0">
            <xccdf:title>Create warning banners for GUI logins</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>banner="Authorized users only. All activity may \be monitored and
                        reported." for file in /usr/dt/config/*/Xresources; dodir="$(dirname "$file"
                        | sed 's|^/usr/|/etc/|')"mkdir -p "$dir"if [ ! -f "$dir/Xresources" ];
                        thencp –p "$file" "$dir/Xresources"fiecho "Dtlogin*greeting.labelString:
                        $banner" \ &gt;&gt; "$dir/Xresources"echo "Dtlogin*greeting.persLabelString:
                        $banner" \ &gt;&gt; "$dir/Xresources"donechown root:sys
                        /etc/dt/config/*/Xresources chmod 644 /etc/dt/config/*/Xresources</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>The standard graphical login program for HP-UX requires the user to
                        enter their username in one dialog box and their password in a second
                        separate dialog. The commands above set the warning message on both to be
                        the same message, but the site has the option of using different messages on
                        each screen. The Dtlogin*greeting.labelString is the message for the first
                        dialog where the user is prompted for their username, and .perslabelString
                        is the message on the second dialog box. Note that system administrators may
                        wish to consult with their site’s legal counsel about the specifics of any
                        warning banners. </xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11560</xccdf:ident>
            <xccdf:complex-check operator="OR">
                <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="none exist" comment="Xresources exist" success="fail">
                                <ecl:command>ls /etc/dt/config/\*/Xresources</ecl:command>
                                <ecl:line-selection op="pm" value=".+"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="labelString has warning banner">
                                <ecl:command>egrep '^Dtlogin\*greeting\.labelString:.*authorized' /etc/dt/config/\*/Xresources</ecl:command>
                                <ecl:line-selection op="pm" value=".+"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="persLabelString has warning banner">
                                <ecl:command>egrep '^Dtlogin\*greeting\.persLabelString:.*authorized' /etc/dt/config/\*/Xresources</ecl:command>
                                <ecl:line-selection op="pm" value=".+"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:complex-check>
        </xccdf:Rule>
        <xccdf:Rule id="login-banners-ftp" role="full" selected="false" weight="1.0">
            <xccdf:title>Create warning banners for FTP daemon</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>banner="Authorized users only. All activity may \be monitored and
                        reported." if [ -d /etc/ftpd ]; thenecho "banner /etc/issue"
                        &gt;&gt;/etc/ftpd/ftpaccesschmod 600 /etc/ftpd/ftpaccesschown root:sys
                        /etc/ftpd /etc/ftpd/ftpaccessfi</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>The FTP daemon in HP-UX 11 is based on the popular Washington
                        University FTP daemon (WU-FTPD), which is an Open Source program widely
                        distributed on the Internet. Note that this setting has no effect if the FTP
                        daemon remains de-activated from item 2.1.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11570</xccdf:ident>
            <xccdf:complex-check operator="OR">
                <xccdf:check system="http://cisecurity.org/check">
                    <xccdf:check-content>
                        <ecl:shell-command check="none exist" comment="FTP is not enabled in inetd.conf" success="fail">
                            <ecl:command>egrep '^ftp' /etc/inetd.conf</ecl:command>
                        </ecl:shell-command>
                    </xccdf:check-content>
                </xccdf:check>
                <xccdf:complex-check operator="AND">
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="Banner enabled" success="pass">
                                <ecl:command>egrep '^[[:space:]]*banner[[:space:]]*/etc/issue$' /etc/ftpd/ftpaccess</ecl:command>
                                <ecl:line-selection op="pm" value=".+"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                    <xccdf:check system="http://cisecurity.org/check">
                        <xccdf:check-content>
                            <ecl:shell-command check="all" comment="/etc/ftpd/ftpaccess permissions are correct" success="pass">
                                <ecl:command>find /etc/ftpd/ftpaccess \( -user root -group sys -perm 600 \)</ecl:command>
                                <ecl:line-selection op="pm" value=".+"/>
                            </ecl:shell-command>
                        </xccdf:check-content>
                    </xccdf:check>
                </xccdf:complex-check>
            </xccdf:complex-check>
        </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="Group-10">
        <xccdf:title>Appendix A: File Backup Script</xccdf:title>
        <xccdf:description>
            <xhtml:p>#!/bin/sh</xhtml:p>
            <xhtml:p># Provided for reference as a starting place for your own script.</xhtml:p>
            <xhtml:p>ext=`date '+%Y%m%d-%H:%M:%S'`cp -rp /etc/rc.config.d
                /etc/rc.config.d-preCIS.$extcp –rp /var/spool/cron/crontabs
                /var/spool/cron/crontabs-preCIS.$extfor file in/.rhosts/.shosts
                \/etc/fstab/etc/ftpd/ftpusers\/etc/ftpusers/etc/ftpd/ftpaccess\
                /etc/hosts.equiv/etc/inet/ntp.conf\ /etc/inetd.conf/etc/inittab\
                /etc/issue/etc/motd\/etc/securettyqls -dl
                q/ssh_config\/etc/ssh/sshd_config\/opt/ssh/etc/ssh_config\/opt/ssh/etc/sshd_config\/var/adm/cron/at.allow\/var/adm/cron/cron.allow\/etc/dt/config/*/Xresourcesdo
                [ -f $file ] &amp;&amp; cp –p $file $file-preCIS.$extdone</xhtml:p>
        </xccdf:description>
    </xccdf:Group>
    <xccdf:Group id="Group-11">
        <xccdf:title>Appendix B: Log Rotation Script</xccdf:title>
        <xccdf:description>
            <xhtml:p>#!/bin/ksh</xhtml:p>
            <xhtml:p># Provided for reference as a starting place for your own script.</xhtml:p>
            <xhtml:p># rotate -- A script to roll over log files</xhtml:p>
            <xhtml:p># Usage: rotate /path/to/log/file [mode [#revs] ]</xhtml:p>
            <xhtml:p>FILE="$1"</xhtml:p>
            <xhtml:p>MODE="${2:-644}"</xhtml:p>
            <xhtml:p>typeset –i DEPTH="${3:-4}"</xhtml:p>
            <xhtml:p>DIR="$(dirname "$FILE")"</xhtml:p>
            <xhtml:p>LOG="$(basename "$FILE")"</xhtml:p>
            <xhtml:p>DEPTH=$(($DEPTH - 1))</xhtml:p>
            <xhtml:p>if [ ! -d "$DIR" ]; then</xhtml:p>
            <xhtml:p>echo "$DIR: Path does not exist"</xhtml:p>
            <xhtml:p>exit 255</xhtml:p>
            <xhtml:p>fi</xhtml:p>
            <xhtml:p>cd "$DIR"</xhtml:p>
            <xhtml:p>while [ $DEPTH -gt 0 ]</xhtml:p>
            <xhtml:p>do</xhtml:p>
            <xhtml:p>OLD=$(($DEPTH - 1))</xhtml:p>
            <xhtml:p>if [ -f "$LOG.$OLD" ]; then</xhtml:p>
            <xhtml:p>mv "$LOG.$OLD" "$LOG.$DEPTH"</xhtml:p>
            <xhtml:p>fi</xhtml:p>
            <xhtml:p>DEPTH=$OLD</xhtml:p>
            <xhtml:p>done</xhtml:p>
            <xhtml:p>if [ $DEPTH -eq 0 -a -f "$LOG" ]; then</xhtml:p>
            <xhtml:p>mv "$LOG" $LOG.0</xhtml:p>
            <xhtml:p>fi</xhtml:p>
            <xhtml:p>cp /dev/null "$LOG"</xhtml:p>
            <xhtml:p>chmod "$MODE" "$LOG"</xhtml:p>
            <xhtml:p>/sbin/init.d/syslog stop</xhtml:p>
            <xhtml:p>/sbin/init.d/syslog start</xhtml:p>
        </xccdf:description>
    </xccdf:Group>
    <xccdf:Group id="Group-12">
        <xccdf:title>Appendix C: Additional Security Notes</xccdf:title>
        <xccdf:description>
            <xhtml:p>The items in this section are security configuration settings that have been
                suggested by</xhtml:p>
            <xhtml:p>several other resources and system hardening tools. However, given the other
                settings in</xhtml:p>
            <xhtml:p>the benchmark document, the settings presented here provide relatively little
                incremental</xhtml:p>
            <xhtml:p>security benefit. Nevertheless, none of these settings should have a
                significant impact on</xhtml:p>
            <xhtml:p>the functionality of the system, and some sites may feel that the slight
                security</xhtml:p>
            <xhtml:p>enhancement of these settings outweighs the (sometimes minimal) administrative
                cost of</xhtml:p>
            <xhtml:p>performing them.</xhtml:p>
            <xhtml:p>None of these settings will be checked by the automated scoring tool provided
                with the</xhtml:p>
            <xhtml:p>benchmark document. They are purely optional and may be applied or not at the
                discretion of local site administrators.</xhtml:p>
        </xccdf:description>
        <xccdf:Rule id="Rule-12.1" role="unscored" selected="false" weight="0.0">
            <xccdf:title>SN.1Enable process accounting on bootup</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>ch_rc -a -p START_ACCT=1 /etc/rc.config.d/acct</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>Process accounting logs information about every process that runs to
                        completion on the system, including the amount of CPU time, memory, etc.
                        consumed by each process.</xhtml:p>
                    <xhtml:p>While this would seem like useful information in the wake of a
                        potential security incident on the system, kernel-level auditing (as enabled
                        in Item 7.2) provides more information about each process execution in
                        general (although kernel-level auditing does not capture system resource
                        usage information).</xhtml:p>
                    <xhtml:p>Both process accounting and kernel-level auditing can be a significant
                        performance drain on the system, so enabling both seems excessive given the
                        large amount of overlap in the information each provides.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
        </xccdf:Rule>
        <xccdf:Rule id="Rule-12.2" role="unscored" selected="false" weight="0.0">
            <xccdf:title>SN.2Create symlinks for dangerous files</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>for file in /.rhosts /.shosts /etc/hosts.equiv /.netrcdo rm -f $file ln
                        -s /dev/null $filedone</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>The /.rhosts, /.shosts, and /etc/hosts.equiv files enable a weak form
                        of access control (see the discussion of .rhosts files in item 8.9).
                        Similarly /.netrc files may contain the root password to other systems.
                        Attackers will often target these files as part of their exploit scripts. By
                        linking these files to /dev/null, any data that an attacker writes to these
                        files is simply discarded (though an astute attacker can still remove the
                        link prior to writing their malicious data).</xhtml:p>
                </xhtml:div>
            </xccdf:description>
        </xccdf:Rule>
        <xccdf:Rule id="Rule-12.3" role="unscored" selected="false" weight="0.0">
            <xccdf:title>SN.3File systems are mounted either 'ro' or 'nosuid'</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>cp -p /etc/fstab /etc/fstab.tmpawk '$0 ~ /^[\t ]*#/ || $3 ~
                        /^(swap|ignore)$/ || $2 ~ "^(swap$|/$|/usr($|/))" { print; next }{ if($2 ~
                        "^/opt($|/)") { if($4 !~ /(^|,)ro($|,)/) { $4 = $4 ",ro" }
                        sub(/(^|,)(rw|delaylog),/, ",", $4) } else if ($4 !~ /(^|,)nosuid($|,)/) {
                        $4 = $4 ",nosuid" sub(/(^|,)suid,/, ",", $4) } sub(/^(defaults,|,)/, "", $4)
                        print}' /etc/fstab.tmp &gt;/etc/fstabrm -f /etc/fstab.tmpchmod a-wx,ug-s
                        /etc/fstab</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>It is important to protect the system from the introduction of
                        unauthorized software, particularly set-UID programs. Since most of the
                        standard set-UID utilities are provided under the /usr and /opt file
                        systems, we mount /opt read-only to help prevent tampering (HP-UX systems
                        cannot start if /usr is mounted read-only on boot-up). Note that
                        administrators may make /opt read-write with themount -o remount,rw /opt
                        command, but must reboot the system to return the file system to read-only
                        mode.</xhtml:p>
                    <xhtml:p>Other file systems should be mounted "nosuid" where possible in order
                        to prevent the introduction of rogue set-UID programs. If a file system is
                        mounted "nosuid" then the set-UID bit on executables in that file system is
                        ignored—these programs will execute with the privileges of the user running
                        the program, rather than the privileges of the owner of the
                        binary.</xhtml:p>
                    <xhtml:p>The action above operates by first making a backup copy of the
                        /etc/fstab file and then walks through the file line by line applying the
                        following logic:</xhtml:p>
                    <xhtml:ol>
                        <xhtml:li>
                            <xhtml:p>If the entry refers to a non-filesystem partition (i.e., swap
                                or ignore), to the '/' filesystem, or to the /usr filesystem (or any
                                filesystem mounted below /usr), then leave this entry
                                alone.</xhtml:p>
                        </xhtml:li>
                        <xhtml:li>
                            <xhtml:p>Otherwise if the entry refers to the /opt filesystem, or any
                                filesystem mounted below /opt, then modify the entry to mount the
                                filesystem read-only (ro).</xhtml:p>
                        </xhtml:li>
                        <xhtml:li>
                            <xhtml:p>Otherwise modify the entry to mount the filesystem
                                nosuid.</xhtml:p>
                        </xhtml:li>
                    </xhtml:ol>
                    <xhtml:p>Beyond simple file system level protections, experts recommend using a
                        file system integrity checking tool such as Tripwire™, which is available in
                        both free and commercial versions (see <xhtml:a href="http://www.tripwire.com/products/tripwire_asr/">http://www.tripwire.com/products/tripwire_asr/</xhtml:a> and <xhtml:a href="http://www.tripwire.org/">http://www.tripwire.org/</xhtml:a> for
                        information on obtaining free versions of this software).</xhtml:p>
                </xhtml:div>
            </xccdf:description>
        </xccdf:Rule>
        <xccdf:Rule id="disable-inetd" role="full" selected="false" weight="1.0">
            <xccdf:title>SN.4 Disable inetd, if possible</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>if grep -Evq '^[ ]*(#|$)' /etc/inetd.confthen:elsemv -f
                        /sbin/rc2.d/S500inetd \ /sbin/rc2.d/.NOS500inetdfi</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>If the actions in Section 2 of this benchmark resulted in no services
                        being enabled in /etc/inetd.conf, then the revised boot script created here
                        will prevent the inetd daemon from even being started. For further
                        information on logging inetd connections if inetd is running, see Item 7.3
                        below.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">10610</xccdf:ident>
            <xccdf:check system="http://cisecurity.org/check">
                <!--command test «lssrc -s inetd|tail -1|egrep 'active$'»-->
                <xccdf:check-content>
                    <ecl:shell-command check="none exist" comment="command test «lssrc -s inetd|tail -1|egrep 'active$'»">
                        <ecl:command>lssrc -s inetd|tail -1|egrep 'active$'</ecl:command>
                        <ecl:line-selection op="pm" value=".+"/>
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>
        </xccdf:Rule>
        <xccdf:Rule id="Rule-12.5" role="unscored" selected="false" weight="0.0">
            <xccdf:title>SN.5 Change default greeting string for Sendmail</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>cd /etc/mailawk '/O SmtpGreetingMessage=/ \ { print "O
                        SmtpGreetingMessage=mailer ready"; next} { print }' sendmail.cf
                        &gt;sendmail.cf.newmv sendmail.cf.new sendmail.cf</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>The default SMTP greeting string displays the version of the Sendmail
                        software running on the remote system. Hiding this information is generally
                        considered to be good practice, since it can help attackers target attacks
                        at machines running a vulnerable version of Sendmail. However, the actions
                        in the benchmark document prevent Sendmail from responding on port 25/tcp in
                        most cases, so changing this default greeting string is something of a moot
                        point unless the machine happens to be an email server.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
        </xccdf:Rule>
        <xccdf:Rule id="Rule-12.6" role="unscored" selected="false" weight="0.0">
            <xccdf:title>SN.6 Install and configure sudo </xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action: </xhtml:p>
                    <xhtml:p>Download and install sudo as part of the HP-UX Internet Express package
                        at:</xhtml:p>
                    <xhtml:ol>
                        <xhtml:li>
                            <xhtml:p>(11.23) <xhtml:a href="http://h20293.www2.hp.com/portal/swdepot/displayProductInfo.do?productNumber=HPUXIEXP1123www.gratisoft.us/sudo/download.html">http://h20293.www2.hp.com/portal/swdepot/displayProductInfo.do?productNumber=HPUXIEXP1123</xhtml:a>,
                                or </xhtml:p>
                        </xhtml:li>
                        <xhtml:li>
                            <xhtml:p>(11.11)<xhtml:a href="http://h20293.www2.hp.com/portal/swdepot/displayProductInfo.do?productNumber=HPUXIEXP1111">http://h20293.www2.hp.com/portal/swdepot/displayProductInfo.do?productNumber=HPUXIEXP1111</xhtml:a>
                            </xhtml:p>
                        </xhtml:li>
                        <xhtml:li>
                            <xhtml:p>Older systems can obtain a HP-UX-packaged depot from the HP-UX
                                porting and archive center at <xhtml:a href="http://hpux.cs.utah.edu/">http://hpux.cs.utah.edu</xhtml:a>/.</xhtml:p>
                        </xhtml:li>
                    </xhtml:ol>
                </xhtml:div>
                <xhtml:div>
                    <xccdf:title>Discussion: </xccdf:title>
                    <xhtml:p>sudo is a package that allows the System Administrator to delegate
                        activities to groups of users. These activities may be beyond the
                        administrative capability of that user – restarting the web server, for
                        example. If frequent web server configuration changes are taking place (or
                        you have a bug and the web server keeps crashing), it becomes very
                        cumbersome to continually engage the system administrator just to restart
                        the web server. sudo allows the administrator to delegate just that one task
                        using root authority without allowing that group of users any other root
                        capability. </xhtml:p>
                    <xhtml:p>Once sudo is installed, configure it using visudo – do not vi the
                        config file. visudo has error checking built in. Experience has shown that
                        if /etc/sudoers gets botched (from using vi without visudo's error checking
                        feature), recovery may become very difficult.</xhtml:p>
                    <xhtml:p>System administators may also wish to explore the HP-UX Role Based
                        Authorization system and the “privrun” command that is part of it.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
        </xccdf:Rule>
        <xccdf:Rule id="remove-compilers" role="unscored" selected="false" weight="0.0">
            <xccdf:title>SN.7 Remove Compilers</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xccdf:title>Question: </xccdf:title>
                    <xhtml:p>Is there a mission-critical reason to have a compiler or assembler on
                        this machine?</xhtml:p>
                    <xhtml:p>If the answer is no, perform the action below. </xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p> Action: </xhtml:p>
                    <xhtml:p>swremove aCC gcc</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xccdf:title>Discussion: </xccdf:title>
                    <xhtml:p>Compilers pose a potential threat to production systems and should not
                        be installed. Compilers should be installed on select development systems –
                        those systems that have a Business need for a compiler – and the resulting
                        output binaries deployed onto other development and production systems using
                        the existing Enterprise change processes. </xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11530</xccdf:ident>
        </xccdf:Rule>
        <xccdf:Rule id="uid-0-accounts" role="full" selected="false" weight="1.0">
            <xccdf:title>SN.8 Verify that no UID 0 accounts exist other than root</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action:</xhtml:p>
                    <xhtml:p>The commandlogins -d | grep ' 0 'should return no output.</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xhtml:p class="discussion">Discussion</xhtml:p>
                    <xhtml:p>Any account with UID 0 has superuser privileges on the system. The only
                        superuser account on the machine should be the root account, and it should
                        normally be accessed by logging in as an unprivileged user and using the su
                        command to gain additional privilege. In fact, UID's should not be shared in
                        general. This assertion can be tested with:logins -d</xhtml:p>
                    <xhtml:p>There is the recognized occasional need for direct administrative
                        console access. For these situations, having multiple uid 0 accounts may be
                        used by experienced administrators to provide individually assigned
                        superuser passwords to eliminate or reduce usage of a shared root password,
                        and to increase accountability. However some tools and situations do not
                        always handle multiple uid 0 accounts as expected or desired, therefore
                        testing is required. Specifically most of the GUI X-windows administration
                        tools, if run by a non-privileged user, will prompt for the "root" password.
                        There may be other applications or tools that behave unexpectedly, so
                        testing is required.</xhtml:p>
                    <xhtml:p>Finer granularity access control for administrative access can also be
                        obtained by using the freely-available sudo program as described in SN.6 or
                        the HP Role Based Authorization system also described in SN.6.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
            <xccdf:ident system="http://benchmarks.cisecurity.org/">11440</xccdf:ident>
            <xccdf:check system="http://cisecurity.org/check">
                <!--command test «lsuser -a id ALL | grep "id=0" | egrep -v '^root[[:space:]]+'»-->
                <xccdf:check-content>
                    <ecl:shell-command check="none exist" comment="command test «lsuser -a id ALL | grep &quot;id=0&quot; | egrep -v '^root[[:space:]]+'»">
                        <ecl:command>lsuser -a id ALL | grep "id=0" | egrep -v
                            '^root[[:space:]]+'</ecl:command>
                        <ecl:line-selection op="pm" value="^.+$"/>
                    </ecl:shell-command>
                </xccdf:check-content>
            </xccdf:check>
        </xccdf:Rule>
        <xccdf:Rule id="Rule-12.9" role="unscored" selected="false" weight="0.0">
            <xccdf:title>
                <xccdf:sub idref="bastille-item"/>SN.9 Install and configure IPFilter</xccdf:title>
            <xccdf:description>
                <xhtml:div>
                    <xhtml:p> Action (HP-UX 11i)</xhtml:p>
                    <xhtml:p>1. Download and install IPFilter from http://hp.com/go/ipfilter.
                        Installation instructions are available from that site as well.</xhtml:p>
                    <xhtml:p>2. Edit the Bastille configuration files to allow the desired
                        traffic.</xhtml:p>
                    <xhtml:ol>
                        <xhtml:li>
                            <xhtml:p>If more inbound protocols are needed than SSH, edit the
                                IPFilter questions in the CIS.config file that CIS bundles with this
                                Benchmark to change the appropriate answers from “yes” to
                                “no.”</xhtml:p>
                        </xhtml:li>
                        <xhtml:li>
                            <xhtml:p>You may also need to edit
                                /etc/opt/sec_mgmt/bastille/ipf.customrules to include other custom
                                rules for your environment.</xhtml:p>
                        </xhtml:li>
                    </xhtml:ol>
                    <xhtml:p>3. Run Bastille as indicated in item 1.4</xhtml:p>
                </xhtml:div>
                <xhtml:div>
                    <xccdf:title>Discussion</xccdf:title>
                    <xhtml:p>HP-UX IPFilter (B9901AA) is a stateful system firewall that controls IP
                        packet flow in or out of a machine.</xhtml:p>
                </xhtml:div>
            </xccdf:description>
        </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="Group-13">
        <xccdf:title>Appendix D: References</xccdf:title>
        <xccdf:description>
            <xhtml:p>The Center for Internet Security</xhtml:p>
            <xhtml:p>Free benchmark documents and security tools for various OS platforms and
                applications:</xhtml:p>
            <xhtml:p>
                <xhtml:a href="http://www.cisecurity.org/">http://www.cisecurity.org/</xhtml:a>
            </xhtml:p>
            <xhtml:p>Pre-compiled software packages for various OS platforms:</xhtml:p>
            <xhtml:p>
                <xhtml:a href="ftp://ftp.cisecurity.org/">ftp://ftp.cisecurity.org/</xhtml:a>
            </xhtml:p>
            <xhtml:p>Hewlett-Packard</xhtml:p>
            <xhtml:p>IT Resource Center:</xhtml:p>
            <xhtml:p>
                <xhtml:a href="http://www.itrc.hp.com/">http://www.itrc.hp.com</xhtml:a>
            </xhtml:p>
            <xhtml:p>HP-UX Software Assistant:</xhtml:p>
            <xhtml:p>
                <xhtml:a href="http://www.hp.com:/go/swa">http://www.hp.com:/go/swa</xhtml:a>
            </xhtml:p>
            <xhtml:p>
                <xhtml:a href="http://www.hp.com:/go/swa"/>
            </xhtml:p>
            <xhtml:p>HP-UX Bastille:</xhtml:p>
            <xhtml:p>
                <xhtml:a href="http://www.hp.com/go/bastille">http://www.hp.com/go/bastille</xhtml:a>
            </xhtml:p>
            <xhtml:p>Other HP-UX Security Software (HP-UX Secure Shell, IDS/9000, HP-UX IPFilter,
                etc.):</xhtml:p>
            <xhtml:p>
                <xhtml:a href="http://h20293.www2.hp.com/portal/swdepot/displayProductsList.do?category=ISS">http://h20293.www2.hp.com/portal/swdepot/displayProductsList.do?category=ISS</xhtml:a>
            </xhtml:p>
            <xhtml:p>Other Misc. Documentation</xhtml:p>
            <xhtml:p>Information on NTP – <xhtml:a href="http://www.ntp.org/">http://www.ntp.org/</xhtml:a>
            </xhtml:p>
            <xhtml:p>Information on MIT Kerberos – <xhtml:a href="http://web.mit.edu/kerberos/www/">http://web.mit.edu/kerberos/www/</xhtml:a>
            </xhtml:p>
            <xhtml:p>Apache "Security Tips" document:</xhtml:p>
            <xhtml:p>
                <xhtml:a href="http://httpd.apache.org/docs-2.0/misc/security_tips.html">http://httpd.apache.org/docs-2.0/misc/security_tips.html</xhtml:a>
            </xhtml:p>
            <xhtml:p>Information on Sendmail and DNS:</xhtml:p>
            <xhtml:p>
                <xhtml:a href="http://www.sendmail.org/">http://www.sendmail.org/</xhtml:a>
            </xhtml:p>
            <xhtml:p>
                <xhtml:a href="http://www.deer-run.com/~hal/dns-sendmail/DNSandSendmail.pdf">http://www.deer-run.com/~hal/dns-sendmail/DNSandSendmail.pdf</xhtml:a>
            </xhtml:p>
            <xhtml:p>Software</xhtml:p>
            <xhtml:p>Pre-compiled software packages for HP-UX:</xhtml:p>
            <xhtml:p>
                <xhtml:a href="http://www.software.hp.com/">http://www.software.hp.com/</xhtml:a>
            </xhtml:p>
            <xhtml:p>
                <xhtml:a href="http://hpux.cs.utah.edu/">http://hpux.cs.utah.edu/</xhtml:a>
            </xhtml:p>
            <xhtml:p>OpenSSH (secure encrypted network logins):</xhtml:p>
            <xhtml:p>
                <xhtml:a href="http://www.openssh.org/">www.openssh.org</xhtml:a>
            </xhtml:p>
            <xhtml:p>TCP Wrappers source distribution:</xhtml:p>
            <xhtml:p>
                <xhtml:a href="ftp://ftp.porcupine.org/">ftp.porcupine.org</xhtml:a>
            </xhtml:p>
            <xhtml:p>PortSentry (monitors unused network ports for unauthorized access):</xhtml:p>
            <xhtml:p>
                <xhtml:a href="http://sourceforge.net/projects/sentrytools/">http://sourceforge.net/projects/sentrytools/</xhtml:a>
            </xhtml:p>
            <xhtml:p>Open Source Sendmail (email server) distributions:</xhtml:p>
            <xhtml:p>
                <xhtml:a href="ftp://ftp.sendmail.org/">ftp://ftp.sendmail.org/</xhtml:a>
            </xhtml:p>
            <xhtml:p>LPRng (Open Source replacement printing system for Unix):</xhtml:p>
            <xhtml:p>
                <xhtml:a href="http://www.lprng.org/">http://www.lprng.org/</xhtml:a>
            </xhtml:p>
            <xhtml:p>sudo (provides fine-grained access controls for superuser activity):</xhtml:p>
            <xhtml:p>
                <xhtml:a href="http://www.courtesan.com/sudo/">http://www.courtesan.com/sudo/</xhtml:a>
            </xhtml:p>
        </xccdf:description>
    </xccdf:Group>
<xccdf:signature><ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
<ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
<ds:Reference URI="">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
<ds:DigestValue>7wnuQpK0tbg1CubBHXNeMWP6LuU=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>
0AkRljTCYJP63qj4HxkACzTZjaNFPtEdO/JyiPMhBHd3KOADR0An4UIDdyb//nHk18WAUEYjXdVT
9Amb0KIstuf0h6SC/Ip8aCss3kn+r01nP2jyrE8PjUmn5QW3xExtN3NZKj/E36PbHBP7PXMVAAQE
2b5XTXNUR26ZVEmgev20JEDoe9BOfZZ8n2pgqahAjdoRPrs4v/94ge2v4kS5Nh8noHxrUBfUWjFm
lFsfBv8ouPEToQHx2E5dukqS/AZ5c+zTJf+gPO2500Mozs9lP3rYlCcJuuGOm+ZkFFRzwV0bbbCN
C6IoGsJeJNrJwyD59Nl0WZBB9MfF1KMKSiJmXg==
</ds:SignatureValue>
<ds:KeyInfo>
<ds:X509Data>
<ds:X509Certificate>
MIIFUjCCBDqgAwIBAgIIYySGQYnuNVswDQYJKoZIhvcNAQELBQAwgbQxCzAJBgNVBAYTAlVTMRAw
DgYDVQQIEwdBcml6b25hMRMwEQYDVQQHEwpTY290dHNkYWxlMRowGAYDVQQKExFHb0RhZGR5LmNv
bSwgSW5jLjEtMCsGA1UECxMkaHR0cDovL2NlcnRzLmdvZGFkZHkuY29tL3JlcG9zaXRvcnkvMTMw
MQYDVQQDEypHbyBEYWRkeSBTZWN1cmUgQ2VydGlmaWNhdGUgQXV0aG9yaXR5IC0gRzIwHhcNMTcx
MDIzMTQ1ODAwWhcNMjAxMDIwMTg1NzQ0WjCBkzELMAkGA1UEBhMCVVMxETAPBgNVBAgTCE5ldyBZ
b3JrMRcwFQYDVQQHEw5FYXN0IEdyZWVuYnVzaDErMCkGA1UEChMiQ2VudGVyIGZvciBJbnRlcm5l
dCBTZWN1cml0eSwgSW5jLjErMCkGA1UEAxMiQ2VudGVyIGZvciBJbnRlcm5ldCBTZWN1cml0eSwg
SW5jLjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANDBp4+sl9kB5JRmnQH0wcbLLz/t
n2HoD6TRl3xJj12V61njBNgaiGzvoSl07sFLnESukb0CU44MzYDoUMdx3HJUcEAeMY/9eITqGUnk
N4WsP145eFqH7FoszOY/4NYlgYMYt8ZP2kRHyim9LpQTLT/1mBaUkY2f2e5uUCootH3iT8W3/sK2
flLzWfLgXTvkhJm4Uvw1RErBFs15+krW0KWtnZ6NmiDhmV0CnFGNnd1meGZPs2sBXEVGLJVSKzoT
G9Ht/oWyRLRcJuXpHoXTYpkqM2MsixmSaJy5b6/D35r0NXHru3p1gkX2a0VgJQxxWqLi3bVPzpl3
PlJu3C8M/FUCAwEAAaOCAYUwggGBMAwGA1UdEwEB/wQCMAAwEwYDVR0lBAwwCgYIKwYBBQUHAwMw
DgYDVR0PAQH/BAQDAgeAMDUGA1UdHwQuMCwwKqAooCaGJGh0dHA6Ly9jcmwuZ29kYWRkeS5jb20v
Z2RpZzJzNS0zLmNybDBdBgNVHSAEVjBUMEgGC2CGSAGG/W0BBxcCMDkwNwYIKwYBBQUHAgEWK2h0
dHA6Ly9jZXJ0aWZpY2F0ZXMuZ29kYWRkeS5jb20vcmVwb3NpdG9yeS8wCAYGZ4EMAQQBMHYGCCsG
AQUFBwEBBGowaDAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuZ29kYWRkeS5jb20vMEAGCCsGAQUF
BzAChjRodHRwOi8vY2VydGlmaWNhdGVzLmdvZGFkZHkuY29tL3JlcG9zaXRvcnkvZ2RpZzIuY3J0
MB8GA1UdIwQYMBaAFEDCvSeOzDSDMKIz1/tss/C0LIDOMB0GA1UdDgQWBBT7fOf4ISDprbE+qUFe
+friFTKgHjANBgkqhkiG9w0BAQsFAAOCAQEAs5SDIMcr3jwOwgKipP7NWsWyAO0zfpmHGaU2C/gW
Kz6DZuwhTLPbn015ZlvjRZ27Jd7rjg3WK2Qs9xaRYn2yb1s4mx/NtlVUBsNpL0CDOrdOgt/ZEweI
uoknr5gPlsFPXmsxEQoFb3KKt/Al1YbjcKHhHZ7BtEL3MGnSOAyItdodtLzxFuLOJKpvEk2OOVoW
BgHAteWAvlKd6exCvfWKHipJ5DTC9eM859tpW0xM+f12CycvrkQVI2lyEHMzDFaHkBO0URjhySSu
SkWLBywIIM02d+Ud7bbC60nXfuxIjayeDJLvDxyMJ/bx12X75w1frT1oKTuifL1bmeualQHKXw==
</ds:X509Certificate>
</ds:X509Data>
<ds:KeyValue>
<ds:RSAKeyValue>
<ds:Modulus>
0MGnj6yX2QHklGadAfTBxssvP+2fYegPpNGXfEmPXZXrWeME2BqIbO+hKXTuwUucRK6RvQJTjgzN
gOhQx3HcclRwQB4xj/14hOoZSeQ3haw/Xjl4WofsWizM5j/g1iWBgxi3xk/aREfKKb0ulBMtP/WY
FpSRjZ/Z7m5QKii0feJPxbf+wrZ+UvNZ8uBdO+SEmbhS/DVESsEWzXn6StbQpa2dno2aIOGZXQKc
UY2d3WZ4Zk+zawFcRUYslVIrOhMb0e3+hbJEtFwm5ekehdNimSozYyyLGZJonLlvr8PfmvQ1ceu7
enWCRfZrRWAlDHFaouLdtU/OmXc+Um7cLwz8VQ==
</ds:Modulus>
<ds:Exponent>AQAB</ds:Exponent>
</ds:RSAKeyValue>
</ds:KeyValue>
</ds:KeyInfo>
</ds:Signature></xccdf:signature></xccdf:Benchmark>