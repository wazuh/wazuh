<?xml version="1.0" encoding="UTF-8" standalone="no"?><xccdf:Benchmark xmlns:xccdf="http://checklists.nist.gov/xccdf/1.1" xmlns:cdfp="http://www.cisecurity.org/xccdf/platform/0.2.3" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dsig="http://www.w3.org/2000/09/xmldsig#" xmlns:ecl="http://cisecurity.org/check" xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:oval4="http://oval.mitre.org/XMLSchema/oval" xmlns:xccdf10="http://checklists.nist.gov/xccdf/1.0" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="cis_slackware_linux_10.2_benchmark" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.1 ../misc/xsd/xccdf-1.1.4.xsd http://cisecurity.org/check ../misc/xsd/ecl.xsd">
  <xccdf:status>accepted</xccdf:status>
  <xccdf:title>CIS Slackware 10.2 Linux Benchmark</xccdf:title>
  <xccdf:description>This benchmark was developed and tested onL slackware Linux version 10.2. It is likely to work for older versions of slackware and other Linux distributions as well.</xccdf:description>
  <xccdf:notice id="notice-1"/>
  <xccdf:front-matter>
    <xhtml:p>
      <xhtml:b>Slackware Linux<xhtml:br clear="none"/>Benchmark v1.1</xhtml:b>
    </xhtml:p>
    <xhtml:p>
      <xhtml:b>(for Slackware 10.2)</xhtml:b>
    </xhtml:p>
    <xhtml:p>Copyright 2001-2005, The Center for Internet Security</xhtml:p>
    <xhtml:p>
      <xhtml:a href="http://www.CISecurity.org/" shape="rect">http://www.CISecurity.org/</xhtml:a>
    </xhtml:p>
    <xhtml:p>Slackware Linux Benchmark v1.0</xhtml:p>
    <xhtml:p>October 24, 2005</xhtml:p>
    <xhtml:p>Copyright 2001-2005, The Center for Internet Security (CIS)</xhtml:p>
    <xhtml:p>
      <xhtml:b>TERMS OF USE AGREEMENT</xhtml:b>
    </xhtml:p>
    <xhtml:p>
      <xhtml:b>Background.</xhtml:b>
    </xhtml:p>
    <xhtml:p>The Center for Internet Security ("<xhtml:b>CIS</xhtml:b>") provides benchmarks, scoring tools, software, data,
            information, suggestions, ideas, and other services and materials from the CIS website or elsewhere
            ("<xhtml:b>Products</xhtml:b>") as a public service to Internet users worldwide. Recommendations contained in the Products
                ("<xhtml:b>Recommendations</xhtml:b>") result from a consensus-building process that involves many security experts and are
            generally generic in nature. The Recommendations are intended to provide helpful information to organizations attempting to
            evaluate or improve the security of their networks, systems, and devices. Proper use of the Recommendations requires careful
            analysis and adaptation to specific user requirements. The Recommendations are not in any way intended to be a "quick fix" for
            anyone's information security needs.</xhtml:p>
    <xhtml:p>
      <xhtml:b>No Representations, Warranties, or Covenants.</xhtml:b>
    </xhtml:p>
    <xhtml:p>CIS makes no representations, warranties, or covenants whatsoever as to (i) the positive or negative effect of the Products
            or the Recommendations on the operation or the security of any particular network, computer system, network device, software,
            hardware, or any component of any of the foregoing or (ii) the accuracy, reliability, timeliness, or completeness of the
            Products or the Recommendations. CIS is providing the Products and the Recommendations "as is" and "as available" without
            representations, warranties, or covenants of any kind.</xhtml:p>
    <xhtml:p>
      <xhtml:b>User Agreements.</xhtml:b>
    </xhtml:p>
    <xhtml:p>By using the Products and/or the Recommendations, I and/or my organization ("<xhtml:b>We</xhtml:b>") agree and acknowledge
            that:</xhtml:p>
    <xhtml:ol>
      <xhtml:li>
        <xhtml:p>No network, system, device, hardware, software, or component can be made fully secure;</xhtml:p>
      </xhtml:li>
      <xhtml:li>
        <xhtml:p>We are using the Products and the Recommendations solely at our own risk;</xhtml:p>
      </xhtml:li>
      <xhtml:li>
        <xhtml:p>We are not compensating CIS to assume any liabilities associated with our use of the Products or the
                    Recommendations, even risks that result from CIS's negligence or failure to perform;</xhtml:p>
      </xhtml:li>
      <xhtml:li>
        <xhtml:p>We have the sole responsibility to evaluate the risks and benefits of the Products and Recommendations to us and to
                    adapt the Products and the Recommendations to our particular circumstances and requirements;</xhtml:p>
      </xhtml:li>
      <xhtml:li>
        <xhtml:p>Neither CIS, nor any CIS Party (defined below) has any responsibility to make any corrections, updates, upgrades,
                    or bug fixes; or to notify us of the need for any such corrections, updates, upgrades, or bug fixes; and</xhtml:p>
      </xhtml:li>
      <xhtml:li>
        <xhtml:p>Neither CIS nor any CIS Party has or will have any liability to us whatsoever (whether based in contract, tort,
                    strict liability or otherwise) for any direct, indirect, incidental, consequential, or special damages (including
                    without limitation loss of profits, loss of sales, loss of or damage to reputation, loss of customers, loss of software,
                    data, information or emails, loss of privacy, loss of use of any computer or other equipment, business interruption,
                    wasted management or other staff resources or claims of any kind against us from third parties) arising out of or in any
                    way connected with our use of or our inability to use any of the Products or Recommendations (even if CIS has been
                    advised of the possibility of such damages), including without limitation any liability associated with infringement of
                    intellectual property, defects, bugs, errors, omissions, viruses, worms, backdoors, Trojan horses or other harmful
                    items.</xhtml:p>
      </xhtml:li>
    </xhtml:ol>
    <xhtml:p>
      <xhtml:b>Grant of Limited Rights.</xhtml:b>
    </xhtml:p>
    <xhtml:p>CIS hereby grants each user the following rights, but only so long as the user complies with all of the terms of these
            Agreed Terms of Use:</xhtml:p>
    <xhtml:ol>
      <xhtml:li>
        <xhtml:p>Except to the extent that we may have received additional authorization pursuant to a written agreement with CIS,
                    each user may download, install and use each of the Products on a single computer;</xhtml:p>
      </xhtml:li>
      <xhtml:li>
        <xhtml:p>Each user may print one or more copies of any Product or any component of a Product that is in a .txt, .pdf, .doc,
                    .mcw, or .rtf format, provided that all such copies are printed in full and are kept intact, including without
                    limitation the text of this Agreed Terms of Use in its entirety.</xhtml:p>
      </xhtml:li>
    </xhtml:ol>
    <xhtml:p>
      <xhtml:b>Retention of Intellectual Property Rights; Limitations on Distribution.</xhtml:b>
    </xhtml:p>
    <xhtml:p>The Products are protected by copyright and other intellectual property laws and by international treaties. We acknowledge
            and agree that we are not acquiring title to any intellectual property rights in the Products and that full title and all
            ownership rights to the Products will remain the exclusive property of CIS or CIS Parties. CIS reserves all rights not expressly
            granted to users in the preceding section entitled "Grant of limited rights."</xhtml:p>
    <xhtml:p>Subject to the paragraph entitled "Special Rules" (which includes a waiver, granted to some classes of CIS Members, of
            certain limitations in this paragraph), and except as we may have otherwise agreed in a written agreement with CIS, we agree
            that we will not (i) decompile, disassemble, reverse engineer, or otherwise attempt to derive the source code for any software
            Product that is not already in the form of source code; (ii) distribute, redistribute, encumber, sell, rent, lease, lend,
            sublicense, or otherwise transfer or exploit rights to any Product or any component of a Product; (iii) post any Product or any
            component of a Product on any website, bulletin board, ftp server, newsgroup, or other similar mechanism or device, without
            regard to whether such mechanism or device is internal or external, (iv) remove or alter trademark, logo, copyright or other
            proprietary notices, legends, symbols or labels in any Product or any component of a Product; (v) remove these Agreed Terms of
            Use from, or alter these Agreed Terms of Use as they appear in, any Product or any component of a Product; (vi) use any Product
            or any component of a Product with any derivative works based directly on a Product or any component of a Product; (vii) use any
            Product or any component of a Product with other products or applications that are directly and specifically dependent on such
            Product or any component for any part of their functionality, or (viii) represent or claim a particular level of compliance with
            a CIS Benchmark, scoring tool or other Product. We will not facilitate or otherwise aid other individuals or entities in any of
            the activities listed in this paragraph.</xhtml:p>
    <xhtml:p>We hereby agree to indemnify, defend, and hold CIS and all of its officers, directors, members, contributors, employees,
            authors, developers, agents, affiliates, licensors, information and service providers, software suppliers, hardware suppliers,
            and all other persons who aided CIS in the creation, development, or maintenance of the Products or Recommendations
                ("<xhtml:b>CIS Parties</xhtml:b>") harmless from and against any and all liability, losses, costs, and expenses (including
            attorneys' fees and court costs) incurred by CIS or any CIS Party in connection with any claim arising out of any violation by
            us of the preceding paragraph, including without limitation CIS's right, at our expense, to assume the exclusive defense and
            control of any matter subject to this indemnification, and in such case, we agree to cooperate with CIS in its defense of such
            claim. We further agree that all CIS Parties are third-party beneficiaries of our undertakings in these Agreed Terms of Use.</xhtml:p>
    <xhtml:p>
      <xhtml:b>Special Rules.</xhtml:b>
    </xhtml:p>
    <xhtml:p>The distribution of the NSA Security Recommendations is subject to the terms of the NSA Legal Notice and the terms
            contained in the NSA Security Recommendations themselves (<xhtml:a href="http://nsa2.www.conxion.com/cisco/notice.htm" shape="rect">http://nsa2.www.conxion.com/cisco/notice.htm</xhtml:a>).</xhtml:p>
    <xhtml:p>CIS has created and will from time to time create, special rules for its members and for other persons and organizations
            with which CIS has a written contractual relationship. Those special rules will override and supersede these Agreed Terms of Use
            with respect to the users who are covered by the special rules.</xhtml:p>
    <xhtml:p>CIS hereby grants each CIS Security Consulting or Software Vendor Member and each CIS Organizational User Member, but only
            so long as such Member remains in good standing with CIS and complies with all of the terms of these Agreed Terms of Use, the
            right to distribute the Products and Recommendations within such Member's own organization, whether by manual or electronic
            means. Each such Member acknowledges and agrees that the foregoing grant is subject to the terms of such Member's membership
            arrangement with CIS and may, therefore, be modified or terminated by CIS at any time.</xhtml:p>
    <xhtml:p>
      <xhtml:b>Choice of Law; Jurisdiction; Venue</xhtml:b>
    </xhtml:p>
    <xhtml:p>We acknowledge and agree that these Agreed Terms of Use will be governed by and construed in accordance with the laws of
            the State of Maryland, that any action at law or in equity arising out of or relating to these Agreed Terms of Use shall be
            filed only in the courts located in the State of Maryland, that we hereby consent and submit to the personal jurisdiction of
            such courts for the purposes of litigating any such action. If any of these Agreed Terms of Use shall be determined to be
            unlawful, void, or for any reason unenforceable, then such terms shall be deemed severable and shall not affect the validity and
            enforceability of any remaining provisions.</xhtml:p>
    <xhtml:p>Terms of Use Agreement Version 2.1 – 02/20/04</xhtml:p>
    <xhtml:p>
      <xhtml:b>Table of Contents</xhtml:b>
    </xhtml:p>
    <xhtml:div dir="LTR" id="Section2"/>
    <xhtml:p>
      <xhtml:b>Applicability</xhtml:b>
    </xhtml:p>
    <xhtml:p>This benchmark was developed and tested on Slackware Linux version 10.2. It is likely to work for older versions of
            Slackware and other Linux distributions as well.</xhtml:p>
    <xhtml:p>
      <xhtml:b>Conventions</xhtml:b>
    </xhtml:p>
    <xhtml:p>The following typographical conventions are used in this document:</xhtml:p>
    <xhtml:table border="1" bordercolor="#000000" cellpadding="4" cellspacing="0" width="666">
      <xhtml:col span="1" width="323"/>
      <xhtml:col span="1" width="325"/>
      <xhtml:thead>
        <xhtml:tr>
          <xhtml:td colspan="1" rowspan="1" width="323">
            <xhtml:p>Arial font</xhtml:p>
          </xhtml:td>
          <xhtml:td colspan="1" rowspan="1" width="325">
            <xhtml:p>normal text</xhtml:p>
          </xhtml:td>
        </xhtml:tr>
      </xhtml:thead>
      <xhtml:tbody>
        <xhtml:tr>
          <xhtml:td colspan="1" rowspan="1" width="323">
            <xhtml:p>
              <xhtml:tt>Courier New font</xhtml:tt>
            </xhtml:p>
          </xhtml:td>
          <xhtml:td colspan="1" rowspan="1" width="325">
            <xhtml:p>used to indicate either a command or a standard Unix parameter or a file</xhtml:p>
          </xhtml:td>
        </xhtml:tr>
        <xhtml:tr>
          <xhtml:td colspan="1" rowspan="1" width="323">
            <xhtml:p>Italics</xhtml:p>
          </xhtml:td>
          <xhtml:td colspan="1" rowspan="1" width="325">
            <xhtml:p>used for a question that you must evaluate before continuing</xhtml:p>
          </xhtml:td>
        </xhtml:tr>
      </xhtml:tbody>
    </xhtml:table>
    <xhtml:p/>
    <xhtml:p>
      <xhtml:span style="background: #c0c0c0">
        <xhtml:b>Root Shell Environment Assumed</xhtml:b>
      </xhtml:span>
    </xhtml:p>
    <xhtml:p>The actions listed in this document are written with the assumption that they will be executed by the root user running the
            bash shell and without<xhtml:span class="code">noclobber</xhtml:span>set. Also, the following directories are assumed to be in
            root's path:</xhtml:p>
    <xhtml:p>
      <xhtml:span class="code">/bin:/sbin:/usr/bin:/usr/sbin</xhtml:span>
    </xhtml:p>
    <xhtml:p>
      <xhtml:b>Executing Actions</xhtml:b>
    </xhtml:p>
    <xhtml:p>The actions listed in this document are written with the assumption that they will be executed in the order presented here.
            Some actions may need to be modified if the order is changed. Actions are written so that they may be copied directly from this
            document into a root shell window with a "cut-and-paste" operation.</xhtml:p>
    <xhtml:p>
      <xhtml:b>Reboot Required</xhtml:b>
    </xhtml:p>
    <xhtml:p>Rebooting the system is required after completing all of the actions below in order to complete the re-configuration of the
            system. In many cases, the changes made in the steps below will not take effect until this reboot is performed. If substantial
            operating system updates are performed after the initial OS load, you may have to reboot more than once.</xhtml:p>
    <xhtml:p>
      <xhtml:b>Vulnerabilities</xhtml:b>
    </xhtml:p>
    <xhtml:p>In addition to any specific issues presented by a particular service or protocol,<xhtml:b><xhtml:i>every</xhtml:i></xhtml:b>service has the potential of being an entry point into a system if vulnerability is found. This is why we recommend
            that some services are disabled even though there is no clear way to exploit them, and there has never been a problem with the
            service. If you are running an un-needed service, you could have a problem if a hole is found.</xhtml:p>
    <xhtml:p>
      <xhtml:b>Backup Key Files</xhtml:b>
    </xhtml:p>
    <xhtml:p>Before performing the steps of this benchmark it is strongly recommended that administrators make backup copies of critical
            configuration files that may get modified by various benchmark items. If this step is not performed, then the site may have no
            reasonable back-out strategy for reversing system modifications made as a result of this document. The script provided in
            Appendix B of this document will automatically back up all files that may be modified by the actions below. Note that an
            executable copy of this script is also provided in the archive containing the PDF version of this document and the CIS scoring
            tool. Assuming the administrator is in the directory where the archive has been unpacked, the command to execute the backup
            script would be:</xhtml:p>
    <xhtml:p>
      <xhtml:span class="code">./do-backup.sh</xhtml:span>
    </xhtml:p>
    <xhtml:p>One of the byproducts of the<xhtml:span class="code">do-backup.sh</xhtml:span>script is<xhtml:span class="code">/root/do-restore.sh</xhtml:span>, which is dynamically generated based on the results of the<xhtml:span class="code">do-backup.sh</xhtml:span>script. To roll back the changes performed by this benchmark run<xhtml:span class="code">do-restore.sh</xhtml:span>, and all changes will be backed out. Since not all Linux installations are identical,
                the<xhtml:span class="code">do-restore.sh</xhtml:span>script is created based on the files that actually existed at the
                time<xhtml:span class="code">do-backup.sh</xhtml:span>was run.</xhtml:p>
    <xhtml:p>
      <xhtml:b>Note:</xhtml:b>If you make any changes manually to any of the files that were preserved by<xhtml:span class="code">do-backup.sh</xhtml:span>, those changes will be lost when do-restore.sh is executed. It may be prudent to delete
                the<xhtml:span class="code">do-restore.sh</xhtml:span>script once you have validated the changes to prevent inadvertently
            undoing the changes.</xhtml:p>
    <xhtml:p>
      <xhtml:b>Build Considerations</xhtml:b>
    </xhtml:p>
    <xhtml:p>If you have not done so already, plan out a partitioned hard drive. Slackware does not have a default partitioning, so its
            up to the administrator to setup the system according to his needs.</xhtml:p>
    <xhtml:p>
      <xhtml:span style="background: #ffff00">However, Slackware does have some certain minimums:</xhtml:span>
    </xhtml:p>
    <xhtml:p>
      <xhtml:span class="code">
        <xhtml:span style="background: #ffff00">SWAP – double RAM (but generally not more than 1 GB)</xhtml:span>
      </xhtml:span>
    </xhtml:p>
    <xhtml:p>
      <xhtml:span class="code">
        <xhtml:span style="background: #ffff00">/ -</xhtml:span>
      </xhtml:span>
    </xhtml:p>
    <xhtml:p>
      <xhtml:span class="code">
        <xhtml:span style="background: #ffff00">/home -</xhtml:span>
      </xhtml:span>
    </xhtml:p>
    <xhtml:p>
      <xhtml:span class="code">
        <xhtml:span style="background: #ffff00">/usr -</xhtml:span>
      </xhtml:span>
    </xhtml:p>
    <xhtml:p>
      <xhtml:span class="code">
        <xhtml:span style="background: #ffff00">/var -</xhtml:span>
      </xhtml:span>
    </xhtml:p>
    <xhtml:p>It is important to keep<xhtml:span class="code">/var</xhtml:span>and<xhtml:span class="code">/home</xhtml:span>(and
                possible<xhtml:span class="code">/opt</xhtml:span>) on their own partitions. Some applications have a tendency to crash when
                the<xhtml:span class="code">/</xhtml:span>or<xhtml:span class="code">/usr</xhtml:span>file system reaches 100%. This could
            happen if users were to store considerable amounts of data (developers storing jar files or copies of application logs, for
            example) or logs were to fill up their partition. Some Enterprises define a<xhtml:span class="code">/logs</xhtml:span>partition
            and store application logs there.</xhtml:p>
    <xhtml:p>To limit the inconveniences caused by filling up<xhtml:span class="code">/home</xhtml:span>, consider implementing user and
            group quotas on the<xhtml:span class="code">/home</xhtml:span>file system. Quotas will limit how much a single user (or single
            group) can store on a given file system.</xhtml:p>
    <xhtml:p>
      <xhtml:b>Software Package Removal</xhtml:b>
    </xhtml:p>
    <xhtml:p>There is considerable debate over the maintenance of unused software packages. Some people feel that as long as the
            software is not being used, leaving it installed poses no appreciable risk. Others feel that unused software presents another
            attack vector and increases the maintenance and security patching efforts for the administrators. This Benchmark makes no
            recommendation for the removal of unused software (other than compilers and debuggers in section 8.12). If vulnerable software
            is present on a system, that vulnerability may be exploitable by a local attacker, and the reader is advised to consider the
            effort in either its removal or maintenance and the risks thereof.</xhtml:p>
  </xccdf:front-matter>
  <xccdf:rear-matter>
    <xhtml:div>
      <xhtml:h1>Appendix B - File Backup Script</xhtml:h1>
      <xhtml:p>
        <xhtml:span class="code">#!/bin/bash</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code"># Create /root/do-restore.sh</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">cat &lt;&lt;EOF &gt; /root/do-restore.sh</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">#!/bin/bash</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code"># This script restores the files changed by the CISecurity</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code"># Linux Benchmark do-backup.sh script.</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">unalias rm mv cp</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">sed -n "31,9999p" /root/do-restore.sh | while read LINE; do</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">FILE=\`echo \$LINE | awk '{print \$1}'\`</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">PERMS=\`echo \$LINE | awk '{print \$2}'\`</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">echo "Restoring \$FILE with \$PERMS permissions"</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">[ -f \${FILE}-preCIS ] &amp;&amp; /bin/cp -p \${FILE}-preCIS \${FILE}</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">/bin/chmod \${PERMS} \${FILE}</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">[ -f \${FILE}-preCIS ] &amp;&amp; /bin/rm \${FILE}-preCIS</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">done</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">echo "Completed file restoration - restoring directories"</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">for DIR in \</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">/etc/rc.d /var/spool/cron/crontabs /etc/cron.* /etc/skel</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">do</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">if [ -d \${DIR}-preCIS ]; then</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">echo "Restoring \${DIR}"</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">/bin/cp -pr \${DIR}-preCIS \${DIR}</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">/bin/rm -rf \${DIR}-preCIS</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">fi</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">done</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">exit 0</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">### END OF SCRIPT. DYNAMIC DATA FOLLOWS. ###</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">EOF</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">/bin/chmod 700 /root/do-restore.sh</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">echo "Backing up individual files"</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">for FILE in \</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">/etc/at.allow /etc/at.deny /etc/cron.allow /etc/cron.deny \</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">/etc/csh.login /etc/csh.cshrc /etc/exports /etc/fstab \</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">/etc/ftpaccess /etc/ftpusers /etc/group \</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">/etc/hosts.allow /etc/hosts.deny /etc/hosts.equiv \</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">/etc/inetd.conf /etc/inittab /etc/issue /etc/issue.net \</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">/etc/lilo.conf /etc/limits.conf /etc/login.defs /etc/motd \</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">/etc/passwd /etc/profile /etc/proftpd.conf \</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">/etc/securetty /etc/shadow /etc/suauth /etc/sudoers \</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">/etc/sysctl.conf /etc/syslog.conf \</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">/etc/vsftpd.conf /etc/vsftpd.ftpusers \</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">/etc/X11/xdm/Xresources /etc/X11/xdm/Xservers \</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">/etc/X11/xinit/xserverrc /opt/kde/share/config/kdm/kdmrc \</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">/etc/cups/cupsd.conf \</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">/etc/ssh/ssh_config /etc/ssh/sshd_config \</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">/root/.bash_profile /root/.bashrc /root/.cshrc /root/.tcshrc; do</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">if [ -f ${FILE} ]; then</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code"># Backup file</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">/bin/cp -p ${FILE} ${FILE}-preCIS</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code"># Add it to the do-restore script</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">echo ${FILE} `find ${FILE} -printf "%m"` &gt;&gt; /root/do-restore.sh</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">fi</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">done</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">echo "Completed file backups - backing up directories"</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">for DIR in \</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">/etc/rc.d /var/spool/cron/crontabs /etc/cron.* /etc/skel</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">do</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">echo ${DIR}</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">[ -d ${DIR} ] &amp;&amp; /bin/cp -pr ${DIR} ${DIR}-preCIS</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">done</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">echo "Recording log permissions"</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">find /var/log -printf "%h/%f %m\n" &gt;&gt; /root/do-restore.sh</xhtml:span>
      </xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">echo "Backup complete."</xhtml:span>
      </xhtml:p>
    </xhtml:div>
    <xhtml:div>
      <xhtml:h1>References</xhtml:h1>
      <xhtml:p>The Center for Internet Security</xhtml:p>
      <xhtml:p>Free benchmark documents and security tools for various OS platforms and applications:</xhtml:p>
      <xhtml:p>
        <xhtml:a href="http://www.cisecurity.org/" shape="rect">http://www.cisecurity.org/</xhtml:a>
      </xhtml:p>
      <xhtml:p>Slackware</xhtml:p>
      <xhtml:p>
        <xhtml:a href="http://www.slackware.com/" shape="rect">http://www.slackware.com</xhtml:a>
      </xhtml:p>
      <xhtml:p>Patches and related documentation:</xhtml:p>
      <xhtml:p>
        <xhtml:a href="http://www.slackware.com/security/" shape="rect">http://www.slackware.com/security/</xhtml:a>
      </xhtml:p>
      <xhtml:p>
        <xhtml:a href="ftp://ftp.slackware.com/pub/slackware/slackware-10.2/patches/" shape="rect">
                    ftp://ftp.slackware.com/pub/slackware/slackware-10.2/patches/</xhtml:a>
      </xhtml:p>
      <xhtml:p>Slackware Book:</xhtml:p>
      <xhtml:p>
        <xhtml:a href="http://www.slackbook.org/" shape="rect">http://www.slackbook.org/</xhtml:a>
      </xhtml:p>
      <xhtml:p>
        <xhtml:u>General Slackware:</xhtml:u>
      </xhtml:p>
      <xhtml:p>
        <xhtml:u>http://wiki.linuxquestions.org/wiki/Slackware</xhtml:u>
      </xhtml:p>
      <xhtml:p>
        <xhtml:u>http://wiki.linuxquestions.org/wiki/Slackware-Introduction</xhtml:u>
      </xhtml:p>
      <xhtml:p>
        <xhtml:u>http://slackwiki.org/Main_Page</xhtml:u>
      </xhtml:p>
      <xhtml:p>
        <xhtml:u>Partitioning:</xhtml:u>
      </xhtml:p>
      <xhtml:p>
        <xhtml:u>http://www.ibiblio.org/pub/Linux/docs/HOWTO/other-formats/html_single/Partition.html</xhtml:u>
      </xhtml:p>
      <xhtml:p>
        <xhtml:a href="http://twiki.iwethey.org/Main/NixPartitioning" shape="rect">http://twiki.iwethey.org/Main/NixPartitioning</xhtml:a>
      </xhtml:p>
      <xhtml:p>
        <xhtml:u>A collection of Slackware Howtos:</xhtml:u>
      </xhtml:p>
      <xhtml:p>
        <xhtml:a href="http://www.linuxpackages.net/howto/" shape="rect">http://www.linuxpackages.net/howto/</xhtml:a>
      </xhtml:p>
      <xhtml:p>Other Misc Documentation:</xhtml:p>
      <xhtml:p>Primary source for information on NTP:</xhtml:p>
      <xhtml:p>
        <xhtml:a href="http://www.ntp.org/" shape="rect">http://www.ntp.org/</xhtml:a>
      </xhtml:p>
      <xhtml:p>Information on MIT Kerberos:</xhtml:p>
      <xhtml:p>
        <xhtml:a href="http://web.mit.edu/kerberos/www/" shape="rect">http://web.mit.edu/kerberos/www/</xhtml:a>
      </xhtml:p>
      <xhtml:p>Apache "Security Tips" document:</xhtml:p>
      <xhtml:p>
        <xhtml:a href="http://www.cisecurity.org/bench_apache.html" shape="rect">http://www.cisecurity.org/bench_apache.html</xhtml:a>
      </xhtml:p>
      <xhtml:p>
        <xhtml:a href="http://httpd.apache.org/docs-2.0/misc/security_tips.html" shape="rect">
                    http://httpd.apache.org/docs-2.0/misc/security_tips.html</xhtml:a>
      </xhtml:p>
      <xhtml:p>Information on sendmail and DNS:</xhtml:p>
      <xhtml:p>
        <xhtml:a href="http://www.sendmail.org/" shape="rect">http://www.sendmail.org/</xhtml:a>
      </xhtml:p>
      <xhtml:p>
        <xhtml:a href="http://www.deer-run.com/~hal/dns-sendmail/DNSandSendmail.pdf" shape="rect">
                    http://www.deer-run.com/~hal/dns-sendmail/DNSandSendmail.pdf</xhtml:a>
      </xhtml:p>
      <xhtml:p>OpenSSH (secure encrypted network logins):</xhtml:p>
      <xhtml:p>
        <xhtml:a href="http://www.openssh.org/" shape="rect">http://www.openssh.org</xhtml:a>
      </xhtml:p>
      <xhtml:p>TCP Wrappers source distribution:</xhtml:p>
      <xhtml:p>
        <xhtml:a href="ftp://ftp.porcupine.org/" shape="rect">ftp.porcupine.org</xhtml:a>
      </xhtml:p>
      <xhtml:p>PortSentry and Logcheck (port and log monitoring tools):</xhtml:p>
      <xhtml:p>
        <xhtml:a href="http://sourceforge.net/projects/sentrytools/" shape="rect">http://sourceforge.net/projects/sentrytools/</xhtml:a>
      </xhtml:p>
      <xhtml:p>Swatch (log monitoring tool):</xhtml:p>
      <xhtml:p>
        <xhtml:a href="http://www.oit.ucsb.edu/~eta/swatch/" shape="rect">http://www.oit.ucsb.edu/~eta/swatch/</xhtml:a>
      </xhtml:p>
      <xhtml:p>Open source sendmail (email server) distributions:</xhtml:p>
      <xhtml:p>
        <xhtml:a href="ftp://ftp.sendmail.org/" shape="rect">ftp://ftp.sendmail.org/</xhtml:a>
      </xhtml:p>
      <xhtml:p>LPRng (Open Source replacement printing system for Unix):</xhtml:p>
      <xhtml:p>
        <xhtml:a href="http://www.lprng.org/" shape="rect">http://www.lprng.org/</xhtml:a>
      </xhtml:p>
      <xhtml:p>CUPS (Common UNIX Printing System):</xhtml:p>
      <xhtml:p>
        <xhtml:a href="http://www.cups.org/" shape="rect">http://www.cups.org/</xhtml:a>
      </xhtml:p>
      <xhtml:p>sudo (provides fine-grained access controls for superuser activity):</xhtml:p>
      <xhtml:p>
        <xhtml:a href="http://www.courtesan.com/sudo/" shape="rect">http://www.courtesan.com/sudo/</xhtml:a>
      </xhtml:p>
      <xhtml:p>Tripwire – file modification utility</xhtml:p>
      <xhtml:p>
        <xhtml:a href="http://www.tripwire.org/" shape="rect">http://www.tripwire.org</xhtml:a>
      </xhtml:p>
      <xhtml:p>DoD Warning banner:</xhtml:p>
      <xhtml:p>
        <xhtml:a href="http://www.dss.mil/infoas/dod_warning_banner.doc" shape="rect">http://www.dss.mil/infoas/dod_warning_banner.doc </xhtml:a>
      </xhtml:p>
      <xhtml:p>
        <xhtml:a href="http://www.voled.doded.mil/voled_web/PrivacySecurityDisclaimer.htm" shape="rect">
          <xhtml:span style="text-decoration: none">General Warning banners:</xhtml:span>
        </xhtml:a>
      </xhtml:p>
      <xhtml:p>
        <xhtml:a href="http://www.voled.doded.mil/voled_web/PrivacySecurityDisclaimer.htm" shape="rect">
                    http://www.voled.doded.mil/voled_web/PrivacySecurityDisclaimer.htm</xhtml:a>
      </xhtml:p>
      <xhtml:p>
        <xhtml:a href="http://ciac.llnl.gov/ciac/bulletins/j-043.shtml" shape="rect">http://ciac.llnl.gov/ciac/bulletins/j-043.shtml</xhtml:a>
      </xhtml:p>
    </xhtml:div>
  </xccdf:rear-matter>
  <xccdf:version>1.1.0.2</xccdf:version>
  <xccdf:Profile id="slackware-level-1-profile">
    <xccdf:title>Level 1 Profile</xccdf:title>
    <xccdf:description>
      <xhtml:p>This profile contains all Level 1 configuration items</xhtml:p>
    </xccdf:description>
    <xccdf:select idref="r0103" selected="true"/>
    <xccdf:select idref="r0104" selected="true"/>
    <xccdf:select idref="r0201" selected="true"/>
    <xccdf:select idref="r0202" selected="true"/>
    <xccdf:select idref="r0203" selected="true"/>
    <xccdf:select idref="r0204" selected="true"/>
    <xccdf:select idref="r0205" selected="true"/>
    <xccdf:select idref="r0206" selected="true"/>
    <xccdf:select idref="r0207" selected="true"/>
    <xccdf:select idref="r0208" selected="true"/>
    <xccdf:select idref="r0301" selected="true"/>
    <xccdf:select idref="r0302" selected="true"/>
    <xccdf:select idref="r0303" selected="true"/>
    <xccdf:select idref="r0304" selected="true"/>
    <xccdf:select idref="r0305" selected="true"/>
    <xccdf:select idref="r0306" selected="true"/>
    <xccdf:select idref="r0307" selected="true"/>
    <xccdf:select idref="r0308" selected="true"/>
    <xccdf:select idref="r0309" selected="true"/>
    <xccdf:select idref="r0310" selected="true"/>
    <xccdf:select idref="r0311" selected="true"/>
    <xccdf:select idref="r0312" selected="true"/>
    <xccdf:select idref="r0313" selected="true"/>
    <xccdf:select idref="r0401" selected="true"/>
    <xccdf:select idref="r0402" selected="true"/>
    <xccdf:select idref="r0501" selected="true"/>
    <xccdf:select idref="r0502" selected="true"/>
    <xccdf:select idref="r0503" selected="true"/>
    <xccdf:select idref="r0504" selected="true"/>
    <xccdf:select idref="r0601" selected="true"/>
    <xccdf:select idref="r0602" selected="true"/>
    <xccdf:select idref="r0603" selected="true"/>
    <xccdf:select idref="r0604" selected="true"/>
    <xccdf:select idref="r0605" selected="true"/>
    <xccdf:select idref="r0606" selected="true"/>
    <xccdf:select idref="r0607" selected="true"/>
    <xccdf:select idref="r0608" selected="true"/>
    <xccdf:select idref="r0701" selected="true"/>
    <xccdf:select idref="r0702" selected="true"/>
    <xccdf:select idref="r0703" selected="true"/>
    <xccdf:select idref="r0704" selected="true"/>
    <xccdf:select idref="r0705" selected="true"/>
    <xccdf:select idref="r0706" selected="true"/>
    <xccdf:select idref="r0708" selected="true"/>
    <xccdf:select idref="r0709" selected="true"/>
    <xccdf:select idref="r0711" selected="true"/>
    <xccdf:select idref="r0712" selected="true"/>
    <xccdf:select idref="r0801" selected="true"/>
    <xccdf:select idref="r0802" selected="true"/>
    <xccdf:select idref="r0803" selected="true"/>
    <xccdf:select idref="r0804" selected="true"/>
    <xccdf:select idref="r0805" selected="true"/>
    <xccdf:select idref="r0806" selected="true"/>
    <xccdf:select idref="r0807" selected="true"/>
    <xccdf:select idref="r0808" selected="true"/>
    <xccdf:select idref="r0809" selected="true"/>
    <xccdf:select idref="r0810" selected="true"/>
    <xccdf:select idref="r0811" selected="true"/>
    <xccdf:select idref="r0812" selected="true"/>
    <xccdf:select idref="r0813" selected="true"/>
    <xccdf:select idref="r0901" selected="true"/>
    <xccdf:select idref="r0902" selected="true"/>
    <xccdf:select idref="r0903" selected="true"/>
    <xccdf:select idref="r1101" selected="true"/>
    <xccdf:select idref="rsn1" selected="true"/>
    <xccdf:select idref="rsn2" selected="true"/>
    <xccdf:select idref="rsn3" selected="true"/>
    <xccdf:select idref="rsn4" selected="true"/>
    <xccdf:select idref="rsn5" selected="true"/>
    <xccdf:select idref="rsn6" selected="true"/>
    <xccdf:select idref="rsn8" selected="true"/>
    <xccdf:select idref="r0101" selected="false"/>
    <xccdf:select idref="r0102" selected="false"/>
    <xccdf:select idref="r0707" selected="false"/>
    <xccdf:select idref="r0710" selected="false"/>
    <xccdf:select idref="r0814" selected="false"/>
    <xccdf:select idref="r1001" selected="false"/>
  </xccdf:Profile>
  <xccdf:Profile id="slackware-level-1-profile-with-appendix-recommendations">
    <xccdf:title>Level 1 Profile + Appendix Recommendations</xccdf:title>
    <xccdf:description>
      <xhtml:p>This profile contains all Level 1 configuration items in addition to appendix recommendations</xhtml:p>
    </xccdf:description>
    <xccdf:select idref="r0103" selected="true"/>
    <xccdf:select idref="r0104" selected="true"/>
    <xccdf:select idref="r0201" selected="true"/>
    <xccdf:select idref="r0202" selected="true"/>
    <xccdf:select idref="r0203" selected="true"/>
    <xccdf:select idref="r0204" selected="true"/>
    <xccdf:select idref="r0205" selected="true"/>
    <xccdf:select idref="r0206" selected="true"/>
    <xccdf:select idref="r0207" selected="true"/>
    <xccdf:select idref="r0208" selected="true"/>
    <xccdf:select idref="r0301" selected="true"/>
    <xccdf:select idref="r0302" selected="true"/>
    <xccdf:select idref="r0303" selected="true"/>
    <xccdf:select idref="r0304" selected="true"/>
    <xccdf:select idref="r0305" selected="true"/>
    <xccdf:select idref="r0306" selected="true"/>
    <xccdf:select idref="r0307" selected="true"/>
    <xccdf:select idref="r0308" selected="true"/>
    <xccdf:select idref="r0309" selected="true"/>
    <xccdf:select idref="r0310" selected="true"/>
    <xccdf:select idref="r0311" selected="true"/>
    <xccdf:select idref="r0312" selected="true"/>
    <xccdf:select idref="r0313" selected="true"/>
    <xccdf:select idref="r0401" selected="true"/>
    <xccdf:select idref="r0402" selected="true"/>
    <xccdf:select idref="r0501" selected="true"/>
    <xccdf:select idref="r0502" selected="true"/>
    <xccdf:select idref="r0503" selected="true"/>
    <xccdf:select idref="r0504" selected="true"/>
    <xccdf:select idref="r0601" selected="true"/>
    <xccdf:select idref="r0602" selected="true"/>
    <xccdf:select idref="r0603" selected="true"/>
    <xccdf:select idref="r0604" selected="true"/>
    <xccdf:select idref="r0605" selected="true"/>
    <xccdf:select idref="r0606" selected="true"/>
    <xccdf:select idref="r0607" selected="true"/>
    <xccdf:select idref="r0608" selected="true"/>
    <xccdf:select idref="r0701" selected="true"/>
    <xccdf:select idref="r0702" selected="true"/>
    <xccdf:select idref="r0703" selected="true"/>
    <xccdf:select idref="r0704" selected="true"/>
    <xccdf:select idref="r0705" selected="true"/>
    <xccdf:select idref="r0706" selected="true"/>
    <xccdf:select idref="r0708" selected="true"/>
    <xccdf:select idref="r0709" selected="true"/>
    <xccdf:select idref="r0711" selected="true"/>
    <xccdf:select idref="r0712" selected="true"/>
    <xccdf:select idref="r0801" selected="true"/>
    <xccdf:select idref="r0802" selected="true"/>
    <xccdf:select idref="r0803" selected="true"/>
    <xccdf:select idref="r0804" selected="true"/>
    <xccdf:select idref="r0805" selected="true"/>
    <xccdf:select idref="r0806" selected="true"/>
    <xccdf:select idref="r0807" selected="true"/>
    <xccdf:select idref="r0808" selected="true"/>
    <xccdf:select idref="r0809" selected="true"/>
    <xccdf:select idref="r0810" selected="true"/>
    <xccdf:select idref="r0811" selected="true"/>
    <xccdf:select idref="r0812" selected="true"/>
    <xccdf:select idref="r0813" selected="true"/>
    <xccdf:select idref="r0901" selected="true"/>
    <xccdf:select idref="r0902" selected="true"/>
    <xccdf:select idref="r0903" selected="true"/>
    <xccdf:select idref="r1101" selected="true"/>
    <xccdf:select idref="rsn1" selected="true"/>
    <xccdf:select idref="rsn2" selected="true"/>
    <xccdf:select idref="rsn3" selected="true"/>
    <xccdf:select idref="rsn4" selected="true"/>
    <xccdf:select idref="rsn5" selected="true"/>
    <xccdf:select idref="rsn6" selected="true"/>
    <xccdf:select idref="rsn8" selected="true"/>
    <xccdf:select idref="r0101" selected="false"/>
    <xccdf:select idref="r0102" selected="false"/>
    <xccdf:select idref="r0707" selected="false"/>
    <xccdf:select idref="r0710" selected="false"/>
    <xccdf:select idref="r0814" selected="false"/>
    <xccdf:select idref="r1001" selected="false"/>
  </xccdf:Profile>
  <xccdf:Group id="g01">
    <xccdf:title>Patches, Packages and Initial Lockdown</xccdf:title>
    <xccdf:description>This group specifies how patches should be scheduled, applied and initial lockdown of a new install.</xccdf:description>
    <xccdf:Rule id="r0101" role="unscored" selected="false" weight="0.0">
      <xccdf:title>Apply Latest OS Patches</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>Update system using Slackware package update procedures.</xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>Developing a procedure for keeping up-to-date with package updates is critical for the security and reliability of
                    the system. Vendors issue operating system updates when they become aware of security vulnerabilities and other serious
                    functionality issues, but it is up to their customers to actually download and install these patches.</xhtml:p>
        <xhtml:p>You can receive notice of security updates by joining the Slackware security mailing list on<xhtml:a href="http://www.slackware.com/lists/" shape="rect">http://www.slackware.com/lists/ .</xhtml:a>Security advisories
                    are published at: http://www.slackware.com/security/ .</xhtml:p>
        <xhtml:p>When Slackware publishes an update, they include the procedures with it for updating the package. This usually
                    entails downloading the new packages from the Slackware ftp site. The location is:<xhtml:a href="ftp://ftp.slackware.com/pub/slackware/slackware-10.2/patches/" shape="rect">
                        ftp://ftp.slackware.com/pub/slackware/slackware-10.2/patches/</xhtml:a></xhtml:p>
        <xhtml:p>There will be two directories, packages and source, either compile the source or use<xhtml:span class="code">pkgtool</xhtml:span>to install the patched software. All the applications listed in those directories, have been
                    patched for security vulnerabilities since the distribution release, so make sure you update your system.</xhtml:p>
        <xhtml:p>Some companies make these packages available over an NFS share or an internal anonymous FTP/HTTP server – your
                    company may follow this practice or do something different.</xhtml:p>
        <xhtml:p>It is also important to observe that your applications work properly after updating. Though problems in updated
                    packages are quite rare in Slackware, it is generally recommended that updated packages be deployed to a non-production
                    system first for testing.</xhtml:p>
        <xhtml:p>Some packages may need to be installed before others. The instructions on the Slackware web site will document
                    these needs. You may need to examine the list of updates that you have downloaded to check for any of these cases.</xhtml:p>
        <xhtml:p>Finally, there is some risk to using a non-updated, non-hardened machine to download the updates, as this involves
                    connecting a system with security vulnerabilities on a network, which is not an Industry Best Practice. Please consider
                    these issues carefully.</xhtml:p>
      </xccdf:description>
      <!--            <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                <xccdf:check-content-ref href="slackware-10.2-oval.xml" name="oval:org.cisecurity:def:990101"/>
            </xccdf:check>-->
      <!--<xccdf:check system="http://www.cisecurity.org/xccdf/interactive/0.1">
                <xccdf:check-content-ref href="slackware-10.2-inter.xml" name="qstn-0001"/>
            </xccdf:check>-->
    </xccdf:Rule>
    <xccdf:Rule id="r0102" role="unscored" selected="false" weight="0.0">
      <xccdf:title>Validate Your System Before Making Changes</xccdf:title>
      <xccdf:description>
        <xhtml:p>Ensuring your system is functioning properly before you make a change is a prudent system administration best
                    practice and will save you hours of aggravation. Applying this Benchmark to a system that already has issues makes
                    troubleshooting very difficult and may lead you to believe the Benchmark is at fault.</xhtml:p>
        <xhtml:p>Examine the system and application logs (<xhtml:span class="code">/var/log</xhtml:span>). Key words to look for
                    include, but are not limited to, "<xhtml:span class="code">error</xhtml:span>", "<xhtml:span class="code">warning</xhtml:span>", "<xhtml:span class="code">critical</xhtml:span>", and "<xhtml:span class="code">alert</xhtml:span>".</xhtml:p>
        <xhtml:p>
          <xhtml:i>
            <xhtml:b>Resolve all issues before continuing.</xhtml:b>
          </xhtml:i>
        </xhtml:p>
      </xccdf:description>
      <!--            <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                <xccdf:check-content-ref href="slackware-10.2-oval.xml" name="oval:org.cisecurity:def:990102"/>
            </xccdf:check>-->
      <!--<xccdf:check system="http://www.cisecurity.org/xccdf/interactive/0.1">
                <xccdf:check-content-ref href="slackware-10.2-inter.xml" name="qstn-0002"/>
            </xccdf:check>-->
    </xccdf:Rule>
    <xccdf:Rule id="r0103" role="full" selected="false" weight="1.0">
      <xccdf:title>Configure SSH</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">unalias cp rm mv<xhtml:br clear="none"/>cd /etc/ssh<xhtml:br clear="none"/>cp ssh_config
                            ssh_config.tmp<xhtml:br clear="none"/>awk '/^#? *Protocol/ { print "Protocol 2"; next };<xhtml:br clear="none"/>{ print }' ssh_config.tmp &gt; ssh_config<xhtml:br clear="none"/>if [ "`egrep -l ^Protocol ssh_config`" == ""
                        ]; then<xhtml:br clear="none"/>echo 'Protocol 2' &gt;&gt; ssh_config<xhtml:br clear="none"/>fi<xhtml:br clear="none"/>rm ssh_config.tmp</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">diff ssh_config-preCIS ssh_config</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">cp sshd_config sshd_config.tmp<xhtml:br clear="none"/>awk '/^#? *Protocol/ { print "Protocol
                        2"; next };<xhtml:br clear="none"/>/^#? *X11Forwarding/ \<xhtml:br clear="none"/>{ print "X11Forwarding yes"; next
                            };<xhtml:br clear="none"/>/^#? *IgnoreRhosts/ \<xhtml:br clear="none"/>{ print "IgnoreRhosts yes"; next
                            };<xhtml:br clear="none"/>/^#? *RhostsAuthentication/ \<xhtml:br clear="none"/>{ print " RhostsAuthentication
                        no"; next };<xhtml:br clear="none"/>/^#? *RhostsRSAAuthentication/ \<xhtml:br clear="none"/>{ print
                        "RhostsRSAAuthentication no"; next };<xhtml:br clear="none"/>/^#? *HostbasedAuthentication/ \<xhtml:br clear="none"/>{ print "HostbasedAuthentication no"; next };<xhtml:br clear="none"/>/^#? *PermitRootLogin/ \<xhtml:br clear="none"/>{ print "PermitRootLogin no"; next };<xhtml:br clear="none"/>/^#? *PermitEmptyPasswords/
                            \<xhtml:br clear="none"/>{ print "PermitEmptyPasswords no"; next };<xhtml:br clear="none"/>/^#? *Banner/
                            \<xhtml:br clear="none"/>{ print "Banner /etc/issue.net"; next };<xhtml:br clear="none"/>{print}'
                        sshd_config.tmp &gt; sshd_config<xhtml:br clear="none"/>rm sshd_config.tmp<xhtml:br clear="none"/>diff
                        sshd_config-preCIS sshd_config</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>OpenSSH is a popular free distribution of the standards-track SSH protocols which has become the standard
                    implementation on Linux distributions. For more information on OpenSSH, see<xhtml:a href="http://www.openssh.org/" shape="rect"> http://www.openssh.org</xhtml:a>.</xhtml:p>
        <xhtml:p>The settings in this section attempt to ensure safe defaults for both the client and the server. Specifically, both
                    the ssh client and the sshd server are configured to use only SSH protocol 2, as security vulnerabilities have been
                    found in the first SSH protocol. This may cause compatibility issues at sites still using the vulnerable SSH protocol 1
                    these sites should endeavor to configure all systems to use only SSH protocol 2.</xhtml:p>
        <xhtml:p>Note that a banner is added in the<xhtml:span class="code">sshd_config</xhtml:span>file – we will create this
                    banner later and it is discussed in detail in section 9. If you choose not to implement a banner, you will have to
                    remove the reference to<xhtml:span class="code">/etc/issue</xhtml:span>from<xhtml:span class="code">sshd_config</xhtml:span>manually. Please read the section on the legal use of banners before deciding to remove
                it.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/ssh/ssh_config Protocol 2-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="command test «egrep '^Protocol[[:space:]]+2[[:space:]]*$' /etc/ssh/ssh_config»" success="pass">
              <ecl:command>egrep '^Protocol[[:space:]]+2[[:space:]]*$' /etc/ssh/ssh_config</ecl:command>
              <ecl:line-selection op="pm" value="^.*$"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/ssh/sshd_config Protocol 2-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="command test «egrep '^Protocol[[:space:]]+2[[:space:]]*$' /etc/ssh/sshd_config»" success="pass">
              <ecl:command>egrep '^Protocol[[:space:]]+2[[:space:]]*$' /etc/ssh/sshd_config</ecl:command>
              <ecl:line-selection op="pm" value="^.*$"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/ssh/sshd_config X11Forwarding yes-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="command test «egrep '^X11Forwarding[[:space:]]+yes[[:space:]]*$' /etc/ssh/sshd_config»" success="pass">
              <ecl:command>egrep '^X11Forwarding[[:space:]]+yes[[:space:]]*$' /etc/ssh/sshd_config</ecl:command>
              <ecl:line-selection op="pm" value="^.*$"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/ssh/sshd_config IgnoreRhosts yes-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="command test «egrep '^IgnoreRhosts[[:space:]]+yes[[:space:]]*$' /etc/ssh/sshd_config»" success="pass">
              <ecl:command>egrep '^IgnoreRhosts[[:space:]]+yes[[:space:]]*$' /etc/ssh/sshd_config</ecl:command>
              <ecl:line-selection op="pm" value="^.*$"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/ssh/sshd_config HostbasedAuthentication no-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="command test «egrep '^HostbasedAuthentication[[:space:]]+no[[:space:]]*$' /etc/ssh/sshd_config»" success="pass">
              <ecl:command>egrep '^HostbasedAuthentication[[:space:]]+no[[:space:]]*$' /etc/ssh/sshd_config</ecl:command>
              <ecl:line-selection op="pm" value="^.*$"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/ssh/sshd_config RhostsAuthentication no-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="command test «egrep '^RhostsAuthentication[[:space:]]+no[[:space:]]*$' /etc/ssh/sshd_config»" success="pass">
              <ecl:command>egrep '^RhostsAuthentication[[:space:]]+no[[:space:]]*$' /etc/ssh/sshd_config</ecl:command>
              <ecl:line-selection op="pm" value="^.*$"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/ssh/sshd_config RhostsRSAAuthentication no-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="command test «egrep '^RhostsRSAAuthentication[[:space:]]+no[[:space:]]*$' /etc/ssh/sshd_config»" success="pass">
              <ecl:command>egrep '^RhostsRSAAuthentication[[:space:]]+no[[:space:]]*$' /etc/ssh/sshd_config</ecl:command>
              <ecl:line-selection op="pm" value="^.*$"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/ssh/sshd_config PermitRootLogin no-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="command test «egrep '^PermitRootLogin[[:space:]]+no[[:space:]]*$' /etc/ssh/sshd_config»" success="pass">
              <ecl:command>egrep '^PermitRootLogin[[:space:]]+no[[:space:]]*$' /etc/ssh/sshd_config</ecl:command>
              <ecl:line-selection op="pm" value="^.*$"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/ssh/sshd_config PermitEmptyPasswords no-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="command test «egrep '^PermitEmptyPasswords[[:space:]]+no[[:space:]]*$' /etc/ssh/sshd_config»" success="pass">
              <ecl:command>egrep '^PermitEmptyPasswords[[:space:]]+no[[:space:]]*$' /etc/ssh/sshd_config</ecl:command>
              <ecl:line-selection op="pm" value="^.*$"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/ssh/sshd_config Banner /etc/issue.net-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="command test «egrep '^Banner[[:space:]]+/etc/issue\.net[[:space:]]*$' /etc/ssh/sshd_config»" success="pass">
              <ecl:command>egrep '^Banner[[:space:]]+/etc/issue\.net[[:space:]]*$' /etc/ssh/sshd_config</ecl:command>
              <ecl:line-selection op="pm" value="^.*$"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0104" role="full" selected="false" weight="1.0">
      <xccdf:title>Enable System Accounting</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>Install package<xhtml:span class="code">sysstat</xhtml:span>.</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">cd /usr/src</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">tar xvzf sysstat-6.0.1.tgz</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">cd sysstat-6.0.1</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">make</xhtml:span>
          <xhtml:span class="code">config</xhtml:span>– the defaults are okay to use</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">make</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">make</xhtml:span>
          <xhtml:span class="code">install</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">systat</xhtml:span>provides a file named<xhtml:span class="code">crontab</xhtml:span>which is
                    then added to root's cron jobs.</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">crontab -l &gt; cron.temp</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">cat crontab &gt;&gt; cron.temp</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">crontab cron.temp</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:b>Note:</xhtml:b>You may want to edit the cron jobs and fine tune the way sysstat works, and change the
                    reporting, use<xhtml:span class="code">man sar</xhtml:span>for more information.</xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>
          <xhtml:b>Note:</xhtml:b>Slackware does not include<xhtml:span class="code">sysstat</xhtml:span>. It is not available on
                    the Slackware packages web site<xhtml:a href="http://www.linuxpackages.net/" shape="rect">www.linuxpackages.net</xhtml:a>. You will need to get it from the sysstat home page (<xhtml:a href="http://perso.wanadoo.fr/sebastien.godard/" shape="rect"> http://perso.wanadoo.fr/sebastien.godard/</xhtml:a>)
                    , compile and install it manually.</xhtml:p>
        <xhtml:p>System accounting gathers baseline system data (CPU utilization, disk I/O, etc.) every 10 minutes. The data may be
                    accessed with the<xhtml:span class="code">sar</xhtml:span>command, or by reviewing the nightly report files
                        named<xhtml:span class="code">/var/log/sa/sar*</xhtml:span>. Once a normal baseline for the system has been
                    established, unauthorized activity (password crackers and other CPU-intensive jobs, and activity outside of normal usage
                    hours) may be detected due to departures from the normal system performance curve. Note that this data is only archived
                    for one week before being automatically removed by the regular nightly cron job. Administrators may wish to archive
                        the<xhtml:span class="code">/var/log/sa/</xhtml:span>directory on a regular basis to preserve this data for longer
                    periods.</xhtml:p>
      </xccdf:description>
      <xccdf:check system="http://cisecurity.org/check">
        <!--Package «sysstat» is installed-->
        <xccdf:check-content>
          <ecl:shell-command check="all" comment="Package «sysstat» is installed">
            <ecl:command>(cd /var/log/packages;ls|sed -r 's/-[^-]+-(i.86|noarch)-.+$//')|egrep '^sysstat$'</ecl:command>
            <ecl:line-selection op="pm" value=".+"/>
          </ecl:shell-command>
        </xccdf:check-content>
      </xccdf:check>
    </xccdf:Rule>
  </xccdf:Group>
  <xccdf:Group id="g02">
    <xccdf:title>Minimize inetd network services</xccdf:title>
    <xccdf:description>
      <xhtml:p>You will need to<xhtml:span class="code">unalias</xhtml:span>the<xhtml:span class="code">mv</xhtml:span>and<xhtml:span class="code">cp</xhtml:span> commands as some commands overwrite files and you may be prompted numerous times about
                overwriting these files:</xhtml:p>
      <xhtml:p>
        <xhtml:span class="code">unalias mv cp</xhtml:span>
      </xhtml:p>
    </xccdf:description>
    <xccdf:Rule id="r0201" role="full" selected="false" weight="1.0">
      <xccdf:title>Disable Standard Services</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">cp /etc/inetd.conf /etc/inetd.conf.original</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">sed \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(echo\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(discard\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(daytime\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(chargen\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(time\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(ftp\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(telnet\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(comsat\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(shell\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(login\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(exec\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(talk\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(ntalk\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(klogin\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(eklogin\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(kshell\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(krbupdate\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(kpasswd\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(pop\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(imap\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(uucp\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(tftp\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(bootps\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(finger\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(systat\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(netstat\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(auth\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(netbios\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(swat\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(rstatd\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(rusersd\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\(walld\)/\#\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/etc/inetd.conf &gt; /etc/inetd.conf.temp</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">mv -f /etc/inetd.conf.temp /etc/inetd.conf</xhtml:span>
        </xhtml:p>
        <xhtml:p>For these changes to take effect, you should either reboot, or</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">killall -s HUP inetd</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>Although other distributions have moved to using<xhtml:span class="code">xinetd</xhtml:span>as the default network
                    supervisor, Slackware Linux continues to use<xhtml:span class="code">inetd</xhtml:span>.</xhtml:p>
        <xhtml:p>The stock<xhtml:span class="code">inetd</xhtml:span>configuration has improved considerably. However many services
                    which were either rarely-used or for which there were more secure alternatives. After enabling SSH, it is possible to
                    nearly do away with all <xhtml:span class="code">inetd</xhtml:span>-based services, since SSH provides both a secure
                    login mechanism and a means of transferring files to and from the system. The actions above will disable all standard
                    services normally enabled in the Slackware configuration file<xhtml:span class="code">/etc/inetd.conf</xhtml:span>.</xhtml:p>
        <xhtml:p>The rest of the actions in this section give the administrator the option of re-enabling certain services. Rather
                    than disabling and then re-enabling these services, experienced administrators may wish to simply disable only those
                    services that they know are unnecessary for their systems. If there is any doubt, it is better to disable everything,
                    then re-enable the necessary services based on the function of the server.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:complex-check operator="OR">
          <!--Service «auth» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «auth» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «auth» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}auth"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «auth» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «auth» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}auth"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «bootps» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «bootps» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «bootps» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}bootps"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «bootps» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «bootps» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}bootps"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «chargen» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «chargen» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «chargen» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}chargen"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «chargen» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «chargen» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}chargen"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «comsat» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «comsat» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «comsat» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}comsat"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «comsat» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «comsat» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}comsat"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «daytime» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «daytime» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «daytime» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}daytime"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «daytime» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «daytime» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}daytime"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «discard» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «discard» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «discard» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}discard"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «discard» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «discard» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}discard"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «echo» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «echo» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «echo» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}echo"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «echo» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «echo» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}echo"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «eklogin» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «eklogin» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «eklogin» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}eklogin"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «eklogin» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «eklogin» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}eklogin"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «exec» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «exec» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «exec» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}exec"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «exec» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «exec» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}exec"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «finger» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «finger» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «finger» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}finger"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «finger» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «finger» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}finger"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «ftp» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «ftp» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «ftp» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}ftp"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «ftp» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «ftp» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}ftp"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «imap» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «imap» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «imap» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}imap"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «imap» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «imap» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}imap"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «klogin» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «klogin» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «klogin» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}klogin"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «klogin» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «klogin» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}klogin"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «kpasswd» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «kpasswd» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «kpasswd» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}kpasswd"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «kpasswd» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «kpasswd» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}kpasswd"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «krbupdate» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «krbupdate» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «krbupdate» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}krbupdate"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «krbupdate» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «krbupdate» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}krbupdate"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «kshell» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «kshell» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «kshell» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}kshell"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «kshell» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «kshell» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}kshell"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «login» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «login» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «login» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}login"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «login» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «login» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}login"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «netbios» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «netbios» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «netbios» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}netbios"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «netbios» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «netbios» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}netbios"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «netstat» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «netstat» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «netstat» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}netstat"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «netstat» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «netstat» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}netstat"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «ntal» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «ntal» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «ntal» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}ntal"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «ntal» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «ntal» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}ntal"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «pop» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «pop» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «pop» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}pop"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «pop» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «pop» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}pop"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «rstatd» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «rstatd» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «rstatd» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}rstatd"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «rstatd» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «rstatd» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}rstatd"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «rusersd» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «rusersd» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «rusersd» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}rusersd"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «rusersd» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «rusersd» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}rusersd"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «shell» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «shell» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «shell» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}shell"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «shell» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «shell» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}shell"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «swat» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «swat» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «swat» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}swat"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «swat» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «swat» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}swat"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «s» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «s» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «s» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}s"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «s» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «s» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}s"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «talk» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «talk» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «talk» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}talk"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «talk» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «talk» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}talk"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «telnet» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «telnet» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «telnet» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}telnet"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «telnet» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «telnet» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}telnet"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «tftp» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «tftp» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «tftp» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}tftp"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «tftp» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «tftp» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}tftp"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «time» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «time» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «time» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}time"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «time» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «time» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}time"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «uucp» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «uucp» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «uucp» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}uucp"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «uucp» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «uucp» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}uucp"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «walld» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «walld» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «walld» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}walld"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «walld» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «walld» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}walld"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0202" role="full" selected="false" weight="1.0">
      <xccdf:title>Configure TCP Wrappers and Firewall to Limit Access</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="question">Question:</xhtml:h3>
        <xhtml:p>Is there a reason to allow unlimited network access to this server?</xhtml:p>
        <xhtml:p>If the answer to this question is no, then perform the action below.</xhtml:p>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:b>Note:</xhtml:b>Do not deny access to your system without allowing access. Complete both parts of this section.</xhtml:p>
        <xhtml:p>
          <xhtml:u>TCP Wrappers</xhtml:u>
        </xhtml:p>
        <xhtml:p>Deny access to this server from all networks:</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">echo "ALL: ALL" &gt; /etc/hosts.deny</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">diff /etc/hosts.deny-preCIS /etc/hosts.deny</xhtml:span>
        </xhtml:p>
        <xhtml:p>To allow access from the authorized networks, refer to the<xhtml:span class="code">hosts.allow</xhtml:span>man page
                    and enter the service and the network in<xhtml:span class="code">/etc/hosts.allow</xhtml:span>. At a minimum, you need
                    to allow<xhtml:span class="code">localhost</xhtml:span>traffic. The following script will create a sample<xhtml:span class="code">hosts.allow</xhtml:span>file that will allow access to the locally connected networks:</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">printf "ALL: localhost" &gt; /etc/hosts.allow</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">for I in `ifconfig | grep "inet addr" | cut -f2 -d: | cut \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-f1-3 -d"." | grep -v ^127 | sort -n`; do</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">printf ", $I." &gt;&gt; /etc/hosts.allow;</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">done</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">echo &gt;&gt; /etc/hosts.allow</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">diff /etc/hosts.allow-preCIS /etc/hosts.allow</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:b>Note:</xhtml:b>The above script intentionally ignores IPv6 networks.</xhtml:p>
        <xhtml:p>
          <xhtml:b>Note:</xhtml:b>The above script assumes a netmask of 255.255.255.0. If yours is different, you will have to
                        adjust<xhtml:span class="code">/etc/hosts.allow</xhtml:span>for your environment.</xhtml:p>
        <xhtml:p>You should review the resulting<xhtml:span class="code">/etc/hosts.allow</xhtml:span>to ensure it meets your needs.
                    Test your configuration now by logging in remotely.</xhtml:p>
        <xhtml:p>
          <xhtml:u>Firewall</xhtml:u>
        </xhtml:p>
        <xhtml:p>See discussion.</xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>TCP Wrappers (<xhtml:span class="code">tcpd</xhtml:span>) and Host-Based Firewalls (<xhtml:span class="code">iptables</xhtml:span>) are presented together as they are similar and complementary in functionality.</xhtml:p>
        <xhtml:p>TCP Wrappers</xhtml:p>
        <xhtml:p>By limiting access to the server, you reduce your exposure to threats from attackers on remote systems. For
                    Internet-connected servers that provide service to the whole Internet, limiting access may not make sense. Intranet
                    servers, limited-access servers, and workstations should limit access to only authorized networks.</xhtml:p>
        <xhtml:p>Many daemons (SSH for example) are compiled with TCP Wrapper support, so you can use<xhtml:span class="code">/etc/hosts.allow</xhtml:span>and<xhtml:span class="code">/etc/hosts.deny</xhtml:span>to limit SSH access to your
                    systems. The portmap daemon also uses TCP wrappers and there is a specific note to this effect in the default TCP
                    wrappers config files.</xhtml:p>
        <xhtml:p>It is important to note that TCP wrappers looks at<xhtml:span class="code">hosts.allow</xhtml:span>first,
                        then<xhtml:span class="code">hosts.deny</xhtml:span>, and controls access based on the first match. If you omit
                    entries in<xhtml:span class="code">hosts.allow</xhtml:span>and deny access to ALL in<xhtml:span class="code">hosts.deny</xhtml:span>, you will block network access to all network clients.</xhtml:p>
        <xhtml:p>The TCP Wrapper tools included in Slackware are:</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">tcpd</xhtml:span>- access control facility for internet services (the TCP Wrapper daemon)</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">tcpdchk</xhtml:span>- tcp wrapper configuration checker</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">tcpdmatch</xhtml:span>- predicts how the tcp wrapper would handle a specific request for
                    service.</xhtml:p>
        <xhtml:p>Host-Based Firewalls</xhtml:p>
        <xhtml:p>Host-based firewalls (also known as personal firewalls) have the following benefits:</xhtml:p>
        <xhtml:ul>
          <xhtml:li>
            <xhtml:p>Protection from compromised systems on the local network;</xhtml:p>
          </xhtml:li>
          <xhtml:li>
            <xhtml:p>Defense in depth where an attacker must overcome both the border firewall and the host-based firewall to
                            attack a system;</xhtml:p>
          </xhtml:li>
          <xhtml:li>
            <xhtml:p>Extremely fine tuned control over what systems may or may not access the system.</xhtml:p>
          </xhtml:li>
        </xhtml:ul>
        <xhtml:p>The Center for Internet Security recommends installing a host-based firewall on workstations, and suggests
                    end-users consider installing them on servers as well.</xhtml:p>
        <xhtml:p>Workstations are defined as Linux systems that offer no services to any external network or system. For example, a
                    workstation that is running Apache and serving up content to the local network segment is not a workstation.</xhtml:p>
        <xhtml:p>Host-based firewalls are available in<xhtml:span class="code">iptables</xhtml:span>(installed by default, but not
                    activated) or via commercial offerings. The Center for Internet Security makes no recommendations for a vendor or even a
                    specific firewall configuration as firewalls are very complex systems. Entire books have been written on<xhtml:span class="code">iptables</xhtml:span> and are outside the scope of this benchmark.</xhtml:p>
        <xhtml:p>The default Slackware<xhtml:span class="code">iptables</xhtml:span>configuration is suitable for workstations and
                    are good starting points for servers. The Center for Internet Security does recommend using a tool (graphical- or
                    text-based) to configure the firewall as manual rule configuration is extremely error-prone and you may end up with a
                    false sense of security and have less secure system.</xhtml:p>
        <xhtml:p>See the following<xhtml:span class="code">iptables</xhtml:span>resources to learn how to activate and build the
                    rules for the firewall:</xhtml:p>
        <xhtml:p>Web-Based</xhtml:p>
        <xhtml:ul>
          <xhtml:li>
            <xhtml:p>Easy Firewall Generator for IPTables -<xhtml:a href="http://linux-firewall-tools.com/linux/firewall/index.html" shape="rect">http://easyfwgen.morizot.net/</xhtml:a></xhtml:p>
          </xhtml:li>
        </xhtml:ul>
        <xhtml:p>Package-Based</xhtml:p>
        <xhtml:ul>
          <xhtml:li>
            <xhtml:p>FireHOL -<xhtml:a href="http://firehol.sourceforge.net/" shape="rect">http://firehol.sourceforge.net/</xhtml:a></xhtml:p>
          </xhtml:li>
          <xhtml:li>
            <xhtml:p>Firewall Builder -<xhtml:a href="http://sourceforge.net/projects/fwbuilder/" shape="rect">
                                http://sourceforge.net/projects/fwbuilder/</xhtml:a></xhtml:p>
          </xhtml:li>
          <xhtml:li>
            <xhtml:p>
              <xhtml:span style="text-decoration: none">GuardDog -</xhtml:span>
              <xhtml:a href="http://www.simonzone.com/software/guarddog/" shape="rect">http://www.simonzone.com/software/guarddog/</xhtml:a>
            </xhtml:p>
          </xhtml:li>
          <xhtml:li>
            <xhtml:p>
              <xhtml:span style="text-decoration: none">Firestarter -</xhtml:span>
              <xhtml:u>http://www.fs-security.com/</xhtml:u>
            </xhtml:p>
          </xhtml:li>
        </xhtml:ul>
        <xhtml:p>
          <xhtml:b>Note:</xhtml:b>Inclusion of a tool on this list is not an endorsement or recommendation by the Center for
                    Internet Security. </xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/hosts.deny ALL:ALL-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="command test «egrep '^ALL[[:space:]]*:[[:space:]]*ALL$' /etc/hosts.deny»" success="pass">
              <ecl:command>egrep '^ALL[[:space:]]*:[[:space:]]*ALL$' /etc/hosts.deny</ecl:command>
              <ecl:line-selection op="pm" value="^.*$"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/hosts.allow ALL: localhost-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="command test «egrep '^ALL[[:space:]]*:[[:space:]]*localhost.*$' /etc/hosts.allow»" success="pass">
              <ecl:command>egrep '^ALL[[:space:]]*:[[:space:]]*localhost.*$' /etc/hosts.allow</ecl:command>
              <ecl:line-selection op="pm" value="^.*$"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0203" role="full" selected="false" weight="1.0">
      <xccdf:title>Only Enable telnet If Absolutely Necessary</xccdf:title>
      <xccdf:description>
        <xhtml:p/>
        <xhtml:h3 class="question">Question:</xhtml:h3>
        <xhtml:p>Is there a mission-critical reason that requires users to access this system via telnet, rather than the more
                    secure SSH protocol?</xhtml:p>
        <xhtml:p>If the answer to this question is yes, proceed with the actions below.</xhtml:p>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">sed -e 's/^\#[ \t]*\(telnet\)/\1/' /etc/inetd.conf &gt; /etc/inetd.conf.temp</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">mv -f /etc/inetd.conf.temp /etc/inetd.conf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">killall -s HUP inetd</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">telnet</xhtml:span>uses an unencrypted network protocol, which means data from the login
                    session (such as passwords and all other data transmitted during the session) can be stolen by eavesdroppers on the
                    network, and also that the session can be hijacked by outsiders to gain access to the remote system. The
                    freely-available SSH utilities that ship with Slackware Linux (see<xhtml:a href="http://www.openssh.com/" shape="rect">http://www.openssh.com/</xhtml:a>) provide encrypted network logins and should be used instead.</xhtml:p>
        <xhtml:p>To aid in the migration to SSH, there is a freely available SSH client for Windows called PuTTY, which is available
                    from Simon Tatham (see<xhtml:a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/" shape="rect">http://www.chiark.greenend.org.uk/~sgtatham/putty/</xhtml:a>). Note that PuTTY does not use the OpenSSL
                    cryptographic library. Other SSH implementations for Windows can be found here:<xhtml:a href="http://www.openssh.com/windows.html" shape="rect">http://www.openssh.com/windows.html</xhtml:a><xhtml:span style="text-decoration: none"><xhtml:a href="http://www.openssh.com/windows.html" shape="rect"/></xhtml:span><xhtml:span style="text-decoration: none">There</xhtml:span>are numerous commercially supported SSH clients as well –
                    check to see if your Enterprise already has an Enterprise SSH client.</xhtml:p>
        <xhtml:p>Some enterprises are using telnet over SSL, however, the simpler and more standard solution is to use SSH.
                    Configuring telnet over SSL is beyond the scope of a Level 1 Benchmark and will not be addressed here.</xhtml:p>
        <xhtml:p>It is understood that large enterprises deeply entrenched in using telnet may take considerable effort in migrating
                    from <xhtml:span class="code">telnet</xhtml:span>to<xhtml:span class="code">ssh</xhtml:span>, so<xhtml:span class="code">telnet</xhtml:span>may have to be enabled.</xhtml:p>
        <xhtml:p>When it can be disabled, run:</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">sed -e 's/^\(telnet\)/\#\1/' /etc/inetd.conf &gt; \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/etc/inetd.conf.temp</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">mv -f /etc/inetd.conf.temp /etc/inetd.conf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">killall -s HUP inetd</xhtml:span>
        </xhtml:p>
        <xhtml:p>off to turn it off again.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="OR">
        <!--Service «telnet» does not exist or is disabled-->
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «telnet» does not exist-->
          <xccdf:check-content>
            <ecl:file-content check="none exist" comment="Service «telnet» does not exist">
              <ecl:path>/etc/inetd.conf</ecl:path>
              <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}telnet"/>
            </ecl:file-content>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «telnet» is «off»-->
          <xccdf:check-content>
            <ecl:file-content check="all" comment="Service «telnet» is «off»">
              <ecl:path>/etc/inetd.conf</ecl:path>
              <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}telnet"/>
            </ecl:file-content>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0204" role="full" selected="false" weight="1.0">
      <xccdf:title>Only Enable FTP If Absolutely Necessary</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="question">Question:</xhtml:h3>
        <xhtml:p>Is this machine an (anonymous) FTP server, or is there a mission-critical reason why data must be transferred to
                    and from this system via an<xhtml:span class="code">ftp</xhtml:span>server, rather than<xhtml:span class="code">sftp</xhtml:span>or<xhtml:span class="code">scp</xhtml:span>?</xhtml:p>
        <xhtml:p>If the answer to this question is yes, proceed with the actions below.</xhtml:p>
        <xhtml:p>
          <xhtml:b>Action</xhtml:b>
        </xhtml:p>
        <xhtml:p>To use PROFTP (Professional File Transfer), run:</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">sed -e '/proftpd/s/^\#[ \t]*\(ftp\)/\1/' /etc/inetd.conf &gt;\</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/etc/inetd.conf.temp</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">mv -f /etc/inetd.conf.temp /etc/inetd.conf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">killall -s HUP inetd</xhtml:span>
        </xhtml:p>
        <xhtml:p>or</xhtml:p>
        <xhtml:p>To use VSFTP (Very Secure File Transfer), run:</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">sed -e '/vsftpd/s/^\#[ \t]*\(ftp\)/\1/' /etc/inetd.conf &gt;
                    /etc/inetd.conf.temp</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">mv -f /etc/inetd.conf.temp /etc/inetd.conf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">killall -s HUP inetd</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>Slackware comes with two ftp servers –<xhtml:span class="code">vsftpd</xhtml:span>(Very Secure File Transfer
                    Protocol) and<xhtml:span class="code">proftpd</xhtml:span>(Professional File Transfer Protocol).</xhtml:p>
        <xhtml:p>Like<xhtml:span class="code">telnet</xhtml:span>, the FTP protocol is unencrypted, which means passwords and other
                    data transmitted during the session can be captured by sniffing the network, and that the FTP session itself can be
                    hijacked by an external attacker. SSH provides two different encrypted file transfer mechanisms –<xhtml:span class="code">scp</xhtml:span>and<xhtml:span class="code">sftp</xhtml:span>– and should be used instead. Even if FTP
                    is required because the local system is an anonymous FTP server, consider requiring non-anonymous users on the system to
                    transfer files via SSH-based protocols. For further information on restricting FTP access to the system, see section 7.2
                    below.</xhtml:p>
        <xhtml:p>
          <xhtml:b>Note:</xhtml:b>Any directory writable by an anonymous FTP server should have its own partition. This helps
                    prevent an FTP server from filling a hard drive used by other services.</xhtml:p>
        <xhtml:p>To aid in the migration away from FTP, there are a number of freely available<xhtml:span class="code">scp</xhtml:span>and<xhtml:span class="code">sftp</xhtml:span>client for Windows, such as WinSCP (available
                        from<xhtml:a href="http://winscp.sourceforge.net/eng/index.php" shape="rect">http://winscp.sourceforge.net/eng/index.php</xhtml:a>) for a Graphical interface to PuTTY, and PSCP, which is a
                    part of the previously mentioned PuTTY package.</xhtml:p>
        <xhtml:p>Some Enterprises are using FTP over SSL, however, the simpler and more standard solution is to use SSH. Configuring
                    FTP over SSL is beyond the scope of a Level 1 Benchmark and will not be addressed here.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:complex-check operator="OR">
          <!--Service «vsftpd» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «vsftpd» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «vsftpd» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}vsftpd"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «vsftpd» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «vsftpd» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}vsftpd"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «proftpd» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «proftpd» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «proftpd» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}proftpd"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «proftpd» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «proftpd» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}proftpd"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0205" role="full" selected="false" weight="1.0">
      <xccdf:title>Only Enable rlogin/rsh/rcp If Absolutely Necessary</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="question">Question:</xhtml:h3>
        <xhtml:p>Is there a mission-critical reason why rlogin/rsh/rcp must be used instead of the more secure ssh/scp?</xhtml:p>
        <xhtml:p>If the answer to this question is yes, proceed with the actions below.</xhtml:p>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">sed -e 's/\#[ \t]*\(shell\)/\1/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/\#[ \t]*\(login\)/\1/' /etc/inetd.conf &gt; \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/etc/inetd.conf.temp</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">mv -f /etc/inetd.conf.temp /etc/inetd.conf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">killall -s HUP inetd</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>The r-commands suffer from the same hijacking and sniffing issues as telnet and ftp, and in addition have a number
                    of well-known weaknesses in their authentication scheme. SSH was designed to be a drop-in replacement for these
                    protocols. Given the wide availability of free SSH implementations, it seems unlikely that there is ever a case where
                    these tools cannot be replaced with SSH (again, see<xhtml:a href="http://www.openssh.com/" shape="rect">http://www.openssh.com/</xhtml:a>).</xhtml:p>
        <xhtml:p>If these protocols are left enabled, please also see section 7.1 for additional security-related configuration
                    settings.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:complex-check operator="OR">
          <!--Service «shell» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «shell» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «shell» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}shell"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «shell» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «shell» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}shell"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «login» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «login» does not exist-->
            <xccdf:check-content>
              <ecl:file-content check="none exist" comment="Service «login» does not exist">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}login"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «login» is «off»-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="Service «login» is «off»">
                <ecl:path>/etc/inetd.conf</ecl:path>
                <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}login"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0206" role="full" selected="false" weight="1.0">
      <xccdf:title>Only Enable TFTP Server if Absolutely Necessary</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="question">Question:</xhtml:h3>
        <xhtml:p>Is this system a boot server or is there some other mission-critical reason why data must be transferred to and
                    from this system via TFTP?</xhtml:p>
        <xhtml:p>If the answer to this question is yes, proceed with the actions below.</xhtml:p>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">sed -e 's/\#[ \t]*\(tftp\)/\1/' /etc/inetd.conf &gt; \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/etc/inetd.conf.temp</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">mv -f /etc/inetd.conf.temp /etc/inetd.conf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">killall -s HUP inetd</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>TFTP is typically used for network booting of diskless workstations, X-terminals, and other similar devices.
                    Routers and other network devices may copy configuration data to remote systems via TFTP for backup. However, unless
                    this system is needed in one of these roles, it is best to leave the TFTP service disabled.</xhtml:p>
        <xhtml:p>
          <xhtml:b>Note:</xhtml:b>The tftp-server software is not installed by default on Slackware Linux. You will have to
                    install it if you need to use it. After installing it, perform the actions above.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="OR">
        <!--Service «tftp» does not exist or is disabled-->
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «tftp» does not exist-->
          <xccdf:check-content>
            <ecl:file-content check="none exist" comment="Service «tftp» does not exist">
              <ecl:path>/etc/inetd.conf</ecl:path>
              <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}tftp"/>
            </ecl:file-content>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «tftp» is «off»-->
          <xccdf:check-content>
            <ecl:file-content check="all" comment="Service «tftp» is «off»">
              <ecl:path>/etc/inetd.conf</ecl:path>
              <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}tftp"/>
            </ecl:file-content>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0207" role="full" selected="false" weight="1.0">
      <xccdf:title>Only Enable IMAP If Absolutely Necessary</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="question">Question:</xhtml:h3>
        <xhtml:p>Is this machine a mail server with a mission-critical reason to use<xhtml:span class="code">imap</xhtml:span>to
                    serve mail to remote mail clients?</xhtml:p>
        <xhtml:p>If the answer to this question is yes, proceed with the actions below.</xhtml:p>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">sed -e 's/\#[ \t]*\(imap\)/\1/' /etc/inetd.conf &gt; \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/etc/inetd.conf.temp</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">mv -f /etc/inetd.conf.temp /etc/inetd.conf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">killall -s HUP inetd</xhtml:span>
          <xhtml:span class="code"/>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>Remote mail clients (like Eudora, Netscape Mail and Kmail) may retrieve mail from remote mail servers using IMAP,
                    the Internet Message Access Protocol, or POP, the Post Office Protocol. If this system is a mail server that must offer
                    this protocol, IMAP may be activated.</xhtml:p>
        <xhtml:p>Slackware provides standard IMAP, which is not encrypted and allows an attacker to eavesdrop on e-mails being
                    transferred or to take over the connection. It may, based on which authentication method is used, allow an attacker to
                    steal user passwords as well.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="OR">
        <!--Service «imap» does not exist or is disabled-->
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «imap» does not exist-->
          <xccdf:check-content>
            <ecl:file-content check="none exist" comment="Service «imap» does not exist">
              <ecl:path>/etc/inetd.conf</ecl:path>
              <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}imap"/>
            </ecl:file-content>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «imap» is «off»-->
          <xccdf:check-content>
            <ecl:file-content check="all" comment="Service «imap» is «off»">
              <ecl:path>/etc/inetd.conf</ecl:path>
              <ecl:line-selection op="pm" value="^(#\s*)(\S+s){6}imap"/>
            </ecl:file-content>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0208" role="full" selected="false" weight="1.0">
      <xccdf:title>Only Enable POP If Absolutely Necessary</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="question">Question:</xhtml:h3>
        <xhtml:p>Is this machine a mail server with a mission-critical reason to use pop to serve mail to remote mail clients?</xhtml:p>
        <xhtml:p>If the answer to this question is yes, proceed with the actions below.</xhtml:p>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">sed -e 's/\#[ \t]*\(pop\)/\1/' /etc/inetd.conf &gt; \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/etc/inetd.conf.temp</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">mv -f /etc/inetd.conf.temp /etc/inetd.conf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">killall -s HUP inetd</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>Remote mail clients (like Eudora, Netscape Mail and Kmail) may retrieve mail from remote mail servers using IMAP,
                    the Internet Message Access Protocol, or POP, the Post Office Protocol. If this system is a mail server that must offer
                    the POP protocol, pop3s may be activated.</xhtml:p>
        <xhtml:p/>
        <xhtml:p>Slackware provides a standard POP3 server, which is not encrypted and thus allows an attacker to eavesdrop on
                    e-mails being transferred or to take over the connection. It may – based on which authentication method is used – allow
                    an attacker to steal user passwords as well.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="OR">
        <!--Service «pop» does not exist or is disabled-->
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «pop» does not exist-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="Service «pop» does not exist">
              <ecl:command>find /etc/rc.d/rc.pop -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «pop» is «off»-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="Service «pop» is «off»">
              <ecl:command>find /etc/rc.d/rc.pop ! -perm +ugo=x -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
  </xccdf:Group>
  <xccdf:Group id="g03">
    <xccdf:title>Minimize boot services</xccdf:title>
    <xccdf:description>This group specifies suggestions for disabling or enabling boot services to minimize attack surface.</xccdf:description>
    <xccdf:Rule id="r0301" role="full" selected="false" weight="1.0">
      <xccdf:title>Disable inetd, If Possible</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">/etc/rc.d/rc.inetd stop</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod ugo-x /etc/rc.d/rc.inetd</xhtml:span>
          <xhtml:span class="code"/>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>If the actions in Section 2 of this benchmark resulted in no services being enabled in the inet super
                        daemon<xhtml:span class="code">/etc/inetd.d</xhtml:span>, then the<xhtml:span class="code">inetd</xhtml:span>service
                    may be disabled completely on this system.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="OR">
        <!--Service «inetd» does not exist or is disabled-->
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «inetd» does not exist-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="Service «inetd» does not exist">
              <ecl:command>find /etc/rc.d/rc.inetd -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «inetd» is «off»-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="Service «inetd» is «off»">
              <ecl:command>find /etc/rc.d/rc.inetd ! -perm +ugo=x -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0302" role="full" selected="false" weight="1.0">
      <xccdf:title>Disable sendmail Server, If Possible</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="question">Question:</xhtml:h3>
        <xhtml:p>Is this system a mail server – that is, does this machine receive and process email from other hosts? Note: The
                    email server need not be running to send outgoing mail.</xhtml:p>
        <xhtml:p>Proceed with the appropriate actions below.</xhtml:p>
        <xhtml:p>
          <xhtml:b>Action</xhtml:b>– Yes –<xhtml:span class="code">sendmail</xhtml:span>is required:</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod ugo+x /etc/rc.d/rc.sendmail</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:b>Action</xhtml:b>– No –<xhtml:span class="code">sendmail</xhtml:span>is not required:</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod ugo-x /etc/rc.d/rc.sendmail</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>
          <xhtml:span style="text-decoration: none">It is possible to run a Unix system with the sendmail daemon disabled and
                        still allow users on that system to send email out from that machine. Running sendmail in "<xhtml:i>daemon
                        mode</xhtml:i>" (with the<xhtml:span class="code">-bd</xhtml:span>command-line option) is only required on machines
                        that act as mail servers, receiving and processing email from other hosts on the network. Note that if the system is
                        an email server, the administrator is encouraged to search the Web for additional documentation on sendmail security
                        issues. Some information is available at:</xhtml:span>
          <xhtml:a href="http://www.deer-run.com/~hal/dns-sendmail/DNSandSendmail.pdf" shape="rect">
            <xhtml:span style="text-decoration: none">http://www.deer-run.com/~hal/dns-sendmail/DNSandSendmail.pdf</xhtml:span>
            <xhtml:span style="text-decoration: none"/>
          </xhtml:a>
          <xhtml:span style="text-decoration: none">and at</xhtml:span>
          <xhtml:a href="http://www.sendmail.org/" shape="rect">
            <xhtml:span style="text-decoration: none">http://www.sendmail.org</xhtml:span>
          </xhtml:a>
          <xhtml:span style="text-decoration: none">.</xhtml:span>
        </xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="OR">
        <!--Service «sendmail» does not exist or is disabled-->
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «sendmail» does not exist-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="Service «sendmail» does not exist">
              <ecl:command>find /etc/rc.d/rc.sendmail -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «sendmail» is «off»-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="Service «sendmail» is «off»">
              <ecl:command>find /etc/rc.d/rc.sendmail ! -perm +ugo=x -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0303" role="full" selected="false" weight="1.0">
      <xccdf:title>Disable GUI Login If Possible</xccdf:title>
      <xccdf:description>
        <xhtml:ol>
          <xhtml:li>
            <xhtml:p/>
          </xhtml:li>
          <xhtml:li>
            <xhtml:h3 class="question">Question:</xhtml:h3>
          </xhtml:li>
        </xhtml:ol>
        <xhtml:p>Is there a mission-critical reason to run a GUI login program on this system?</xhtml:p>
        <xhtml:p>If the answer to this question is no, proceed with the actions below.</xhtml:p>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">sed -e 's/id:4:initdefault:/id:3:initdefault:/' \<xhtml:br clear="none"/>&lt;
                        /etc/inittab-preCIS &gt; /etc/inittab<xhtml:br clear="none"/>chown root:root /etc/inittab<xhtml:br clear="none"/>chmod 0600 /etc/inittab</xhtml:span>
          <xhtml:span class="code"/>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>There is usually no reason to run X Windows on a dedicated server machine, like a dedicated web server. This action
                    disables the graphical login, if present, leaving the user to login via SSH or a normal text-based console. If you elect
                    to deactivate the GUI login screen, users can still run X Windows by typing<xhtml:span class="code">startx</xhtml:span>at the shell prompt. In Slackware, there are two main runlevels that the system runs in. Runlevel 4
                    boots directly into X Windows, so as to allow graphical login or easy use of specialized X terminals. Otherwise, for
                    normal text-based console login, runlevel 3 is desirable. GUI login is activated or deactivated by changing this
                    runlevel in<xhtml:span class="code">/etc/inittab</xhtml:span>. Again, note that runlevel 3 still allows the user to run
                    X Windows by typing<xhtml:span class="code">startx</xhtml:span>at the shell prompt.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:check system="http://cisecurity.org/check">
          <!--Default runlevel is 3-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="command test «egrep '^id:3:initdefault:' /etc/inittab»" success="pass">
              <ecl:command>egrep '^id:3:initdefault:' /etc/inittab</ecl:command>
              <ecl:line-selection op="pm" value="^.*$"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/inittab ownership and permission-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="/etc/inittab ownership and permission">
              <ecl:command>find /etc/inittab -follow -maxdepth 0 ! \( -user root -group root -perm u=r,g=,o= \) -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0304" role="full" selected="false" weight="1.0">
      <xccdf:title>Disable Standard Boot Services</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">for FILE in acpid alsa atalk bind cups dnsmasq font.new \<xhtml:br clear="none"/>gpm hotplug
                        httpd mysqld nfsd pcmcia portmap \<xhtml:br clear="none"/>samba saslauthd sendmail serial sysvinit \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">udev wireless yp; do</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/etc/rc.d/rc.$FILE stop<xhtml:br clear="none"/>chmod ugo-x /etc/rc.$FILE<xhtml:br clear="none"/>done<xhtml:br clear="none"/>for USERID in lp sync mail news uucp games ftp smmsp \<xhtml:br clear="none"/>mysql rpc sshd gdm operator pop nobody bin daemon \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">adm; do<xhtml:br clear="none"/>usermod -L -s /dev/null $USERID<xhtml:br clear="none"/>done</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>
          <xhtml:b>Note:</xhtml:b>
          <xhtml:span class="code">sshd</xhtml:span>was not included in the above script because it is considered an essential
                    service, if you do not need it for your environment because you always use console access, just add<xhtml:span class="code">sshd</xhtml:span>in one of the for loops in the action above – however, you will not be able to log in
                    remotely with ssh if you do this.</xhtml:p>
        <xhtml:p>Every system daemon that does not have a clear and necessary purpose on the host should be deactivated. This
                    greatly reduces the chances that the machine will be running a vulnerable daemon when the next vulnerability is
                    discovered in its operating system.</xhtml:p>
        <xhtml:p>Slackware has a simple approach to startup scripts. There are a number of<xhtml:span class="code">rc.*</xhtml:span>scripts in<xhtml:span class="code">/etc/rc.d</xhtml:span>. These can be deactivated individually by
                    removing the execute permission with<xhtml:span class="code">chmod ugo-x /etc/rc.d/rc.script</xhtml:span>, and
                    reactivated by setting the execute permission with<xhtml:span class="code">chmod</xhtml:span><xhtml:span class="code">ugo+x /etc/rc.d/rc.script</xhtml:span>.</xhtml:p>
        <xhtml:p>This process deactivates most of the rc-scripts, so that the local administrator can easily reactivate any of these
                    scripts upon discovery of a mission-critical need for one of these services. One could reactivate the daemon script by
                        typing<xhtml:span class="code">chmod ugo+x /etc/rc.d/rc.daemon</xhtml:span>.</xhtml:p>
        <xhtml:p>Note that security upgrades and updates may restore some of the original entries in the startup script
                        directories<xhtml:span class="code">/etc/rc.d/rc.*</xhtml:span>– it is always a good idea to check<xhtml:span class="code">/etc/rc.d</xhtml:span>and remove any scripts that may have been added by upgrades or patches.</xhtml:p>
        <xhtml:p>The rest of the actions in this section give the administrator the option of re-enabling certain services. Rather
                    than disabling and then re-enabling these services, experienced administrators may wish to simply disable only those
                    services that they know are unnecessary for their systems.</xhtml:p>
        <xhtml:p>The second loop in the "Action" section locks daemon-user accounts related to servers that we examine by setting a
                    lockout password. This will not prevent a given daemon from running as these users – it simply confirms that these users
                    are not available for human login. It also changes the shell to<xhtml:span class="code">/dev/null</xhtml:span>for an
                    additional layer of security as long as shell access is not necessary. Bear in mind that some packages (<xhtml:span class="code">find-utils</xhtml:span>up to version 4.1.20, for example) do not work properly without a shell for
                        the<xhtml:span class="code">nobody</xhtml:span>account – be sure you test this thoroughly if you choose to
                    invalidate the daemon shells.</xhtml:p>
        <xhtml:p>
          <xhtml:b>Note:</xhtml:b>Not all of the scripts listed above will exist on all systems, as this is a superset of the
                    available rc-scripts. The benchmark's recommended action will register some trivial errors on each distribution version
                    as a result – these are not cause for alarm.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:complex-check operator="OR">
          <!--Service «acpid» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «acpid» does not exist-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="Service «acpid» does not exist">
                <ecl:command>find /etc/rc.d/rc.acpid -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «acpid» is «off»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="Service «acpid» is «off»">
                <ecl:command>find /etc/rc.d/rc.acpid ! -perm +ugo=x -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «alsa» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «alsa» does not exist-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="Service «alsa» does not exist">
                <ecl:command>find /etc/rc.d/rc.alsa -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «alsa» is «off»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="Service «alsa» is «off»">
                <ecl:command>find /etc/rc.d/rc.alsa ! -perm +ugo=x -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «atalk» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «atalk» does not exist-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="Service «atalk» does not exist">
                <ecl:command>find /etc/rc.d/rc.atalk -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «atalk» is «off»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="Service «atalk» is «off»">
                <ecl:command>find /etc/rc.d/rc.atalk ! -perm +ugo=x -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «bind» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «bind» does not exist-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="Service «bind» does not exist">
                <ecl:command>find /etc/rc.d/rc.bind -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «bind» is «off»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="Service «bind» is «off»">
                <ecl:command>find /etc/rc.d/rc.bind ! -perm +ugo=x -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «cups» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «cups» does not exist-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="Service «cups» does not exist">
                <ecl:command>find /etc/rc.d/rc.cups -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «cups» is «off»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="Service «cups» is «off»">
                <ecl:command>find /etc/rc.d/rc.cups ! -perm +ugo=x -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «dnsmasq» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «dnsmasq» does not exist-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="Service «dnsmasq» does not exist">
                <ecl:command>find /etc/rc.d/rc.dnsmasq -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «dnsmasq» is «off»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="Service «dnsmasq» is «off»">
                <ecl:command>find /etc/rc.d/rc.dnsmasq ! -perm +ugo=x -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «font.new» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «font.new» does not exist-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="Service «font.new» does not exist">
                <ecl:command>find /etc/rc.d/rc.font.new -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «font.new» is «off»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="Service «font.new» is «off»">
                <ecl:command>find /etc/rc.d/rc.font.new ! -perm +ugo=x -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «gpm» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «gpm» does not exist-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="Service «gpm» does not exist">
                <ecl:command>find /etc/rc.d/rc.gpm -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «gpm» is «off»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="Service «gpm» is «off»">
                <ecl:command>find /etc/rc.d/rc.gpm ! -perm +ugo=x -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «hotplug» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «hotplug» does not exist-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="Service «hotplug» does not exist">
                <ecl:command>find /etc/rc.d/rc.hotplug -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «hotplug» is «off»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="Service «hotplug» is «off»">
                <ecl:command>find /etc/rc.d/rc.hotplug ! -perm +ugo=x -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «httpd» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «httpd» does not exist-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="Service «httpd» does not exist">
                <ecl:command>find /etc/rc.d/rc.httpd -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «httpd» is «off»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="Service «httpd» is «off»">
                <ecl:command>find /etc/rc.d/rc.httpd ! -perm +ugo=x -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «mysqld» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «mysqld» does not exist-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="Service «mysqld» does not exist">
                <ecl:command>find /etc/rc.d/rc.mysqld -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «mysqld» is «off»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="Service «mysqld» is «off»">
                <ecl:command>find /etc/rc.d/rc.mysqld ! -perm +ugo=x -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «nfsd» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «nfsd» does not exist-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="Service «nfsd» does not exist">
                <ecl:command>find /etc/rc.d/rc.nfsd -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «nfsd» is «off»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="Service «nfsd» is «off»">
                <ecl:command>find /etc/rc.d/rc.nfsd ! -perm +ugo=x -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «pcmcia» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «pcmcia» does not exist-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="Service «pcmcia» does not exist">
                <ecl:command>find /etc/rc.d/rc.pcmcia -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «pcmcia» is «off»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="Service «pcmcia» is «off»">
                <ecl:command>find /etc/rc.d/rc.pcmcia ! -perm +ugo=x -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «portmap» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «portmap» does not exist-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="Service «portmap» does not exist">
                <ecl:command>find /etc/rc.d/rc.portmap -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «portmap» is «off»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="Service «portmap» is «off»">
                <ecl:command>find /etc/rc.d/rc.portmap ! -perm +ugo=x -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «samba» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «samba» does not exist-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="Service «samba» does not exist">
                <ecl:command>find /etc/rc.d/rc.samba -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «samba» is «off»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="Service «samba» is «off»">
                <ecl:command>find /etc/rc.d/rc.samba ! -perm +ugo=x -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «saslauthd» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «saslauthd» does not exist-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="Service «saslauthd» does not exist">
                <ecl:command>find /etc/rc.d/rc.saslauthd -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «saslauthd» is «off»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="Service «saslauthd» is «off»">
                <ecl:command>find /etc/rc.d/rc.saslauthd ! -perm +ugo=x -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «sendmail» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «sendmail» does not exist-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="Service «sendmail» does not exist">
                <ecl:command>find /etc/rc.d/rc.sendmail -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «sendmail» is «off»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="Service «sendmail» is «off»">
                <ecl:command>find /etc/rc.d/rc.sendmail ! -perm +ugo=x -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «serial» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «serial» does not exist-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="Service «serial» does not exist">
                <ecl:command>find /etc/rc.d/rc.serial -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «serial» is «off»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="Service «serial» is «off»">
                <ecl:command>find /etc/rc.d/rc.serial ! -perm +ugo=x -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «sysvinit» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «sysvinit» does not exist-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="Service «sysvinit» does not exist">
                <ecl:command>find /etc/rc.d/rc.sysvinit -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «sysvinit» is «off»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="Service «sysvinit» is «off»">
                <ecl:command>find /etc/rc.d/rc.sysvinit ! -perm +ugo=x -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «udev» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «udev» does not exist-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="Service «udev» does not exist">
                <ecl:command>find /etc/rc.d/rc.udev -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «udev» is «off»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="Service «udev» is «off»">
                <ecl:command>find /etc/rc.d/rc.udev ! -perm +ugo=x -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «wireless» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «wireless» does not exist-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="Service «wireless» does not exist">
                <ecl:command>find /etc/rc.d/rc.wireless -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «wireless» is «off»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="Service «wireless» is «off»">
                <ecl:command>find /etc/rc.d/rc.wireless ! -perm +ugo=x -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="OR">
          <!--Service «yp» does not exist or is disabled-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «yp» does not exist-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="Service «yp» does not exist">
                <ecl:command>find /etc/rc.d/rc.yp -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--Service «yp» is «off»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="Service «yp» is «off»">
                <ecl:command>find /etc/rc.d/rc.yp ! -perm +ugo=x -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--command test «egrep '^(lp|sync|mail|news|uucp|games|ftp|smmsp|mysql|rpc|sshd|gdm|operator|pop|nobody|bin|daemon|adm)' /etc/passwd|egrep -v '((/dev/null)|:)$'»-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="command test «egrep '^(lp|sync|mail|news|uucp|games|ftp|smmsp|mysql|rpc|sshd|gdm|operator|pop|nobody|bin|daemon|adm)' /etc/passwd|egrep -v '((/dev/null)|:)$'»" success="pass">
              <ecl:command>egrep
                                '^(lp|sync|mail|news|uucp|games|ftp|smmsp|mysql|rpc|sshd|gdm|operator|pop|nobody|bin|daemon|adm)'
                                /etc/passwd|egrep -v '((/dev/null)|:)$'</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--command test «egrep '^(lp|sync|mail|news|uucp|games|ftp|smmsp|mysql|rpc|sshd|gdm|operator|pop|nobody|bin|daemon|adm)' /etc/shadow|egrep -v '.+:[!\*]'»-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="command test «egrep '^(lp|sync|mail|news|uucp|games|ftp|smmsp|mysql|rpc|sshd|gdm|operator|pop|nobody|bin|daemon|adm)' /etc/shadow|egrep -v '.+:[!\*]'»" success="pass">
              <ecl:command>egrep
                                '^(lp|sync|mail|news|uucp|games|ftp|smmsp|mysql|rpc|sshd|gdm|operator|pop|nobody|bin|daemon|adm)'
                                /etc/shadow|egrep -v '.+:[!\*]'</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0305" role="full" selected="false" weight="1.0">
      <xccdf:title>Only Enable SMB (Windows File Sharing) Processes If Absolutely Necessary</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="question">Question:</xhtml:h3>
        <xhtml:p>Is this machine sharing files via the Windows file sharing protocols?</xhtml:p>
        <xhtml:p>If the answer to this question is yes, proceed with the actions below.</xhtml:p>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">chmod ugo+x /etc/rc.d/rc.samba</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/etc/rc.d/rc.samba start</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>Slackware includes the popular Open Source Samba server for providing file and print services to Windows-based
                    systems. This allows a Unix system to act as a file or print server in on a Windows network, and even act as a Domain
                    Controller (authentication server) to older Windows operating systems. However, if this functionality is not required by
                    the site, the service should be disabled.</xhtml:p>
        <xhtml:p>The SysAdmin may also wish to remove the packages from the system:</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">cd /var/log/packages</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">removepkg samba</xhtml:span>
        </xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="OR">
        <!--Service «samba» does not exist or is disabled-->
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «samba» does not exist-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="Service «samba» does not exist">
              <ecl:command>find /etc/rc.d/rc.samba -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «samba» is «off»-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="Service «samba» is «off»">
              <ecl:command>find /etc/rc.d/rc.samba ! -perm +ugo=x -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0306" role="full" selected="false" weight="1.0">
      <xccdf:title>Only Enable RPC Portmap Process If Absolutely Necessary</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="question">Question:</xhtml:h3>
        <xhtml:p>Are any of the following statements true?</xhtml:p>
        <xhtml:ul>
          <xhtml:li>
            <xhtml:p>This machine is an NFS client or server</xhtml:p>
          </xhtml:li>
          <xhtml:li>
            <xhtml:p>This machine is an NIS (YP) or NIS+ client or server</xhtml:p>
          </xhtml:li>
          <xhtml:li>
            <xhtml:p>The machine runs a third-party software application which is dependent on RPC support</xhtml:p>
          </xhtml:li>
        </xhtml:ul>
        <xhtml:p>If the answer to this question is yes, proceed with the actions below.</xhtml:p>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">chmod ugo+x /etc/rc.d/rc.portmap</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/etc/rc.d/rc.portmap start</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>
          <xhtml:b>Note:</xhtml:b>This section needs to precede the next two sections (3.7 and 3.8).</xhtml:p>
        <xhtml:p>RPC-based services typically use very weak or non-existent authentication and yet may share very sensitive
                    information. Unless one of the services listed above is required on this machine, best to disable RPC-based tools
                    completely. If there is uncertainty in whether or not a particular third-party application requires RPC services,
                    consult with the application vendor.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="OR">
        <!--Service «portmap» does not exist or is disabled-->
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «portmap» does not exist-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="Service «portmap» does not exist">
              <ecl:command>find /etc/rc.d/rc.portmap -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «portmap» is «off»-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="Service «portmap» is «off»">
              <ecl:command>find /etc/rc.d/rc.portmap ! -perm +ugo=x -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0307" role="full" selected="false" weight="1.0">
      <xccdf:title>Only Enable NFS Server Processes If Absolutely Necessary</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="question">Question:</xhtml:h3>
        <xhtml:p>Is this machine an NFS file server?</xhtml:p>
        <xhtml:p>If the answer to this question is yes, proceed with the actions below.</xhtml:p>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">chmod ugo+x /etc/rc.d/rc.nfsd</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/etc/rc.d/rc.nfsd start</xhtml:span>
          <xhtml:span class="code"/>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>NFS is frequently exploited to gain unauthorized access to files and systems. Clearly there is no need to run the
                    NFS server-related daemons on hosts that are not NFS servers. If the system is an NFS server, the administrator should
                    take reasonable precautions when exporting file systems, including restricting NFS access to a specific range of local
                    IP addresses and exporting file systems "read-only" where appropriate. For more information, consult the exports manual
                    page (<xhtml:span class="code">man exports</xhtml:span>).</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="OR">
        <!--Service «nfsd» does not exist or is disabled-->
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «nfsd» does not exist-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="Service «nfsd» does not exist">
              <ecl:command>find /etc/rc.d/rc.nfsd -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «nfsd» is «off»-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="Service «nfsd» is «off»">
              <ecl:command>find /etc/rc.d/rc.nfsd ! -perm +ugo=x -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0308" role="full" selected="false" weight="1.0">
      <xccdf:title>Only Enable NIS Client Processes If Absolutely Necessary</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="question">Question:</xhtml:h3>
        <xhtml:p>Is there a mission-critical reason why this machine must be an NIS client?</xhtml:p>
        <xhtml:p>If the answer to this question is yes, proceed with the actions below.</xhtml:p>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">chmod ugo-x /usr/sbin/ypbind</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>Unless this site must use NIS, it should really be avoided. While it can be very useful for transparently scaling
                    the number of workstations, it's not well designed for security. Sun Microsystems is now phasing out NIS+ in favor of
                    LDAP for naming services – NIS and NIS+ are now reaching end of life.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="OR">
        <!--Service «ypbind» does not exist or is disabled-->
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «ypbind» does not exist-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="Service «ypbind» does not exist">
              <ecl:command>find /etc/rc.d/rc.ypbind -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «ypbind» is «off»-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="Service «ypbind» is «off»">
              <ecl:command>find /etc/rc.d/rc.ypbind ! -perm +ugo=x -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0309" role="full" selected="false" weight="1.0">
      <xccdf:title>Only Enable NIS Server Processes If Absolutely Necessary</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="question">Question:</xhtml:h3>
        <xhtml:p>Is there a mission-critical reason why this machine must be an NIS server?</xhtml:p>
        <xhtml:p>If the answer to this question is yes, proceed with the actions below.</xhtml:p>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">chmod ugo+x /etc/rc.d/rc.yp</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/etc/rc.d/rc.yp start</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>Unless this site must use NIS, it should be avoided. While it can be very useful for transparently scaling the
                    number of workstations, it is not well designed for security.</xhtml:p>
        <xhtml:p>
          <xhtml:b>Note:</xhtml:b>
          <xhtml:span style="font-weight: medium">Slackware has every line in<xhtml:span class="code">/etc/rc.d/rc.yp</xhtml:span>commented out by default. A SysAdmin would have to modify that file, plus the other NIS
                        configuration files to get NIS working. If your NIS server is also a NIS client, you will need to skip section
                    3.10.</xhtml:span>
        </xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="OR">
        <!--Service «yp» does not exist or is disabled-->
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «yp» does not exist-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="Service «yp» does not exist">
              <ecl:command>find /etc/rc.d/rc.yp -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «yp» is «off»-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="Service «yp» is «off»">
              <ecl:command>find /etc/rc.d/rc.yp ! -perm +ugo=x -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0310" role="full" selected="false" weight="1.0">
      <xccdf:title>Only Enable Printer Daemon Processes If Absolutely Necessary</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="question">Question:</xhtml:h3>
        <xhtml:p>Is this system a print server, or is there a mission-critical reason why users must submit print jobs from this
                    system?</xhtml:p>
        <xhtml:p>If the answer to this question is yes, proceed with the actions below.</xhtml:p>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">if [ -e /etc/rc.d/rc.cups ]; then</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod ugo+x /etc/rc.d/rc.cups</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/etc/rc.d/rc.cups start</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">sed -e 's/^\#User lp/User lp/' /etc/cups/cupsd.conf \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">-e 's/^\#Group sys/Group sys/' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/etc/cups/cupsd.conf-preCIS &gt;/etc/cups/cupsd.conf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chown root:root /etc/cups/cupsd.conf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod 600 /etc/cups/cupsd.conf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">fi</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">diff /etc/cups/cupsd.conf-preCIS /etc/cups/cupsd.conf</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>If users will never print files from this machine and the system will never be used as a print server by other
                    hosts on the network, then it is safe to disable the print daemon,<xhtml:span class="code">cupsd</xhtml:span>. The Unix
                    print servers have generally had a poor security record – be sure to keep up-to-date on vendor patches.</xhtml:p>
        <xhtml:p>
          <xhtml:b>Note:</xhtml:b>this item also sets<xhtml:span class="code">cupsd</xhtml:span>, when present, to run as a
                    non-root user and group, namely user<xhtml:span class="code">lp</xhtml:span>and group<xhtml:span class="code">sys</xhtml:span>.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="OR">
        <!--Service «cups» does not exist or is disabled-->
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «cups» does not exist-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="Service «cups» does not exist">
              <ecl:command>find /etc/rc.d/rc.cups -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «cups» is «off»-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="Service «cups» is «off»">
              <ecl:command>find /etc/rc.d/rc.cups ! -perm +ugo=x -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0311" role="full" selected="false" weight="1.0">
      <xccdf:title>Only Enable Web Server Processes If Absolutely Necessary</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="question">Question:</xhtml:h3>
        <xhtml:p>Is there a mission-critical reason why this system must run a Web server?</xhtml:p>
        <xhtml:p>If the answer to this question is yes, proceed with the actions below.</xhtml:p>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">chmod ugo+x /etc/rc.d/rc.httpd</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/etc/rc.d/rc.httpd start</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>If you are running a web server, make sure you check for security advisories. For suggestions on how to configure
                    Apache, check out the guide from the Center for Internet Security:<xhtml:a href="http://www.cisecurity.org/bench_apache.html" shape="rect">http://www.cisecurity.org/bench_apache.html</xhtml:a></xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="OR">
        <!--Service «httpd» does not exist or is disabled-->
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «httpd» does not exist-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="Service «httpd» does not exist">
              <ecl:command>find /etc/rc.d/rc.httpd -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «httpd» is «off»-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="Service «httpd» is «off»">
              <ecl:command>find /etc/rc.d/rc.httpd ! -perm +ugo=x -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0312" role="full" selected="false" weight="1.0">
      <xccdf:title>Only Enable DNS Server Process If Absolutely Necessary</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="question">Question:</xhtml:h3>
        <xhtml:p>Is this machine a DNS server, or name server, for this site?</xhtml:p>
        <xhtml:p>If the answer to this question is yes, proceed with the actions below.</xhtml:p>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">chmod ugo+x /etc/rc.d/rc.bind</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/etc/rc.d/rc.bind start</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>Most of the machines in the organization do not need a DNS server running on the box. Unless this is one of the
                    organization's name servers, it is safe to shut this down.</xhtml:p>
        <xhtml:p>If this must be left active, please patch often and consider tightening the configuration. One highly suggested
                    configuration is to bind the DNS server program in a chroot environment. This significantly restricts the resources that
                    the DNS server has access to on the system, reducing this set to the minimum required for the program to function
                    properly.</xhtml:p>
        <xhtml:p>Additionally, consider the use of Access Control Lists (ACL's) in<xhtml:span class="code">/etc/named.conf</xhtml:span>to limit who can query your name server. For example, Internal name servers should not
                    respond to outside requests. Large Enterprises run multiple name servers so this should not be an issue. However,
                    smaller organizations may not be able to deploy internal and external name servers and should consider this
                precaution.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="OR">
        <!--Service «bind» does not exist or is disabled-->
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «bind» does not exist-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="Service «bind» does not exist">
              <ecl:command>find /etc/rc.d/rc.bind -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «bind» is «off»-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="Service «bind» is «off»">
              <ecl:command>find /etc/rc.d/rc.bind ! -perm +ugo=x -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0313" role="full" selected="false" weight="1.0">
      <xccdf:title>Only Enable SQL Server Processes If Absolutely Necessary</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="question">Question:</xhtml:h3>
        <xhtml:p>Is this machine an SQL (database) server?</xhtml:p>
        <xhtml:p>If the answer to this question is yes, proceed with the actions below.</xhtml:p>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:i>
            <xhtml:b>Please read the discussion before executing the action.</xhtml:b>
          </xhtml:i>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod ugo+x /etc/rc.d/rc.mysqld</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/etc/rc.d/rc.mysqld start</xhtml:span>
          <xhtml:span class="code"/>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>If this machine does not need to run the mainstream database (SQL) server MySQL, it is safe to deactivate it. If
                    you need to enable it, issue the command (above).</xhtml:p>
        <xhtml:p>There is another SQL database called PostgreSQL, it is available from:<xhtml:a href="http://www.linuxpackages.net/" shape="rect"> http://www.linuxpackages.net/</xhtml:a></xhtml:p>
        <xhtml:p>Before running the above action, MySQL must be configured. By default, there are 4 configuration files provided
                        in<xhtml:span class="code">/etc</xhtml:span>:</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">my-huge.cnf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">my-large.cnf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">my-medium.cnf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">my-small.cnf</xhtml:span>
        </xhtml:p>
        <xhtml:p>Choose one of these and copy it to<xhtml:span class="code">/etc/my.cnf</xhtml:span>– edit the file to suit your
                    needs.</xhtml:p>
        <xhtml:p>In sections, 3.6 and 8.1 the<xhtml:span class="code">mysql</xhtml:span>user was “locked down.” Before starting the
                    MySQL daemon, we must unlock the mysql user:</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">usermod -U -s /bin/bash mysql</xhtml:span>
        </xhtml:p>
        <xhtml:p>Also, the database needs to be initialized before starting the daemon. This is done by logging in as the<xhtml:span class="code">mysql</xhtml:span>user and initializing the database with these commands:</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">su – mysql</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">mysql_install_db</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">exit</xhtml:span>
        </xhtml:p>
        <xhtml:p>Then run above action to start the<xhtml:span class="code">mysql</xhtml:span>daemon.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="OR">
        <!--Service «mysqld» does not exist or is disabled-->
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «mysqld» does not exist-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="Service «mysqld» does not exist">
              <ecl:command>find /etc/rc.d/rc.mysqld -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «mysqld» is «off»-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="Service «mysqld» is «off»">
              <ecl:command>find /etc/rc.d/rc.mysqld ! -perm +ugo=x -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
  </xccdf:Group>
  <xccdf:Group id="g04">
    <xccdf:title>Kernel Tuning</xccdf:title>
    <xccdf:description>
      <xhtml:p>For an explanation of some of these parameters, see <xhtml:span class="code">/Documentation/networking/ip-sysctl.txt</xhtml:span> in your local copy of the kernel source or read the latest from the
        cross-referencing Linux site: <xhtml:a href="http://lxr.linux.no/source/Documentation/networking/ip-sysctl.txt">http://lxr.linux.no/source/Documentation/networking/ip-sysctl.txt</xhtml:a>. <xhtml:br/><xhtml:br/>See also SN.9 for additional security-related tunings that you may want to consider.</xhtml:p>
    </xccdf:description>
    <xccdf:Rule id="r0401" role="full" selected="false" weight="1.0">
      <xccdf:title>Network Parameter Modifications</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">cat &lt;&lt;END_SCRIPT &gt;&gt; /etc/sysctl.conf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code"># Following 11 lines added by CISecurity Benchmark sec 4.1</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">net.ipv4.tcp_max_syn_backlog = 4096</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">net.ipv4.tcp_syncookies=1</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">net.ipv4.conf.all.rp_filter = 1</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">net.ipv4.conf.all.accept_source_route = 0</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">net.ipv4.conf.all.accept_redirects = 0</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">net.ipv4.conf.all.secure_redirects = 0</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">net.ipv4.conf.default.rp_filter = 1</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">net.ipv4.conf.default.accept_source_route = 0</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">net.ipv4.conf.default.accept_redirects = 0</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">net.ipv4.conf.default.secure_redirects = 0</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">net.ipv4.icmp_echo_ignore_broadcasts = 1</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">END_SCRIPT</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chown root:root /etc/sysctl.conf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod 0600 /etc/sysctl.conf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">diff /etc/sysctl.conf-preCIS /etc/sysctl.conf</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>For an explanation of some of these parameters, see</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/Documentation/networking/ip-sysctl.txt</xhtml:span>in your local copy of the kernel source or
                    read the latest from the cross-referencing Linux site:<xhtml:a href="http://lxr.linux.no/source/Documentation/networking/ip-sysctl.txt" shape="rect">http://lxr.linux.no/source/Documentation/networking/ip-sysctl.txt</xhtml:a>.</xhtml:p>
        <xhtml:p>See also Security Note 8, for additional security-related tunings that you may want to consider.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:check system="http://cisecurity.org/check">
          <!--sysctl variable net.ipv4.tcp_max_syn_backlog equals «4096».-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="sysctl variable net.ipv4.tcp_max_syn_backlog equals «4096»." success="pass">
              <ecl:command>test `sysctl -n net.ipv4.tcp_max_syn_backlog` = 4096 || sysctl net.ipv4.tcp_max_syn_backlog</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--sysctl variable net.ipv4.tcp_syncookies equals «1».-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="sysctl variable net.ipv4.tcp_syncookies equals «1»." success="pass">
              <ecl:command>test `sysctl -n net.ipv4.tcp_syncookies` = 1 || sysctl net.ipv4.tcp_syncookies</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--sysctl variable net.ipv4.conf.all.rp_filter equals «1».-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="sysctl variable net.ipv4.conf.all.rp_filter equals «1»." success="pass">
              <ecl:command>test `sysctl -n net.ipv4.conf.all.rp_filter` = 1 || sysctl net.ipv4.conf.all.rp_filter</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--sysctl variable net.ipv4.conf.all.accept_source_route equals «0».-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="sysctl variable net.ipv4.conf.all.accept_source_route equals «0»." success="pass">
              <ecl:command>test `sysctl -n net.ipv4.conf.all.accept_source_route` = 0 || sysctl
                                net.ipv4.conf.all.accept_source_route</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--sysctl variable net.ipv4.conf.all.accept_redirects equals «0».-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="sysctl variable net.ipv4.conf.all.accept_redirects equals «0»." success="pass">
              <ecl:command>test `sysctl -n net.ipv4.conf.all.accept_redirects` = 0 || sysctl
                                net.ipv4.conf.all.accept_redirects</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--sysctl variable net.ipv4.conf.all.secure_redirects equals «0».-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="sysctl variable net.ipv4.conf.all.secure_redirects equals «0»." success="pass">
              <ecl:command>test `sysctl -n net.ipv4.conf.all.secure_redirects` = 0 || sysctl
                                net.ipv4.conf.all.secure_redirects</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--sysctl variable net.ipv4.conf.default.rp_filter equals «1».-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="sysctl variable net.ipv4.conf.default.rp_filter equals «1»." success="pass">
              <ecl:command>test `sysctl -n net.ipv4.conf.default.rp_filter` = 1 || sysctl net.ipv4.conf.default.rp_filter</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--sysctl variable net.ipv4.conf.default.accept_source_route equals «0».-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="sysctl variable net.ipv4.conf.default.accept_source_route equals «0»." success="pass">
              <ecl:command>test `sysctl -n net.ipv4.conf.default.accept_source_route` = 0 || sysctl
                                net.ipv4.conf.default.accept_source_route</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--sysctl variable net.ipv4.conf.default.accept_redirects equals «0».-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="sysctl variable net.ipv4.conf.default.accept_redirects equals «0»." success="pass">
              <ecl:command>test `sysctl -n net.ipv4.conf.default.accept_redirects` = 0 || sysctl
                                net.ipv4.conf.default.accept_redirects</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--sysctl variable net.ipv4.conf.default.secure_redirects equals «0».-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="sysctl variable net.ipv4.conf.default.secure_redirects equals «0»." success="pass">
              <ecl:command>test `sysctl -n net.ipv4.conf.default.secure_redirects` = 0 || sysctl
                                net.ipv4.conf.default.secure_redirects</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--sysctl variable net.ipv4.icmp_echo_ignore_broadcasts equals «1».-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="sysctl variable net.ipv4.icmp_echo_ignore_broadcasts equals «1»." success="pass">
              <ecl:command>test `sysctl -n net.ipv4.icmp_echo_ignore_broadcasts` = 1 || sysctl
                                net.ipv4.icmp_echo_ignore_broadcasts</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:complex-check operator="AND">
          <xccdf:check system="http://cisecurity.org/check">
            <!--/etc/sysctl.conf ownership and permission-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="/etc/sysctl.conf ownership and permission">
                <ecl:command>find /etc/sysctl.conf -follow -maxdepth 0 ! \( -user root -group root -perm u=rw,g=,o= \) -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0402" role="full" selected="false" weight="1.0">
      <xccdf:title>Additional Network Parameter Modifications</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="question">Question:</xhtml:h3>
        <xhtml:p>Is this system going to be used as a firewall or gateway to pass network traffic between different networks?</xhtml:p>
        <xhtml:p>If the answer to this question is no, then perform the action below.</xhtml:p>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">cat &lt;&lt;END_SCRIPT &gt;&gt; /etc/sysctl.conf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code"># Following 3 lines added by CISecurity Benchmark sec 4.2</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">net.ipv4.ip_forward = 0</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">net.ipv4.conf.all.send_redirects = 0</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">net.ipv4.conf.default.send_redirects = 0</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">END_SCRIPT</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chown root:root /etc/sysctl.conf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod 0600 /etc/sysctl.conf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">diff /etc/sysctl.conf-preCIS /etc/sysctl.conf</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>For an explanation of some of these parameters, see</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/Documentation/networking/ip-sysctl.txt</xhtml:span>in your local copy of the kernel source or
                    read the latest from the cross-referencing Linux site:<xhtml:a href="http://lxr.linux.no/source/Documentation/networking/ip-sysctl.txt" shape="rect">http://lxr.linux.no/source/Documentation/networking/ip-sysctl.txt</xhtml:a>.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:check system="http://cisecurity.org/check">
          <!--sysctl variable net.ipv4.ip_forward equals «0».-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="sysctl variable net.ipv4.ip_forward equals «0»." success="pass">
              <ecl:command>test `sysctl -n net.ipv4.ip_forward` = 0 || sysctl net.ipv4.ip_forward</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--sysctl variable net.ipv4.conf.all.send_redirects equals «0».-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="sysctl variable net.ipv4.conf.all.send_redirects equals «0»." success="pass">
              <ecl:command>test `sysctl -n net.ipv4.conf.all.send_redirects` = 0 || sysctl net.ipv4.conf.all.send_redirects</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--sysctl variable net.ipv4.conf.default.send_redirects equals «0».-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="sysctl variable net.ipv4.conf.default.send_redirects equals «0»." success="pass">
              <ecl:command>test `sysctl -n net.ipv4.conf.default.send_redirects` = 0 || sysctl
                                net.ipv4.conf.default.send_redirects</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:complex-check operator="AND">
          <xccdf:check system="http://cisecurity.org/check">
            <!--/etc/sysctl.conf ownership and permission-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="/etc/sysctl.conf ownership and permission">
                <ecl:command>find /etc/sysctl.conf -follow -maxdepth 0 ! \( -user root -group root -perm u=rw,g=,o= \) -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
      </xccdf:complex-check>
    </xccdf:Rule>
  </xccdf:Group>
  <xccdf:Group id="g05">
    <xccdf:title>Logging</xccdf:title>
    <xccdf:description>
      <xhtml:p>The items in this section cover enabling various different forms of system logging in order to keep track of activity
                on the system. Because it is often necessary to correlate log information from many different systems (particularly after a
                security incident) experts recommend establishing some form of time synchronization among systems and devices connected to
                the local network. The standard Internet protocol for time synchronization is the Network Time Protocol (NTP), which is
                supported by most network-ready devices. More information on NTP can be found at<xhtml:a href="http://www.ntp.org/" shape="rect"> http://www.ntp.org</xhtml:a><xhtml:span style="text-decoration: none"><xhtml:a href="http://www.ntp.org/" shape="rect"/></xhtml:span><xhtml:span style="text-decoration: none">and</xhtml:span><xhtml:a href="http://www.ibiblio.org/pub/Linux/docs/HOWTO/otherformats/html_single/TimePrecision-HOWTO.html" shape="rect"><xhtml:span style="text-decoration: none">
                        http://www.ibiblio.org/pub/Linux/docs/HOWTO/otherformats/html_single/TimePrecision-HOWTO.html</xhtml:span><xhtml:span style="text-decoration: none">.</xhtml:span></xhtml:a></xhtml:p>
    </xccdf:description>
    <xccdf:Rule id="r0501" role="full" selected="false" weight="1.0">
      <xccdf:title>Capture Messages Sent To Syslog AUTHPRIV Facility</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">if [ `grep -v '^#' /etc/syslog.conf | \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">grep -c 'authpriv'` -eq 0 ]; then</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">echo -e "authpriv.*\t\t\t\t/var/log/secure" \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">&gt;&gt; /etc/syslog.conf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">fi</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">touch /var/log/secure</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chown root:root /var/log/secure</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod 600 /var/log/secure</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">diff /etc/syslog.conf-preCIS /etc/syslog.conf</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>The default installation of Slackware already has this enabled. It is included in case it had been previously
                    disabled.</xhtml:p>
        <xhtml:p>Not all Linux distributions, especially the older ones, capture logging information which is sent to the<xhtml:span class="code">LOG_AUTHPRIV</xhtml:span>facilities. This is unfortunate, since a great deal of important
                    security-related information is sent via these channels (e.g., successful and failed<xhtml:span class="code">su</xhtml:span>attempts, failed login attempts, root login attempts, etc). The above action causes this information to
                    be captured in the<xhtml:span class="code">/var/log/secure</xhtml:span>file (which is only readable by the superuser).
                    This file should be reviewed and archived on a regular basis.</xhtml:p>
        <xhtml:p/>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:check system="http://cisecurity.org/check">
          <!--command test «egrep '^authpriv\.\*[[:space:]]+/var/log/secure$' /etc/syslog.conf»-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="command test «egrep '^authpriv\.\*[[:space:]]+/var/log/secure$' /etc/syslog.conf»" success="pass">
              <ecl:command>egrep '^authpriv\.\*[[:space:]]+/var/log/secure$' /etc/syslog.conf</ecl:command>
              <ecl:line-selection op="pm" value="^.*$"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:complex-check operator="AND">
          <xccdf:check system="http://cisecurity.org/check">
            <!--/var/log/secure ownership and permission-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="/var/log/secure ownership and permission">
                <ecl:command>find /var/log/secure -follow -maxdepth 0 ! \( -user root -group root -perm u=rw,g=,o= \) -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0502" role="full" selected="false" weight="1.0">
      <xccdf:title>Turn On Additional Logging For FTP Daemon</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">if [ -f /etc/vsftpd.conf ]; then</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">awk '/^#?xferlog_std_format/ \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">{ print "xferlog_std_format=NO"; next };</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/^#?log_ftp_protocol/ \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">{ print "log_ftp_protocol=YES"; next };</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">{ print }' /etc/vsftpd.conf-preCIS &gt; /etc/vsftpd.conf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">if [ `egrep -c log_ftp_protocol /etc/vsftpd.conf` == 0 ]; then</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">echo "log_ftp_protocol=YES" &gt;&gt; /etc/vsftpd.conf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">fi</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod 0600 /etc/vsftpd.conf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chown root:root /etc/vsftpd.conf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">diff /etc/vsftpd.conf-preCIS /etc/vsftpd.conf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">fi</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>Slackware already logs connections and all files transferred in both vsftpd and proftpd. The above script will
                    change the vsftpd configuration file to allow more detailed logs to be kept if vsftpd is used. The proftpd does not
                    provide this level of granularity.</xhtml:p>
        <xhtml:p>The list of files transferred can be found at<xhtml:span class="code">/var/log/xferlog</xhtml:span>and the list of
                    ftp connections can be found at<xhtml:span class="code">/var/log/secure</xhtml:span>for both proftpd and
                vsftpd.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="OR">
        <xccdf:complex-check operator="AND">
          <xccdf:check system="http://cisecurity.org/check">
            <!--/etc/vsftpd/vsftpd.conf does not exist-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="/etc/vsftpd/vsftpd.conf does not exist" success="pass">
                <ecl:command>find /etc/vsftpd/vsftpd.conf -follow -maxdepth 0 -ls 2&gt;/dev/null</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="AND">
          <xccdf:check system="http://cisecurity.org/check">
            <!--command test «egrep '^xferlog_std_format=NO$' /etc/vsftpd/vsftpd.conf»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="command test «egrep '^xferlog_std_format=NO$' /etc/vsftpd/vsftpd.conf»" success="pass">
                <ecl:command>egrep '^xferlog_std_format=NO$' /etc/vsftpd/vsftpd.conf</ecl:command>
                <ecl:line-selection op="pm" value="^.*$"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--command test «egrep '^log_ftp_protocol=YES$' /etc/vsftpd/vsftpd.conf»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="command test «egrep '^log_ftp_protocol=YES$' /etc/vsftpd/vsftpd.conf»" success="pass">
                <ecl:command>egrep '^log_ftp_protocol=YES$' /etc/vsftpd/vsftpd.conf</ecl:command>
                <ecl:line-selection op="pm" value="^.*$"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0503" role="full" selected="false" weight="1.0">
      <xccdf:title>Confirm Permissions On System Log Files</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">cd /var/log</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code"># Permissions for other</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code"># log files in /var/log</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod o-rwx btmp cron* debug* dmesg faillog lastlog maillog* \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">messages* secure* spooler* syslog* wtmp xferlog</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code"># directories in /var/log</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod o-w apache cups iptraf nfsd samba sa uucp</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code"># contents of directories in /var/log</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod o-rwx apache/* cups/* iptraf/* nfsd/* samba/* sa/* uucp/*</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code"># Slackware package management</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod o-w packages removed_packages removed_scripts \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">scripts setup</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod o-rwx packages/* removed_packages/* removed_scripts/* \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">scripts/* setup/*</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code"># Permissions for group</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code"># log files in /var/log</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod g-wx btmp cron* debug* dmesg faillog lastlog maillog* \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">messages* secure* spooler* syslog* wtmp xferlog</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code"># directories in /var/log</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod g-w apache cups iptraf nfsd samba sa uucp</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code"># contents of directories in /var/log</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod g-wx apache/* cups/* iptraf/* nfsd/* samba/* sa/* uucp/*</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code"># Slackware package management</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod g-w packages removed_packages removed_scripts \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">scripts setup</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod g-wx packages/* removed_packages/* removed_scripts/* \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">scripts/* setup/*</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code"># Permissions for owner</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code"># log files in /var/log</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod u-x btmp cron* debug* dmesg faillog lastlog maillog* \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">messages* secure* spooler* syslog* wtmp xferlog</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code"># contents of directories in /var/log</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod u-x apache/* cups/* iptraf/* nfsd/* samba/* sa/* uucp/*</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code"># Slackware package management</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod u-x packages/* removed_packages/* removed_scripts/* \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">scripts/* setup/*</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code"># Change ownership</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chown -R root:root .</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chown uucp uucp</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chgrp uucp uucp/*</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chgrp utmp wtmpq</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>It is critical to protect system log files from being modified by unauthorized individuals. Also, certain logs
                    contain sensitive data that should only be available to the system administrator.</xhtml:p>
        <xhtml:p>If you should add any of the services that affect the above logs, please revisit this section to ensure the logs
                    have the correct/secure permissions.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:complex-check operator="AND">
          <!--Permissions for other-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--log files in /var/log chmod o-rwx-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="command test «(cd /var/log;for f in btmp cron.* debug.* dmesg faillog lastlog maillog.* messages.* secure.* spooler.* syslog.* wtmp xferlog; do find $f -maxdepth 0 \( -perm +o=rwx \) -ls 2&gt;/dev/null; done)»">
                <ecl:command>(cd /var/log;for f in btmp cron.* debug.* dmesg faillog lastlog maillog.* messages.* secure.*
                                    spooler.* syslog.* wtmp xferlog; do find $f -maxdepth 0 \( -perm +o=rwx \) -ls 2&gt;/dev/null; done)</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--directories in /var/log chmod o-w-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="command test «(cd /var/log;for f in apache cups iptraf nfsd samba sa uucp; do find $f -maxdepth 0 \( -perm +o=w \) -ls 2&gt;/dev/null; done)»">
                <ecl:command>(cd /var/log;for f in apache cups iptraf nfsd samba sa uucp; do find $f -maxdepth 0 \( -perm
                                    +o=w \) -ls 2&gt;/dev/null; done)</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--contents of directories in /var/log chmod o-rwx-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="command test «(cd /var/log;for f in apache cups iptraf nfsd samba sa uucp; do find $f \( -perm +o=rwx \) -ls 2&gt;/dev/null; done)»">
                <ecl:command>(cd /var/log;for f in apache cups iptraf nfsd samba sa uucp; do find $f \( -perm +o=rwx \) -ls
                                    2&gt;/dev/null; done)</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:complex-check operator="AND">
            <!--Slackware package management-->
            <xccdf:check system="http://cisecurity.org/check">
              <!--Slackware package management chmod o-w-->
              <xccdf:check-content>
                <ecl:shell-command check="none exist" comment="command test «(cd /var/log;for f in packages removed_packages removed_scripts scripts setup; do find $f -maxdepth 0 \( -perm +o=rwx \) -ls 2&gt;/dev/null; done)»">
                  <ecl:command>(cd /var/log;for f in packages removed_packages removed_scripts scripts setup; do find $f
                                        -maxdepth 0 \( -perm +o=rwx \) -ls 2&gt;/dev/null; done)</ecl:command>
                  <ecl:line-selection op="pm" value=".+"/>
                </ecl:shell-command>
              </xccdf:check-content>
            </xccdf:check>
            <xccdf:check system="http://cisecurity.org/check">
              <!--Slackware package management chmod o-rwx-->
              <xccdf:check-content>
                <ecl:shell-command check="none exist" comment="command test «(cd /var/log;for f in packages removed_packages removed_scripts scripts setup; do find $f \( -perm +o=rwx \) -ls 2&gt;/dev/null; done)»">
                  <ecl:command>(cd /var/log;for f in packages removed_packages removed_scripts scripts setup; do find $f
                                        \( -perm +o=rwx \) -ls 2&gt;/dev/null; done)</ecl:command>
                  <ecl:line-selection op="pm" value=".+"/>
                </ecl:shell-command>
              </xccdf:check-content>
            </xccdf:check>
          </xccdf:complex-check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="AND">
          <!--Permissions for group-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--log files in /var/log chmod g-wx-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="command test «(cd /var/log;for f in btmp cron.* debug.* dmesg faillog lastlog maillog.* messages.* secure.* spooler.* syslog.* wtmp xferlog; do find $f -maxdepth 0 \( -perm +g=wx \) -ls 2&gt;/dev/null; done)»">
                <ecl:command>(cd /var/log;for f in btmp cron.* debug.* dmesg faillog lastlog maillog.* messages.* secure.*
                                    spooler.* syslog.* wtmp xferlog; do find $f -maxdepth 0 \( -perm +g=wx \) -ls 2&gt;/dev/null; done)</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--directories in /var/log chmod g-w-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="command test «(cd /var/log;for f in apache cups iptraf nfsd samba sa uucp; do find $f -maxdepth 0 \( -perm +g=w \) -ls 2&gt;/dev/null; done)»">
                <ecl:command>(cd /var/log;for f in apache cups iptraf nfsd samba sa uucp; do find $f -maxdepth 0 \( -perm
                                    +g=w \) -ls 2&gt;/dev/null; done)</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--contents of directories in /var/log chmod g-wx-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="command test «(cd /var/log;for f in apache cups iptraf nfsd samba sa uucp; do find $f \( -perm +g=wx \) -ls 2&gt;/dev/null; done)»">
                <ecl:command>(cd /var/log;for f in apache cups iptraf nfsd samba sa uucp; do find $f \( -perm +g=wx \) -ls
                                    2&gt;/dev/null; done)</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:complex-check operator="AND">
            <!--Slackware package management-->
            <xccdf:check system="http://cisecurity.org/check">
              <!--Slackware package management chmod g-w-->
              <xccdf:check-content>
                <ecl:shell-command check="none exist" comment="command test «(cd /var/log;for f in packages removed_packages removed_scripts scripts setup; do find $f -maxdepth 0 \( -perm +g=w \) -ls 2&gt;/dev/null; done)»">
                  <ecl:command>(cd /var/log;for f in packages removed_packages removed_scripts scripts setup; do find $f
                                        -maxdepth 0 \( -perm +g=w \) -ls 2&gt;/dev/null; done)</ecl:command>
                  <ecl:line-selection op="pm" value=".+"/>
                </ecl:shell-command>
              </xccdf:check-content>
            </xccdf:check>
            <xccdf:check system="http://cisecurity.org/check">
              <!--Slackware package management chmod o-wx-->
              <xccdf:check-content>
                <ecl:shell-command check="none exist" comment="command test «(cd /var/log;for f in packages removed_packages removed_scripts scripts setup; do find $f \( -perm +g=wx \) -ls 2&gt;/dev/null; done)»">
                  <ecl:command>(cd /var/log;for f in packages removed_packages removed_scripts scripts setup; do find $f
                                        \( -perm +g=wx \) -ls 2&gt;/dev/null; done)</ecl:command>
                  <ecl:line-selection op="pm" value=".+"/>
                </ecl:shell-command>
              </xccdf:check-content>
            </xccdf:check>
          </xccdf:complex-check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="AND">
          <!--Permissions for owner-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--log files in /var/log chmod u-x-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="command test «(cd /var/log;for f in btmp cron.* debug.* dmesg faillog lastlog maillog.* messages.* secure.* spooler.* syslog.* wtmp xferlog; do find $f -maxdepth 0 \( -perm +u=x \) -ls 2&gt;/dev/null; done)»">
                <ecl:command>(cd /var/log;for f in btmp cron.* debug.* dmesg faillog lastlog maillog.* messages.* secure.*
                                    spooler.* syslog.* wtmp xferlog; do find $f -maxdepth 0 \( -perm +u=x \) -ls 2&gt;/dev/null; done)</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--directories in /var/log chmod u-x-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="command test «(cd /var/log;for f in apache cups iptraf nfsd samba sa uucp; do find $f -maxdepth 0 \( -perm +u=x \) -ls 2&gt;/dev/null; done)»">
                <ecl:command>(cd /var/log;for f in apache cups iptraf nfsd samba sa uucp; do find $f -maxdepth 0 \( -perm
                                    +u=x \) -ls 2&gt;/dev/null; done)</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:complex-check operator="AND">
            <!--Slackware package management-->
            <xccdf:check system="http://cisecurity.org/check">
              <!--Slackware package management chmod u-x-->
              <xccdf:check-content>
                <ecl:shell-command check="none exist" comment="command test «(cd /var/log;for f in packages removed_packages removed_scripts scripts setup; do find $f \( -perm +u=x \) -ls 2&gt;/dev/null; done)»">
                  <ecl:command>(cd /var/log;for f in packages removed_packages removed_scripts scripts setup; do find $f
                                        \( -perm +u=x \) -ls 2&gt;/dev/null; done)</ecl:command>
                  <ecl:line-selection op="pm" value=".+"/>
                </ecl:shell-command>
              </xccdf:check-content>
            </xccdf:check>
          </xccdf:complex-check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="AND">
          <!--Change ownership-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--command test «find /var/log -follow ! \( -user root -group root \) -ls|grep -v uucp|grep -v wtmp»-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="command test «find /var/log -follow ! \( -user root -group root \) -ls|grep -v uucp|grep -v wtmp»">
                <ecl:command>find /var/log -follow ! \( -user root -group root \) -ls|grep -v uucp|grep -v wtmp</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--command test «find /var/log/* -follow -name uucp ! \( -user uucp -group uucp \) -ls»-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="command test «find /var/log/* -follow -name uucp ! \( -user uucp -group uucp \) -ls»">
                <ecl:command>find /var/log/* -follow -name uucp ! \( -user uucp -group uucp \) -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--command test «find /var/log/* -follow -name 'wtmp*' ! \( -user root -group utmp \) -ls»-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="command test «find /var/log/* -follow -name 'wtmp*' ! \( -user root -group utmp \) -ls»">
                <ecl:command>find /var/log/* -follow -name 'wtmp*' ! \( -user root -group utmp \) -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0504" role="full" selected="false" weight="1.0">
      <xccdf:title>Configure syslogd to Send Logs to a Remote LogHost</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:i>In the script below, replace loghost with the proper name (Full Quallified Domain Name (FQDN), if necessary) of
                        your loghost.</xhtml:i>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">printf "### Following lines added by CISecurity \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">Slackware Benchmark Section 5.4\n\</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">kern.warning;*.err;authpriv.none\t@loghost\n\</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">*.info;mail.none;authpriv.none;cron.none\t@loghost\n\</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">*.emerg\t@loghost\n\</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">local7.*\t@loghost\n" &gt;&gt; /etc/syslog.conf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">diff /etc/syslog.conf-preCIS /etc/syslog.conf</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>Remote logging is essential in detecting intrusion and monitoring several servers operating in concert. An intruder
                    – once he/she has obtained root – can edit the system logs to remove all traces of the attack. If the logs are stored
                    off the machine, those logs can be analyzed for anomalies and used for prosecuting the attacker.</xhtml:p>
        <xhtml:p>For more information or remote logging use:<xhtml:span class="code">man syslogd</xhtml:span>.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:check system="http://cisecurity.org/check">
          <!--kern.warning;*.err;authpriv.none @loghost-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="command test «egrep '^kern.warning;\*\.err;authpriv\.none[[:space:]]+@' /etc/syslog.conf»" success="pass">
              <ecl:command>egrep '^kern.warning;\*\.err;authpriv\.none[[:space:]]+@' /etc/syslog.conf</ecl:command>
              <ecl:line-selection op="pm" value="^.*$"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--*.info;mail.none;authpriv.none;cron.none @loghost-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="command test «egrep '^\*\.info;mail\.none;authpriv\.none;cron\.none[[:space:]]+@' /etc/syslog.conf»" success="pass">
              <ecl:command>egrep '^\*\.info;mail\.none;authpriv\.none;cron\.none[[:space:]]+@' /etc/syslog.conf</ecl:command>
              <ecl:line-selection op="pm" value="^.*$"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--*.emerg @loghost-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="command test «egrep '^\*\.emerg[[:space:]]+@l' /etc/syslog.conf»" success="pass">
              <ecl:command>egrep '^\*\.emerg[[:space:]]+@l' /etc/syslog.conf</ecl:command>
              <ecl:line-selection op="pm" value="^.*$"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--local7.*\t@loghost-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="command test «egrep '^local7\.\*[[:space:]]+@' /etc/syslog.conf»" success="pass">
              <ecl:command>egrep '^local7\.\*[[:space:]]+@' /etc/syslog.conf</ecl:command>
              <ecl:line-selection op="pm" value="^.*$"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
  </xccdf:Group>
  <xccdf:Group id="g06">
    <xccdf:title>File/Directory Permissions/Access</xccdf:title>
    <xccdf:description>This group specifies the file/directory permissions for many of the sensitive files.</xccdf:description>
    <xccdf:Rule id="r0601" role="full" selected="false" weight="1.0">
      <xccdf:title>Add 'nodev' Option To Appropriate Partitions In /etc/fstab</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">cp -p /etc/fstab /etc/fstab.tmp</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">awk '($3 ~ /^(ext[23]|reiserfs)$/ &amp;&amp; $2 != "/") \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">{ $4 = $4 ",nodev" }; \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">{ print }' /etc/fstab.tmp &gt; /etc/fstab</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chown root:root /etc/fstab</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod 0644 /etc/fstab</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">rm -f /etc/fstab.tmp</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">diff /etc/fstab-preCIS /etc/fstab</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>Placing "<xhtml:span class="code">nodev</xhtml:span>" on these partitions prevents users from mounting unauthorized
                    devices on any partitions that we know should not contain devices. There should be little need to mount devices on any
                    partitions other than /<xhtml:span class="code">dev</xhtml:span>.</xhtml:p>
        <xhtml:p>One notable exception, of course, is the case where system programs are being placed into "<xhtml:span class="code">chroot</xhtml:span> jails"- these often require that several devices be created in the<xhtml:span class="code">chroot</xhtml:span>directory. If you are using<xhtml:span class="code">chroot</xhtml:span>jails on your machines,
                    you should be careful with the<xhtml:span class="code">nodev</xhtml:span>option.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:check system="http://cisecurity.org/check">
          <!--Add 'nodev' Option To Appropriate Partitions In /etc/fstab-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="command test «egrep '/[^\s#]+\s+(ext[23]|reiserfs)\s+' /etc/fstab|egrep -v '([^\s]+\s+){3}.*nodev.*\s+'»">
              <ecl:command>egrep '/[^\s#]+\s+(ext[23]|reiserfs)\s+' /etc/fstab|egrep -v '([^\s]+\s+){3}.*nodev.*\s+'</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/fstab ownership and permission-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="/etc/fstab ownership and permission">
              <ecl:command>find /etc/fstab -follow -maxdepth 0 ! \( -user root -group root -perm u=rw,g=r,o=r \) -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0602" role="full" selected="false" weight="1.0">
      <xccdf:title>Add 'nosuid' and 'nodev' Option For Removable Media In /etc/fstab</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">cp -p /etc/fstab /etc/fstab.tmp<xhtml:br clear="none"/>awk '($2 ~ /^\/m.*\/(floppy|cdrom)$/)
                            \<xhtml:br clear="none"/>{ $4 = $4 ",nosuid,nodev" }; \<xhtml:br clear="none"/>{ print }' /etc/fstab.tmp
                        &gt; /etc/fstab<xhtml:br clear="none"/>chown root:root /etc/fstab<xhtml:br clear="none"/>chmod 0644
                            /etc/fstab<xhtml:br clear="none"/>rm -f /etc/fstab.tmp</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">diff /etc/fstab-preCIS /etc/fstab</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>Removable media is one vector by which malicious software can be introduced onto the system. By forcing these file
                    systems to be mounted with the<xhtml:span class="code">nosuid</xhtml:span>option, the administrator prevents users from
                    bringing set-UID programs onto the system via CDROMs and floppy disks. We also force these filesystems to mount with
                        the<xhtml:span class="code">nodev</xhtml:span>option, as explained in item 6.1.</xhtml:p>
        <xhtml:p>If this machine has multiple CD-ROM or floppy drives, additional action must be taken. Simply add<xhtml:span class="code">nosuid</xhtml:span>to the fourth field for the<xhtml:span class="code">/etc/fstab</xhtml:span>lines
                    that reference those drives.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:check system="http://cisecurity.org/check">
          <!--Add 'nosuid' and 'nodev' Option For Removable Media In /etc/fstab-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="command test «egrep 'm.*/(floppy|cdrom)' /etc/fstab|grep -v 'nosuid';egrep 'm.*/(floppy|cdrom)' /etc/fstab|grep -v 'nodev'»">
              <ecl:command>egrep 'm.*/(floppy|cdrom)' /etc/fstab|grep -v 'nosuid';egrep 'm.*/(floppy|cdrom)' /etc/fstab|grep
                                -v 'nodev'</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/fstab ownership and permission-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="/etc/fstab ownership and permission">
              <ecl:command>find /etc/fstab -follow -maxdepth 0 ! \( -user root -group root -perm u=rw,g=r,o=r \) -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0603" role="full" selected="false" weight="1.0">
      <xccdf:title>Verify passwd, shadow, and group File Permissions</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">cd /etc<xhtml:br clear="none"/>chown root:root passwd shadow group<xhtml:br clear="none"/>chmod
                        644 passwd group<xhtml:br clear="none"/>chmod 400 shadow</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>These are the default owners and access permissions for these files. It is worthwhile to periodically check these
                    file permissions as there have been package defects that changed<xhtml:span class="code">/etc/shadow</xhtml:span>permissions to 644.</xhtml:p>
        <xhtml:p>Tripwire (<xhtml:a href="http://www.tripwire.org/downloads/index.php" shape="rect">http://www.tripwire.org/downloads/index.php </xhtml:a>) and AIDE (<xhtml:a href="http://sourceforge.net/projects/aide" shape="rect">http://sourceforge.net/projects/aide</xhtml:a>) – the
                    successor to Tripwire – are excellent products for alerting you to changes in these files. Whereas AIDE is an
                    improvement to Tripwire, it is still listed as Beta software, and may not be suitable for enterprise production systems.
                </xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/passwd ownership and permission-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="/etc/passwd ownership and permission">
              <ecl:command>find /etc/passwd -follow -maxdepth 0 ! \( -user root -group root -perm u=rw \) -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/group ownership and permission-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="/etc/group ownership and permission">
              <ecl:command>find /etc/group -follow -maxdepth 0 ! \( -user root -group root -perm u=rw \) -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0604" role="full" selected="false" weight="1.0">
      <xccdf:title>World-Writable Directories Should Have Their Sticky Bit Set</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>The automated tool supplied with this benchmark will flag world-writable directories that do not have the sticky
                    bit set.</xhtml:p>
        <xhtml:p>Administrators who wish to obtain a list of these directories may execute the following commands:</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">for PART in `awk '($3 == "ext2" || $3 == "ext3" || \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">$3 == "reiserfs") \<xhtml:br clear="none"/>{ print $2 }' /etc/fstab`; do<xhtml:br clear="none"/>find $PART -xdev -type d \<xhtml:br clear="none"/>\( -perm -0002 -a ! -perm -1000 \) -print<xhtml:br clear="none"/>done</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:i>There should be no entries returned.</xhtml:i>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>When the so-called "sticky bit" is set on a directory, then only the owner of a file may remove that file from the
                    directory (as opposed to the usual behavior where anybody with write access to that directory may remove the file).
                    Setting the sticky bit prevents users from overwriting each other's files, whether accidentally or maliciously, and is
                    generally appropriate for most world-writable directories. However, consult appropriate vendor documentation before
                    blindly applying the sticky bit (<xhtml:span class="code">chmod +t &lt;filename&gt;</xhtml:span>) to any world
                    writable directories found in order to avoid breaking any application dependencies on a given directory.</xhtml:p>
      </xccdf:description>
      <xccdf:check system="http://cisecurity.org/check">
        <!--World-Writable Directories Should Have Their Sticky Bit Set-->
        <xccdf:check-content>
          <ecl:shell-command check="none exist" comment="command test «for PART in `awk '($3 ~ &quot;ext2|ext3|reiserfs&quot;) { print $2 }' /etc/fstab`; do find $PART -xdev -type d \( -perm -0002 -a ! -perm -1000 \) -ls; done»">
            <ecl:command>for PART in `awk '($3 ~ "ext2|ext3|reiserfs") { print $2 }' /etc/fstab`; do find $PART -xdev -type d \(
                            -perm -0002 -a ! -perm -1000 \) -ls; done</ecl:command>
            <ecl:line-selection op="pm" value=".+"/>
          </ecl:shell-command>
        </xccdf:check-content>
      </xccdf:check>
    </xccdf:Rule>
    <xccdf:Rule id="r0605" role="full" selected="false" weight="1.0">
      <xccdf:title>Find Unauthorized World-Writable Files</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>The automated testing tool supplied with this benchmark will flag unexpected world-writable files on the system.</xhtml:p>
        <xhtml:p>Administrators who wish to obtain a list of the world-writable files currently installed on the system may run the
                    following commands:</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">for PART in `awk '($3 == "ext2" || $3 == "ext3" || \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">$3 == "reiserfs") \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">{ print $2 }' /etc/fstab`; do<xhtml:br clear="none"/>find $PART -xdev -type f \<xhtml:br clear="none"/>\( -perm -0002 -a ! -perm -1000 \) -print<xhtml:br clear="none"/>done</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:i>There should be no entries returned.</xhtml:i>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>Data in world-writable files can be modified and compromised by any user on the system. World-writable files may
                    also indicate an incorrectly written script or program that could potentially be the cause of a larger compromise to the
                    system's integrity. Generally removing write access for the "other" category (<xhtml:span class="code">chmod o-w
                        &lt;filename&gt;</xhtml:span>) is advisable, but always consult relevant vendor documentation in order to
                    avoid breaking any application dependencies on a given file.</xhtml:p>
      </xccdf:description>
      <xccdf:check system="http://cisecurity.org/check">
        <!--Unauthorized World-Writable Files-->
        <xccdf:check-content>
          <ecl:shell-command check="none exist" comment="command test «for PART in `awk '(!/^#/ &amp;&amp; $6 != &quot;0&quot;) { print $2 }' /etc/fstab`; do find $PART -xdev -type f \( -perm -0002 -a ! -perm -1000 \) -ls 2&gt;/dev/null; done»">
            <ecl:command>for PART in `awk '(!/^#/ &amp;&amp; $6 != "0") { print $2 }' /etc/fstab`; do find $PART -xdev
                            -type f \( -perm -0002 -a ! -perm -1000 \) -ls 2&gt;/dev/null; done</ecl:command>
            <ecl:line-selection op="pm" value=".+"/>
          </ecl:shell-command>
        </xccdf:check-content>
      </xccdf:check>
    </xccdf:Rule>
    <xccdf:Rule id="r0606" role="full" selected="false" weight="1.0">
      <xccdf:title>Find Unauthorized SUID/SGID System Executables</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>The automated testing tool supplied with this benchmark will flag unexpected set-UID and set-GID applications on
                    the system.</xhtml:p>
        <xhtml:p>Administrators who wish to obtain a list of the set-UID and set-GID programs currently installed on the system may
                    run the following commands:</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">for PART in `awk '($3 == "ext2" || $3 == "ext3" || \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">$3 == "reiserfs") \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">{ print $2 }' /etc/fstab`; do<xhtml:br clear="none"/>find $PART \( -perm -04000 -o -perm -02000
                        \) \<xhtml:br clear="none"/>-type f -xdev -print<xhtml:br clear="none"/>done</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>The administrator should take care to ensure that no rogue set-UID programs have been introduced into the system.
                    In addition, if possible, the administrator should attempt a Set-UID audit and reduction either by removing files or
                    changing the permissions (<xhtml:span class="code">chmod -s &lt;filename&gt;</xhtml:span>), but always consult
                    relevant vendor documentation in order to avoid breaking any applications.</xhtml:p>
      </xccdf:description>
      <xccdf:check system="http://cisecurity.org/check">
        <!--Unauthorized SUID/SGID System Executables-->
        <xccdf:check-content>
          <ecl:shell-command check="none exist" comment="command test «for PART in `awk '(!/^#/ &amp;&amp; $6 != &quot;0&quot;) { print $2 }' /etc/fstab`; do find $PART \( -perm -04000 -o -perm -02000 \) -type f -xdev -ls 2&gt;/dev/null; done»">
            <ecl:command>for PART in `awk '(!/^#/ &amp;&amp; $6 != "0") { print $2 }' /etc/fstab`; do find $PART \(
                            -perm -04000 -o -perm -02000 \) -type f -xdev -ls 2&gt;/dev/null; done</ecl:command>
            <ecl:line-selection op="pm" value=".+"/>
          </ecl:shell-command>
        </xccdf:check-content>
      </xccdf:check>
    </xccdf:Rule>
    <xccdf:Rule id="r0607" role="full" selected="false" weight="1.0">
      <xccdf:title>Find All Unowned Files</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">for PART in `awk '($3 == "ext2" || $3 == "ext3" || \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">$3 == "reiserfs") \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">{ print $2 }' /etc/fstab`; do<xhtml:br clear="none"/>find $PART -nouser -o -nogroup
                            -print<xhtml:br clear="none"/>done</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:i>There should be no entries returned.</xhtml:i>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>Do not allow any unowned files on your system. Unowned files may be an indication an intruder has accessed your
                    system or improper package maintenance/installation. Sometimes a package removal results in unowned files or directories
                    related to this software as the user/group associated with that package is removed, but that user's files (i.e., files
                    changed after the package was installed) are left behind. Another common cause is the installation of software that does
                    not properly set file ownerships.</xhtml:p>
        <xhtml:p>Files in any NFS mounts may be ignored as the user ID mapping between systems may be out of sync. If your
                    Enterprise uses a central user management system (NIS or LDAP), the presence of unowned files may indicate another
                    problem and should be investigated.</xhtml:p>
      </xccdf:description>
      <xccdf:check system="http://cisecurity.org/check">
        <!--Unowned Files-->
        <xccdf:check-content>
          <ecl:shell-command check="none exist" comment="command test «for PART in `awk '(!/^#/ &amp;&amp; $6 != &quot;0&quot;) { print $2 }' /etc/fstab`; do find $PART -xdev \( -nouser -o -nogroup \) -ls 2&gt;/dev/null; done»">
            <ecl:command>for PART in `awk '(!/^#/ &amp;&amp; $6 != "0") { print $2 }' /etc/fstab`; do find $PART -xdev
                            \( -nouser -o -nogroup \) -ls 2&gt;/dev/null; done</ecl:command>
            <ecl:line-selection op="pm" value="^.+$"/>
          </ecl:shell-command>
        </xccdf:check-content>
      </xccdf:check>
    </xccdf:Rule>
    <xccdf:Rule id="r0608" role="full" selected="false" weight="1.0">
      <xccdf:title>Disable USB Devices (AKA Hotplugger)</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="question">Question:</xhtml:h3>
        <xhtml:p>Is there a mission-critical reason to allow use of PCMCIA or USB-based devices on this system?</xhtml:p>
        <xhtml:p>If the answer to this question is no, then perform the action below.</xhtml:p>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:i>To stop the packages from running and prevent them from running at boot:</xhtml:i>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">cd /etc/rc.d</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/etc/rc.d/rc.pcmcia stop</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod ugo-x rc.pcmcia</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/etc/rc.d/rc.hotplug stop</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod ugo-x rc.hotplug</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:i>Once the packages have been stopped, to completely remove the packages from the system (no reboot
                    required):</xhtml:i>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">cd /var/log/packages</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">removepkg pcmcia*</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">removepkg hotplug*</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>PCMCIA cards, USB drives and memory devices represent another attack vector against your systems. The prices for a
                    512MB or even 1GB USB memory device have become very affordable, and is enough storage to transport vast quantities of
                    data off a system. Few servers have any need for PCMCIA or USB devices and this whole avenue should be disabled.</xhtml:p>
        <xhtml:p>Another possible attack would be to have a bootable Linux system installed on the USB device. Most modern BIOS'
                    allow booting from USB devices, so this would let a person with physical access to a server an extremely easy way take
                    over a system and bypass some of the security you are setting up. See the discussion regarding floppy and CD-ROM drives
                    in section 6.2.</xhtml:p>
        <xhtml:p>For these reasons, you should also disable USB in the BIOS.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:check system="http://cisecurity.org/check">
          <!--Package «hotplug» does not exist-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="Package «hotplug» does not exist">
              <ecl:command>(cd /var/log/packages;ls|sed -r 's/-[^-]+-(i.86|noarch)-.+$//')|egrep '^hotplug$'</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--Package «pcmcia» does not exist-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="Package «pcmcia» does not exist">
              <ecl:command>(cd /var/log/packages;ls|sed -r 's/-[^-]+-(i.86|noarch)-.+$//')|egrep '^pcmcia$'</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
  </xccdf:Group>
  <xccdf:Group id="g07">
    <xccdf:title>System Access, Authentication, and Authorization</xccdf:title>
    <xccdf:description>This group specifies the system access, authentication and authorization recommendations that can help lock down the system.</xccdf:description>
    <xccdf:Rule id="r0701" role="full" selected="false" weight="1.0">
      <xccdf:title>Disable rhosts Support</xccdf:title>
      <xccdf:description>
        <xhtml:p>Is there a mission-critical reason to allow the use of the BSD-style “r-commands”on this system?</xhtml:p>
        <xhtml:p>If the answer to this question is no, then perform the action below.</xhtml:p>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">chmod ugo-x /usr/bin/rlogin</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod ugo-x /usr/bin/rsh</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod ugo-x /usr/bin/rcp</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>Used in conjunction with the BSD-style "r-commands" (<xhtml:span class="code">rlogin</xhtml:span>,<xhtml:span class="code">rsh</xhtml:span>,<xhtml:span class="code">rcp</xhtml:span>), the<xhtml:br clear="none"/>.<xhtml:span class="code">rhosts</xhtml:span>files implement a weak form of authentication based on the network address or host
                    name of the remote computer (which can be spoofed by a potential attacker to exploit the local system). Disabling
                        .<xhtml:span class="code">rhosts</xhtml:span>support helps prevent users from subverting the system's normal access
                    control mechanisms.</xhtml:p>
        <xhtml:p>To permanently disable .<xhtml:span class="code">rhosts</xhtml:span>support, the administrator can remove the
                    following files:</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/usr/bin/rlogin</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/usr/bin/rsh</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/usr/bin/rcp</xhtml:span>
        </xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:check system="http://cisecurity.org/check">
          <!--/usr/bin/rlogin ownership and permission-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="/usr/bin/rlogin ownership and permission">
              <ecl:command>find /usr/bin/rlogin -follow -maxdepth 0 ! \( -perm u=,g=,o= \) -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/usr/bin/rsh ownership and permission-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="/usr/bin/rsh ownership and permission">
              <ecl:command>find /usr/bin/rsh -follow -maxdepth 0 ! \( -perm u=,g=,o= \) -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/usr/bin/rcp ownership and permission-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="/usr/bin/rcp ownership and permission">
              <ecl:command>find /usr/bin/rcp -follow -maxdepth 0 ! \( -perm u=,g=,o= \) -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0702" role="full" selected="false" weight="1.0">
      <xccdf:title>All .rhosts Files Should Be Readable Only By Their Owner</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">find / -type f -name '.rhosts' | xargs chmod 600</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>Ensure that .rhosts files are only readable by the owner of the file (i.e., these files should be mode 600).</xhtml:p>
        <xhtml:p>If .<xhtml:span class="code">rhosts</xhtml:span>support is required for some reason, some basic precautions should
                    be taken when creating and managing .<xhtml:span class="code">rhosts</xhtml:span>files. Never use the "+" wildcard
                    character in<xhtml:br clear="none"/>.<xhtml:span class="code">rhosts</xhtml:span>files. In fact, .<xhtml:span class="code">rhosts</xhtml:span>entries should always specify a specific trusted host name along with the user name
                    of the trusted account on that system (e.g., "trustedhost alice" and not just "trustedhost"). Avoid establishing trust
                    relationships with systems outside of the organization's security perimeter and/or systems not controlled by the local
                    administrative staff. Firewalls and other network security elements should actually block<xhtml:span class="code">rlogin/rsh/rcp</xhtml:span>access from external hosts.</xhtml:p>
      </xccdf:description>
      <xccdf:check system="http://cisecurity.org/check">
        <!--/.rhosts ownership and permission-->
        <xccdf:check-content>
          <ecl:shell-command check="none exist" comment="/.rhosts ownership and permission">
            <ecl:command>find /.rhosts -follow -maxdepth 0 ! \( -perm u=rw,g=,o= \) -ls</ecl:command>
            <ecl:line-selection op="pm" value=".+"/>
          </ecl:shell-command>
        </xccdf:check-content>
      </xccdf:check>
    </xccdf:Rule>
    <xccdf:Rule id="r0703" role="full" selected="false" weight="1.0">
      <xccdf:title>Create ftpusers Files</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">for NAME in `cut -d: -f1 /etc/passwd`; do</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">if [ `id -u $NAME` -lt 500 ]; then</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">echo $NAME &gt;&gt; /etc/ftpusers</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">fi</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">done</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chown root:root /etc/ftpusers</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod 600 /etc/ftpusers</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">diff /etc/ftpusers-preCIS /etc/ftpusers</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">if [ -e /etc/vsftpd.conf ]; then</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">rm -f /etc/vsftpd.ftpusers</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">cp -fp /etc/ftpusers /etc/vsftpd.ftpusers</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">diff /etc/vsftpd.ftpusers-preCIS /etc/vsftpd.ftpusers</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">fi</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">/etc/ftpusers</xhtml:span>and<xhtml:span class="code">/etc/vsftp.ftpusers</xhtml:span>contain a
                    list of users who are not allowed to access the system via<xhtml:span class="code">proftpd</xhtml:span>and<xhtml:span class="code">vsftpd</xhtml:span>, respectively.</xhtml:p>
        <xhtml:p>Generally, only normal users should ever access the system via FTP – there should be no reason for "system" type
                    accounts to be transferring information via this mechanism. Certainly the root account should never be allowed to
                    transfer files directly via FTP.</xhtml:p>
      </xccdf:description>
      <xccdf:check system="http://cisecurity.org/check">
        <!--/etc/ftpusers ownership and permission-->
        <xccdf:check-content>
          <ecl:shell-command check="none exist" comment="/etc/ftpusers ownership and permission">
            <ecl:command>find /etc/ftpusers -follow -maxdepth 0 ! \( -user root -group root -perm u=rw,g=,o= \) -ls</ecl:command>
            <ecl:line-selection op="pm" value=".+"/>
          </ecl:shell-command>
        </xccdf:check-content>
      </xccdf:check>
    </xccdf:Rule>
    <xccdf:Rule id="r0704" role="full" selected="false" weight="1.0">
      <xccdf:title>Prevent X Server From Listening On Port 6000/tcp</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">if [ -e /etc/X11/xdm/Xservers ]; then</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">cd /etc/X11/xdm</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">awk '($1 !~ /^#/ &amp;&amp; $3 == "/usr/X11R6/bin/X") \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">{ $3 = $3 " -nolisten tcp" };</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">{ print }' Xservers-preCIS &gt; Xservers</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chown root:root Xservers</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod 444 Xservers</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">diff Xservers-preCIS Xservers</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">fi</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">if [ -d /etc/X11/xinit ]; then</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">cd /etc/X11/xinit</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">if [ -e xserverrc ]; then</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">awk '/X/ &amp;&amp; !/^#/ \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">{ print $0 " :0 -nolisten tcp \$@"; next }; \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">{ print }' xserverrc-preCIS &gt; xserverrc</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">else</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">cat &lt;&lt;END &gt; xserverrc</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">#!/bin/bash</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">exec X :0 -nolisten tcp \$@</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">END</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">fi</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chown root:root xserverrc</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod 755 xserverrc</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">diff xserverrc-preCIS xserverrc</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">fi</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">FILE=/opt/kde/share/config/kdm/kdmrc</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">if [ -e $FILE ]; then</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">sed -e 's/^#ServerArgsLocal/ServerArgsLocal/' $FILE-preCIS &gt; $FILE</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">fi</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>X servers listen on port 6000/tcp for messages from remote clients running on other systems. However, X Windows
                    uses a relatively insecure authentication protocol and an attacker who is able to gain unauthorized access to the local
                    X server can easily compromise the system. Invoking the "<xhtml:span class="code">-nolisten tcp</xhtml:span>" option
                    causes the X server not to listen on port 6000/tcp by default. This prevents authorized remote X clients from displaying
                    windows on the local system as well. However, the forwarding of X events via SSH will still happen normally. This is the
                    preferred and more secure method transmitting results from remote X clients in any event.</xhtml:p>
        <xhtml:p>
          <xhtml:b>Note:</xhtml:b>gdm is not supplied, as Gnome is not supplied with Slackware.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:complex-check operator="AND">
          <!--/etc/X11/xdm/Xservers-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--/etc/X11/xdm/Xservers text content-->
            <xccdf:check-content>
              <ecl:file-content check="all" comment="/etc/X11/xdm/Xservers text content">
                <ecl:path>/etc/X11/xdm/Xservers</ecl:path>
                <ecl:line-selection op="pm" value="(^#.*$)|(^\s*$)|(^.*/usr/X11R6/bin/X -nolisten tcp.*$)"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--/etc/X11/xdm/Xservers ownership and permission-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="/etc/X11/xdm/Xservers ownership and permission">
                <ecl:command>find /etc/X11/xdm/Xservers -follow -maxdepth 0 ! \( -user root -group root -perm u=r,g=r,o=r \)
                                    -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="AND">
          <!--/etc/X11/xinit/xserverrc-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--/etc/X11/xinit/xserverrc ownership and permission-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="/etc/X11/xinit/xserverrc ownership and permission">
                <ecl:command>find /etc/X11/xinit/xserverrc -follow -maxdepth 0 ! \( -user root -group root -perm
                                    u=rwx,g=rx,o=rx \) -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--command test «egrep '^exec[[:space:]]+X[[:space:]]+:0[[:space:]]+-nolisten[[:space:]]+tcp[[:space:]]+' /etc/X11/xinit/xserverrc»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="command test «egrep '^exec[[:space:]]+X[[:space:]]+:0[[:space:]]+-nolisten[[:space:]]+tcp[[:space:]]+' /etc/X11/xinit/xserverrc»" success="pass">
                <ecl:command>egrep '^exec[[:space:]]+X[[:space:]]+:0[[:space:]]+-nolisten[[:space:]]+tcp[[:space:]]+'
                                    /etc/X11/xinit/xserverrc</ecl:command>
                <ecl:line-selection op="pm" value="^.*$"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/opt/kde/share/config/kdm/kdmrc-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="command test «egrep '^ServerArgsLocal' /opt/kde/share/config/kdm/kdmrc»" success="pass">
              <ecl:command>egrep '^ServerArgsLocal' /opt/kde/share/config/kdm/kdmrc</ecl:command>
              <ecl:line-selection op="pm" value="^.*$"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0705" role="full" selected="false" weight="1.0">
      <xccdf:title>Restrict at/cron To Authorized Users</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">cd /etc/<xhtml:br clear="none"/>rm -f cron.deny at.deny<xhtml:br clear="none"/>echo root
                        &gt; cron.allow<xhtml:br clear="none"/>diff cron.allow-preCIS cron.allow<xhtml:br clear="none"/>echo root
                        &gt; at.allow<xhtml:br clear="none"/>diff at.allow-preCIS at.allow<xhtml:br clear="none"/>chown root:root
                        cron.allow at.allow<xhtml:br clear="none"/>chmod 400 cron.allow at.allow</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>The<xhtml:span class="code">cron.allow</xhtml:span>and<xhtml:span class="code">at.allow</xhtml:span>files are a
                    list of users who are allowed to run the<xhtml:span class="code">crontab</xhtml:span>and at commands to submit jobs to
                    be run at scheduled intervals. On many systems, only the system administrator needs the ability to schedule jobs. Note
                    that even though a given user is not listed in<xhtml:span class="code">cron.allow</xhtml:span>,<xhtml:span class="code">cron</xhtml:span>jobs can still be run as that user.<xhtml:span class="code">cron.allow</xhtml:span>only controls
                    administrative access to the<xhtml:span class="code">crontab</xhtml:span>command for scheduling and modifying<xhtml:span class="code">cron</xhtml:span>jobs.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/cron.deny does not exist-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="/etc/cron.deny does not exist" success="pass">
              <ecl:command>find /etc/cron.deny -follow -maxdepth 0 -ls 2&gt;/dev/null</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/at.deny does not exist-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="/etc/at.deny does not exist" success="pass">
              <ecl:command>find /etc/at.deny -follow -maxdepth 0 -ls 2&gt;/dev/null</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--command test «egrep -v root /etc/cron.allow»-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="command test «egrep -v root /etc/cron.allow»" success="pass">
              <ecl:command>egrep -v root /etc/cron.allow</ecl:command>
              <ecl:line-selection op="pm" value="^.+$"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--command test «egrep -v root /etc/at.allow»-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="command test «egrep -v root /etc/at.allow»" success="pass">
              <ecl:command>egrep -v root /etc/at.allow</ecl:command>
              <ecl:line-selection op="pm" value="^.+$"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/cron.allow ownership and permission-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="/etc/cron.allow ownership and permission">
              <ecl:command>find /etc/cron.allow -follow -maxdepth 0 ! \( -user root -group root -perm u=r,g=,o= \) -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/at.allow ownership and permission-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="/etc/at.allow ownership and permission">
              <ecl:command>find /etc/at.allow -follow -maxdepth 0 ! \( -user root -group root -perm u=r,g=,o= \) -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0706" role="full" selected="false" weight="1.0">
      <xccdf:title>Restrict Permissions On crontab Files</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">chown root:root /etc/crontab<xhtml:br clear="none"/>chmod 400 /etc/crontab<xhtml:br clear="none"/>chown -R root:root /var/spool/cron<xhtml:br clear="none"/>chmod -R go-rwx /var/spool/cron<xhtml:br clear="none"/>ls | grep cron | grep -v preCIS | xargs chown -R root:root<xhtml:br clear="none"/>ls | grep cron |
                        grep -v preCIS | xargs chmod -R go-rwx</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>The system<xhtml:span class="code">crontab</xhtml:span>files are accessed only by the<xhtml:span class="code">cron</xhtml:span>daemon (which runs with superuser privileges) and the<xhtml:span class="code">crontab</xhtml:span>command (which is set-UID to root). Allowing unprivileged users to read or (even worse) modify
                        system<xhtml:span class="code">crontab</xhtml:span>files can create the potential for a local user on the system to
                    gain elevated privileges.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:complex-check operator="AND">
          <!--/etc/crontab-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--/etc/crontab ownership and permission-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="/etc/crontab ownership and permission">
                <ecl:command>find /etc/crontab -follow -maxdepth 0 ! \( -user root -group root -perm u=r,g=,o= \) -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="AND">
          <!--/var/spool/cron-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--command test «find /var/spool/cron ! \( -user root -group root \) -ls»-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="command test «find /var/spool/cron ! \( -user root -group root \) -ls»">
                <ecl:command>find /var/spool/cron ! \( -user root -group root \) -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="AND">
          <!--/etc/*cron*-->
          <xccdf:check system="http://cisecurity.org/check">
            <!--command test «find /etc -maxdepth 0 -name '*cron*' ! \( -user root -group root -perm g=,o= \) -ls»-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="command test «find /etc -maxdepth 0 -name '*cron*' ! \( -user root -group root -perm g=,o= \) -ls»">
                <ecl:command>find /etc -maxdepth 0 -name '*cron*' ! \( -user root -group root -perm g=,o= \) -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0707" role="unscored" selected="false" weight="0.0">
      <xccdf:title>Configure inetd Access Control</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:i>See discussion below.</xhtml:i>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>To enhance access control further (from section 2.2) to to daemons spawned from inetd or that run all the time,
                    consider the following applications: PortSentry or PSAD. These programs provide an additional layer of access control
                    protection at the application layer.</xhtml:p>
        <xhtml:p>The PortSentry tool (http://sourceforge.net/projects/sentrytools/) can be used to monitor access attempts on unused
                    ports. Note that running PortSentry may result in the CIS testing tools reporting "false positives" for "active" ports
                    that are actually being held by the PortSentry daemon. Also, note that PortSentry does not seem to be actively
                    supported, since its last update was in May 2003.</xhtml:p>
        <xhtml:p>Consider replacing the PortSentry daemon with PSAD, short for Port Scan Attack Detector, available from
                    http://www.cipherdyne.com/psad/. Unlike PortSentry, PSAD doesn't have to hold open ports -- instead, it communicates
                    directly with the kernel and is currently maintained.</xhtml:p>
      </xccdf:description>
      <!--            <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                <xccdf:check-content-ref href="slackware-10.2-oval.xml" name="oval:org.cisecurity:def:990707"/>
            </xccdf:check>-->
      <!--<xccdf:check system="http://www.cisecurity.org/xccdf/interactive/0.1">
                <xccdf:check-content-ref href="slackware-10.2-inter.xml" name="qstn-0003"/>
            </xccdf:check>-->
    </xccdf:Rule>
    <xccdf:Rule id="r0708" role="full" selected="false" weight="1.0">
      <xccdf:title>Restrict Root Logins To System Console</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">echo console &gt; /etc/securetty</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">for i in `seq 1 6`; do</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">echo tty$i &gt;&gt; /etc/securetty</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">done</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chown root:root /etc/securetty</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod 400 /etc/securetty</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">diff /etc/securetty-preCIS /etc/securetty</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>Anonymous root logins should never be allowed, except on the system console in emergency situations. At all other
                    times, the administrator should access the system via an unprivileged account and use some authorized mechanism (such as
                        the<xhtml:span class="code">su</xhtml:span>command, or the freely-available<xhtml:span class="code">sudo</xhtml:span>package) to gain additional privileges. These mechanisms provide at least some audit trail in the
                    event of problems.</xhtml:p>
        <xhtml:p>Many Enterprises – who use serial port concentrators to connect to a server in a data center without physically
                    having to use the keyboard – consider the serial port a console. This is in keeping with the Unix server tradition of
                    controlling headless Unix machines using a serial port console. Just like the virtual consoles, this one needs protected
                    as well. If this applies to your organization, you may execute these lines:</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">echo ttyS0 &gt;&gt; /etc/securetty<xhtml:br clear="none"/>echo ttyS1 &gt;&gt;
                        /etc/securetty </xhtml:span>
        </xhtml:p>
        <xhtml:p>Be advised that doing so will reduce your CIS Scoring Tool score and reduce your security posture.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:complex-check operator="AND">
          <xccdf:check system="http://cisecurity.org/check">
            <!--/etc/securetty text content-->
            <xccdf:check-content>
              <ecl:file-content check="at least one" comment="/etc/securetty text content">
                <ecl:path>/etc/securetty</ecl:path>
                <ecl:line-selection op="pm" value="^(.+)$">
                  <ecl:regex-group group="1" op="eq" value="console"/>
                </ecl:line-selection>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--/etc/securetty text content-->
            <xccdf:check-content>
              <ecl:file-content check="at least one" comment="/etc/securetty text content">
                <ecl:path>/etc/securetty</ecl:path>
                <ecl:line-selection op="pm" value="^(.+)$">
                  <ecl:regex-group group="1" op="eq" value="tty1"/>
                </ecl:line-selection>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--/etc/securetty text content-->
            <xccdf:check-content>
              <ecl:file-content check="at least one" comment="/etc/securetty text content">
                <ecl:path>/etc/securetty</ecl:path>
                <ecl:line-selection op="pm" value="^(.+)$">
                  <ecl:regex-group group="1" op="eq" value="tty2"/>
                </ecl:line-selection>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--/etc/securetty text content-->
            <xccdf:check-content>
              <ecl:file-content check="at least one" comment="/etc/securetty text content">
                <ecl:path>/etc/securetty</ecl:path>
                <ecl:line-selection op="pm" value="^(.+)$">
                  <ecl:regex-group group="1" op="eq" value="tty3"/>
                </ecl:line-selection>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--/etc/securetty text content-->
            <xccdf:check-content>
              <ecl:file-content check="at least one" comment="/etc/securetty text content">
                <ecl:path>/etc/securetty</ecl:path>
                <ecl:line-selection op="pm" value="^(.+)$">
                  <ecl:regex-group group="1" op="eq" value="tty4"/>
                </ecl:line-selection>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--/etc/securetty text content-->
            <xccdf:check-content>
              <ecl:file-content check="at least one" comment="/etc/securetty text content">
                <ecl:path>/etc/securetty</ecl:path>
                <ecl:line-selection op="pm" value="^(.+)$">
                  <ecl:regex-group group="1" op="eq" value="tty5"/>
                </ecl:line-selection>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--/etc/securetty text content-->
            <xccdf:check-content>
              <ecl:file-content check="at least one" comment="/etc/securetty text content">
                <ecl:path>/etc/securetty</ecl:path>
                <ecl:line-selection op="pm" value="^(.+)$">
                  <ecl:regex-group group="1" op="eq" value="tty6"/>
                </ecl:line-selection>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/securetty ownership and permission-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="/etc/securetty ownership and permission">
              <ecl:command>find /etc/securetty -follow -maxdepth 0 ! \( -user root -group root -perm u=r,g=,o= \) -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0709" role="full" selected="false" weight="1.0">
      <xccdf:title>Set LILO Password</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:i>Replace<xhtml:span class="code">&lt;password&gt;</xhtml:span>with an appropriate password for your
                        organization.</xhtml:i>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chown root:root /etc/lilo.conf<xhtml:br clear="none"/>chmod 600 /etc/lilo.conf<xhtml:br clear="none"/>lilo</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>By default on most Linux systems, the boot loader prompt allows an attacker to subvert the normal boot process very
                    easily. The action above will allow the system to boot normally, only requiring a password when the user attempts to
                    modify the boot process by passing commands to LILO. Make sure to replace<xhtml:span class="code">&lt;password&gt;</xhtml:span>in the actions above with a good password.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="OR">
        <!--LILO-->
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/lilo.conf does not exist-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="/etc/lilo.conf does not exist" success="pass">
              <ecl:command>find /etc/lilo.conf -follow -maxdepth 0 -ls 2&gt;/dev/null</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:complex-check operator="AND">
          <xccdf:check system="http://cisecurity.org/check">
            <!--/etc/lilo.conf text content-->
            <xccdf:check-content>
              <ecl:file-content check="at least one" comment="/etc/lilo.conf text content">
                <ecl:path>/etc/lilo.conf</ecl:path>
                <ecl:line-selection op="pm" value="^restricted$"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--/etc/lilo.conf text content-->
            <xccdf:check-content>
              <ecl:file-content check="at least one" comment="/etc/lilo.conf text content">
                <ecl:path>/etc/lilo.conf</ecl:path>
                <ecl:line-selection op="pm" value="^password=.+$"/>
              </ecl:file-content>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--/etc/lilo.conf ownership and permission-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="/etc/lilo.conf ownership and permission">
                <ecl:command>find /etc/lilo.conf -follow -maxdepth 0 ! \( -user root -group root -perm u=rw,g=,o= \) -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0710" role="unscored" selected="false" weight="0.0">
      <xccdf:title>Require Authentication For Single-User Mode</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:i>See discussion below.</xhtml:i>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>By default on Slackware, if you attempt to enter single user mode by typing "linux single" at the LILO prompt, you
                    are then required to login as root and enter the root password.</xhtml:p>
        <xhtml:p>If an attacker has access to the physical machine, there are a range of attacks that can be made, including booting
                    from the Slackware installation cdrom, booting a Knoppix cdrom, or using LILO attacks that allow brief root access
                    enough to change the root password.</xhtml:p>
        <xhtml:p>To help prevent these sorts of attacks, you should consider setting the BIOS to boot only from the main hard disk
                    and locking this setting with a BIOS password. Even these measures can be defeated on some servers by opening the box
                    and resetting BIOS to its defaults. Physical security of the hardware is important. For more information on reducing the
                    threat posed by an attacker with physical/boot access, consider the article "Anyone with a Screwdriver Can Break In,"
                    available at <xhtml:a href="http://www.bastille-linux.org/jay/anyone-with-a-screwdriver.html" shape="rect">
                        http://www.bastille-linux.org/jay/anyone-with-a-screwdriver.html</xhtml:a>.</xhtml:p>
        <xhtml:p>
          <xhtml:b>Note:</xhtml:b>Even though this topic is addressed by Bastille, and Bastille does not support Slackware, the
                    system administrator may want to apply the precautions in the article.</xhtml:p>
      </xccdf:description>
      <!--            <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                <xccdf:check-content-ref href="slackware-10.2-oval.xml" name="oval:org.cisecurity:def:990710"/>
            </xccdf:check>-->
      <!--<xccdf:check system="http://www.cisecurity.org/xccdf/interactive/0.1">
                <xccdf:check-content-ref href="slackware-10.2-inter.xml" name="qstn-0004"/>
            </xccdf:check>-->
    </xccdf:Rule>
    <xccdf:Rule id="r0711" role="full" selected="false" weight="1.0">
      <xccdf:title>Restrict NFS Client Requests To Privileged Ports</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>Add the secure option to all entries in the /etc/exports file. The following Perl code will perform this action
                    automatically.</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">if [ -s /etc/exports ]; then</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">perl -i.orig -pe \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">'next if (/^\s*#/ || /^\s*$/);</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">($res, @hst) = split(" ");</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">foreach $ent (@hst) {</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">undef(%set);</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">($optlist) = $ent =~ /\((.*?)\)/;</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">foreach $opt (split(/,/, $optlist)) {</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">$set{$opt} = 1;</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">}</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">delete($set{"insecure"});</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">$set{"secure"} = 1;</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">$ent =~ s/\(.*?\)//;</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">$ent .= "(" . join(",", keys(%set)) . ")";</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">}</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">$hst[0] = "(secure)" unless (@hst);</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">$_ = "$res\t" . join(" ", @hst) . "\n";' \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/etc/exports</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">fi</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">diff /etc/exports-preCIS /etc/exports</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>Setting the secure parameter causes the NFS server process on the local system to ignore NFS client requests that
                    do not originate from the privileged port range (ports less than 1024). This should not hinder normal NFS operations but
                    may block some automated NFS attacks that are run by unprivileged users.</xhtml:p>
      </xccdf:description>
      <xccdf:check system="http://cisecurity.org/check">
        <!--command test «egrep -v '(^#.*$)|(^$)' /etc/exports|egrep -v 'secure'»-->
        <xccdf:check-content>
          <ecl:shell-command check="none exist" comment="command test «egrep -v '(^#.*$)|(^$)' /etc/exports|egrep -v 'secure'»" success="pass">
            <ecl:command>egrep -v '(^#.*$)|(^$)' /etc/exports|egrep -v 'secure'</ecl:command>
            <ecl:line-selection op="pm" value="^.+$"/>
          </ecl:shell-command>
        </xccdf:check-content>
      </xccdf:check>
    </xccdf:Rule>
    <xccdf:Rule id="r0712" role="full" selected="false" weight="1.0">
      <xccdf:title>Only Enable syslog To Accept Messages If Absolutely Necessary</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="question">Question:</xhtml:h3>
        <xhtml:p>Is this machine a log server, or does it need to receive<xhtml:span class="code">syslog</xhtml:span>messages via
                    the network from other systems?</xhtml:p>
        <xhtml:p>If the answer to this question is yes, then perform the action below.</xhtml:p>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:i>Read<xhtml:span class="code">syslog</xhtml:span>manpage for the -l, -r and -s options.</xhtml:i>
        </xhtml:p>
        <xhtml:p>
          <xhtml:i>Edit<xhtml:span class="code">/etc/rc.d/rc.syslog</xhtml:span>and look for the line that says:</xhtml:i>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/usr/sbin/syslogd</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:i>and add the entries that are appropriate for your site. An example entry would look like this:</xhtml:i>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/usr/sbin/syslogd -l loghost -r -s mydomain.com</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>By default the system logging daemon,<xhtml:span class="code">syslogd</xhtml:span>, does not listen for log
                    messages from other systems on network port 514/udp (Solaris, by contrast, does listen by default).</xhtml:p>
        <xhtml:p>It is considered good practice to set up one or more machines as central "log servers" to aggregate log traffic
                    from all machines at a site. However, unless a system is set up to be one of these "log server" systems, it should not
                    be listening on 514/udp for incoming log messages as the protocol used to transfer these messages does not include any
                    form of authentication, so a malicious outsider could simply barrage the local system's<xhtml:span class="code">syslog</xhtml:span>port with spurious traffic either as a denial-of- service attack on the system, or to fill up the
                    local system's logging file systems so that subsequent attacks will not be logged.</xhtml:p>
      </xccdf:description>
      <xccdf:check system="http://cisecurity.org/check">
        <!--/etc/rc.d/rc.syslog text content-->
        <xccdf:check-content>
          <ecl:file-content check="none exist" comment="/etc/rc.d/rc.syslog text content">
            <ecl:path>/etc/rc.d/rc.syslog</ecl:path>
            <ecl:line-selection op="pm" value="^/usr/sbin/syslogd.+-r.*$"/>
          </ecl:file-content>
        </xccdf:check-content>
      </xccdf:check>
    </xccdf:Rule>
  </xccdf:Group>
  <xccdf:Group id="g08">
    <xccdf:title>User Accounts and Environment</xccdf:title>
    <xccdf:description>
      <xhtml:p>Note that the items in this section are tasks that the local administrator should undertake on a regular, ongoing basis
                perhaps in an automated fashion via<xhtml:span class="code">cron</xhtml:span>. The automated host-based scanning tools
                provided from the Center for Internet Security can be used for this purpose. These scanning tools are typically provided
                with this document, but are also available for free download from<xhtml:a href="http://www.CISecurity.org/" shape="rect">
                    http://www.CISecurity.org/</xhtml:a>.</xhtml:p>
    </xccdf:description>
    <xccdf:Rule id="r0801" role="full" selected="false" weight="1.0">
      <xccdf:title>Block System Accounts</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">for NAME in `cut -d: -f1 /etc/passwd`; do<xhtml:br clear="none"/>MyUID=`id -u $NAME`<xhtml:br clear="none"/>if [ $MyUID -lt 500 -a $NAME != 'root' ]; then<xhtml:br clear="none"/>usermod -L -s /dev/null
                            $NAME<xhtml:br clear="none"/>fi<xhtml:br clear="none"/>done</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>These accounts are non-human system accounts that should be made less useful to an attacker by locking them and
                    setting the shell to a shell not in<xhtml:span class="code">/etc/shells</xhtml:span>. They can even be deleted if the
                    machines does not use the daemon/service that each is responsible for, though it is safest to simply deactivate them as
                    is done here. To deactivate them, lock the password and set the login shell to an invalid shell.<xhtml:span class="code">/dev/null</xhtml:span>is a good choice because it is not a valid login shell, and should an attacker attempt to
                    replace it with a copy of a valid shell the system will not operate properly. Note, if the administrator is using the
                    MySQL service, they will need to change the shell back to bash. The command to do this is:</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">usermod -L -s /bin/bash mysql</xhtml:span>
        </xhtml:p>
        <xhtml:p>This section expands upon section 3.6 for locking out users.</xhtml:p>
      </xccdf:description>
      <xccdf:check system="http://cisecurity.org/check">
        <!--command test «awk -F: '($1!="root" && $3<500 && $7!="/dev/null") {print}' /etc/passwd»-->
        <xccdf:check-content>
          <ecl:shell-command check="none exist" comment="command test «awk -F: '($1!=&quot;root&quot; &amp;&amp; $3&lt;500 &amp;&amp; $7!=&quot;/dev/null&quot;) {print}' /etc/passwd»">
            <ecl:command>awk -F: '($1!="root" &amp;&amp; $3&lt;500 &amp;&amp; $7!="/dev/null") {print}'
                            /etc/passwd</ecl:command>
            <ecl:line-selection op="pm" value=".+"/>
          </ecl:shell-command>
        </xccdf:check-content>
      </xccdf:check>
    </xccdf:Rule>
    <xccdf:Rule id="r0802" role="full" selected="false" weight="1.0">
      <xccdf:title>Verify That There Are No Accounts With Empty Password Fields</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>The command:</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">awk -F: '($2 == "") { print $1 }' /etc/shadow</xhtml:span>
        </xhtml:p>
        <xhtml:p>should return no lines of output.</xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>An account with an empty password field means that anybody may log in as that user without providing a password at
                    all. All accounts should have strong passwords or should be locked by using a password string like "<xhtml:span class="code">NP</xhtml:span>" or "<xhtml:span class="code">*LOCKED*</xhtml:span>".</xhtml:p>
        <xhtml:p>The default Slackware indicator for a locked system account is “<xhtml:span class="code">!*</xhtml:span>”.
                    Optionally, the administrator may want to run the following script, that will change empty password fields and the
                    default Slackware locked password indicator “<xhtml:span class="code">!*</xhtml:span>” to “<xhtml:span class="code">*LOCKED*</xhtml:span>”.</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">awk 'BEGIN { OFS=":"; FS=":"} ($2 == "" || $2 == "!*") \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">{ $2 = "*LOCKED*" }; \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">{ print } ' /etc/shadow &gt; /etc/shadow.tmp</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">mv -f /etc/shadow.tmp /etc/shadow</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod 400 /etc/shadow</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:b>Note:</xhtml:b>even if an account has no password, the second field will still show a hashed value.</xhtml:p>
      </xccdf:description>
      <xccdf:check system="http://cisecurity.org/check">
        <!--command test «awk -F: '(!$2) {print}' /etc/shadow»-->
        <xccdf:check-content>
          <ecl:shell-command check="none exist" comment="command test «awk -F: '(!$2) {print}' /etc/shadow»">
            <ecl:command>awk -F: '(!$2) {print}' /etc/shadow</ecl:command>
            <ecl:line-selection op="pm" value=".+"/>
          </ecl:shell-command>
        </xccdf:check-content>
      </xccdf:check>
    </xccdf:Rule>
    <xccdf:Rule id="r0803" role="full" selected="false" weight="1.0">
     <xccdf:title>Set Account Expiration Parameters On Active Accounts</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">cd /etc<xhtml:br clear="none"/>awk '($1 ~ /^PASS_MAX_DAYS/) { $2="90" }<xhtml:br clear="none"/>($1 ~ /^PASS_MIN_DAYS/) { $2="7" }<xhtml:br clear="none"/>($1 ~ /^PASS_WARN_AGE/) { $2="28" }<xhtml:br clear="none"/>($1 ~ /^PASS_MIN_LEN/) { $2="6" }<xhtml:br clear="none"/>{ print } ' login.defs-preCIS &gt;
                            login.defs<xhtml:br clear="none"/>chown root:root login.defs<xhtml:br clear="none"/>chmod 640
                            login.defs<xhtml:br clear="none"/>diff login.defs-preCIS login.defs<xhtml:br clear="none"/>for NAME in `cut -d:
                        -f1 /etc/passwd`; do<xhtml:br clear="none"/>uid=`id -u $NAME`<xhtml:br clear="none"/>if [ $uid -ge 500 -a $uid !=
                        65534 ]; then<xhtml:br clear="none"/>chage -m 7 -M 90 -W 28 $NAME<xhtml:br clear="none"/>fi<xhtml:br clear="none"/>done</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>It is a good idea to force users to change passwords on a regular basis. The commands above will set all active
                    accounts (except the root account) to force password changes every 90 days, and then prevent password changes for seven
                    days thereafter. Users will begin receiving warnings 28 days before their password expires. Slackware also has the
                    option of expiring idle accounts after a certain number of days (see the on-line manual page for the<xhtml:span class="code">usermod</xhtml:span> command, particularly the -f option). Finally, the instructions above set a
                    minimum password length of 6 characters.</xhtml:p>
        <xhtml:p>These are recommended starting values. Some regulated industries require more restrictive values – ensure they
                    comply with your security policy.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/login.defs text content-->
          <xccdf:check-content>
            <ecl:file-content check="all" comment="/etc/login.defs text content">
              <ecl:path>/etc/login.defs</ecl:path>
              <ecl:line-selection op="pm" value="^PASS_MAX_DAYS\s+(\d+)$">
                <ecl:regex-group dt="xs:integer" group="1" op="le" value="90"/>
              </ecl:line-selection>
            </ecl:file-content>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/login.defs text content-->
          <xccdf:check-content>
            <ecl:file-content check="all" comment="/etc/login.defs text content">
              <ecl:path>/etc/login.defs</ecl:path>
              <ecl:line-selection op="pm" value="^PASS_MIN_DAYS\s+(\d+)$">
                <ecl:regex-group dt="xs:integer" group="1" op="ge" value="7"/>
              </ecl:line-selection>
            </ecl:file-content>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/login.defs text content-->
          <xccdf:check-content>
            <ecl:file-content check="all" comment="/etc/login.defs text content">
              <ecl:path>/etc/login.defs</ecl:path>
              <ecl:line-selection op="pm" value="^PASS_WARN_AGE\s+(\d+)$">
                <ecl:regex-group dt="xs:integer" group="1" op="eq" value="28"/>
              </ecl:line-selection>
            </ecl:file-content>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/login.defs text content-->
          <xccdf:check-content>
            <ecl:file-content check="all" comment="/etc/login.defs text content">
              <ecl:path>/etc/login.defs</ecl:path>
              <ecl:line-selection op="pm" value="^PASS_MIN_LEN\s+(\d+)$">
                <ecl:regex-group dt="xs:integer" group="1" op="ge" value="6"/>
              </ecl:line-selection>
            </ecl:file-content>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/login.defs ownership and permission-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="/etc/login.defs ownership and permission">
              <ecl:command>find /etc/login.defs -follow -maxdepth 0 ! \( -user root -group root -perm u=rw,g=r,o= \) -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--chage -m 7 -M 90 -W 28 -I 7 all user accounts-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="command test «for u in `awk -F: '($3&gt;500 &amp;&amp; $3&lt;65534) {print $1}' /etc/passwd`; do egrep ^$u: /etc/shadow; done|awk -F: '($2!~/[!*]+/ &amp;&amp; ($4&gt;=7 || $5&gt;90 || $6&gt;28 || $7&gt;7)) {print}'»">
              <ecl:command>for u in `awk -F: '($3&gt;500 &amp;&amp; $3&lt;65534) {print $1}' /etc/passwd`; do
                                egrep ^$u: /etc/shadow; done|awk -F: '($2!~/[!*]+/ &amp;&amp; ($4&gt;=7 || $5&gt;90 ||
                                $6&gt;28 || $7&gt;7)) {print}'</ecl:command>
              <ecl:line-selection op="pm" value="^.+$"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0804" role="full" selected="false" weight="1.0">
      <xccdf:title>Verify No Legacy '+' Entries Exist In passwd, shadow, And group Files</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>The command:</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">grep ^+: /etc/passwd /etc/shadow /etc/group</xhtml:span>
        </xhtml:p>
        <xhtml:p>should return no lines of output.</xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>'+' entries in various files used to be markers for systems to insert data from NIS maps at a certain point in a
                    system configuration file. These entries may provide an avenue for attackers to gain privileged access on the system,
                    and should be deleted if they exist.</xhtml:p>
      </xccdf:description>
      <xccdf:check system="http://cisecurity.org/check">
        <!--/etc/^(passwd|shadow|group)$ text content-->
        <xccdf:check-content>
          <ecl:file-content check="none exist" comment="/etc/^(passwd|shadow|group)$ text content">
            <ecl:path>/etc/^(passwd|shadow|group)$</ecl:path>
            <ecl:line-selection op="pm" value="^+:.*$"/>
          </ecl:file-content>
        </xccdf:check-content>
      </xccdf:check>
    </xccdf:Rule>
    <xccdf:Rule id="r0805" role="full" selected="false" weight="1.0">
      <xccdf:title>Verify That No UID 0 Accounts Exist Other Than Root</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>The command:</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">awk -F: '($3 == 0) { print $1 }' /etc/passwd</xhtml:span>
        </xhtml:p>
        <xhtml:p>should return only the word "root".</xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>Any account with UID 0 has superuser privileges on the system. The only superuser account on the machine should be
                    the root account, and it should be accessed by logging in as an unprivileged user and using the<xhtml:span class="code">su</xhtml:span>command (or equivalent) to gain additional privilege.</xhtml:p>
        <xhtml:p>Finer granularity access control for administrative access can be achieved by using<xhtml:span class="code">sudo</xhtml:span>and<xhtml:span class="code">visudo</xhtml:span>. Administrators can find more information by
                    checking the man pages.</xhtml:p>
      </xccdf:description>
      <xccdf:check system="http://cisecurity.org/check">
        <!--command test «awk -F: '($3==0 && $1!="root") {print}' /etc/passwd»-->
        <xccdf:check-content>
          <ecl:shell-command check="none exist" comment="command test «awk -F: '($3==0 &amp;&amp; $1!=&quot;root&quot;) {print}' /etc/passwd»">
            <ecl:command>awk -F: '($3==0 &amp;&amp; $1!="root") {print}' /etc/passwd</ecl:command>
            <ecl:line-selection op="pm" value="^.+$"/>
          </ecl:shell-command>
        </xccdf:check-content>
      </xccdf:check>
    </xccdf:Rule>
    <xccdf:Rule id="r0806" role="full" selected="false" weight="1.0">
      <xccdf:title>No '.' or Group/World-Writable Directory In Root's $PATH</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>The automated testing tool supplied with this benchmark will alert the administrator if action is required.</xhtml:p>
        <xhtml:p>
          <xhtml:i>To find ‘.’ in<xhtml:span class="code">$PATH:</xhtml:span></xhtml:i>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">echo $PATH | egrep '(^|:)(\.|:|$)'</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:i>To find group- or world-writable directories in<xhtml:span class="code">$PATH:</xhtml:span></xhtml:i>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">find `echo $PATH | tr ':' ' '` -type d \<xhtml:br clear="none"/>\( -perm -002 -o -perm -020 \)
                        -ls</xhtml:span>
        </xhtml:p>
        <xhtml:p>These commands should produce no output.</xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>Including the current working directory ('.') or other writable directory in root's executable path makes it likely
                    that an attacker can gain superuser access by forcing an administrator operating as root to execute a Trojan horse
                    program. If output is produced, the administrator should audit the scripts in<xhtml:span class="code">/etc/profile</xhtml:span>and<xhtml:span class="code">/etc/profile.d</xhtml:span>.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:check system="http://cisecurity.org/check">
          <!--command test «echo $PATH»-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="command test «echo $PATH»">
              <ecl:command>echo $PATH</ecl:command>
              <ecl:line-selection op="pm" value="^\.:|:\.:|:\.$"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--command test «find `echo $PATH|sed "s/:/ /g"` -prune -type d \( -perm -g+w -o -perm -o+w \) 2>/dev/null»-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="command test «find `echo $PATH|sed &quot;s/:/ /g&quot;` -prune -type d \( -perm -g+w -o -perm -o+w \) 2&gt;/dev/null»">
              <ecl:command>find `echo $PATH|sed "s/:/ /g"` -prune -type d \( -perm -g+w -o -perm -o+w \) 2&gt;/dev/null</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0807" role="full" selected="false" weight="1.0">
      <xccdf:title>User Home Directories Should Be Mode 750 or More Restrictive</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">for DIR in \<xhtml:br clear="none"/>`awk -F: '($3 &gt;= 500) { print $6 }' /etc/passwd`;
                            do<xhtml:br clear="none"/>chmod g-w $DIR<xhtml:br clear="none"/>chmod o-rwx $DIR<xhtml:br clear="none"/>done</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>Group or world-writable user home directories may enable malicious users to steal or modify other users' data or to
                    gain another user's system privileges. Disabling "read" and "execute" access for users who are not members of the same
                    group (the "other" access category) allows for appropriate use of discretionary access control by each user. While the
                    above modifications are relatively benign, making global modifications to user home directories without alerting the
                    user community can result in unexpected outages and unhappy users.</xhtml:p>
      </xccdf:description>
      <xccdf:check system="http://cisecurity.org/check">
        <!--command test «find `awk -F: '($3 >= 500 && $1 != "nobody") {print $6}' /etc/passwd` -maxdepth 1 -type d -prune \( -perm -g+w -o -perm -o+r -o -perm -o+w -o -perm -o+x \) -ls»-->
        <xccdf:check-content>
          <ecl:shell-command check="none exist" comment="command test «find `awk -F: '($3 &gt;= 500 &amp;&amp; $1 != &quot;nobody&quot;) {print $6}' /etc/passwd` -maxdepth 1 -type d -prune \( -perm -g+w -o -perm -o+r -o -perm -o+w -o -perm -o+x \) -ls»">
            <ecl:command>find `awk -F: '($3 &gt;= 500 &amp;&amp; $1 != "nobody") {print $6}' /etc/passwd` -maxdepth
                            1 -type d -prune \( -perm -g+w -o -perm -o+r -o -perm -o+w -o -perm -o+x \) -ls</ecl:command>
            <ecl:line-selection op="pm" value=".+"/>
          </ecl:shell-command>
        </xccdf:check-content>
      </xccdf:check>
    </xccdf:Rule>
    <xccdf:Rule id="r0808" role="full" selected="false" weight="1.0">
      <xccdf:title>No User Dot-Files Should Be World-Writable</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">for DIR in \<xhtml:br clear="none"/>`awk -F: '($3 &gt;= 500) { print $6 }' /etc/passwd`;
                            do<xhtml:br clear="none"/>for FILE in $DIR/.[A-Za-z0-9]*; do<xhtml:br clear="none"/>if [ ! -h "$FILE" -a -f
                        "$FILE" ]; then<xhtml:br clear="none"/>chmod go-w "$FILE"<xhtml:br clear="none"/>fi<xhtml:br clear="none"/>done<xhtml:br clear="none"/>done</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>World-writable user configuration files may enable malicious users to steal or modify other users' data or to gain
                    another user's system privileges. While the above modifications are relatively benign, making global modifications to
                    user home directories without alerting the user community can result in unexpected outages and unhappy users.</xhtml:p>
      </xccdf:description>
      <xccdf:check system="http://cisecurity.org/check">
        <!--command test «find `cut -f6 -d: /etc/passwd` -maxdepth 1 -type f -name '\.*' -prune \( -perm -g+w -o -perm -o+w \) 2>/dev/null»-->
        <xccdf:check-content>
          <ecl:shell-command check="none exist" comment="command test «find `cut -f6 -d: /etc/passwd` -maxdepth 1 -type f -name '\.*' -prune \( -perm -g+w -o -perm -o+w \) 2&gt;/dev/null»">
            <ecl:command>find `cut -f6 -d: /etc/passwd` -maxdepth 1 -type f -name '\.*' -prune \( -perm -g+w -o -perm -o+w \)
                            2&gt;/dev/null</ecl:command>
            <ecl:line-selection op="pm" value="^.+$"/>
          </ecl:shell-command>
        </xccdf:check-content>
      </xccdf:check>
    </xccdf:Rule>
    <xccdf:Rule id="r0809" role="full" selected="false" weight="1.0">
      <xccdf:title>Remove User .netrc Files</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>find / -name .netrc</xhtml:p>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:b>Stop!!!</xhtml:b>
          <xhtml:i>Read the discussion before proceeding.</xhtml:i>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">for DIR in `cut -f6 -d: /etc/passwd`; do<xhtml:br clear="none"/>if [ -e $DIR/.netrc ];
                            then<xhtml:br clear="none"/>echo "Removing $DIR/.netrc"<xhtml:br clear="none"/>rm -f $DIR/.netrc<xhtml:br clear="none"/>fi<xhtml:br clear="none"/>done</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">.netrc</xhtml:span>files (used by ftp) may contain unencrypted passwords which may be used to
                    attack other systems. While the above modifications are relatively benign, making global modifications to user home
                    directories without alerting the user community can result in unexpected outages and unhappy users. If the first command
                    returns any results, carefully evaluate the ramifications of removing those files before executing the remaining
                    commands as you may end up impacting an application that has not had time to revise its architecture to a more secure
                    design, such as using sftp.</xhtml:p>
      </xccdf:description>
      <xccdf:check system="http://cisecurity.org/check">
        <!--command test «find `cut -f6 -d: /etc/passwd` -maxdepth 1 -type f -name '.netrc' 2>/dev/null»-->
        <xccdf:check-content>
          <ecl:shell-command check="none exist" comment="command test «find `cut -f6 -d: /etc/passwd` -maxdepth 1 -type f -name '.netrc' 2&gt;/dev/null»">
            <ecl:command>find `cut -f6 -d: /etc/passwd` -maxdepth 1 -type f -name '.netrc' 2&gt;/dev/null</ecl:command>
            <ecl:line-selection op="pm" value="^.+$"/>
          </ecl:shell-command>
        </xccdf:check-content>
      </xccdf:check>
    </xccdf:Rule>
    <xccdf:Rule id="r0810" role="full" selected="false" weight="1.0">
      <xccdf:title>Set Default umask For Users</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">for FILE in /etc/profile /etc/csh.login /etc/csh.cshrc \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/etc/bashrc; do</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">if ! egrep -q 'umask.*77' $FILE ; then</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">echo "umask 077" &gt;&gt; $FILE</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">fi</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chown root:root $FILE</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod 444 $FILE</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">diff ${FILE}-preCIS $FILE</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">done</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">for FILE in /root/.bash_profile /root/.bashrc \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/root/.cshrc /root/.tcshrc; do</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">if ! egrep -q 'umask.*77' $FILE ; then</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">echo "umask 077" &gt;&gt; $FILE # See description</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">fi</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chown root:root $FILE</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">diff ${FILE}-preCIS $FILE</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">done</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>With a default<xhtml:span class="code">umask</xhtml:span>setting of 077 – a setting agreed to as part of the
                    consensus process with DISA and NSA – files and directories created by users will not be readable by any other user on
                    the system. The user creating the file has the discretion of making their files and directories readable by others via
                        the<xhtml:span class="code">chmod</xhtml:span>command. Users who wish to allow their files and directories to be
                    readable by others by default may choose a different default<xhtml:span class="code">umask</xhtml:span>by inserting
                        the<xhtml:span class="code">umask</xhtml:span>command into the standard shell configuration files (.<xhtml:span class="code">profile</xhtml:span>, .<xhtml:span class="code">cshrc</xhtml:span>, etc.) in their home directories.
                        A<xhtml:span class="code">umask</xhtml:span>of 027 would make files and directories readable by users in the same
                    Unix group, while a<xhtml:span class="code">umask</xhtml:span>of 022 would make files readable by every user on the
                    system.</xhtml:p>
        <xhtml:p>We adjust root's<xhtml:span class="code">umask</xhtml:span>setting separately in this item, as root shells don't
                    necessarily read the system-wide configuration files. For example, root sessions using bash doesn't get<xhtml:span class="code">umask</xhtml:span>settings from<xhtml:span class="code">/etc/profile</xhtml:span>.</xhtml:p>
        <xhtml:p>
          <xhtml:b>Note:</xhtml:b>This is been shown to cause problems with the installation of software packages where the
                    installation script uses the default<xhtml:span class="code">umask</xhtml:span>– the directories are owned by root with
                    700 permissions, and then the application and/or daemon cannot read its files. A simple fix to this problem is to
                    manually issue a less restrictive<xhtml:span class="code">umask</xhtml:span>(such as<xhtml:span class="code">umask</xhtml:span>022) for the shell session doing the installation, or place such a<xhtml:span class="code">umask</xhtml:span>command in the beginning to a less restrictive value before the installation, or in the beginning of
                    the installation script.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:complex-check operator="AND">
          <xccdf:check system="http://cisecurity.org/check">
            <!--command test «egrep '^umask[[:space:]]+077$' /etc/profile»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="command test «egrep '^umask[[:space:]]+077$' /etc/profile»" success="pass">
                <ecl:command>egrep '^umask[[:space:]]+077$' /etc/profile</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--command test «egrep '^umask[[:space:]]+077$' /etc/csh.login»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="command test «egrep '^umask[[:space:]]+077$' /etc/csh.login»" success="pass">
                <ecl:command>egrep '^umask[[:space:]]+077$' /etc/csh.login</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--command test «egrep '^umask[[:space:]]+077$' /etc/csh.cshrc»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="command test «egrep '^umask[[:space:]]+077$' /etc/csh.cshrc»" success="pass">
                <ecl:command>egrep '^umask[[:space:]]+077$' /etc/csh.cshrc</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--command test «egrep '^umask[[:space:]]+077$' /etc/bashrc»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="command test «egrep '^umask[[:space:]]+077$' /etc/bashrc»" success="pass">
                <ecl:command>egrep '^umask[[:space:]]+077$' /etc/bashrc</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="AND">
          <xccdf:check system="http://cisecurity.org/check">
            <!--command test «egrep '^umask[[:space:]]+077$' /root/.bash_profile»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="command test «egrep '^umask[[:space:]]+077$' /root/.bash_profile»" success="pass">
                <ecl:command>egrep '^umask[[:space:]]+077$' /root/.bash_profile</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--command test «egrep '^umask[[:space:]]+077$' /root/.bashrc»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="command test «egrep '^umask[[:space:]]+077$' /root/.bashrc»" success="pass">
                <ecl:command>egrep '^umask[[:space:]]+077$' /root/.bashrc</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--command test «egrep '^umask[[:space:]]+077$' /root/.cshrc»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="command test «egrep '^umask[[:space:]]+077$' /root/.cshrc»" success="pass">
                <ecl:command>egrep '^umask[[:space:]]+077$' /root/.cshrc</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--command test «egrep '^umask[[:space:]]+077$' /root/.tcshrc»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="command test «egrep '^umask[[:space:]]+077$' /root/.tcshrc»" success="pass">
                <ecl:command>egrep '^umask[[:space:]]+077$' /root/.tcshrc</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0811" role="full" selected="false" weight="1.0">
      <xccdf:title>Disable Core Dumps</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="question">Question:</xhtml:h3>
        <xhtml:p>
          <xhtml:span style="background: #ffff00">Do you have developers who need to debug crashed programs or send low-level
                        debugging information to software developers/vendors?</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span style="background: #ffff00">If the answer to this question is no, then perform the action
                    below.</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">
            <xhtml:span style="background: #ffff00">cd /etc/security<xhtml:br clear="none"/>cat &lt;&lt;END_ENTRIES
                            &gt;&gt; limits.conf<xhtml:br clear="none"/># Following 9 lines added by CISecurity Benchmark sec
                                8.11<xhtml:br clear="none"/>* soft core 0<xhtml:br clear="none"/>* hard core 0<xhtml:br clear="none"/>END_ENTRIES<xhtml:br clear="none"/>diff limits.conf-preCIS limits.conf</xhtml:span>
          </xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>
          <xhtml:span style="background: #ffff00">Core dumps can consume large amounts of disk space and may contain sensitive
                        data. On the other hand, developers using this system may require core files in order to aid in debugging.
                            The<xhtml:span class="code">limits.conf</xhtml:span>file can be used to grant core dump ability to individual
                        users or groups of users.</xhtml:span>
        </xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:check system="http://cisecurity.org/check">
          <!--command test «egrep '^ulimit[[:space:]]+\-Hc[[:space:]]+0$' /etc/profile»-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="command test «egrep '^ulimit[[:space:]]+\-Hc[[:space:]]+0$' /etc/profile»" success="pass">
              <ecl:command>egrep '^ulimit[[:space:]]+\-Hc[[:space:]]+0$' /etc/profile</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--command test «egrep '^limit[[:space:]]+\-h[[:space:]]+coredumpsize[[:space:]]+0$' /etc/security/limits.conf»-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="command test «egrep '^limit[[:space:]]+\-h[[:space:]]+coredumpsize[[:space:]]+0$' /etc/security/limits.conf»" success="pass">
              <ecl:command>egrep '^limit[[:space:]]+\-h[[:space:]]+coredumpsize[[:space:]]+0$' /etc/security/limits.conf</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0812" role="full" selected="false" weight="1.0">
      <xccdf:title>Remove All Compilers and Assemblers</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="question">Question:</xhtml:h3>
        <xhtml:p>Is there a mission-critical reason to have a compiler or assembler on this machine?</xhtml:p>
        <xhtml:p>If the answer is no, perform the action below.</xhtml:p>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>Remove the following packages if they exist on your system:</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">cd /var/log/packages</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">removepkg gcc</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">removepkg gcc-g++</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">removepkg gcc-g77</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">removepkg gcc-gnat</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">removepkg gcc-java</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">removepkg gcc-objc</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">removepkg bin86</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">removepkg nasm</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">removepkg gdb</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>Compilers pose a credible threat to production systems and should not be installed. Compilers and debuggers should
                    be installed on select development systems – those systems that have a business need for a compiler – and the resulting
                    output binaries deployed onto other development and production systems.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:check system="http://cisecurity.org/check">
          <!--Package «gcc» does not exist-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="Package «gcc» does not exist">
              <ecl:command>(cd /var/log/packages;ls|sed -r 's/-[^-]+-(i.86|noarch)-.+$//')|egrep '^gcc$'</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--Package «gcc-g++» does not exist-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="Package «gcc-g++» does not exist">
              <ecl:command>(cd /var/log/packages;ls|sed -r 's/-[^-]+-(i.86|noarch)-.+$//')|egrep '^gcc-g++$'</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--Package «gcc-g77» does not exist-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="Package «gcc-g77» does not exist">
              <ecl:command>(cd /var/log/packages;ls|sed -r 's/-[^-]+-(i.86|noarch)-.+$//')|egrep '^gcc-g77$'</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--Package «gcc-gnat» does not exist-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="Package «gcc-gnat» does not exist">
              <ecl:command>(cd /var/log/packages;ls|sed -r 's/-[^-]+-(i.86|noarch)-.+$//')|egrep '^gcc-gnat$'</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--Package «gcc-java» does not exist-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="Package «gcc-java» does not exist">
              <ecl:command>(cd /var/log/packages;ls|sed -r 's/-[^-]+-(i.86|noarch)-.+$//')|egrep '^gcc-java$'</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--Package «gcc-objc» does not exist-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="Package «gcc-objc» does not exist">
              <ecl:command>(cd /var/log/packages;ls|sed -r 's/-[^-]+-(i.86|noarch)-.+$//')|egrep '^gcc-objc$'</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--Package «bin86» does not exist-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="Package «bin86» does not exist">
              <ecl:command>(cd /var/log/packages;ls|sed -r 's/-[^-]+-(i.86|noarch)-.+$//')|egrep '^bin86$'</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--Package «nasm» does not exist-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="Package «nasm» does not exist">
              <ecl:command>(cd /var/log/packages;ls|sed -r 's/-[^-]+-(i.86|noarch)-.+$//')|egrep '^nasm$'</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--Package «gdb» does not exist-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="Package «gdb» does not exist">
              <ecl:command>(cd /var/log/packages;ls|sed -r 's/-[^-]+-(i.86|noarch)-.+$//')|egrep '^gdb$'</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0813" role="full" selected="false" weight="1.0">
      <xccdf:title>Limit Access To The Root Account From su</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">echo "root:ALL:DENY" &gt;&gt; /etc/suauth</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chown root:root /etc/suauth</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod 400 /etc/suauth</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">diff /etc/suauth-preCIS /etc/suauth</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>The<xhtml:span class="code">su</xhtml:span>command allows you to become other users on the system. This is commonly
                    used to become “<xhtml:span class="code">root</xhtml:span>” and execute commands as the super-user. The script in the
                    action section stops all users from becoming root with the<xhtml:span class="code">su</xhtml:span>command. All users
                    that attempt to become root using<xhtml:span class="code">su</xhtml:span>, will be rejected.</xhtml:p>
        <xhtml:p>If the administrator wants to allow certain users (especially the administrators non-root account) change the text
                    in quotes from the first line of the script to something similar to the following example:</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">root:ALL EXCEPT username1, username2, usernameN:DENY</xhtml:span>
        </xhtml:p>
        <xhtml:p>If the administrator needs all users belonging to an entire group to be able to use the<xhtml:span class="code">su</xhtml:span>command to become root, then change the text in quotes from the first line of the script to something
                    similar to the following example:</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">root:ALL EXCEPT GROUP somegroup:DENY</xhtml:span>
        </xhtml:p>
        <xhtml:p>For more information see the<xhtml:span class="code">suauth</xhtml:span>man pages.</xhtml:p>
        <xhtml:p>By limiting access to the root account, even if a user knows the root password, they will not be able to become
                    root unless that user has physical access to the server's console, or they are added to the wheel group. This adds
                    another layer of security to the system and prevents unauthorized system access.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:check system="http://cisecurity.org/check">
          <!--command test «egrep '^root:ALL:DENY$' /etc/suauth»-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="command test «egrep '^root:ALL:DENY$' /etc/suauth»" success="pass">
              <ecl:command>egrep '^root:ALL:DENY$' /etc/suauth</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/suauth ownership and permission-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="/etc/suauth ownership and permission">
              <ecl:command>find /etc/suauth -follow -maxdepth 0 ! \( -user root -group root -perm u=r,g=,o= \) -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0814" role="unscored" selected="false" weight="0.0">
      <xccdf:title>Reboot</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">shutdown -r now</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>Whenever you make substantial changes to a system, reboot. Some System Administrators believe any change to
                        the<xhtml:span class="code">init</xhtml:span>scripts warrant a reboot to ensure the system comes up as expected.
                    Hours of lost productivity with extensive troubleshooting (not to mention lost revenue) have occurred because a system
                    did not start up as expected. The root cause was an<xhtml:span class="code">init</xhtml:span>problem that would have
                    been detected had the reboot taken place.</xhtml:p>
      </xccdf:description>
      <!--            <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                <xccdf:check-content-ref href="slackware-10.2-oval.xml" name="oval:org.cisecurity:def:990814"/>
            </xccdf:check>-->
      <!--<xccdf:check system="http://www.cisecurity.org/xccdf/interactive/0.1">
                <xccdf:check-content-ref href="slackware-10.2-inter.xml" name="qstn-0005"/>
            </xccdf:check>-->
    </xccdf:Rule>
  </xccdf:Group>
  <xccdf:Group id="g09">
    <xccdf:title>Warning Banners</xccdf:title>
    <xccdf:description>
      <xhtml:p>Presenting some sort of statutory warning message prior to the normal user logon may assist the prosecution of
                trespassers on the computer system. Changing some of these login banners also has the side effect of hiding OS version
                information and other detailed system information from attackers attempting to target specific attacks at a system (though
                there are other mechanisms available for acquiring this information). Guidelines published by the US Department of Defense
                require that warning messages include at least the name of the organization that owns the system, the fact that the system
                is subject to monitoring and that such monitoring is in compliance with local statutes, and that use of the system implies
                consent to such monitoring. Clearly, the organization's local legal counsel and/or site security administrator should review
                the content of all messages before any system modifications are made, as these warning messages are inherently
                site-specific.</xhtml:p>
      <xhtml:p>More information (including citations of relevant case law) can be found at<xhtml:a href="http://www.usdoj.gov/criminal/cybercrime/s&amp;sappendix2002.htm" shape="rect">
                    http://www.usdoj.gov/criminal/cybercrime/s&amp;sappendix2002.htm</xhtml:a>.</xhtml:p>
    </xccdf:description>
    <xccdf:Rule id="r0901" role="full" selected="false" weight="1.0">
      <xccdf:title>Create Warnings For Network And Physical Access Services</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>1. Turn off the automatic creation of the default /etc/motd.</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">FILE=/etc/rc.d/rc.S</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">sed -e '/&gt; \/etc\/motd/s/^/#/' $FILE &gt; $FILE.temp</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">mv -f $FILE.temp $FILE</xhtml:span>
        </xhtml:p>
        <xhtml:p>2. Create a warning banner before login.</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">cat &lt;&lt;END_ISSUE &gt; /etc/issue</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">*************************************************</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">NOTICE TO USERS</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">This is a private system and is the property of</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">[insert company name here]. It is for authorized</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">use only. Users (authorized or unauthorized) have</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">no explicit or implicit expectation of privacy.</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">Any or all uses of this system and all files on</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">this system may be intercepted, monitored,</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">recorded, copied, audited, inspected, and disclosed</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">to authorized site, and law enforcement</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">personnel, as well as authorized officials of</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">other agencies, both domestic and foreign. By</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">using this system, the user consents to such</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">interception, monitoring, recording, copying,</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">auditing, inspection, and disclosure at the</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">discretion of the authorized site.</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">Unauthorized or improper use of this system may</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">result in administrative disciplinary action and</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">civil and criminal penalties. By continuing to use</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">this system you indicate your awareness of and</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">consent to these terms and conditions of use. DO</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">NOT LOGIN if you do not agree to the conditions</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">stated in this warning.</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">**************************************************</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">END_ISSUE</xhtml:span>
        </xhtml:p>
        <xhtml:p>3. Create a message-of-the-day for after login.</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">cat &lt;&lt;END_MOTD &gt; /etc/motd</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">*************************************************</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">NOTICE TO USERS</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">Use of this system constitutes consent to security</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">monitoring and testing. All activity is logged</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">with your host name and IP address.</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">*************************************************</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">END_MOTD</xhtml:span>
        </xhtml:p>
        <xhtml:p>4. Create a banner for network access.</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">cp -fp /etc/issue /etc/issue.net</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">echo "Authorized uses only. All activity may be \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">monitored and reported." &gt;&gt; /etc/issue.net</xhtml:span>
        </xhtml:p>
        <xhtml:p>5. Protect banners.</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chown root:root /etc/motd /etc/issue /etc/issue.net<xhtml:br clear="none"/>chmod 644 /etc/motd
                        /etc/issue /etc/issue.net</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>The contents of the<xhtml:span class="code">/etc/issue</xhtml:span>file are displayed prior to the login prompt on
                    the system's console and serial devices.<xhtml:span class="code">/etc/motd</xhtml:span>is generally displayed after all
                    successful logins, no matter where the user is logging in from, but is thought to be less useful because it only
                    provides notification to the user after the machine has been accessed.</xhtml:p>
        <xhtml:p>DoD Warning banner:<xhtml:a href="http://www.dss.mil/infoas/dod_warning_banner.doc" shape="rect">
                        http://www.dss.mil/infoas/dod_warning_banner.doc</xhtml:a></xhtml:p>
        <xhtml:p>
          <xhtml:a href="http://www.voled.doded.mil/voled_web/PrivacySecurityDisclaimer.htm" shape="rect">
                        http://www.voled.doded.mil/voled_web/PrivacySecurityDisclaimer.htm</xhtml:a>
        </xhtml:p>
        <xhtml:p>
          <xhtml:a href="http://ciac.llnl.gov/ciac/bulletins/j-043.shtml" shape="rect">http://ciac.llnl.gov/ciac/bulletins/j-043.shtml</xhtml:a>
        </xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:check system="http://cisecurity.org/check">
          <!--Turn off the automatic creation of the default /etc/motd-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="command test «egrep '/etc/motd$' /etc/rc.d/rc.S|egrep -v '^#'»" success="pass">
              <ecl:command>egrep '/etc/motd$' /etc/rc.d/rc.S|egrep -v '^#'</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--command test «cat /etc/issue»-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="command test «cat /etc/issue»" success="pass">
              <ecl:command>cat /etc/issue</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--command test «cat /etc/issue.net»-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="command test «cat /etc/issue.net»" success="pass">
              <ecl:command>cat /etc/issue.net</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--command test «cat /etc/motd»-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="command test «cat /etc/motd»" success="pass">
              <ecl:command>cat /etc/motd</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/issue ownership and permission-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="/etc/issue ownership and permission">
              <ecl:command>find /etc/issue -follow -maxdepth 0 ! \( -user root -group root -perm u=rw,g=r,o=r \) -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/issue.net ownership and permission-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="/etc/issue.net ownership and permission">
              <ecl:command>find /etc/issue.net -follow -maxdepth 0 ! \( -user root -group root -perm u=rw,g=r,o=r \) -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--/etc/motd ownership and permission-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="/etc/motd ownership and permission">
              <ecl:command>find /etc/motd -follow -maxdepth 0 ! \( -user root -group root -perm u=rw,g=r,o=r \) -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0902" role="full" selected="false" weight="1.0">
      <xccdf:title>Create Warnings For GUI-Based Logins</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">if [ -e /etc/X11/xdm/Xresources ]; then<xhtml:br clear="none"/>cd /etc/X11/xdm<xhtml:br clear="none"/>awk '/xlogin*greeting:/ \<xhtml:br clear="none"/>{ print "xlogin*greeting: Authorized uses only!";
                        next };<xhtml:br clear="none"/>{ print }' Xresources-preCIS &gt; Xresources<xhtml:br clear="none"/>chown
                        root:root Xresources<xhtml:br clear="none"/>chmod 644 Xresources<xhtml:br clear="none"/>fi<xhtml:br clear="none"/>if
                        [ -e /opt/kde/share/config/kdm/kdmrc ]; then<xhtml:br clear="none"/> cd /etc/X11/xdm<xhtml:br clear="none"/>awk
                        '/GreetString=/ \<xhtml:br clear="none"/>{ print "GreetString=Authorized uses only!"; next };<xhtml:br clear="none"/>{ print }' kdmrc-preCIS &gt; kdmrc<xhtml:br clear="none"/>chown root:root kdmrc<xhtml:br clear="none"/>chmod
                        644 kdmrc<xhtml:br clear="none"/>fi</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>The standard graphical login program for Slackware is kdm, which requires the user to enter their username in one
                    text box and their password in a second text box. The commands above set the warning message on xdm and kdm – in case
                    something other than the default X login GUI was installed. See /etc/rc.d/rc.4 for the order of GUI login tools startup,
                    without Gnome (which is no longer supplied with Slackware) the first one to startup is kdm.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:complex-check operator="OR">
          <!--/etc/X11/xdm/Xresources either does not exist or contains a warning banner-->
          <xccdf:complex-check operator="AND">
            <xccdf:check system="http://cisecurity.org/check">
              <!--/etc/X11/xdm/Xresources does not exist-->
              <xccdf:check-content>
                <ecl:shell-command check="none exist" comment="command test «find /etc/X11/xdm/Xresources»" success="pass">
                  <ecl:command>find /etc/X11/xdm/Xresources</ecl:command>
                  <ecl:line-selection op="pm" value=".+"/>
                </ecl:shell-command>
              </xccdf:check-content>
            </xccdf:check>
          </xccdf:complex-check>
          <xccdf:complex-check operator="AND">
            <xccdf:check system="http://cisecurity.org/check">
              <!--command test «egrep '^xlogin\*greeting:[[:space:]]*Authorized' /etc/X11/xdm/Xresources»-->
              <xccdf:check-content>
                <ecl:shell-command check="all" comment="command test «egrep '^xlogin\*greeting:[[:space:]]*Authorized' /etc/X11/xdm/Xresources»" success="pass">
                  <ecl:command>egrep '^xlogin\*greeting:[[:space:]]*Authorized' /etc/X11/xdm/Xresources</ecl:command>
                  <ecl:line-selection op="pm" value=".*"/>
                </ecl:shell-command>
              </xccdf:check-content>
            </xccdf:check>
            <xccdf:check system="http://cisecurity.org/check">
              <!--/etc/X11/xdm/Xresources ownership and permission-->
              <xccdf:check-content>
                <ecl:shell-command check="none exist" comment="/etc/X11/xdm/Xresources ownership and permission">
                  <ecl:command>find /etc/X11/xdm/Xresources -follow -maxdepth 0 ! \( -user root -group root -perm
                                        u=rw,g=r,o=r \) -ls</ecl:command>
                  <ecl:line-selection op="pm" value=".+"/>
                </ecl:shell-command>
              </xccdf:check-content>
            </xccdf:check>
          </xccdf:complex-check>
        </xccdf:complex-check>
        <xccdf:complex-check operator="AND">
          <xccdf:check system="http://cisecurity.org/check">
            <!--command test «egrep '^GreetString=Authorized' /opt/kde/share/config/kdm/kdmrc»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="command test «egrep '^GreetString=Authorized' /opt/kde/share/config/kdm/kdmrc»" success="pass">
                <ecl:command>egrep '^GreetString=Authorized' /opt/kde/share/config/kdm/kdmrc</ecl:command>
                <ecl:line-selection op="pm" value=".*"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--/opt/kde/share/config/kdm/kdmrc ownership and permission-->
            <xccdf:check-content>
              <ecl:shell-command check="none exist" comment="/opt/kde/share/config/kdm/kdmrc ownership and permission">
                <ecl:command>find /opt/kde/share/config/kdm/kdmrc -follow -maxdepth 0 ! \( -user root -group root -perm
                                    u=rw,g=r,o=r \) -ls</ecl:command>
                <ecl:line-selection op="pm" value=".+"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="r0903" role="full" selected="false" weight="1.0">
      <xccdf:title>Create "authorized only" Banners For vsftpd, If Applicable</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">cd /etc<xhtml:br clear="none"/>if [ -d vsftpd ]; then<xhtml:br clear="none"/>cd vsftpd<xhtml:br clear="none"/>fi<xhtml:br clear="none"/>if [ -e vsftpd.conf ]; then<xhtml:br clear="none"/>echo
                        "ftpd_banner=Authorized users only. All activity \<xhtml:br clear="none"/>may be monitored and reported."
                        &gt;&gt; vsftpd.conf<xhtml:br clear="none"/>fi</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>This item configures vsftpd "authorized users only" banner messages.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="OR">
        <xccdf:check system="http://cisecurity.org/check">
          <!--Service «vsftpd» does not exist-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="Service «vsftpd» does not exist">
              <ecl:command>find /etc/rc.d/rc.vsftpd -ls</ecl:command>
              <ecl:line-selection op="pm" value=".+"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--command test «egrep '^ftpd_banner=Authorized users only. All activity may be monitored and reported\.$' /etc/vsftpd/vsftpd.conf»-->
          <xccdf:check-content>
            <ecl:shell-command check="all" comment="command test «egrep '^ftpd_banner=Authorized users only. All activity may be monitored and reported\.$' /etc/vsftpd/vsftpd.conf»" success="pass">
              <ecl:command>egrep '^ftpd_banner=Authorized users only. All activity may be monitored and reported\.$'
                                /etc/vsftpd/vsftpd.conf</ecl:command>
              <ecl:line-selection op="pm" value=".*"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
  </xccdf:Group>
  <xccdf:Group id="g10">
    <xccdf:title>Anti-Virus Consideration</xccdf:title>
    <xccdf:description>
      <xhtml:strong>Anti-Virus Products</xhtml:strong>
      <xhtml:br/>
      <xhtml:br/>Certain systems - such as mail servers and file servers - should have anti0virus software installed to protect the
      Windows clients that use the server. The following table summarizes the popular anti-virus offerings for the Linux platform. The
      Center for Internet security makes no endorsement for any product. <xhtml:br/><xhtml:br/><xhtml:table border="1" cellpadding="1" cellspacing="1"><xhtml:tr><xhtml:th>Vendor</xhtml:th><xhtml:th>Product</xhtml:th></xhtml:tr><xhtml:tr><xhtml:td>Sophos <xhtml:br/><xhtml:a href="http://www.sophos.com/">http://www.sophos.com/</xhtml:a></xhtml:td><xhtml:td>Commercial</xhtml:td></xhtml:tr><xhtml:tr><xhtml:td>NAI Virus Scan <xhtml:br/></xhtml:td><xhtml:td>Commercial</xhtml:td></xhtml:tr><xhtml:tr><xhtml:td>ClamAV <xhtml:br/><xhtml:a href="http://www.clamav.net/">http://www.clamav.net/</xhtml:a></xhtml:td><xhtml:td>Open Source</xhtml:td></xhtml:tr><xhtml:tr><xhtml:td>McAfee <xhtml:br/><xhtml:a href="http://www.mcafee.com/">http://www.mcafee.com/</xhtml:a></xhtml:td><xhtml:td>Commercial</xhtml:td></xhtml:tr><xhtml:tr><xhtml:td>CyberSoft Vfind <xhtml:br/><xhtml:a href="http://www.cyber.com/products/masterprice.html">http://www.cyber.com/products/masterprice.html</xhtml:a></xhtml:td><xhtml:td/></xhtml:tr><xhtml:tr><xhtml:td>H+B edv (hbedv) <xhtml:br/></xhtml:td><xhtml:td/></xhtml:tr><xhtml:tr><xhtml:td>f-prot Antivirus <xhtml:br/><xhtml:a href="http://www.f-prot.com/products/corporate_users/unix/">http://www.f-prot.com/products/corporate_users/unix/</xhtml:a></xhtml:td><xhtml:td>Commercial</xhtml:td></xhtml:tr><xhtml:tr><xhtml:td>Trend Micro <xhtml:br/></xhtml:td><xhtml:td>Commercial</xhtml:td></xhtml:tr><xhtml:tr><xhtml:td>Computer Associates InoculateIT <xhtml:br/><xhtml:a href="http://www.cai.com/">http://www.cai.com/</xhtml:a></xhtml:td><xhtml:td>Commercial</xhtml:td></xhtml:tr></xhtml:table></xccdf:description>
    <xccdf:Rule id="r1001" role="unscored" selected="false" weight="0.0">
      <xccdf:title>Anti-Virus Products</xccdf:title>
      <xccdf:description>
        <xhtml:p>Certain systems – such as mail servers and file servers – should have anti-virus software installed to protect the
                    Windows clients that use the server. The following table summarizes the popular anti-virus offerings for the Linux
                    platform. The Center for Internet security makes no endorsement for any product.</xhtml:p>
        <xhtml:table border="1" bordercolor="#000000" cellpadding="4" cellspacing="0" width="666">
          <xhtml:col span="1" width="124"/>
          <xhtml:col span="1" width="373"/>
          <xhtml:col span="1" width="143"/>
          <xhtml:thead>
            <xhtml:tr>
              <xhtml:td bgcolor="#e6e6e6" colspan="1" rowspan="1" width="124">
                <xhtml:p>
                  <xhtml:b>Vendor</xhtml:b>
                </xhtml:p>
              </xhtml:td>
              <xhtml:td bgcolor="#e6e6e6" colspan="1" rowspan="1" width="373">
                <xhtml:p>
                  <xhtml:b>Website</xhtml:b>
                </xhtml:p>
              </xhtml:td>
              <xhtml:td bgcolor="#e6e6e6" colspan="1" rowspan="1" width="143">
                <xhtml:p>
                  <xhtml:b>Product</xhtml:b>
                </xhtml:p>
              </xhtml:td>
            </xhtml:tr>
          </xhtml:thead>
          <xhtml:tbody>
            <xhtml:tr>
              <xhtml:td colspan="1" rowspan="1" width="124">
                <xhtml:p>Sophos</xhtml:p>
              </xhtml:td>
              <xhtml:td colspan="1" rowspan="1" width="373">
                <xhtml:p>
                  <xhtml:a href="http://www.sophos.com/" shape="rect">http://www.sophos.com/</xhtml:a>
                </xhtml:p>
              </xhtml:td>
              <xhtml:td colspan="1" rowspan="1" width="143">
                <xhtml:p>Commercial</xhtml:p>
              </xhtml:td>
            </xhtml:tr>
            <xhtml:tr>
              <xhtml:td colspan="1" rowspan="1" width="124">
                <xhtml:p>NAI Virus Scan</xhtml:p>
              </xhtml:td>
              <xhtml:td colspan="1" rowspan="1" width="373">
                <xhtml:p>
                  <xhtml:a href="http://www.mcafee.com/us/products/mcafee/antivirus/desktop/vs_commandline.htm" shape="rect">
                                    http://www.mcafee.com/us/products/mcafee/antivirus/desktop/vs_commandline.htm</xhtml:a>
                </xhtml:p>
              </xhtml:td>
              <xhtml:td colspan="1" rowspan="1" width="143">
                <xhtml:p>Commercial</xhtml:p>
              </xhtml:td>
            </xhtml:tr>
            <xhtml:tr>
              <xhtml:td colspan="1" rowspan="1" width="124">
                <xhtml:p>ClamAV</xhtml:p>
              </xhtml:td>
              <xhtml:td colspan="1" rowspan="1" width="373">
                <xhtml:p>
                  <xhtml:a href="http://www.clamav.net/" shape="rect">http://www.clamav.net/</xhtml:a>
                </xhtml:p>
              </xhtml:td>
              <xhtml:td colspan="1" rowspan="1" width="143">
                <xhtml:p>Open Source</xhtml:p>
              </xhtml:td>
            </xhtml:tr>
            <xhtml:tr>
              <xhtml:td colspan="1" rowspan="1" width="124">
                <xhtml:p>McAfee</xhtml:p>
              </xhtml:td>
              <xhtml:td colspan="1" rowspan="1" width="373">
                <xhtml:p>
                  <xhtml:a href="http://www.mcafee.com/" shape="rect">http://www.mcafee.com/</xhtml:a>
                </xhtml:p>
              </xhtml:td>
              <xhtml:td colspan="1" rowspan="1" width="143">
                <xhtml:p>Commercial</xhtml:p>
              </xhtml:td>
            </xhtml:tr>
            <xhtml:tr>
              <xhtml:td colspan="1" rowspan="1" width="124">
                <xhtml:p>CyberSoft Vfind</xhtml:p>
              </xhtml:td>
              <xhtml:td colspan="1" rowspan="1" width="373">
                <xhtml:p>
                  <xhtml:a href="http://www.cyber.com/products/masterprice.html" shape="rect">
                                        http://www.cyber.com/products/masterprice.html</xhtml:a>
                </xhtml:p>
              </xhtml:td>
              <xhtml:td colspan="1" rowspan="1" width="143"/>
            </xhtml:tr>
            <xhtml:tr>
              <xhtml:td colspan="1" rowspan="1" width="124">
                <xhtml:p>H+B edv (hbedv)</xhtml:p>
              </xhtml:td>
              <xhtml:td colspan="1" rowspan="1" width="373">
                <xhtml:p>
                  <xhtml:a href="http://www.antivir.de/en/index.html" shape="rect">http://www.antivir.de/en/index.html</xhtml:a>
                </xhtml:p>
              </xhtml:td>
              <xhtml:td colspan="1" rowspan="1" width="143">
                <xhtml:p>Commercial</xhtml:p>
              </xhtml:td>
            </xhtml:tr>
            <xhtml:tr>
              <xhtml:td colspan="1" rowspan="1" width="124">
                <xhtml:p>f-prot Antivirus</xhtml:p>
              </xhtml:td>
              <xhtml:td colspan="1" rowspan="1" width="373">
                <xhtml:p>
                  <xhtml:a href="http://www.f-prot.com/products/corporate_users/unix/" shape="rect">
                                        http://www.f-prot.com/products/corporate_users/unix/</xhtml:a>
                </xhtml:p>
              </xhtml:td>
              <xhtml:td colspan="1" rowspan="1" width="143">
                <xhtml:p>Commercial</xhtml:p>
              </xhtml:td>
            </xhtml:tr>
            <xhtml:tr>
              <xhtml:td colspan="1" rowspan="1" width="124">
                <xhtml:p>Trend Micro</xhtml:p>
              </xhtml:td>
              <xhtml:td colspan="1" rowspan="1" width="373">
                <xhtml:p>
                  <xhtml:a href="http://www.trendmicro.com/en/products/linux/overview.htm" shape="rect">
                                        http://www.trendmicro.com/en/products/linux/overview.htm</xhtml:a>
                </xhtml:p>
              </xhtml:td>
              <xhtml:td colspan="1" rowspan="1" width="143">
                <xhtml:p>Commercial</xhtml:p>
              </xhtml:td>
            </xhtml:tr>
            <xhtml:tr>
              <xhtml:td colspan="1" rowspan="1" width="124">
                <xhtml:p>Computer Associates InoculateIT</xhtml:p>
              </xhtml:td>
              <xhtml:td colspan="1" rowspan="1" width="373">
                <xhtml:p>
                  <xhtml:a href="http://www.cai.com/" shape="rect">http://www.cai.com/</xhtml:a>
                </xhtml:p>
              </xhtml:td>
              <xhtml:td colspan="1" rowspan="1" width="143">
                <xhtml:p>Commercial</xhtml:p>
              </xhtml:td>
            </xhtml:tr>
          </xhtml:tbody>
        </xhtml:table>
      </xccdf:description>
      <!--            <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                <xccdf:check-content-ref href="slackware-10.2-oval.xml" name="oval:org.cisecurity:def:991001"/>
            </xccdf:check>-->
      <!--<xccdf:check system="http://www.cisecurity.org/xccdf/interactive/0.1">
                <xccdf:check-content-ref href="slackware-10.2-inter.xml" name="qstn-0006"/>
            </xccdf:check>-->
    </xccdf:Rule>
  </xccdf:Group>
  <xccdf:Group id="g11">
    <xccdf:title>Remove Backup Files</xccdf:title>
    <xccdf:description>When you are certain your changes are successful, remove the backup files as they will have insecure contents
      and/or permissions/ownerships. By leaving these files on your system, an attacker can use the backup files as if they were the
      originals thereby defeating much of your efforts. <xhtml:br/><xhtml:br/>Action: <xhtml:br/><xhtml:span class="command">find / -xdev | grep preCIS | xargs rm -rf</xhtml:span></xccdf:description>
    <xccdf:Rule id="r1101" role="full" selected="false" weight="1.0">
      <xccdf:title>Remove Backup Files</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:i>
            <xhtml:b>Warning:</xhtml:b>Read discussion before performing this action.</xhtml:i>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">find / -xdev | grep preCIS | xargs rm -rf</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>When you are certain your changes are successful, remove the backup files as they will have insecure contents
                    and/or permissions/ownerships. By leaving these files on your system, an attacker can use the backup files as if they
                    were the originals thereby defeating much of your efforts.</xhtml:p>
      </xccdf:description>
      <xccdf:complex-check operator="AND">
        <xccdf:complex-check operator="AND">
          <xccdf:check system="http://cisecurity.org/check">
            <!--command test «ps -Fc»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="command test «ps -Fc»">
                <ecl:command>ps -Fc</ecl:command>
                <ecl:line-selection op="pm" value="^.*$"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--command test «java -version»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="command test «java -version»">
                <ecl:command>java -version</ecl:command>
                <ecl:line-selection op="pm" value="^.*$"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://cisecurity.org/check">
            <!--command test «env|sort»-->
            <xccdf:check-content>
              <ecl:shell-command check="all" comment="command test «env|sort»">
                <ecl:command>env|sort</ecl:command>
                <ecl:line-selection op="pm" value="^.*$"/>
              </ecl:shell-command>
            </xccdf:check-content>
          </xccdf:check>
        </xccdf:complex-check>
        <xccdf:check system="http://cisecurity.org/check">
          <!--command test «find / -xdev | grep preCIS»-->
          <xccdf:check-content>
            <ecl:shell-command check="none exist" comment="command test «find / -xdev | grep preCIS»">
              <ecl:command>find / -xdev | grep preCIS</ecl:command>
              <ecl:line-selection op="pm" value="^.+$"/>
            </ecl:shell-command>
          </xccdf:check-content>
        </xccdf:check>
      </xccdf:complex-check>
    </xccdf:Rule>
  </xccdf:Group>
  <xccdf:Group id="ga" selected="false">
    <xccdf:title>Appendix A - Additional Security Notes</xccdf:title>
    <xccdf:description>
      <xhtml:p>The items in this section are security configuration settings that have been suggested by several other resources and
                system hardening tools. However, given the other settings in the benchmark document, the settings presented here provide
                relatively little incremental security benefit. Nevertheless, none of these settings should have a significant impact on the
                functionality of the system, and some sites may feel that the slight security enhancement of these settings outweighs the
                (sometimes minimal) administrative cost of performing them.</xhtml:p>
      <xhtml:p>None of these settings will be checked by the automated scoring tool provided with the benchmark document. They are
                purely optional and may be applied or not at the discretion of local site administrators.</xhtml:p>
    </xccdf:description>
    <xccdf:Rule id="rsn1" role="unscored" selected="false" weight="0.0">
      <xccdf:title>SN.1 Create Symlinks For Dangerous Files</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">for FILE in /root/.rhosts /root/.shosts /etc/hosts.equiv \<xhtml:br clear="none"/>/etc/shosts.equiv; do<xhtml:br clear="none"/>rm -f $FILE<xhtml:br clear="none"/>ln -s /dev/null $FILE<xhtml:br clear="none"/>done</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>The<xhtml:span class="code">/root/.rhosts</xhtml:span>,<xhtml:span class="code">/root/.shosts</xhtml:span>,
                        and<xhtml:span class="code">/etc/hosts.equiv</xhtml:span>files enable a weak form of access control (see the
                    discussion of<xhtml:span class="code">.rhosts</xhtml:span>files above). Attackers will often target these files as part
                    of their exploit scripts. By linking these files to<xhtml:span class="code">/dev/null</xhtml:span>, any data that an
                    attacker writes to these files is simply discarded (though an astute attacker can still remove the link prior to writing
                    their malicious data).</xhtml:p>
      </xccdf:description>
    </xccdf:Rule>
    <xccdf:Rule id="rsn2" role="unscored" selected="false" weight="0.0">
      <xccdf:title>SN.2 Change Default Greeting String For sendmail</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>If you configure sendmail by using the M4 macro processor to “compile” the configuration files, by editing
                    sendmail.mc and creating sendmail.cf from it:</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">cd /usr/share/sendmail/cf/cf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">echo "define(\`confSMTP_LOGIN_MSG', \`mailer ready')dnl" &gt;&gt;
                    sendmail.mc</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">make sendmail.cf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">cp -f sendmail.cf /etc/mail/sendmail.cf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chown root:bin /etc/mail/sendmail.cf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod 444 /etc/mail/sendmail.cf</xhtml:span>
        </xhtml:p>
        <xhtml:p>If you use the method of editing sendmail.cf directly:</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">cd /etc/mail</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">awk '/O SmtpGreetingMessage=/ \</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">{ print "O SmtpGreetingMessage=mailer ready"; next}</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">{ print }' sendmail.cf &gt; sendmail.cf.new</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">mv -f sendmail.cf.new sendmail.cf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chown root:bin sendmail.cf</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod 444 sendmail.cf</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>The default SMTP greeting string displays the version of the sendmail software running on the remote system. Hiding
                    this information is generally considered to be good practice, since it can help attackers target attacks at machines
                    running a vulnerable version of sendmail. However, the actions in the benchmark document completely disable sendmail on
                    the system, so changing this default greeting string is something of a moot point unless the machine happens to be an
                    email server.</xhtml:p>
      </xccdf:description>
    </xccdf:Rule>
    <xccdf:Rule id="rsn3" role="unscored" selected="false" weight="0.0">
      <xccdf:title>SN.3 Enable TCP SYN Cookie Protection</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">echo "echo 1 &gt; /proc/sys/net/ipv4/tcp_syncookies" \<xhtml:br clear="none"/>&gt;&gt; /etc/rc.d/rc.local</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:h3 class="question">Question:</xhtml:h3>
        <xhtml:p>
          <xhtml:i>How many of the startup scripts do you really need?</xhtml:i>
        </xhtml:p>
        <xhtml:p>Perform the action below.</xhtml:p>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">cd /etc/rc.d<xhtml:br clear="none"/>ls</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>The most effective way to get rid of the much of the unused software is to look in the startup directory /etc/rc.d
                    and evaluate which of these remaining services are not necessary. To see what package a script belongs to, use grep to
                    search the files in<xhtml:span class="code">/var/log/packages</xhtml:span>:</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">grep &lt;scriptname&gt; /var/log/packages/*</xhtml:span>
        </xhtml:p>
        <xhtml:p>Note the package file name, then view the first part of the package log in<xhtml:span class="code">/var/log/packages</xhtml:span>to read about it and decide if it can be safely removed.</xhtml:p>
        <xhtml:p>If it can, use</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">removepkg /var/log/packages/&lt;package&gt;</xhtml:span>
        </xhtml:p>
        <xhtml:p>to remove it.</xhtml:p>
        <xhtml:p>For example, if there are no Macs in your network, or you do not need a file or print server for Macs, then you
                    probably do not the Appletalk daemons, which are started by the<xhtml:span class="code">rc.atalk</xhtml:span>script. If
                        you<xhtml:span class="code">grep</xhtml:span>for<xhtml:span class="code">rc.atalk</xhtml:span>in<xhtml:span class="code">/var/log/packages/*</xhtml:span>, you can see that this script is part of the netatalk package. A quick
                    view of the start of the file (view<xhtml:span class="code">/var/log/packages/netatalk-2.0.3-i486-1</xhtml:span>shows
                    that we can remove this package, and<xhtml:span class="code">removepkg</xhtml:span><xhtml:span class="code">/var/log/netatalk-2.0.3-i486-1</xhtml:span>will remove the package.</xhtml:p>
        <xhtml:p>
          <xhtml:b>Note:</xhtml:b>Slackware does not provide dependency checking, so it's up to you to confirm that a package can
                    be safely removed. Also be aware that if files have been changed from their original state, they will not be removed
                        by<xhtml:span class="code">removepkg</xhtml:span>. The package file contains a list of all files, so you should
                    check if they have all been removed.</xhtml:p>
        <xhtml:p>In some cases, you will not be able to remove a script because it's part of a package that is needed for other
                    things. This does not happen often as Slackware's package granularity is relatively fine. If it does happen, you may
                    just want to use</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/etc/rc.d/&lt;scriptname&gt; stop</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod ugo-x &lt;scriptname&gt;</xhtml:span>
        </xhtml:p>
        <xhtml:p>to stop the service and prevent it from running again.</xhtml:p>
        <xhtml:p>A "SYN Attack" is a denial of service (DoS) attack that consumes resources on your system forcing you to reboot.
                    This particular attack is performed by beginning the TCP connection handshake (sending the SYN packet), and then never
                    completing the process to open the connection. This leaves your system with several (hundreds or thousands) of half-open
                    connections. This is a fairly simple attack and should be blocked.</xhtml:p>
      </xccdf:description>
    </xccdf:Rule>
    <xccdf:Rule id="rsn4" role="unscored" selected="false" weight="0.0">
      <xccdf:title>SN.4 Additional LILO Security</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">chattr +i /etc/lilo.conf</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>Setting the immutable flag on the LILO config file will prevent any changes (accidental or otherwise) to
                        the<xhtml:span class="code">lilo.conf</xhtml:span>file. If you wish to modify the file you will need to unset the
                    immutable flag using the <xhtml:span class="code">chattr</xhtml:span>command with<xhtml:span class="code">-i</xhtml:span>instead of<xhtml:span class="code">+i</xhtml:span>.</xhtml:p>
      </xccdf:description>
    </xccdf:Rule>
    <xccdf:Rule id="rsn5" role="unscored" selected="false" weight="0.0">
      <xccdf:title>SN.5 Evaluate Packages Associated With Startup Scripts</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="question">Question:</xhtml:h3>
        <xhtml:p>
          <xhtml:i>How many of the startup scripts do you really need?</xhtml:i>
        </xhtml:p>
        <xhtml:p>Perform the action below.</xhtml:p>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">cd /etc/rc.d<xhtml:br clear="none"/>ls</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>The most effective way to get rid of the much of the unused software is to look in the startup directory /etc/rc.d
                    and evaluate which of these remaining services are not necessary. To see what package a script belongs to, use grep to
                    search the files in<xhtml:span class="code">/var/log/packages</xhtml:span>:</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">grep &lt;scriptname&gt; /var/log/packages/*</xhtml:span>
        </xhtml:p>
        <xhtml:p>Note the package file name, then view the first part of the package log in<xhtml:span class="code">/var/log/packages</xhtml:span>to read about it and decide if it can be safely removed.</xhtml:p>
        <xhtml:p>If it can, use</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">removepkg /var/log/packages/&lt;package&gt;</xhtml:span>
        </xhtml:p>
        <xhtml:p>to remove it.</xhtml:p>
        <xhtml:p>For example, if there are no Macs in your network, or you do not need a file or print server for Macs, then you
                    probably do not the Appletalk daemons, which are started by the<xhtml:span class="code">rc.atalk</xhtml:span>script. If
                        you<xhtml:span class="code">grep</xhtml:span>for<xhtml:span class="code">rc.atalk</xhtml:span>in<xhtml:span class="code">/var/log/packages/*</xhtml:span>, you can see that this script is part of the netatalk package. A quick
                    view of the start of the file (view<xhtml:span class="code">/var/log/packages/netatalk-2.0.3-i486-1</xhtml:span>shows
                    that we can remove this package, and<xhtml:span class="code">removepkg</xhtml:span><xhtml:span class="code">/var/log/netatalk-2.0.3-i486-1</xhtml:span>will remove the package.</xhtml:p>
        <xhtml:p>
          <xhtml:b>Note:</xhtml:b>Slackware does not provide dependency checking, so it's up to you to confirm that a package can
                    be safely removed. Also be aware that if files have been changed from their original state, they will not be removed
                        by<xhtml:span class="code">removepkg</xhtml:span>. The package file contains a list of all files, so you should
                    check if they have all been removed.</xhtml:p>
        <xhtml:p>In some cases, you will not be able to remove a script because it's part of a package that is needed for other
                    things. This does not happen often as Slackware's package granularity is relatively fine. If it does happen, you may
                    just want to use</xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">/etc/rc.d/&lt;scriptname&gt; stop</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">chmod ugo-x &lt;scriptname&gt;</xhtml:span>
        </xhtml:p>
        <xhtml:p>to stop the service and prevent it from running again.</xhtml:p>
      </xccdf:description>
    </xccdf:Rule>
    <xccdf:Rule id="rsn6" role="unscored" selected="false" weight="0.0">
      <xccdf:title>SN.6 Evaluate Every Installed Package</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="question">Question:</xhtml:h3>
        <xhtml:p>
          <xhtml:i>How much unused software was installed on your system?</xhtml:i>
        </xhtml:p>
        <xhtml:p>Perform the action below.</xhtml:p>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>See Discussion</xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>The default Slackware installation may contain packages that are not necessary in for a server. Computer Security
                    Industry Best Practices recommend removing unused services and software to minimize attack vectors on a system. The
                    following references suggest removing unused software:</xhtml:p>
        <xhtml:ul>
          <xhtml:li>
            <xhtml:p>Common Sense Guide to Cyber Security for Small Businesses – Recommended Actions for Information Security,
                            1st Edition, March 2004,<xhtml:a href="http://www.us-cert.gov/reading_room/CSG-small-business.pdf" shape="rect">
                                http://www.us-cert.gov/reading_room/CSG-small-business.pdf</xhtml:a></xhtml:p>
          </xhtml:li>
          <xhtml:li>
            <xhtml:p>IUP System Administrator Security Guidelines and Best Practices,<xhtml:a href="http://www.iup.edu/tsc/security" shape="rect">http://www.iup.edu/tsc/security</xhtml:a></xhtml:p>
          </xhtml:li>
          <xhtml:li>
            <xhtml:p>Security Engineering Awareness for Systems Engineers,<xhtml:a href="http://www.software.org/pub/externalpapers/SecEngAwareness.doc" shape="rect">
                                http://www.software.org/pub/externalpapers/SecEngAwareness.doc</xhtml:a></xhtml:p>
          </xhtml:li>
        </xhtml:ul>
        <xhtml:p>
          <xhtml:span style="text-decoration: none">For example, to remove a unneeded package the administrator can use
                            the<xhtml:span class="code">removepkg</xhtml:span>tool. When used with the<xhtml:span class="code">-warn</xhtml:span>flag, the files can be reviewed before actually removing them. See the<xhtml:span class="code">removepkg</xhtml:span>man page (<xhtml:span class="code">man</xhtml:span><xhtml:span class="code">removepkg</xhtml:span>) for more information.</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code"># removepkg -warn zlib</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">Only warning... not actually removing any files.</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">Here's what would be removed (and left behind) if you</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">removed the package(s):</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">--&gt; /usr/lib/libz.so.1 (symlink) was found in another package. Skipping.</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">--&gt; /usr/lib/libz.so (symlink) would be deleted</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">--&gt; /usr/lib/libz.so.1.2.3 was found in another package. Skipping.</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">--&gt; /usr/doc/zlib-1.2.3/ChangeLog would be deleted</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">--&gt; /usr/doc/zlib-1.2.3/FAQ would be deleted</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">--&gt; /usr/doc/zlib-1.2.3/INDEX would be deleted</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">--&gt; /usr/doc/zlib-1.2.3/README would be deleted</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">--&gt; /usr/include/zconf.h would be deleted</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">--&gt; /usr/include/zlib.h would be deleted</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">--&gt; /usr/lib/libz.a would be deleted</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">--&gt; /usr/man/man3/zlib.3.gz would be deleted</xhtml:span>
        </xhtml:p>
        <xhtml:p>
          <xhtml:span class="code">--&gt; /usr/doc/zlib-1.2.3/ (dir) would be deleted if empty</xhtml:span>
        </xhtml:p>
        <xhtml:p>Removed software can always be reinstalled if it is needed.</xhtml:p>
        <xhtml:p>
          <xhtml:b>Note:</xhtml:b>Slackware does not provide dependency checking, so it's up to you to confirm that a package can
                    be safely removed. Also be aware that if files have been changed from their original state, they will not be removed
                        by<xhtml:span class="code">removepkg</xhtml:span>. The package file contains a list of all files, so you should
                    check if they have all been removed.</xhtml:p>
        <xhtml:p>
          <xhtml:b>
            <xhtml:i>SN.7 Install and Configure<xhtml:span class="code">sudo</xhtml:span></xhtml:i>
          </xhtml:b>
        </xhtml:p>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>Using your Enterprise process, install<xhtml:span class="code">sudo</xhtml:span>.</xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">sudo</xhtml:span>is a package that allows the System Administrator to delegate activities to
                    groups of users. These activities are normally beyond the administrative capability of that user – restarting the web
                    server, for example. If frequent web server configuration changes are taking place (or you have a bug and the web server
                    keeps crashing), it becomes very cumbersome to continually engage the SysAdmin just to restart the web
                        server.<xhtml:span class="code">sudo</xhtml:span>allows the Administrator to delegate just that one task using root
                    authority without allowing that group of users any other root capability.</xhtml:p>
        <xhtml:p>Once<xhtml:span class="code">sudo</xhtml:span>is installed, configure it using<xhtml:span class="code">visudo</xhtml:span>– do not vi the config file.<xhtml:span class="code">visudo</xhtml:span>has error checking built in.
                    Experience has shown that if<xhtml:span class="code">/etc/sudoers</xhtml:span>gets botched (from using vi
                        without<xhtml:span class="code">visudo's</xhtml:span>error checking feature), recovery may become very
                difficult.</xhtml:p>
      </xccdf:description>
    </xccdf:Rule>
    <xccdf:Rule id="rsn8" role="unscored" selected="false" weight="0.0">
      <xccdf:title>SN.8 Additional Kernel Tunings</xccdf:title>
      <xccdf:description>
        <xhtml:h3 class="action">Action:</xhtml:h3>
        <xhtml:p>
          <xhtml:span class="code">cat &lt;&lt;END_SCRIPT &gt;&gt; /etc/sysctl.conf<xhtml:br clear="none"/>#
                        Following 2 lines added by CISecurity Benchmark sec SN.9<xhtml:br clear="none"/>net.ipv4.tcp_max_orphans =
                            256<xhtml:br clear="none"/>net.ipv4.conf.all.log_martians = 1<xhtml:br clear="none"/>END_SCRIPT<xhtml:br clear="none"/>chown root:root /etc/sysctl.conf<xhtml:br clear="none"/>chmod 0600 /etc/sysctl.conf</xhtml:span>
        </xhtml:p>
        <xhtml:h3 class="discussion">Discussion:</xhtml:h3>
        <xhtml:p>Before implementing these changes, please review them with your environment in mind. The above value for
                    tcp_max_orphans is much lower than the default 16,384, and may be too low, depending on the server's use and
                    environment.</xhtml:p>
        <xhtml:p>Also be aware that logging all martians may generate an excessive amount of logs, especially on multi-homed servers
                    with at least one network interface on a hostile network (i.e, your border firewalls). You should ensure you have plenty
                    of log space available as well as sending your logs to a remote logging host.</xhtml:p>
      </xccdf:description>
    </xccdf:Rule>
  </xccdf:Group>
<xccdf:signature><ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
<ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
<ds:Reference URI="">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
<ds:DigestValue>fu0gREl9adLaq7+V+XwXF+blPSc=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>
qKEZo76ca+o50ulSXzNn/1W2cYi+1HQuXpKvl7ZH2V7C4lnmRG6ZVrs9fvq383My9ynjT38c2VFX
EYQL/FbB5JsVkDTCMmx86HM7kbhUwZr32FY8Q6aPOj0wAImw9ganvSYlblCulu7jNINXqMZ1/lU9
xFaovN+f1UzCu6LOjhpi0iZSQzgZ0as/JHkoxbnoh9I6sjL80RPRHUC1ocWYi3YNPsiUmoFgikRq
WWNUQ7xpvuCakZeWmEotLO4IvnoYMwE48iwEmfK00l5IWP/Ayw0dBhAoC4X+NaboFF3eTPJqDJ1x
P8nmkGuTaCx8384qQaVS8GLVQMo0x9SMNvUQJg==
</ds:SignatureValue>
<ds:KeyInfo>
<ds:X509Data>
<ds:X509Certificate>
MIIFUjCCBDqgAwIBAgIIYySGQYnuNVswDQYJKoZIhvcNAQELBQAwgbQxCzAJBgNVBAYTAlVTMRAw
DgYDVQQIEwdBcml6b25hMRMwEQYDVQQHEwpTY290dHNkYWxlMRowGAYDVQQKExFHb0RhZGR5LmNv
bSwgSW5jLjEtMCsGA1UECxMkaHR0cDovL2NlcnRzLmdvZGFkZHkuY29tL3JlcG9zaXRvcnkvMTMw
MQYDVQQDEypHbyBEYWRkeSBTZWN1cmUgQ2VydGlmaWNhdGUgQXV0aG9yaXR5IC0gRzIwHhcNMTcx
MDIzMTQ1ODAwWhcNMjAxMDIwMTg1NzQ0WjCBkzELMAkGA1UEBhMCVVMxETAPBgNVBAgTCE5ldyBZ
b3JrMRcwFQYDVQQHEw5FYXN0IEdyZWVuYnVzaDErMCkGA1UEChMiQ2VudGVyIGZvciBJbnRlcm5l
dCBTZWN1cml0eSwgSW5jLjErMCkGA1UEAxMiQ2VudGVyIGZvciBJbnRlcm5ldCBTZWN1cml0eSwg
SW5jLjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANDBp4+sl9kB5JRmnQH0wcbLLz/t
n2HoD6TRl3xJj12V61njBNgaiGzvoSl07sFLnESukb0CU44MzYDoUMdx3HJUcEAeMY/9eITqGUnk
N4WsP145eFqH7FoszOY/4NYlgYMYt8ZP2kRHyim9LpQTLT/1mBaUkY2f2e5uUCootH3iT8W3/sK2
flLzWfLgXTvkhJm4Uvw1RErBFs15+krW0KWtnZ6NmiDhmV0CnFGNnd1meGZPs2sBXEVGLJVSKzoT
G9Ht/oWyRLRcJuXpHoXTYpkqM2MsixmSaJy5b6/D35r0NXHru3p1gkX2a0VgJQxxWqLi3bVPzpl3
PlJu3C8M/FUCAwEAAaOCAYUwggGBMAwGA1UdEwEB/wQCMAAwEwYDVR0lBAwwCgYIKwYBBQUHAwMw
DgYDVR0PAQH/BAQDAgeAMDUGA1UdHwQuMCwwKqAooCaGJGh0dHA6Ly9jcmwuZ29kYWRkeS5jb20v
Z2RpZzJzNS0zLmNybDBdBgNVHSAEVjBUMEgGC2CGSAGG/W0BBxcCMDkwNwYIKwYBBQUHAgEWK2h0
dHA6Ly9jZXJ0aWZpY2F0ZXMuZ29kYWRkeS5jb20vcmVwb3NpdG9yeS8wCAYGZ4EMAQQBMHYGCCsG
AQUFBwEBBGowaDAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuZ29kYWRkeS5jb20vMEAGCCsGAQUF
BzAChjRodHRwOi8vY2VydGlmaWNhdGVzLmdvZGFkZHkuY29tL3JlcG9zaXRvcnkvZ2RpZzIuY3J0
MB8GA1UdIwQYMBaAFEDCvSeOzDSDMKIz1/tss/C0LIDOMB0GA1UdDgQWBBT7fOf4ISDprbE+qUFe
+friFTKgHjANBgkqhkiG9w0BAQsFAAOCAQEAs5SDIMcr3jwOwgKipP7NWsWyAO0zfpmHGaU2C/gW
Kz6DZuwhTLPbn015ZlvjRZ27Jd7rjg3WK2Qs9xaRYn2yb1s4mx/NtlVUBsNpL0CDOrdOgt/ZEweI
uoknr5gPlsFPXmsxEQoFb3KKt/Al1YbjcKHhHZ7BtEL3MGnSOAyItdodtLzxFuLOJKpvEk2OOVoW
BgHAteWAvlKd6exCvfWKHipJ5DTC9eM859tpW0xM+f12CycvrkQVI2lyEHMzDFaHkBO0URjhySSu
SkWLBywIIM02d+Ud7bbC60nXfuxIjayeDJLvDxyMJ/bx12X75w1frT1oKTuifL1bmeualQHKXw==
</ds:X509Certificate>
</ds:X509Data>
<ds:KeyValue>
<ds:RSAKeyValue>
<ds:Modulus>
0MGnj6yX2QHklGadAfTBxssvP+2fYegPpNGXfEmPXZXrWeME2BqIbO+hKXTuwUucRK6RvQJTjgzN
gOhQx3HcclRwQB4xj/14hOoZSeQ3haw/Xjl4WofsWizM5j/g1iWBgxi3xk/aREfKKb0ulBMtP/WY
FpSRjZ/Z7m5QKii0feJPxbf+wrZ+UvNZ8uBdO+SEmbhS/DVESsEWzXn6StbQpa2dno2aIOGZXQKc
UY2d3WZ4Zk+zawFcRUYslVIrOhMb0e3+hbJEtFwm5ekehdNimSozYyyLGZJonLlvr8PfmvQ1ceu7
enWCRfZrRWAlDHFaouLdtU/OmXc+Um7cLwz8VQ==
</ds:Modulus>
<ds:Exponent>AQAB</ds:Exponent>
</ds:RSAKeyValue>
</ds:KeyValue>
</ds:KeyInfo>
</ds:Signature></xccdf:signature></xccdf:Benchmark>