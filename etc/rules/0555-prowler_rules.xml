<!--
  Rules for parsing Prowler output
  Authored by Jeremy Phillips <jeremy@uranusbytes.com>
  Copyright: GPLv3
  ID: 87800-87899
  Prowler - https://github.com/toniblyx/prowler
-->

<group name="local,amazon,prowler,">
    <!-- Filter 1: Only prowler events -->
    <rule id="87801" level="0">
        <field name="integration">prowler</field>
        <description>Prowler Check Result: $(prowler.status) - Control $(prowler.control_id)</description>
    </rule>
    <!-- Check Result: Pass -->
    <rule id="87802" level="1">
        <if_sid>87801</if_sid>
        <field name="prowler.status">Pass</field>
        <description>Prowler Check Result: $(prowler.status) - Control $(prowler.control_id)</description>
    </rule>
    <!-- Check Result: Info -->
    <rule id="87803" level="3">
        <if_sid>87801</if_sid>
        <field name="prowler.status">Info</field>
        <description>Prowler Check Result: $(prowler.status) - Control $(prowler.control_id)</description>
    </rule>
    <!-- Check Result: Error -->
    <rule id="87804" level="5">
        <if_sid>87801</if_sid>
        <field name="prowler.status">Error</field>
        <description>Prowler Check Result: $(prowler.status) - Control $(prowler.control_id)</description>
    </rule>
    <!-- Check Result: Fail, Scored -->
    <rule id="87805" level="9">
        <if_sid>87801</if_sid>
        <field name="prowler.status">Fail</field>
        <description>Prowler Check Result: $(prowler.status) - Control $(prowler.control_id)</description>
    </rule>
    <!-- Check Result: Fail, Not Scored -->
    <rule id="87806" level="7">
        <if_sid>87805</if_sid>
        <field name="prowler.scored">Not Scored</field>
        <description>Prowler Check Result: $(prowler.status) - Control $(prowler.control_id)</description>
    </rule>
</group>

