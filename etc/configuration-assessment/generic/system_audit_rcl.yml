# Configuration assessment
# Checks for auditing Linux systems
# Copyright (C) 2015-2019, Wazuh Inc.
#
# This program is a free software; you can redistribute it
# and/or modify it under the terms of the GNU General Public
# License (version 2) as published by the FSF - Free Software
# Foundation

policy:
  id: ""
  file: ""
  name: ""
  description: ""
  references:
    - 

variables:
  $php.ini: /etc/php.ini,/var/www/conf/php.ini,/etc/php5/apache2/php.ini;
  $web_dirs: /var/www,/var/htdocs,/home/httpd,/usr/local/apache,/usr/local/apache2,/usr/local/www;
# PHP checks

checks:
 - id: 15000
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - 
   condition: any
   rules:
     - 'f:$php.ini -> r:^register_globals = On;'
# PHP checks
 - id: 15001
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - 
   condition: any
   rules:
     - 'f:$php.ini -> r:^expose_php = On;'
# PHP checks
 - id: 15002
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - 
   condition: any
   rules:
     - 'f:$php.ini -> r:^allow_url_fopen = On;'
# PHP checks
 - id: 15003
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - 
   condition: any
   rules:
     - 'f:$php.ini -> r:^display_errors = On;'
# PHP checks - consider open_basedir && disable_functions
## Looking for common web exploits (might indicate that you are owned).
## Using http://dcid.me/blog/logsamples/webattacks_links as a reference.
#[Web exploits - Possible compromise] [any] []
#d:$web_dirs -> .txt$ -> r:^<?php|^#!;
## Looking for common web exploits files (might indicate that you are owned).
## There are not specific, like the above.
## Using http://dcid.me/blog/logsamples/webattacks_links as a reference.
 - id: 15004
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - 
   condition: any
   rules:
     - 'd:$web_dirs -> ^.yop$;'
 - id: 15005
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - 
   condition: any
   rules:
     - 'd:$web_dirs -> ^id$;'
 - id: 15006
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - 
   condition: any
   rules:
     - 'd:$web_dirs -> ^.ssh$;'
 - id: 15007
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - 
   condition: any
   rules:
     - 'd:$web_dirs -> ^...$;'
 - id: 15008
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - 
   condition: any
   rules:
     - 'd:$web_dirs -> ^.shell$;'
## Looking for outdated Web applications
## Taken from http://sucuri.net/latest-versions
 - id: 15009
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - http://sucuri.net/latest-versions
   condition: any
   rules:
     - 'd:$web_dirs -> ^version.php$ -> r:^\.wp_version && >:$wp_version = '4.4.2';'
 - id: 15010
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - http://sucuri.net/latest-versions
   condition: any
   rules:
     - 'd:$web_dirs -> ^version.php$ -> r:var \.RELEASE && r:'3.4.8';'
 - id: 15011
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - http://sucuri.net/latest-versions
   condition: any
   rules:
     - 'd:$web_dirs -> ^application_top.php$ -> r:'osCommerce 2.2-;'
## Looking for known backdoors
 - id: 15012
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - 
   condition: any
   rules:
     - 'd:$web_dirs -> .php$ -> r:eval\(base64_decode\(\paWYo;'
 - id: 15013
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - 
   condition: any
   rules:
     - 'd:$web_dirs -> .php$ -> r:eval\(base64_decode\(\S_POST;'
 - id: 15014
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - http://blog.sucuri.net/2011/05/understanding-htaccess-attacks-part-1.html
   condition: any
   rules:
     - 'd:$web_dirs -> ^.htaccess$ -> r:RewriteCond \S+HTTP_REFERERS \S+google;'
 - id: 15015
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - http://blog.sucuri.net/2011/05/understanding-htaccess-attacks-part-1.html
   condition: any
   rules:
     - 'd:$web_dirs -> ^.htaccess$ -> r:php_value auto_append_file;'
