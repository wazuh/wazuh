include "cvss.fbs";

namespace cve_v5;

table StringifiedObject {
    data: string;
}

table SupportingMedia {
    type: string;
    base64: bool;
    value: string;
}

table Description {
    lang: string;
    value: string;
    supportingMedia: [SupportingMedia];
}

table Change {
    at: string;
    status: string;
}

table Version {
    version: string;
    status: string;
    versionType: string;
    lessThan: string;
    lessThanOrEqual: string;
    changes: [Change];
}

table ProgramRoutine {
    name: string;
}

table Affected {
    vendor: string;
    product: string;
    collectionURL: string;
    packageName: string;
    cpes: [string];
    modules: [string];
    programFiles: [string];
    programRoutines: [ProgramRoutine];
    platforms: [string];
    repo: string;
    defaultStatus: string;
    versions: [Version];
}

table Reference {
    url: string;
    name: string;
    tags: [string];
}

table DescriptionProblemTypes {
    lang: string;
    description: string;
    cweId: string;
    type: string;
}

table ProblemType {
    descriptions: [DescriptionProblemTypes];
}

table Impact {
    capecId: string;
    descriptions: [Description];
}

table Other {
    type: string;
    content: StringifiedObject;
}

table Scenario {
    lang: string;
    value: string;    
}

table Metric {
    format: string;
    scenarios: [Scenario];
    cvssV3_1: cvss.V3_1;
    cvssV3_0: cvss.V2_0;
    cvssV2_0: cvss.V2_0;
    other: Other;
}

table Timeline {
    time: string;
    lang: string;
    value: string;
}

table Credit {
    lang: string;
    value: string;
    user: string;
    type: string;
}

table Remediation {
    anyOf: [string];
    products: [string];
    type: string;
}

table Remediations {
    windows: [Remediation];
    alpine: [Remediation];
    custom: [string];
}

table ProviderMetadata {
    orgId: string;
    shortName: string;
    dateUpdated: string;
}

table TaxonomyRelation {
    taxonomyId: string;
    relationshipName: string;
    relationshipValue: string;
}

table TaxonomyMapping {
    taxonomyName: string;
    taxonomyVersion: string;
    taxonomyRelations: [TaxonomyRelation];
}

table Adp {
    providerMetadata: ProviderMetadata;
    datePublic: string;
    title: string;
    descriptions: [Description];
    affected: [Affected];
    problemTypes: [ProblemType];
    references: [Reference];
    impacts: [Impact];
    metrics: [Metric];
    configurations: [Description];
    workarounds: [Description];
    solutions: [Description];
    exploits: [Description];
    timeline: [Timeline];
    credits: [Credit];
    source: StringifiedObject;
    tags: [string];    
    taxonomyMappings: [TaxonomyMapping];
}

table Cna {
    providerMetadata: ProviderMetadata;
    dateAssigned: string;
    datePublic: string;
    title: string;
    descriptions: [Description];
    affected: [Affected];
    problemTypes: [ProblemType];
    references: [Reference];
    impacts: [Impact];
    metrics: [Metric];
    configurations: [Description];
    workarounds: [Description];
    solutions: [Description];
    exploits: [Description];
    timeline: [Timeline];
    credits: [Credit];
    source: StringifiedObject;
    tags: [string];        
    taxonomyMappings: [TaxonomyMapping];
    x_remediations: Remediations;
}

table Container {
    cna: Cna;
    adp: [Adp];
}

table CveMetadata {
    cveId: string;
    assignerOrgId: string;
    assignerShortName: string;
    requesterUserId: string;
    dateUpdated: string;
    serial: int;
    dateReserved: string;
    datePublished: string;
    state: string;
}

table Entry {
    dataType: string;
    dataVersion: string;
    cveMetadata: CveMetadata;
    containers: Container;
}

root_type Entry;
