{
  "description": "Metadata delta flow test: start with MetadataDelta mode -> end (no data messages)",
  "messages": [
    {
      "type": "start",
      "data": {
        "module": "inventory_sync",
        "mode": 3,
        "size": 0,
        "option": 0,
        "indices": ["wazuh-states-fim-files", "wazuh-states-sca", "wazuh-states-inventory-system"],
        "agentid": "001",
        "agentname": "metadata-test-agent",
        "agentversion": "4.9.0",
        "architecture": "x86_64",
        "hostname": "test-host-001",
        "osname": "Ubuntu",
        "osplatform": "ubuntu",
        "ostype": "linux",
        "osversion": "22.04",
        "groups": ["default", "production"],
        "global_version": 12345
      },
      "description": "Start MetadataDelta synchronization - updates agent metadata across all indices",
      "delay": 0.5,
      "expect_session_response": true
    },
    {
      "type": "end",
      "data": {},
      "description": "End MetadataDelta synchronization - should receive EndAck with Status_Ok",
      "delay": 0.5,
      "use_session_from_start": true,
      "expect_end_response": true
    }
  ],
  "verification": {
    "check_opensearch": true,
    "expected_updates": {
      "indices": ["wazuh-states-fim-files", "wazuh-states-sca", "wazuh-states-inventory-system"],
      "agent_id": "001",
      "fields": {
        "agent.name": "metadata-test-agent",
        "agent.version": "4.9.0",
        "agent.host.architecture": "x86_64",
        "agent.host.hostname": "test-host-001",
        "agent.host.os.name": "Ubuntu",
        "agent.host.os.platform": "ubuntu",
        "agent.host.os.type": "linux",
        "agent.host.os.version": "22.04",
        "state.document_version": 12345
      }
    }
  }
}
