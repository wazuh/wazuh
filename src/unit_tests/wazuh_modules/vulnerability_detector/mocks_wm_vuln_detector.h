/*
 * Copyright (C) 2015, Wazuh Inc.
 *
 * This program is free software; you can redistribute it
 * and/or modify it under the terms of the GNU General Public
 * License (version 2) as published by the FSF - Free Software
 * Foundation.
 */

#include <stdarg.h>
#include <stddef.h>
#include <setjmp.h>
#include <cmocka.h>
#include <stdio.h>

#include "../../wazuh_modules/wmodules.h"
#include "../../headers/shared.h"

extern char **d_sub_strings;

/* redefinitons/wrapping */

struct tm *__wrap_localtime(const time_t *t);

int __wrap_wurl_request_uncompress_bz2_gz(const char * url, const char * dest, const char * header, const char * data, const long timeout);

int __wrap_w_uncompress_bz2_gz_file(const char * path, const char * dest);

int __wrap_OS_ReadXML(const char *file, OS_XML *_lxml);

int __wrap_OS_ReadXML_Ex(const char *file, OS_XML *_lxml);

char* __wrap_OS_GetOneContentforElement(OS_XML *_lxml, const char **element_name);

void __wrap_OS_ClearXML(OS_XML *_lxml);

xml_node **__wrap_OS_GetElementsbyNode(const OS_XML *_lxml, const xml_node *node);

char * __wrap_w_get_file_content(const char * path, int max_size);

FILE * __wrap_w_get_file_pointer(const char * path);
