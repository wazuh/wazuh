# Integration labels
event:
  module: system #TODO and sysmon?
  dataset:
    - system-auth
    - sysmon-linux
#    - system-general
#    - system-secure
#    - system-kernel

title: System events

# Sections to generate the Markdown documentation, the strings must be literals (plain or |) and using Markdown syntax
overview: |

  The enhanced system module is designed to collect, parse, and analyze logs generated by the system logging
  service across a variety of common Unix/Linux based distributions.
  The aim of this module is to provide a comprehensive overview of system activities,
  aiding administrators and security personnel in monitoring, auditing, and troubleshooting the system.

  <!-- Components: -->
  - System-auth: Specifically tailored to parse authentication-related logs, it keeps track of activities such as sudo commands, ssh logins, and cron jobs. This component plays a pivotal role in maintaining the security integrity of the system by logging all access and privilege escalation events.

  - Sysmon-linux: This component focuses on system monitoring logs. It records events like process creation or termination, network connections, and file operations (creation, deletion, modification). This dataset is valuable for understanding the operational status of the system and detecting any unusual or unexpected activity.

  <!--
  - System-general: This component caters to the general system events not covered by the other components. It provides an overall picture of the system health, keeping track of routine events and errors across various services and applications running on the system.

  - System-secure: Exclusive to Red Hat-based Linux distributions, this component processes logs related to authentication and security validations, providing additional depth to the audit trail.

  - System-kernel: This component processes messages from the Linux kernel. These logs provide critical insight into interactions between the hardware and the kernel, which is especially useful for diagnosing hardware issues and driver conflicts.
  -->


compatibility: This integration was tested with logs from OSes like Ubuntu 20.04, Centos 7, Fedora 32.

configuration: |

  This integration ingests logs from `/var/log/syslog`, `/var/log/auth.log`, `/var/log/messages`, `/var/log/secure`
  and `/var/log/kern.log` (the location of the files can be configured in the localfile configuration).

  As mentioned above, we use the logcollector source localfile to ingest the logs from all the files.

  Adding to the ossec.conf file in the monitored agent the following blocks:
  ```xml
  <localfile>
    <location>/var/log/syslog</location>
    <log_format>syslog</log_format>
  </localfile>
  <localfile>
    <location>/var/log/auth.log</location>
    <log_format>syslog</log_format>
  </localfile>
  <localfile>
    <location>/var/log/messages</location>
    <log_format>syslog</log_format>
  </localfile>
  <localfile>
    <location>/var/log/secure</location>
    <log_format>syslog</log_format>
  </localfile>
  <localfile>
    <location>/var/log/kern.log</location>
    <log_format>syslog</log_format>
  </localfile>
  ```
