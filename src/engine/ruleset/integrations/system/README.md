# System events


|   |   |
|---|---|
| event.module | system |
| event.dataset | ['system-auth', 'sysmon-linux'] |


The enhanced system module is designed to collect, parse, and analyze logs generated by the system logging
service across a variety of common Unix/Linux based distributions.
The aim of this module is to provide a comprehensive overview of system activities,
aiding administrators and security personnel in monitoring, auditing, and troubleshooting the system.

<!-- Components: -->
- System-auth: Specifically tailored to parse authentication-related logs, it keeps track of activities such as sudo commands, ssh logins, and cron jobs. This component plays a pivotal role in maintaining the security integrity of the system by logging all access and privilege escalation events.

- Sysmon-linux: This component focuses on system monitoring logs. It records events like process creation or termination, network connections, and file operations (creation, deletion, modification). This dataset is valuable for understanding the operational status of the system and detecting any unusual or unexpected activity.

<!--
- System-general: This component caters to the general system events not covered by the other components. It provides an overall picture of the system health, keeping track of routine events and errors across various services and applications running on the system.

- System-secure: Exclusive to Red Hat-based Linux distributions, this component processes logs related to authentication and security validations, providing additional depth to the audit trail.

- System-kernel: This component processes messages from the Linux kernel. These logs provide critical insight into interactions between the hardware and the kernel, which is especially useful for diagnosing hardware issues and driver conflicts.
-->


## Compatibility

This integration was tested with logs from OSes like Ubuntu 20.04, Centos 7, Fedora 32.

## Configuration


This integration ingests logs from `/var/log/syslog`, `/var/log/auth.log`, `/var/log/messages`, `/var/log/secure`
and `/var/log/kern.log` (the location of the files can be configured in the localfile configuration).

As mentioned above, we use the logcollector source localfile to ingest the logs from all the files.

Adding to the ossec.conf file in the monitored agent the following blocks:
```xml
<localfile>
  <location>/var/log/syslog</location>
  <log_format>syslog</log_format>
</localfile>
<localfile>
  <location>/var/log/auth.log</location>
  <log_format>syslog</log_format>
</localfile>
<localfile>
  <location>/var/log/messages</location>
  <log_format>syslog</log_format>
</localfile>
<localfile>
  <location>/var/log/secure</location>
  <log_format>syslog</log_format>
</localfile>
<localfile>
  <location>/var/log/kern.log</location>
  <log_format>syslog</log_format>
</localfile>
```


## Schema

## Decoders

| Name | Description |
|---|---|
| decoder/sysmon-linux/0 | Decoder for sysmon logs. Currently suport all events generate with id 1, 3, 4, 5, 9, 11, 16 and 23 |
| decoder/system-auth/0 | Decoder for system athenticated action logs. |
## Rules

| Name | Description |
|---|---|
## Outputs

| Name | Description |
|---|---|
## Filters

| Name | Description |
|---|---|
## Changelog

| Version | Description | Details |
|---|---|---|
| 0.0.2-dev | Add base sysmon-linux integration | [#17399](https://github.com/wazuh/wazuh/pull/17399) |
| 0.0.1-dev | Created integration for system auth events | [#17273](https://github.com/wazuh/wazuh/pull/17273) |
