{
    // Use IntelliSense to learn about possible attributes.
    // Hover to view descriptions of existing attributes.
    // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387
    "version": "0.2.0",
    "configurations": [
        {
            "name": "wazuh-engine standalone",
            "type": "cppdbg",
            "request": "launch",
            "program": "${env:ENGINE_BUILD}/wazuh-engine",
            "args": ["-f"],
            "stopAtEntry": false,
            "cwd": "${env:ENGINE_BUILD}",
            "environment": [
                {
                    "name": "MALLOC_CHECK_",
                    "value": "2"
                },
                {
                    "name": "WAZUH_STANDALONE_LOG_LEVEL",
                    "value": "trace"
                },
                // Data, store, kvdb and indexer store
                {
                    "name": "WAZUH_KVDB_PATH",
                    "value": "${env:ENGINE_STANDALONE_DIR}/kvdb/"
                },
                {
                    "name": "WAZUH_STORE_PATH",
                    "value": "${env:ENGINE_STANDALONE_DIR}/store"
                },
                // Server and sockets
                {
                    "name": "WAZUH_MANAGER_API_SOCKET",
                    "value": "${env:ENGINE_STANDALONE_SOCKET_API}"
                },
                {
                    "name": "WAZUH_MANAGER_ENRICHED_EVENTS_SOCKET",
                    "value": "${env:ENGINE_STANDALONE_SOCKET_REMOTED}"
                },
                {
                    "name": "WAZUH_MANAGER_EVENT_SOCKET",
                    "value": "${env:ENGINE_STANDALONE_SOCKET_LEGACY}"
                },
                // TZDB
                {
                    "name": "WAZUH_TZDB_PATH",
                    "value": "${env:ENGINE_STANDALONE_DIR}/tzdb"
                },
                {
                    "name": "WAZUH_TZDB_AUTO_UPDATE",
                    "value": "true"
                },
                //{
                //    "name": "WAZUH_TZDB_FORCE_VERSION_UPDATE",
                //    "value": "2024a"
                //},
                // Arcive
                {
                    "name": "WAZUH_ARCHIVER_ENABLED",
                    "value": "false"
                },
                {
                    "name": "WAZUH_STREAMLOG_BASE_PATH",
                    "value": "${env:ENGINE_STANDALONE_DIR}/logs/"
                },
                // Orchestrator
                {
                    "name": "WAZUH_ORCHESTRATOR_THREADS",
                    "value": "2"
                },
                // Indexer conector
                {
                    "name": "WAZUH_INDEXER_HOSTS",
                    "value": "https://localhost:9200"
                },
                {
                    "name": "WAZUH_INDEXER_USER",
                    "value": "admin"
                },
                {
                    "name": "WAZUH_INDEXER_PASSWORD",
                    "value": "admin"
                },
                {
                    "name": "WAZUH_INDEXER_SSL_CERTIFICATE",
                    "value": "/etc/wazuh-indexer/certs/admin.pem"
                },
                {
                    "name": "WAZUH_INDEXER_SSL_KEY",
                    "value": "/etc/wazuh-indexer/certs/admin-key.pem"
                },
                             {
                    "name": "WAZUH_INDEXER_SSL_CA_BUNDLE",
                    "value": "/etc/wazuh-indexer/certs/root-ca.pem"
                },
                // Standalone mode
                {
                    "name": "WAZUH_ENGINE_STANDALONE",
                    "value": "true"
                },
                {
                    "name": "WAZUH_MANAGER_ENABLE_EVENT_PROCESSING",
                    "value": "true"
                },
            ],
            "MIMode": "gdb",
            "setupCommands": [
                {
                    "description": "Enable pretty-printing for gdb",
                    "text": "-enable-pretty-printing",
                    "ignoreFailures": true
                },
                {
                    "description": "Enable capture SIGINT",
                    "text": "handle SIGINT print nostop pass",
                    "ignoreFailures": true
                },
                {
                    "description": "Muchos caracteres",
                    "text": "-interpreter-exec console \"set print elements 300\"",
                    "ignoreFailures": true
                },
            ]
        },
        {
            "name": "wazuh-engine as analysisd",
            "type": "cppdbg",
            "request": "launch",
            "program": "${env:ENGINE_BUILD}/wazuh-engine",
            "args": ["-f"],
            "stopAtEntry": false,
            "cwd": "/var/wazuh-manager/",
            "environment": [
                {
                    "name": "MALLOC_CHECK_",
                    "value": "2"
                },
                {
                    "name": "WAZUH_ORCHESTRATOR_THREADS",
                    "value": "2"
                },
                {
                    "name": "WAZUH_LOG_LEVEL",
                    "value": "0"
                }
            ],
            "MIMode": "gdb",
            "setupCommands": [
                {
                    "description": "Enable pretty-printing for gdb",
                    "text": "-enable-pretty-printing",
                    "ignoreFailures": true
                },
                {
                    "description": "Enable capture SIGINT",
                    "text": "handle SIGINT print nostop pass",
                    "ignoreFailures": true
                },
                {
                    "description": "Muchos caracteres",
                    "text": "-interpreter-exec console \"set print elements 300\"",
                    "ignoreFailures": true
                },
            ]
        },
        {
            "name": "wazuh-analsysid",
            "type": "cppdbg",
            "request": "launch",
            "program": "/var/wazuh-manager/bin/wazuh-manager-analysisd",
           // "additionalSOLibSearchPath": "${workspaceFolder}/wazuh/src/",
            "args": ["-f", "-d"],
            "stopAtEntry": false,
            "cwd": "/var/wazuh-manager/",
            "environment": [
                {
                    "name": "MALLOC_CHECK_",
                    "value": "2"
                },
                {
                    "name": "WAZUH_ORCHESTRATOR_THREADS",
                    "value": "2"
                },
            ],
            "MIMode": "gdb",
            "setupCommands": [
                {
                    "description": "Enable pretty-printing for gdb",
                    "text": "-enable-pretty-printing",
                    "ignoreFailures": true
                },
                {
                    "description": "Enable capture SIGINT",
                    "text": "handle SIGINT print nostop pass",
                    "ignoreFailures": true
                },
                {
                    "description": "Muchos caracteres",
                    "text": "-interpreter-exec console \"set print elements 300\"",
                    "ignoreFailures": true
                },
            ]
        },
        /*********************************************************************************
        *                        Installation scripts debug configurations
        *********************************************************************************/
        {
            "name": "Wazuh ./install.sh",
            "type": "bashdb",
            "request": "launch",
            "program": "${env:WAZUH_REPO}/install.sh",
            "args": [],
            "cwd": "${env:WAZUH_REPO}",
            "showDebugOutput": true,
            "terminalKind": "integrated"
        },
        {
            "name": "E2E Init script",
            "type": "bashdb",
            "request": "launch",
            "program": "${env:ENGINE_SRC}/tools/devContainer/e2e/init.sh",
            "args": [],
            "cwd": "${env:ENGINE_SRC}",
            "showDebugOutput": true,
            "terminalKind": "integrated"
        },
        /*********************************************************************************
        *                        Go tools debug configurations
        *********************************************************************************/
        {
            "name": "http by pass",
            "type": "go",
            "request": "launch",
            "mode": "auto",
            "program": "${env:ENGINE_SRC}/tools/http_bypass.go",
            "env": {},
            "args": [],
            "showLog": true
        },
        /*********************************************************************************
        *                        C++ Core dump configurations
        *********************************************************************************/
        {
            "type": "cppdbg",
            "request": "launch",
            "name": "Open a core dump Wazuh-Engine",
            "program": "${env:ENGINE_BUILD}/main",
            "coreDumpPath": "${input:coreFileName}",
            "cwd": "${env:ENGINE_SRC}",
            "miDebuggerPath": "/usr/bin/gdb",
            "MIMode": "gdb"
        },
        {
            "type": "cppdbg",
            "request": "launch",
            "name": "Open a core dump cpp_test",
            "program": "${env:ENGINE_BUILD}/source/router/router_utest",
            "coreDumpPath": "${input:coreFileName}",
            "cwd": "${env:ENGINE_SRC}",
            "miDebuggerPath": "/usr/bin/gdb",
            "MIMode": "gdb"
        },
        /*********************************************************************************
        *                        Python Tools debug configurations
        * "cwd": "${env:TMP_CLEAN_ENV}", is temporary,
        *  it is used until we can have a configuration for indexer conector folder
        *********************************************************************************/
        {
            "name": "Python: engine-helper-test init",
            "type": "debugpy",
            "request": "launch",
            "program": "${env:ENGINE_SRC}/test/helper_tests/engine-helper-test/src/helper_test/__main__.py",
            "console": "integratedTerminal",
            "python": "${command:python.interpreterPath}",
            "args": [
                "-e", "${env:TMP_CLEAN_ENV}",
                "init",
                "--mmdb", "${env:ENGINE_SRC}/test/helper_tests/mmdb/",
                "--conf", "${env:ENGINE_SRC}/test/helper_tests/configuration_files/config.env"
            ],
            "env": {
                "PYTHONPATH": "${env:ENGINE_PYTHONPATH_DBG}:${env:PYTHONPATH}",
            },
            "justMyCode": false
        },
        {
            "name": "Python: engine-helper-test validate",
            "type": "debugpy",
            "request": "launch",
            "program": "${env:ENGINE_SRC}/test/helper_tests/engine-helper-test/src/helper_test/__main__.py",
            "console": "integratedTerminal",
            "python": "${command:python.interpreterPath}",
            "args": [
                "-e", "${env:TMP_CLEAN_ENV}",
                "validate",
                "--input-dir", "${env:ENGINE_SRC}/test/helper_tests/helpers_description/"
            ],
            "env": {
                "PYTHONPATH": "${env:ENGINE_PYTHONPATH_DBG}:${env:PYTHONPATH}",
            },
            "justMyCode": false
        },
        {
            "name": "Python: engine-helper-test generate-test",
            "type": "debugpy",
            "request": "launch",
            "program": "${env:ENGINE_SRC}/test/helper_tests/engine-helper-test/src/helper_test/__main__.py",
            "console": "integratedTerminal",
            "python": "${command:python.interpreterPath}",
            "args": [
                "-e", "${env:TMP_CLEAN_ENV}",
                "generate-tests",
                "--input-dir", "${env:ENGINE_SRC}/test/helper_tests/helpers_description/",
                "-o", "/tmp/helper_tests/"
            ],
            "env": {
                "PYTHONPATH": "${env:ENGINE_PYTHONPATH_DBG}:${env:PYTHONPATH}",
            },
            "justMyCode": false
        },
        {
            "name": "Python: engine-helper-test run",
            "type": "debugpy",
            "request": "launch",
            "program": "${env:ENGINE_SRC}/test/helper_tests/engine-helper-test/src/helper_test/__main__.py",
            "console": "integratedTerminal",
            "python": "${command:python.interpreterPath}",
            "args": [
                "-e", "${env:TMP_CLEAN_ENV}",
                "run",
                "--input-dir", "/tmp/helper_tests/"
            ],
            "env": {
                "PYTHONPATH": "${env:ENGINE_PYTHONPATH_DBG}:${env:PYTHONPATH}",
            },
            "justMyCode": false
        },
        {
            "name": "Python: engine-helper-test generate-doc",
            "type": "debugpy",
            "request": "launch",
            "program": "${env:ENGINE_SRC}/test/helper_tests/engine-helper-test/src/helper_test/__main__.py",
            "console": "integratedTerminal",
            "python": "${command:python.interpreterPath}",
            "args": [
                "-e", "${env:TMP_CLEAN_ENV}",
                "generate-doc",
                "--input-dir", "${env:ENGINE_SRC}/test/helper_tests/helpers_description/",
                "-o", "${env:WAZUH_REPO}/docs/ref/modules/engine"
            ],
            "env": {
                "PYTHONPATH": "${env:ENGINE_PYTHONPATH_DBG}:${env:PYTHONPATH}",
            },
            "justMyCode": false
        },
        {
            "name": "Python: engine-it setup",
            "type": "debugpy",
            "request": "launch",
            "program": "${env:ENGINE_SRC}/test/integration_tests/engine-it/src/integration_test/__main__.py",
            "console": "integratedTerminal",
            "python": "${command:python.interpreterPath}",
            "args": [
                "-e", "${env:TMP_CLEAN_ENV}",
                "-t", "${env:ENGINE_SRC}/test/integration_tests",
                "init"
            ],
            "env": {
                "PYTHONPATH": "${env:ENGINE_PYTHONPATH_DBG}:${env:PYTHONPATH}",
            },
            "justMyCode": false
        },
        {
            "name": "Python: engine-it runner",
            "type": "debugpy",
            "request": "launch",
            "program": "${env:ENGINE_SRC}/test/integration_tests/engine-it/src/integration_test/__main__.py",
            "console": "integratedTerminal",
            "python": "${command:python.interpreterPath}",
            "args": [
                "-e", "${env:TMP_CLEAN_ENV}",
                "-t", "${env:ENGINE_SRC}/test/integration_tests",
                "run"
            ],
            "env": {
                "PYTHONPATH": "${env:ENGINE_PYTHONPATH_DBG}:${env:PYTHONPATH}",
            },
            "justMyCode": false
        },
        {
            "name": "Python: run IT behave",
            "cwd": "${env:ENGINE_SRC}/",
            "type": "debugpy",
            "request": "launch",
            "module": "behave",
            "console": "integratedTerminal",
            "args": [
                 // "-e", "/tmp/engine-integration-test",
                 // "-f","${env:ENGINE_SRC}/test/integration_tests/router/features/api.feature"
                 "${env:ENGINE_SRC}/test/integration_tests/router"
            ],
            "env": {
                "PYTHONPATH": "${env:ENGINE_PYTHONPATH_DBG}:${env:PYTHONPATH}",
                "ENV_DIR": "${env:TMP_CLEAN_ENV}",
                "BINARY_DIR": "${env:TMP_CLEAN_ENV}/wazuh-engine",
                "CONF_FILE": "${env:TMP_CLEAN_ENV}/config.env"
            },
            "justMyCode": false
        },
        {
            "name": "Python: engine-test",
            "type": "debugpy",
            "request": "launch",
            "program": "${env:ENGINE_SRC}/tools/engine-suite/src/engine_test/__main__.py",
            "console": "integratedTerminal",
            "python": "${command:python.interpreterPath}",
            "args": [
                "run", "syslog"
            ],
            "env": {
                "PYTHONPATH": "${env:ENGINE_PYTHONPATH_DBG}:${env:PYTHONPATH}",
            },
            "justMyCode": false
        },
        /*********************************************************************************
        *                        C++ Core dump configurations
        *********************************************************************************/
        {
            "type": "cppdbg",
            "request": "launch",
            "name": "Open a core dump Wazuh-Engine",
            "program": "${env:ENGINE_BUILD}/main",
            "coreDumpPath": "${input:coreFileName}",
            "cwd": "${env:ENGINE_SRC}",
            "miDebuggerPath": "/usr/bin/gdb",
            "MIMode": "gdb"
        },
        {
            "type": "cppdbg",
            "request": "launch",
            "name": "Open a core dump cpp_test",
            "program": "${env:ENGINE_BUILD}/source/router/router_utest",
            "coreDumpPath": "${input:coreFileName}",
            "cwd": "${env:ENGINE_SRC}",
            "miDebuggerPath": "/usr/bin/gdb",
            "MIMode": "gdb"
        }
    ],
    "inputs": [
        {
            "id": "coreFileName",
            "type": "promptString",
            "description": "Enter core file path"
        }
    ]
}
