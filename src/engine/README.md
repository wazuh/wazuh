# Engine development enviroment

1. [Project structure](#structure)
    1. [Benchamarck](#benchamarck)
    1. [Build](#build)
    1. [Docs](#docs)
    1. [Source](#source)
    1. [Test](#test)
    1. [Tools](#tools)                   
1. [Directory description](#directory-description)
1. [Engine Compilation](#engine-compilation)
    1. [Install cmake](#install-cmake)
    1. [Install vcpkg](#install-vcpkg)
    1. [Building engine](#building-engine)
1. [License](#license)

<a name="structure"></a>
## Project structure
```bash
engine/
├── benchmark
├── build
├── docs
├── source
├── test
├── tools
```

## Benchamarck

Dedicated to the implementation of performance tests and benchmarking. Contains source code files necessary to evaluate the performance of various system components. The tests developed in this folder allow identifying bottlenecks and optimizing the efficiency of operations, contributing to the continuous improvement of the system.

## Build

Is the workspace generated by CMake for the project build. Files generated during the build process are stored here, including binaries, intermediate objects, and other artifacts necessary for the execution of applications and tests.

## Docs

Its main purpose is the generation and management of the project's technical documentation. Its objective is to provide detailed information about the helper functions used in the development of decoders and rules, thus facilitating their understanding and maintenance. The generated documentation helps developers better understand the functionalities and the use of these functions in the context of the project.

## Source

It houses all the engine components of the project. Each component is structured with its own interface, header files, source files, and unit and component tests.

## Test

- **Integration Tests**: They verify the correct interaction between the different components of the system.
- **End-to-End Testing**: Evaluate the complete operation of the helper functions in real scenarios to ensure that they meet the expected requirements.
- **Decoders and Rules Tests**: They check the behavior and accuracy of the decoders and the rules defined in the project.

## Tools

The tools folder contains packages and scripts designed to facilitate engine resource management and testing. Includes tools for:

- **Run Valgrind and ASAN**: These tools are used to detect memory problems and synchronization errors in tests, helping to ensure code stability and performance.
- **Communication with the API**: Allows interaction with the project's API to manage and control the engine's resources.
- **Testing of Decoders and Rules**: Provides functionalities to perform specific tests on decoders and rules, contributing to the validation and adjustment of the system.

# Engine Compilation

## Install cmake
```bash
curl -sL https://github.com/Kitware/CMake/releases/download/v3.24.2/cmake-3.24.2-linux-x86_64.tar.gz | tar -xz -C /usr/local --strip-components=1
export PATH=$PATH:/usr/local/bin
```
## Install vcpkg
- **Prepare the environment**:
```bash
sudo apt update
sudo apt install -y zip unzip
```
- **Install build-essential and pkg-config packages**:
```bash
sudo apt install -y build-essential pkg-config
```
- **Install vcpkg from GitHub**:
```bash
wget -O vcpkg.tar.gz https://github.com/microsoft/vcpkg/archive/master.tar.gz
```
- **Make a new directory to hold vcpkg and extract the tar.gz file**:
```bash
sudo mkdir /home/$USER/engine/vcpkg
sudo tar xf vcpkg.tar.gz --strip-components=1 -C /home/$USER/engine/vcpkg
```
- **Build vcpkg**:
```bash
sudo /home/$USER/engine/vcpkg/bootstrap-vcpkg.sh
```
- **Make a symbolic link to the vcpkg command in “/usr/local/bin”**
```bash
sudo ln -s /home/$USER/engine/vcpkg/vcpkg /usr/local/bin/vcpkg
```
- **Check the version of vcpkg**:
```bash
vcpkg version
```
- **Remove the tar.gz file**:
```bash
rm -rf vcpkg.tar.gz
```

## Building engine
```bash
export VCPKG_ROOT=/home/$USER/engine/vcpkg # Required by CMAKE_TOOLCHAIN_FILE
cmake --preset=default
cmake --build build/ --config Debug --target main -j $(nproc)
```


<a name="license"></a>
## License
Wazuh Engine is distributed under the AGPLv3 license. See [LICENSE-engine](LICENSE-engine) and [COPYING-engine](COPYING-engine) for more details.