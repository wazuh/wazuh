syntax = "proto3";

import "engine.proto";
import "google/protobuf/struct.proto";

package com.wazuh.api.engine.geo;

/* Entry of a db in the geo manager */
message DbEntry
{
    string name = 1;
    string path = 2;
    string hash = 3;
    string createdAt = 4;
    string type = 5;
}

/***************************************************
 * Remove a mmddb from the geo manager
 *
 * command: geo.db/delete (<resource>/<action>)
 **************************************************/
message DbGet_Request
{
    string ip = 1;
}

message DbGet_Response
{
    ReturnStatus status = 1;
    string error = 2;
    google.protobuf.Struct data = 3; // JSON object with geo data
}

/***************************************************
 * Get the list of mmddb used by the geo manager
 *
 * command: geo.db/list (<resource>/<action>)
 **************************************************/
message DbList_Request {}

message DbList_Response
{
    ReturnStatus status = 1;   // Status of the query
    optional string error = 2; // Error message if status is ERROR
    repeated DbEntry entries = 3;
}
