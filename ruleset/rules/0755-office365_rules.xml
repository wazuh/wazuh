<!--
  -  Office365 rules
  -  Created by Wazuh, Inc.
  -  Copyright (C) 2015, Wazuh Inc.
  -  This program is a free software; you can redistribute it and/or modify it under the terms of GPLv2.
-->

<!--
ID: 91531 - 91650
-->

<group name="office365,">

    <!-- Office365 wodle -->
    <rule id="91531" level="0">
        <decoded_as>json</decoded_as>
        <field name="integration">office365</field>
        <description>Office 365: $(office365.Workload) $(office365.Operation) operation.</description>
        <options>no_full_log</options>
    </rule>

    <!-- Office365 generic rule
        This rule captures unknown alerts
    -->
    <rule id="91532" level="3">
        <if_sid>91531</if_sid>
        <field name="office365.RecordType" type="osregex">\d+</field>
        <description>Office 365: $(office365.Workload) $(office365.Operation) operation.</description>
        <options>no_full_log</options>
    </rule>

    <!-- RecordType
            ExchangeAdmin
            ExchangeItem
            ExchangeItemGroup
            SharePoint
            SharePointFileOperation
            OneDrive
            AzureActiveDirectory
            AzureActiveDirectoryAccountLogon
            DataCenterSecurityCmdlet
            ComplianceDLPSharePoint
            ComplianceDLPExchange
            SharePointSharingOperation
            AzureActiveDirectoryStsLogon
            SkypeForBusinessPSTNUsage
            SkypeForBusinessUsersBlocked
            SecurityComplianceCenterEOPCmdlet
            ExchangeAggregatedOperation
            PowerBIAudit
            CRM
            Yammer
            SkypeForBusinessCmdlets
            Discovery
            MicrosoftTeams
            ThreatIntelligence
            MailSubmission
            MicrosoftFlow
            AeD
            MicrosoftStream
            ComplianceDLPSharePointClassification
            ThreatFinder
            Project
            SharePointListOperation
            SharePointCommentOperation
            DataGovernance
            Kaizala
            SecurityComplianceAlerts
            ThreatIntelligenceUrl
            SecurityComplianceInsights
            MIPLabel
            WorkplaceAnalytics
            PowerAppsApp
            PowerAppsPlan
            ThreatIntelligenceAtpContent
            LabelContentExplorer
            TeamsHealthcare
            ExchangeItemAggregated
            HygieneEvent
            DataInsightsRestApiAudit
            InformationBarrierPolicyApplication
            SharePointListItemOperation
            SharePointContentTypeOperation
            SharePointFieldOperation
            MicrosoftTeamsAdmin
            HRSignal
            MicrosoftTeamsDevice
            MicrosoftTeamsAnalytics
            InformationWorkerProtection
            Campaign
            DLPEndpoint
            AirInvestigation
            Quarantine
            MicrosoftForms
            ApplicationAudit
            ComplianceSupervisionExchange
            CustomerKeyServiceEncryption
            OfficeNative
            MipAutoLabelSharePointItem
            MipAutoLabelSharePointPolicyLocation
            MicrosoftTeamsShifts
            MipAutoLabelExchangeItem
            CortanaBriefing
            Search
            WDATPAlerts
            MDATPAudit
            SensitivityLabelPolicyMatch
            SensitivityLabelAction
            SensitivityLabeledFileAction
            AttackSim
            AirManualInvestigation
            SecurityComplianceRBAC
            UserTraining
            AirAdminActionInvestigation
            MSTIC
            PhysicalBadgingSignal
            AipDiscover
            AipSensitivityLabelAction
            AipProtectionAction
            AipFileDeleted
            AipHeartBeat
            MCASAlerts
            OnPremisesFileShareScannerDlp
            OnPremisesSharePointScannerDlp
            ExchangeSearch
            SharePointSearch
            PrivacyInsights
            MyAnalyticsSettings
            SecurityComplianceUserChange
            ComplianceDLPExchangeClassification
            MipExactDataMatch
    -->


    <rule id="91533" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^1$</field>
        <description>Office 365: Events from the Exchange admin audit log.</description>
        <options>no_full_log</options>
        <group>ExchangeAdmin,hipaa_164.312.b,pci_dss_10.2.2,pci_dss_10.6.1</group>
    </rule>

    <rule id="91534" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^2$</field>
        <description>Office 365: Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.</description>
        <options>no_full_log</options>
        <group>ExchangeItem,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91535" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^3$</field>
        <description>Office 365: Events from an Exchange mailbox audit log for actions that can be performed on multiple items, such as moving or deleted one or more email messages.</description>
        <options>no_full_log</options>
        <group>ExchangeItemGroup,hipaa_164.312.b,hipaa_164.312.c.1,pci_dss_10.6.2</group>
    </rule>

    <rule id="91536" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^4$</field>
        <description>Office 365: SharePoint events.</description>
        <options>no_full_log</options>
        <group>SharePoint,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91537" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^6$</field>
        <description>Office 365: SharePoint file operation events.</description>
        <options>no_full_log</options>
        <group>SharePointFileOperation,hipaa_164.312.b,hipaa_164.312.c.1,pci_dss_10.6.2,pci_dss_11.5</group>
    </rule>

    <rule id="91538" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^7$</field>
        <description>Office 365: OneDrive for Business events.</description>
        <options>no_full_log</options>
        <group>OneDrive,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91539" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^8$</field>
        <description>Office 365: Azure Active Directory events.</description>
        <options>no_full_log</options>
        <group>AzureActiveDirectory,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91540" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^9$</field>
        <description>Office 365: Azure Active Directory OrgId logon events (deprecated).</description>
        <options>no_full_log</options>
        <group>AzureActiveDirectoryAccountLogon,hipaa_164.312.a.1,hipaa_164.312.a.2.I,hipaa_164.312.b,hipaa_164.312.d,pci_dss_10.6.2</group>
    </rule>

    <rule id="91541" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^10$</field>
        <description>Office 365: Data Center security cmdlet events.</description>
        <options>no_full_log</options>
        <group>DataCenterSecurityCmdlet,hipaa_164.312.b,pci_dss_10.6.1</group>
    </rule>

    <rule id="91542" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^11$</field>
        <description>Office 365: Data loss protection (DLP) events in SharePoint and OneDrive for Business.</description>
        <options>no_full_log</options>
        <group>ComplianceDLPSharePoint,hipaa_164.312.a.1,hipaa_164.312.b,hipaa_164.312.c.1,pci_dss_10.6.1,pci_dss_11.5</group>
        <mitre>
            <id>T1213.002</id>
        </mitre>
    </rule>

    <rule id="91543" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^13$</field>
        <description>Office 365: Data loss protection (DLP) events in Exchange, when configured via Unified DLP Policy. DLP events based on Exchange Transport Rules are not supported.</description>
        <options>no_full_log</options>
        <group>ComplianceDLPExchange,hipaa_164.312.a.1,hipaa_164.312.b,hipaa_164.312.c.1,pci_dss_10.6.1,pci_dss_11.5</group>
    </rule>

    <rule id="91544" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^14$</field>
        <description>Office 365: SharePoint sharing events.</description>
        <options>no_full_log</options>
        <group>SharePointSharingOperation,hipaa_164.312.b,pci_dss_10.6.2</group>
        <mitre>
            <id>T1213.002</id>
        </mitre>
    </rule>

    <rule id="91545" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^15$</field>
        <description>Office 365: Secure Token Service (STS) logon events in Azure Active Directory.</description>
        <options>no_full_log</options>
        <group>AzureActiveDirectoryStsLogon,hipaa_164.312.a.2.I,hipaa_164.312.b,hipaa_164.312.d,hipaa_164.312.e.2.II,pci_dss_8.3,pci_dss_10.6.1</group>
    </rule>

    <rule id="91546" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^16$</field>
        <description>Office 365: Public Switched Telephone Network (PSTN) events from Skype for Business.</description>
        <options>no_full_log</options>
        <group>SkypeForBusinessPSTNUsage,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91547" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^17$</field>
        <description>Office 365: Blocked user events from Skype for Business.</description>
        <options>no_full_log</options>
        <group>SkypeForBusinessUsersBlocked,hipaa_164.312.a.1,hipaa_164.312.b,pci_dss_7.1,pci_dss_10.2.4,pci_dss_10.5.2,pci_dss_10.6.1</group>
    </rule>

    <rule id="91548" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^18$</field>
        <description>Office 365: Admin actions from the Security and Compliance Center.</description>
        <options>no_full_log</options>
        <group>SecurityComplianceCenterEOPCmdlet,hipaa_164.312.b,pci_dss_10.2.2,pci_dss_10.6.1</group>
    </rule>

    <rule id="91549" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^19$</field>
        <description>Office 365: Aggregated Exchange mailbox auditing events.</description>
        <options>no_full_log</options>
        <group>ExchangeAggregatedOperation,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91550" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^20$</field>
        <description>Office 365: Power BI events.</description>
        <options>no_full_log</options>
        <group>PowerBIAudit,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91551" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^21$</field>
        <description>Office 365: Dynamics 365 events.</description>
        <options>no_full_log</options>
        <group>CRM,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91552" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^22$</field>
        <description>Office 365: Yammer events.</description>
        <options>no_full_log</options>
        <group>Yammer,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91553" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^23$</field>
        <description>Office 365: Skype for Business events.</description>
        <options>no_full_log</options>
        <group>SkypeForBusinessCmdlets,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91554" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^24$</field>
        <description>Office 365: Events for eDiscovery activities performed by running content searches and managing eDiscovery cases in the Security and Compliance Center.</description>
        <options>no_full_log</options>
        <group>Discovery,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91555" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^25$</field>
        <description>Office 365: Events from Microsoft Teams.</description>
        <options>no_full_log</options>
        <group>MicrosoftTeams,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91556" level="12">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^28$</field>
        <description>Office 365: Phishing and malware events from Exchange Online Protection and Microsoft Defender for Office 365.</description>
        <options>no_full_log</options>
        <group>ThreatIntelligence,hipaa_164.312.b,pci_dss_5.3,pci_dss_6.1,pci_dss_10.6.1</group>
    </rule>

    <rule id="91557" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^29$</field>
        <description>Office 365: Submission events from Exchange Online Protection and Microsoft Defender for Office 365.</description>
        <options>no_full_log</options>
        <group>MailSubmission,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91558" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^30$</field>
        <description>Office 365: Microsoft Power Automate (formerly called Microsoft Flow) events.</description>
        <options>no_full_log</options>
        <group>MicrosoftFlow,hipaa_164.312.b,pci_dss_10.6.2</group>
        <mitre>
            <id>T1137.006</id>
        </mitre>
    </rule>

    <rule id="91559" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^31$</field>
        <description>Office 365: Advanced eDiscovery events.</description>
        <options>no_full_log</options>
        <group>AeD,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91560" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^32$</field>
        <description>Office 365: Microsoft Stream events.</description>
        <options>no_full_log</options>
        <group>MicrosoftStream,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91561" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^33$</field>
        <description>Office 365: Events related to DLP classification in SharePoint.</description>
        <options>no_full_log</options>
        <group>ComplianceDLPSharePointClassification,hipaa_164.312.b,pci_dss_10.6.2</group>
        <mitre>
            <id>T1213.002</id>
        </mitre>
    </rule>

    <rule id="91562" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^34$</field>
        <description>Office 365: Campaign-related events from Microsoft Defender for Office 365.</description>
        <options>no_full_log</options>
        <group>ThreatFinder,hipaa_164.312.b,pci_dss_5.3,pci_dss_6.1,pci_dss_10.6.1</group>
    </rule>

    <rule id="91563" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^35$</field>
        <description>Office 365: Microsoft Project events.</description>
        <options>no_full_log</options>
        <group>Project,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91564" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^36$</field>
        <description>Office 365: SharePoint List events.</description>
        <options>no_full_log</options>
        <group>SharePointListOperation,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91565" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^37$</field>
        <description>Office 365: SharePoint comment events.</description>
        <options>no_full_log</options>
        <group>SharePointCommentOperation,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91566" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^38$</field>
        <description>Office 365: Events related to retention policies and retention labels in the Security and Compliance Center.</description>
        <options>no_full_log</options>
        <group>DataGovernance,hipaa_164.312.b,pci_dss_10.6.1</group>
    </rule>

    <rule id="91567" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^39$</field>
        <description>Office 365: Kaizala events.</description>
        <options>no_full_log</options>
        <group>Kaizala,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91568" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^40$</field>
        <description>Office 365: Security and compliance alert signals.</description>
        <options>no_full_log</options>
        <group>SecurityComplianceAlerts,hipaa_164.312.b,pci_dss_10.6.1</group>
    </rule>

    <rule id="91569" level="7">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^41$</field>
        <description>Office 365: Safe links time-of-block and block override events from Microsoft Defender for Office 365.</description>
        <options>no_full_log</options>
        <group>ThreatIntelligenceUrl,hipaa_164.312.b,pci_dss_10.6.1</group>
    </rule>

    <rule id="91570" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^42$</field>
        <description>Office 365: Events related to insights and reports in the Office 365 security and compliance center.</description>
        <options>no_full_log</options>
        <group>SecurityComplianceInsights,hipaa_164.312.b,pci_dss_10.6.1</group>
    </rule>

    <rule id="91571" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^43$</field>
        <description>Office 365: Events related to the detection in the Transport pipeline of email messages that have been tagged (manually or automatically) with sensitivity labels.</description>
        <options>no_full_log</options>
        <group>MIPLabel,hipaa_164.312.b,pci_dss_10.6.1</group>
    </rule>

    <rule id="91572" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^44$</field>
        <description>Office 365: Workplace Analytics events.</description>
        <options>no_full_log</options>
        <group>WorkplaceAnalytics,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91573" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^45$</field>
        <description>Office 365: Power Apps events.</description>
        <options>no_full_log</options>
        <group>PowerAppsApp,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91574" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^46$</field>
        <description>Office 365: Subscription plan events for Power Apps.</description>
        <options>no_full_log</options>
        <group>PowerAppsPlan,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91575" level="12">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^47$</field>
        <description>Office 365: Phishing and malware events for files in SharePoint, OneDrive for Business, and Microsoft Teams from Microsoft Defender for Office 365.</description>
        <options>no_full_log</options>
        <group>ThreatIntelligenceAtpContent,hipaa_164.312.b,pci_dss_5.3,pci_dss_6.1,pci_dss_10.6.1</group>
    </rule>

    <rule id="91576" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^48$</field>
        <description>Office 365: Events related to data classification content explorer.</description>
        <options>no_full_log</options>
        <group>LabelContentExplorer,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91577" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^49$</field>
        <description>Office 365: Events related to the Patients application in Microsoft Teams for Healthcare.</description>
        <options>no_full_log</options>
        <group>TeamsHealthcare,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91578" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^50$</field>
        <description>Office 365: Events related to the MailItemsAccessed mailbox auditing action.</description>
        <options>no_full_log</options>
        <group>ExchangeItemAggregated,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91579" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^51$</field>
        <description>Office 365: Events related to outbound spam protection.</description>
        <options>no_full_log</options>
        <group>HygieneEvent,hipaa_164.312.b,hipaa_164.312.e.1,pci_dss_1.3.4,pci_dss_5.3,pci_dss_10.6.1,pci_dss_11.4</group>
    </rule>

    <rule id="91580" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^52$</field>
        <description>Office 365: Data Insights REST API events.</description>
        <options>no_full_log</options>
        <group>DataInsightsRestApiAudit,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91581" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^53$</field>
        <description>Office 365: Events related to the application of information barrier policies.</description>
        <options>no_full_log</options>
        <group>InformationBarrierPolicyApplication,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91582" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^54$</field>
        <description>Office 365: SharePoint list item events.</description>
        <options>no_full_log</options>
        <group>SharePointListItemOperation,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91583" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^55$</field>
        <description>Office 365: SharePoint list content type events.</description>
        <options>no_full_log</options>
        <group>SharePointContentTypeOperation,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91584" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^56$</field>
        <description>Office 365: SharePoint list field events.</description>
        <options>no_full_log</options>
        <group>SharePointFieldOperation,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91585" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^57$</field>
        <description>Office 365: Teams admin events.</description>
        <options>no_full_log</options>
        <group>MicrosoftTeamsAdmin,hipaa_164.312.b,pci_dss_10.2.2,pci_dss_10.6.2</group>
    </rule>

    <rule id="91586" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^58$</field>
        <description>Office 365: Events related to HR data signals that support the Insider risk management solution.</description>
        <options>no_full_log</options>
        <group>HRSignal,hipaa_164.312.b,pci_dss_10.6.1</group>
    </rule>

    <rule id="91587" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^59$</field>
        <description>Office 365: Teams device events.</description>
        <options>no_full_log</options>
        <group>MicrosoftTeamsDevice,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91588" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^60$</field>
        <description>Office 365: Teams analytics events.</description>
        <options>no_full_log</options>
        <group>MicrosoftTeamsAnalytics,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91589" level="7">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^61$</field>
        <description>Office 365: Events related to compromised user alerts.</description>
        <options>no_full_log</options>
        <group>InformationWorkerProtection,hipaa_164.312.b,pci_dss_10.6.1</group>
    </rule>

    <rule id="91590" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^62$</field>
        <description>Office 365: Email campaign events from Microsoft Defender for Office 365.</description>
        <options>no_full_log</options>
        <group>Campaign,hipaa_164.312.b,pci_dss_5.3,pci_dss_6.1,pci_dss_10.6.1</group>
    </rule>

    <rule id="91591" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^63$</field>
        <description>Office 365: Endpoint DLP events.</description>
        <options>no_full_log</options>
        <group>DLPEndpoint,hipaa_164.312.a.1,hipaa_164.312.b,hipaa_164.312.c.1,pci_dss_10.6.1,pci_dss_11.5</group>
    </rule>

    <rule id="91592" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^64$</field>
        <description>Office 365: Automated incident response (AIR) events.</description>
        <options>no_full_log</options>
        <group>AirInvestigation,hipaa_164.312.b,pci_dss_10.6.1</group>
    </rule>

    <rule id="91593" level="9">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^65$</field>
        <description>Office 365: Quarantine events.</description>
        <options>no_full_log</options>
        <group>Quarantine,hipaa_164.312.b,pci_dss_5.3,pci_dss_10.6.1,pci_dss_11.5</group>
    </rule>

    <rule id="91594" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^66$</field>
        <description>Office 365: Microsoft Forms events.</description>
        <options>no_full_log</options>
        <group>MicrosoftForms,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91595" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^67$</field>
        <description>Office 365: Application audit events.</description>
        <options>no_full_log</options>
        <group>ApplicationAudit,hipaa_164.312.b,pci_dss_10.6.1</group>
    </rule>

    <rule id="91596" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^68$</field>
        <description>Office 365: Events tracked by the Communication compliance offensive language model.</description>
        <options>no_full_log</options>
        <group>ComplianceSupervisionExchange,hipaa_164.312.b,pci_dss_10.6.1</group>
    </rule>

    <rule id="91597" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^69$</field>
        <description>Office 365: Events related to the customer key encryption service.</description>
        <options>no_full_log</options>
        <group>CustomerKeyServiceEncryption,hipaa_164.312.a.1,hipaa_164.312.a.2.I,hipaa_164.312.a.2.IV,hipaa_164.312.b,hipaa_164.312.e.2.II,pci_dss_3.5.4,pci_dss_4.1,pci_dss_10.6.1</group>
    </rule>

    <rule id="91598" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^70$</field>
        <description>Office 365: Events related to sensitivity labels applied to Office documents.</description>
        <options>no_full_log</options>
        <group>OfficeNative,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91599" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^71$</field>
        <description>Office 365: Auto-labeling events in SharePoint.</description>
        <options>no_full_log</options>
        <group>MipAutoLabelSharePointItem,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91600" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^72$</field>
        <description>Office 365: Auto-labeling policy events in SharePoint.</description>
        <options>no_full_log</options>
        <group>MipAutoLabelSharePointPolicyLocation,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91601" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^73$</field>
        <description>Office 365: Teams Shifts events.</description>
        <options>no_full_log</options>
        <group>MicrosoftTeamsShifts,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91602" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^75$</field>
        <description>Office 365: Auto-labeling events in Exchange.</description>
        <options>no_full_log</options>
        <group>MipAutoLabelExchangeItem,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91603" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^76$</field>
        <description>Office 365: Briefing email events.</description>
        <options>no_full_log</options>
        <group>CortanaBriefing,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91604" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^77$</field>
        <description>Office 365: Events related to performing search queries in SharePoint and Exchange.</description>
        <options>no_full_log</options>
        <group>Search,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91605" level="7">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^78$</field>
        <description>Office 365: Events related to alerts generated by Windows Defender for Endpoint.</description>
        <options>no_full_log</options>
        <group>WDATPAlerts,hipaa_164.312.b,pci_dss_5.3,pci_dss_6.1,pci_dss_10.6.1</group>
    </rule>

    <rule id="91606" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^81$</field>
        <description>Office 365: Microsoft Defender for Endpoint events.</description>
        <options>no_full_log</options>
        <group>MDATPAudit,hipaa_164.312.b,pci_dss_5.3,pci_dss_6.1,pci_dss_10.6.1</group>
    </rule>

    <rule id="91607" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^82$</field>
        <description>Office 365: Events generated when the file labeled with a sensitivity label is opened or renamed.</description>
        <options>no_full_log</options>
        <group>SensitivityLabelPolicyMatch,hipaa_164.312.b,hipaa_164.312.c.1,pci_dss_10.6.1,pci_dss_11.5</group>
    </rule>

    <rule id="91608" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^83$</field>
        <description>Office 365: Event generated when sensitivity labels are applied, updated, or removed from a file.</description>
        <options>no_full_log</options>
        <group>SensitivityLabelAction,hipaa_164.312.b,hipaa_164.312.c.1,pci_dss_10.6.1,pci_dss_11.5</group>
    </rule>

    <rule id="91609" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^84$</field>
        <description>Office 365: Events generated when a file labeled with a sensitivity label is opened or renamed.</description>
        <options>no_full_log</options>
        <group>SensitivityLabeledFileAction,hipaa_164.312.b,hipaa_164.312.c.1,pci_dss_10.6.1,pci_dss_11.5</group>
    </rule>

    <rule id="91610" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^85$</field>
        <description>Office 365: Attack simulator events.</description>
        <options>no_full_log</options>
        <group>AttackSim,hipaa_164.312.b,pci_dss_6.1,pci_dss_10.6.1,pci_dss_11.2.1,pci_dss_11.2.3</group>
    </rule>

    <rule id="91611" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^86$</field>
        <description>Office 365: Events related to manual investigations in Automated investigation and response (AIR).</description>
        <options>no_full_log</options>
        <group>AirManualInvestigation,hipaa_164.312.b,pci_dss_10.6.1</group>
    </rule>

    <rule id="91612" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^87$</field>
        <description>Office 365: Security and compliance RBAC events.</description>
        <options>no_full_log</options>
        <group>SecurityComplianceRBAC,hipaa_164.312.b,pci_dss_10.6.1</group>
    </rule>

    <rule id="91613" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^88$</field>
        <description>Office 365: Attack simulator training events in Microsoft Defender for Office 365.</description>
        <options>no_full_log</options>
        <group>UserTraining,hipaa_164.312.b,pci_dss_6.1,pci_dss_10.6.1,pci_dss_11.2.1,pci_dss_11.2.3</group>
    </rule>

    <rule id="91614" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^89$</field>
        <description>Office 365: Events related to admin actions in Automated investigation and response (AIR).</description>
        <options>no_full_log</options>
        <group>AirAdminActionInvestigation,hipaa_164.312.b,pci_dss_10.2.2,pci_dss_10.6.1</group>
    </rule>

    <rule id="91615" level="7">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^90$</field>
        <description>Office 365: Threat intelligence events in Microsoft Defender for Office 365.</description>
        <options>no_full_log</options>
        <group>MSTIC,hipaa_164.312.b,pci_dss_10.6.1</group>
    </rule>

    <rule id="91616" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^91$</field>
        <description>Office 365: Events related to physical badging signals that support the Insider risk management solution.</description>
        <options>no_full_log</options>
        <group>PhysicalBadgingSignal,hipaa_164.312.b,pci_dss_8.6,pci_dss_9.1.1,pci_dss_10.6.1</group>
    </rule>

    <rule id="91617" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^93$</field>
        <description>Office 365: Azure Information Protection (AIP) scanner events.</description>
        <options>no_full_log</options>
        <group>AipDiscover,hipaa_164.312.a.1,hipaa_164.312.b,hipaa_164.312.c.1,pci_dss_5.3,pci_dss_10.6.1,pci_dss_11.4,pci_dss_11.5</group>
    </rule>

    <rule id="91618" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^94$</field>
        <description>Office 365: AIP sensitivity label events.</description>
        <options>no_full_log</options>
        <group>AipSensitivityLabelAction,hipaa_164.312.b,hipaa_164.312.c.1,pci_dss_10.6.1,pci_dss_11.4,pci_dss_11.5</group>
    </rule>

    <rule id="91619" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^95$</field>
        <description>Office 365: AIP protection events.</description>
        <options>no_full_log</options>
        <group>AipProtectionAction,hipaa_164.312.a.1,hipaa_164.312.b,hipaa_164.312.c.1,pci_dss_5.3,pci_dss_10.6.1,pci_dss_11.4,pci_dss_11.5</group>
    </rule>

    <rule id="91620" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^96$</field>
        <description>Office 365: AIP file deletion events.</description>
        <options>no_full_log</options>
        <group>AipFileDeleted,hipaa_164.312.a.1,hipaa_164.312.b,hipaa_164.312.c.1,pci_dss_10.6.1,pci_dss_11.4,pci_dss_11.5</group>
    </rule>

    <rule id="91621" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^97$</field>
        <description>Office 365: AIP heartbeat events.</description>
        <options>no_full_log</options>
        <group>AipHeartBeat,hipaa_164.312.b,hipaa_164.312.c.1,pci_dss_10.6.1,pci_dss_11.4,pci_dss_11.5</group>
    </rule>

    <rule id="91622" level="7">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^98$</field>
        <description>Office 365: Events corresponding to alerts triggered by Microsoft Cloud App Security.</description>
        <options>no_full_log</options>
        <group>MCASAlerts,hipaa_164.312.b,pci_dss_10.6.1</group>
    </rule>

    <rule id="91623" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^99$</field>
        <description>Office 365: Events related to scanning for sensitive data on file shares.</description>
        <options>no_full_log</options>
        <group>OnPremisesFileShareScannerDlp,hipaa_164.312.a.1,hipaa_164.312.b,pci_dss_5.3,pci_dss_10.6.1</group>
    </rule>

    <rule id="91624" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^100$</field>
        <description>Office 365: Events related to scanning for sensitive data in SharePoint.</description>
        <options>no_full_log</options>
        <group>OnPremisesSharePointScannerDlp,hipaa_164.312.a.1,hipaa_164.312.b,pci_dss_5.3,pci_dss_10.6.1</group>
    </rule>

    <rule id="91625" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^101$</field>
        <description>Office 365: Events related to using Outlook on the web (OWA) to search for mailbox items.</description>
        <options>no_full_log</options>
        <group>ExchangeSearch,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91626" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^102$</field>
        <description>Office 365: Events related to searching an organization's SharePoint home site.</description>
        <options>no_full_log</options>
        <group>SharePointSearch,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91627" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^103$</field>
        <description>Office 365: Privacy insight events.</description>
        <options>no_full_log</options>
        <group>PrivacyInsights,hipaa_164.312.b,pci_dss_10.6.1</group>
    </rule>

    <rule id="91628" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^105$</field>
        <description>Office 365: MyAnalytics events.</description>
        <options>no_full_log</options>
        <group>MyAnalyticsSettings,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91629" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^106$</field>
        <description>Office 365: Events related to modifying or deleting a user.</description>
        <options>no_full_log</options>
        <group>SecurityComplianceUserChange,hipaa_164.312.a.2.I,pci_dss_8.1.2,pci_dss_10.6.1</group>
    </rule>

    <rule id="91630" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^107$</field>
        <description>Office 365: Exchange DLP classification events.</description>
        <options>no_full_log</options>
        <group>ComplianceDLPExchangeClassification,hipaa_164.312.a.1,hipaa_164.312.b,hipaa_164.312.c.1,pci_dss_10.6.1,pci_dss_11.5</group>
    </rule>

    <rule id="91631" level="3">
        <if_sid>91532</if_sid>
        <field name="office365.RecordType" type="osregex">^109$</field>
        <description>Office 365: Exact Data Match (EDM) classification events.</description>
        <options>no_full_log</options>
        <group>MipExactDataMatch,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <!-- This rule capture internal event, 3 request fail.
        {"integration":"office365","office365":{"actor":"wazuh","tenant_id":"8CE4AF1D-20DC-4E7E-B306-1CEF89A3B898","subscription_name":"Audit.Exchange"}}
    -->
    <rule id="91648" level="3">
        <if_sid>91531</if_sid>
        <field name="office365.actor">wazuh</field>
        <description>Office 365 module internal event, 3 request fail.</description>
        <options>no_full_log</options>
    </rule>


    <!--
    ID: 91700 - 91799
    -->
    <!--
        MUST operations to cover
    -->
    <rule id="91700" level="14">
        <if_sid>91532</if_sid>
        <field name="office365.Operation" type="osregex">^FileMalwareDetected$</field>
        <description>Office 365: Detected malware in file $(office365.SourceFileName).</description>
        <options>no_full_log</options>
        <group>OneDrive,SharePoint,hipaa_164.312.b,pci_dss_10.6.1</group>
    </rule>

    <rule id="91701" level="5">
        <if_sid>91532</if_sid>
        <field name="office365.Operation" type="osregex">^DocumentSensitivityMismatchDetected$</field>
        <description>Office 365: Document sensitivity mismatch detected</description>
        <options>no_full_log</options>
        <group>OneDrive,SharePoint,pci_dss_10.6.1,hipaa_164.312.b</group>
    </rule>

    <rule id="91702" level="4">
        <if_sid>91532</if_sid>
        <field name="office365.Operation" type="osregex">^FileDownloaded$</field>
        <description>Office 365: User downloads a file.</description>
        <options>no_full_log</options>
        <group>OneDrive,SharePoint,hipaa_164.312.a.1,hipaa_164.312.b,pci_dss_10.6.2</group>
    </rule>

    <rule id="91703" level="6">
        <if_sid>91532</if_sid>
        <field name="office365.Operation" type="osregex">^PermissionLevelAdded$</field>
        <description>Office 365: A permission level was added to a site collection.</description>
        <options>no_full_log</options>
        <group>OneDrive,SharePoint,hipaa_164.312.a.1,hipaa_164.312.b,pci_dss_10.5.1</group>
    </rule>

    <rule id="91704" level="6">
        <if_sid>91532</if_sid>
        <field name="office365.Operation" type="osregex">^SharingInvitationBlocked$</field>
        <description>Office 365: Blocked sharing invitation</description>
        <options>no_full_log</options>
        <group>OneDrive,SharePoint,hipaa_164.312.a.1,hipaa_164.312.b,hipaa_164.312.e.2.I,pci_dss_1.3.2,pci_dss_7.1,pci_dss_10.2.4,pci_dss_10.6.1,pci_dss_11.4</group>
        <mitre>
            <id>T1136</id>
        </mitre>
    </rule>

    <rule id="91705" level="6">
        <if_sid>91532</if_sid>
        <field name="office365.Operation" type="osregex">^Add-MailboxPermission$</field>
        <description>Office 365: Added delegate mailbox permissions</description>
        <options>no_full_log</options>
        <group>Exchange,hipaa_164.312.a.1,hipaa_164.312.b,pci_dss_10.5.1,pci_dss_10.6.2</group>
    </rule>

    <rule id="91706" level="6">
        <if_sid>91532</if_sid>
        <field name="office365.Operation" type="osregex">^AddFolderPermissions$</field>
        <description>Office 365: Added permissions to folder</description>
        <options>no_full_log</options>
        <group>Exchange,hipaa_164.312.a.1,hipaa_164.312.b,pci_dss_10.5.1,pci_dss_10.6.2</group>
    </rule>

    <rule id="91707" level="4">
        <if_sid>91532</if_sid>
        <field name="office365.Operation" type="osregex">^Send$</field>
        <description>Office 365: Sent message</description>
        <options>no_full_log</options>
        <group>Exchange,hipaa_164.312.b,pci_dss_10.6.2</group>
        <mitre>
            <id>T1114.003</id>
        </mitre>
    </rule>

    <rule id="91708" level="6">
        <if_sid>91532</if_sid>
        <field name="office365.Operation" type="osregex">^SendAs|SendOnBehalf$</field>
        <description>Office 365: Sent message using different permissions</description>
        <options>no_full_log</options>
        <group>Exchange,hipaa_164.312.a.2.I,hipaa_164.312.b,pci_dss_8.1.2</group>
        <mitre>
            <id>T1114.003</id>
        </mitre>
    </rule>

    <rule id="91709" level="6">
        <if_sid>91532</if_sid>
        <field name="office365.Operation" type="osregex">^Add user.$</field>
        <description>Office 365: Added user</description>
        <options>no_full_log</options>
        <group>AzureActiveDirectory,hipaa_164.312.a.2.I,hipaa_164.312.b,pci_dss_8.1.2,pci_dss_10.6.2</group>
        <mitre>
            <id>T1078</id>
            <id>T1098.001</id>
        </mitre>
    </rule>

    <rule id="91710" level="6">
        <if_sid>91532</if_sid>
        <field name="office365.Operation" type="osregex">^Update user.$</field>
        <description>Office 365: Updated user</description>
        <options>no_full_log</options>
        <group>AzureActiveDirectory,hipaa_164.312.a.2.I,hipaa_164.312.b,pci_dss_8.1.2,pci_dss_10.6.2</group>
        <mitre>
            <id>T1078</id>
        </mitre>
    </rule>

    <rule id="91711" level="6">
        <if_sid>91532</if_sid>
        <field name="office365.Operation" type="osregex">^Add member to role.$</field>
        <description>Office 365: Add member to role</description>
        <options>no_full_log</options>
        <group>AzureActiveDirectory,pci_dss_8.1.2,hipaa_164.312.a.2.I</group>
        <mitre>
            <id>T1078</id>
        </mitre>
    </rule>

    <rule id="91712" level="6">
        <if_sid>91532</if_sid>
        <field name="office365.Operation" type="osregex">^Add group.$</field>
        <description>Office 365: Added group</description>
        <options>no_full_log</options>
        <group>AzureActiveDirectory,pci_dss_8.1.2,hipaa_164.312.a.2.I</group>
    </rule>

    <rule id="91713" level="6">
        <if_sid>91532</if_sid>
        <field name="office365.Operation" type="osregex">^Add member to group.$</field>
        <description>Office 365: Added member to group</description>
        <options>no_full_log</options>
        <group>AzureActiveDirectory,pci_dss_8.1.2,hipaa_164.312.a.2.I</group>
    </rule>

    <rule id="91714" level="6">
        <if_sid>91532</if_sid>
        <field name="office365.Operation" type="osregex">^Add service principal credentials.$</field>
        <description>Office 365: Added credentials to a service principal</description>
        <options>no_full_log</options>
        <group>AzureActiveDirectory,pci_dss_8.1.2,hipaa_164.312.a.2.I,pci_dss_10.2.5</group>
    </rule>

    <rule id="91715" level="6">
        <if_sid>91532</if_sid>
        <field name="office365.Operation" type="osregex">^CaseAdminUpdated$</field>
        <description>Office 365: Changed eDiscovery administrator membership</description>
        <options>no_full_log</options>
        <group>Discovery,hipaa_164.312.a.2.I,pci_dss_8.1.2,pci_dss_10.2.5</group>
        <mitre>
            <id>T1526</id>
        </mitre>
    </rule>

    <rule id="91716" level="6">
        <if_sid>91532</if_sid>
        <field name="office365.Operation" type="osregex">^CaseAdminAdded$</field>
        <description>Office 365: Created eDiscovery administrator</description>
        <options>no_full_log</options>
        <group>Discovery,pci_dss_8.1.2,hipaa_164.312.a.2.I,pci_dss_10.2.5</group>
        <mitre>
            <id>T1526</id>
        </mitre>
    </rule>

    <rule id="91717" level="6">
        <if_sid>91532</if_sid>
        <field name="office365.Operation" type="osregex">^CaseAdded$</field>
        <description>Office 365: Created eDiscovery case</description>
        <options>no_full_log</options>
        <group>Discovery,hipaa_164.312.a.1</group>
        <mitre>
            <id>T1526</id>
        </mitre>
    </rule>

    <rule id="91718" level="6">
        <if_sid>91532</if_sid>
        <field name="office365.Operation" type="osregex">^SearchCreated$</field>
        <description>Office 365: Created content search</description>
        <options>no_full_log</options>
        <group>Discovery,hipaa_164.312.a.1</group>
        <mitre>
            <id>T1526</id>
        </mitre>
    </rule>

    <rule id="91719" level="4">
        <if_sid>91532</if_sid>
        <field name="office365.Operation" type="osregex">^QuarantineDelete$</field>
        <description>Office 365: Deleted quarantine message</description>
        <options>no_full_log</options>
        <group>Exchange,hipaa_164.312.a.1,hipaa_164.312.b,pci_dss_5.3,pci_dss_10.6.1,pci_dss_11.4,pci_dss_11.5</group>
    </rule>

    <rule id="91720" level="12">
        <if_sid>91532</if_sid>
        <field name="office365.Operation" type="osregex">^QuarantineExport$</field>
        <description>Office 365: Exported quarantine message</description>
        <options>no_full_log</options>
        <group>Exchange,hipaa_164.312.a.1,hipaa_164.312.b,pci_dss_5.3,pci_dss_10.6.1,pci_dss_11.4,pci_dss_11.5</group>
    </rule>

    <rule id="91721" level="6">
        <if_sid>91532</if_sid>
        <field name="office365.Operation" type="osregex">^QuarantinePreview$</field>
        <description>Office 365: Previewed quarantine message</description>
        <options>no_full_log</options>
        <group>Exchange,hipaa_164.312.a.1,hipaa_164.312.b,pci_dss_5.3,pci_dss_10.6.1,pci_dss_11.4,pci_dss_11.5</group>
    </rule>

    <rule id="91722" level="12">
        <if_sid>91532</if_sid>
        <field name="office365.Operation" type="osregex">^QuarantineRelease$</field>
        <description>Office 365: Released quarantine message</description>
        <options>no_full_log</options>
        <group>Exchange,hipaa_164.312.a.1,hipaa_164.312.b,pci_dss_5.3,pci_dss_10.2.2,pci_dss_10.6.1,pci_dss_11.4,pci_dss_11.5</group>
    </rule>

    <rule id="91723" level="6">
        <if_sid>91532</if_sid>
        <field name="office365.Operation" type="osregex">^QuarantineViewHeader$</field>
        <description>Office 365: Viewed quarantine message's header</description>
        <options>no_full_log</options>
        <group>Exchange,hipaa_164.312.a.1,hipaa_164.312.b,pci_dss_5.3,pci_dss_10.6.1,pci_dss_11.4,pci_dss_11.5</group>
    </rule>

    <!--
        Advanced Detections
    -->
    <rule id="91724" level="10" frequency="100" timeframe="60" ignore="30">
        <if_matched_sid>91702</if_matched_sid>
        <same_field>office365.UserId</same_field>
        <description>Office 365: Suspicious download activity by user: $(office365.UserId)</description>
        <options>no_full_log</options>
        <group>OneDrive,SharePoint</group>
        <mitre>
            <id>T1213.002</id>
        </mitre>
    </rule>

    <rule id="91725" level="10">
        <if_sid>91705</if_sid>
        <field name="office365.Parameters" type="pcre2">\"Value\":\s*\"FullAccess\"</field>
        <description>Office 365: User $(office365.UserId) got FullAccess permissions in Exchange</description>
        <options>no_full_log</options>
        <group>Exchange,hipaa_164.312.a.1,pci_dss_10.2.2</group>
        <mitre>
            <id>T1098.002</id>
        </mitre>
    </rule>
</group>
