<!--
  -  Vulnerability detector module rules
  -  Created by Wazuh, Inc.
  -  Copyright (C) 2015, Wazuh Inc.
  -  This program is a free software; you can redistribute it and/or modify it under the terms of GPLv2.
-->

<group name="vulnerability-detector,gdpr_IV_35.7.d,pci_dss_11.2.1,pci_dss_11.2.3,tsc_CC7.1,tsc_CC7.2,">
  <rule id="23501" level="0">
    <decoded_as>json</decoded_as>
    <options>no_full_log</options>
    <field name="vulnerability.cve">\.+</field>
    <description>$(vulnerability.cve) affects $(vulnerability.package.name)</description>
  </rule>

  <rule id="23502" level="3">
      <if_sid>23501</if_sid>
      <options>no_full_log</options>
      <field name="vulnerability.status">Solved</field>
      <description>The $(vulnerability.cve) that affected $(vulnerability.package.name) was solved due to an update in the agent or feed.</description>
  </rule>

  <rule id="23503" level="5">
      <if_sid>23501</if_sid>
      <options>no_full_log</options>
      <field name="vulnerability.status">Active</field>
      <field name="vulnerability.severity">Low</field>
      <description>$(vulnerability.cve) affects $(vulnerability.package.name)</description>
  </rule>

  <rule id="23504" level="7">
      <if_sid>23501</if_sid>
      <options>no_full_log</options>
      <field name="vulnerability.status">Active</field>
      <field name="vulnerability.severity">Medium|Untriaged</field>
      <description>$(vulnerability.cve) affects $(vulnerability.package.name)</description>
  </rule>

  <rule id="23505" level="10">
      <if_sid>23501</if_sid>
      <options>no_full_log</options>
      <field name="vulnerability.status">Active</field>
      <field name="vulnerability.severity">High</field>
      <description>$(vulnerability.cve) affects $(vulnerability.package.name)</description>
  </rule>

  <rule id="23506" level="13">
      <if_sid>23501</if_sid>
      <options>no_full_log</options>
      <field name="vulnerability.status">Active</field>
      <field name="vulnerability.severity">Critical</field>
      <description>$(vulnerability.cve) affects $(vulnerability.package.name)</description>
  </rule>

  <rule id="23507" level="3">
    <decoded_as>json</decoded_as>
    <options>no_full_log</options>
    <field name="vulnerability.status">Clear</field>
    <description>Vulnerabilities cleared</description>
  </rule>

</group>
