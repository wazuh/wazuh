name: decoder/windows-json/0

metadata:
  description: Partial parent decoder for Windows events
  module: Windows
  compatibility: >
    This decoder has been tested on Wazuh version 4.3
  author:
    name: Wazuh, Inc.
    date: 2023/01/23
  title: This decoder processes event coming through Windows Event Channel queue
  references:
    - https://learn.microsoft.com/en-us/windows/win32/events/windows-events

sources:
  - decoder/integrations/0

check:
  - event.original: +starts_with/{

parse:
  logpar:
    - event.original: <~json/json>

normalize:
 - map:
    - wazuh.decoders: +array_append/windows-json
