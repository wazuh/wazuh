# WAZUH SYSTEM FILE, PLEASE DO NOT MODIFY

default_policies:
  agents_all:
    description: Grant full access to all agents related functionalities.
    policies:
      resourceless:
        actions:
          - agent:create
          - group:create
          - agent:uninstall
        resources:
          - '*:*:*'
        effect: allow
      agents:
        actions:
          - agent:read
          - agent:delete
          - agent:modify_group
          - agent:reconnect
          - agent:restart
          - agent:upgrade
        resources:
          - agent:id:*
          - agent:group:*
        effect: allow
      groups:
        actions:
          - group:read
          - group:delete
          - group:update_config
          - group:modify_assignments
        resources:
          - group:id:*
        effect: allow

  agents_read:
    description: Grant read access to all agents related functionalities.
    policies:
      agents:
        actions:
          - agent:read
        resources:
          - agent:id:*
          - agent:group:*
        effect: allow
      groups:
        actions:
          - group:read
        resources:
          - group:id:*
        effect: allow

  agents_commands:
    description: Allow sending commands to agents.
    policies:
      agents:
        actions:
          - active-response:command
        resources:
          - agent:id:*
        effect: allow

  security_all:
    description: Provide full access to all security related functionalities.
    policies:
      resourceless:
        actions:
          - security:create
          - security:create_user
          - security:read_config
          - security:update_config
          - security:revoke
          - security:edit_run_as
        resources:
          - '*:*:*'
        effect: allow
      security:
        actions:
          - security:read
          - security:update
          - security:delete
        resources:
          - role:id:*
          - policy:id:*
          - user:id:*
          - rule:id:*
        effect: allow

  users_all:
    description: Provide full access to all users related functionalities.
    policies:
      resourceless:
        actions:
          - security:create_user
          - security:revoke
          - security:edit_run_as
        resources:
          - '*:*:*'
        effect: allow
      users:
        actions:
          - security:read
          - security:update
          - security:delete
        resources:
          - user:id:*
        effect: allow

  users_modify_run_as:
    description: Allow changing the allow_run_as value of the users.
    policies:
      flag:
        actions:
          - security:edit_run_as
        resources:
          - '*:*:*'
        effect: allow

  mitre_read:
    description: Allow read MITRE database information.
    policies:
      mitre:
        actions:
          - mitre:read
        resources:
          - '*:*:*'
        effect: allow

  integrations_order_read:
    description: Allow reading integrations order.
    policies:
      integrations_order:
        actions:
          - asset:read
        resources:
          - 'content:space:*'
        effect: allow

  integrations_order_all:
    description: Allow managing integrations order.
    policies:
      integrations_order:
        actions:
          - asset:read
          - asset:update
        resources:
          - 'content:space:draft'
        effect: allow

  assets_read:
    description: Allow reading assets.
    policies:
      assets:
        actions:
          - asset:read
        resources:
          - 'content:space:*'
        effect: allow

  assets_all:
    description: Allow managing all assets.
    policies:
      assets:
        actions:
          - asset:create
          - asset:read
          - asset:update
          - asset:delete
        resources:
          - 'content:space:draft'
        effect: allow

  catalog_read:
    description: Allow reading the catalog.
    policies:
      catalog:
        actions:
          - asset:read
        resources:
          - 'content:space:*'
        effect: allow 

  rootcheck_run:
    description: Allow run rootcheck.
    policies:
      rootcheck:
        actions:
          - rootcheck:run
        resources:
          - agent:id:*
        effect: allow

  rules_read:
    description: Allow reading all rule files in the system.
    policies:
      rules:
        actions:
          - rules:read
        resources:
          - rule:file:*
        effect: allow

  rules_all:
    description: Allow managing all rule files in the system.
    policies:
      files:
        actions:
          - rules:read
          - rules:delete
        resources:
          - rule:file:*
        effect: allow
      resourceless:
        actions:
          - rules:update
        resources:
          - '*:*:*'
        effect: allow

  syscheck_run:
    description: Allow run syscheck
    policies:
      syscheck:
        actions:
          - syscheck:run
        resources:
          - agent:id:*
        effect: allow

  cluster_all:
    description: Provide full access to all cluster related functionalities.
    policies:
      resourceless:
        actions:
          - cluster:status
          - cluster:update_config
          - cluster:restart
        resources:
          - '*:*:*'
        effect: allow
      nodes:
        actions:
          - cluster:read_api_config
          - cluster:read
          - cluster:restart
          - cluster:update_config
        resources:
          - node:id:*
        effect: allow

  cluster_read:
    description: Provide read access to all cluster related functionalities.
    policies:
      resourceless:
        actions:
          - cluster:status
          - cluster:read
          - cluster:read_api_config
        resources:
          - '*:*:*'
        effect: allow
      nodes:
        actions:
          - cluster:read_api_config
          - cluster:read
        resources:
          - node:id:*
        effect: allow

  logtest_all:
    description: Provide access to all logtest related functionalities.
    policies:
      logtest:
        actions:
          - logtest:run
        resources:
          - '*:*:*'
        effect: allow

  task_status:
    description: Provide permissions to check the status of tasks
    policies:
      task:
        actions:
          - task:status
        resources:
          - '*:*:*'
        effect: allow

  events_ingest:
    description: Allow ingesting events.
    policies:
      resourceless:
        actions:
          - event:ingest
        resources:
          - '*:*:*'
        effect: allow
