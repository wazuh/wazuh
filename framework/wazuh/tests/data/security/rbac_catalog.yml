---
get_rbac_actions:
  - params:
      endpoint: GET /agents
    result:
      agent:read:
        description: Access to one or more agents basic information (id, name, group, last
          keep alive, etc)
        resources:
          - "$ref": "#/x-rbac-catalog/resources/agent:id"
        example:
          actions:
            - agent:read
          resources:
            - agent:id:*
          effect: allow
        related_endpoints:
          - GET /agents
  - params:
      endpoint: DELETE /agents/{agent_id}/group
    result:
      agent:modify_group:
        description: Change the group of specified agent
        resources:
          - "$ref": "#/x-rbac-catalog/resources/agent:id"
        example:
          actions:
            - agent:modify_group
          resources:
            - agent:id:*
          effect: allow
        related_endpoints:
          - DELETE /agents/{agent_id}/group
      group:modify_assignments:
        description: Allow to change the agents assigned to the group
        resources:
          - "$ref": "#/x-rbac-catalog/resources/group:id"
        example:
          actions:
            - group:modify_assignments
          resources:
            - group:id:*
          effect: allow
        related_endpoints:
          - DELETE /agents/{agent_id}/group
  - params:
      endpoint: /
    result: {}
  - params:
      endpoint: None
    result:
      active-response:command:
        description: Allow to execute active response commands in the agents
        resources:
          - "$ref": "#/x-rbac-catalog/resources/agent:id"
        example:
          actions:
            - active-response:command
          resources:
            - agent:id:001
          effect: allow
        related_endpoints:
          - PUT /active-response
      agent:delete:
        description: Delete system's agents
        resources:
          - "$ref": "#/x-rbac-catalog/resources/agent:id"
        example:
          actions:
            - agent:delete
          resources:
            - agent:id:010
          effect: allow
        related_endpoints:
          - DELETE /agents
      agent:read:
        description: Access to one or more agents basic information (id, name, group, last
          keep alive, etc)
        resources:
          - "$ref": "#/x-rbac-catalog/resources/agent:id"
        example:
          actions:
            - agent:read
          resources:
            - agent:id:*
          effect: allow
        related_endpoints:
          - GET /agents
          - GET /agents/{agent_id}/config/{component}/{configuration}
          - GET /agents/{agent_id}/group/is_sync
          - GET /agents/{agent_id}/key
          - GET /agents/no_group
          - GET /agents/outdated
          - GET /agents/stats/distinct
          - GET /agents/summary/os
          - GET /agents/summary/status
          - GET /ciscat/{agent_id}/results
          - GET /overview/agents
      agent:create:
        description: Create new agents
        resources:
          - "$ref": "#/x-rbac-catalog/resources/*:*"
        example:
          actions:
            - agent:create
          resources:
            - "*:*:*"
          effect: allow
        related_endpoints:
          - POST /agents
          - POST /agents/insert
          - POST /agents/insert/quick
      agent:modify_group:
        description: Change the group of specified agent
        resources:
          - "$ref": "#/x-rbac-catalog/resources/agent:id"
        example:
          actions:
            - agent:modify_group
          resources:
            - agent:id:*
          effect: allow
        related_endpoints:
          - DELETE /agents/{agent_id}/group
          - DELETE /agents/{agent_id}/group/{group_id}
          - PUT /agents/{agent_id}/group/{group_id}
          - DELETE /agents/group
          - PUT /agents/group
      group:modify_assignments:
        description: Allow to change the agents assigned to the group
        resources:
          - "$ref": "#/x-rbac-catalog/resources/group:id"
        example:
          actions:
            - group:modify_assignments
          resources:
            - group:id:*
          effect: allow
        related_endpoints:
          - DELETE /agents/{agent_id}/group
          - DELETE /agents/{agent_id}/group/{group_id}
          - PUT /agents/{agent_id}/group/{group_id}
          - DELETE /agents/group
          - PUT /agents/group
      agent:restart:
        description: Restart Wazuh for allowed agents
        resources:
          - "$ref": "#/x-rbac-catalog/resources/agent:id"
        example:
          actions:
            - agent:restart
          resources:
            - agent:id:050
            - agent:id:049
          effect: deny
        related_endpoints:
          - PUT /agents/{agent_id}/restart
          - PUT /agents/restart
      agent:upgrade:
        description: Upgrade the version of an agent
        resources:
          - "$ref": "#/x-rbac-catalog/resources/agent:id"
        example:
          actions:
            - agent:upgrade
          resources:
            - agent:id:*
          effect: allow
        related_endpoints:
          - PUT /agents/{agent_id}/upgrade
          - PUT /agents/{agent_id}/upgrade_custom
          - GET /agents/{agent_id}/upgrade_result
      group:delete:
        description: Delete system's groups
        resources:
          - "$ref": "#/x-rbac-catalog/resources/group:id"
        example:
          actions:
            - group:delete
          resources:
            - group:id:*
          effect: allow
        related_endpoints:
          - DELETE /groups
          - GET /groups/{group_id}/files
          - GET /groups/{group_id}/files/{file_name}/json
          - GET /groups/{group_id}/files/{file_name}/xml
      group:read:
        description: Access to one or more groups basic information (id, name, agents, etc)
        resources:
          - "$ref": "#/x-rbac-catalog/resources/*:*"
        example:
          actions:
            - group:create
          resources:
            - "*:*:*"
          effect: allow
        related_endpoints:
          - GET /groups
          - GET /groups/{group_id}/agents
          - GET /groups/{group_id}/configuration
          - GET /overview/agents
      group:create:
        description: Create new groups
        resources:
          - "$ref": "#/x-rbac-catalog/resources/*:*"
        example:
          actions:
            - group:create
          resources:
            - "*:*:*"
          effect: allow
        related_endpoints:
          - POST /groups
      group:update_config:
        description: Change group's configuration
        resources:
          - "$ref": "#/x-rbac-catalog/resources/group:id"
        example:
          actions:
            - group:update_config
          resources:
            - group:id:*
          effect: deny
        related_endpoints:
          - PUT /groups/{group_id}/configuration
      cluster:read_config:
        description: Read Wazuh's cluster configuration
        resources:
          - "$ref": "#/x-rbac-catalog/resources/node:id"
        example:
          actions:
            - cluster:read_config
          resources:
            - node:id:worker1
            - node:id:worker3
          effect: deny
        related_endpoints:
          - GET /cluster/local/info
          - GET /cluster/nodes
          - GET /cluster/healthcheck
          - GET /cluster/local/config
          - GET /cluster/{node_id}/info
          - GET /cluster/{node_id}/configuration
          - GET /cluster/{node_id}/stats
          - GET /cluster/{node_id}/stats/hourly
          - GET /cluster/{node_id}/stats/weekly
          - GET /cluster/{node_id}/stats/analysisd
          - GET /cluster/{node_id}/stats/remoted
          - GET /cluster/{node_id}/logs
          - GET /cluster/{node_id}/logs/summary
          - GET /cluster/configuration/validation
          - GET /cluster/{node_id}/configuration/{component}/{configuration}
      cluster:status:
        description: Check Wazuh's cluster status
        resources:
          - "$ref": "#/x-rbac-catalog/resources/*:*"
        example:
          actions:
            - cluster:status
          resources:
            - "*:*:*"
          effect: allow
        related_endpoints:
          - GET /cluster/status
          - GET /cluster/{node_id}/status
      cluster:read_file:
        description: Read Wazuh's cluster files
        resources:
          - "$ref": "#/x-rbac-catalog/resources/node:id"
          - "$ref": "#/x-rbac-catalog/resources/file:path"
        example:
          actions:
            - cluster:read_file
          resources:
            - node:id:worker1
            - file:path:etc/rules/new-rules.xml
          effect: allow
        related_endpoints:
          - GET /cluster/{node_id}/files
      cluster:upload_file:
        description: Upload new file to Wazuh's cluster node
        resources:
          - "$ref": "#/x-rbac-catalog/resources/node:id"
        example:
          actions:
            - cluster:upload_file
          resources:
            - node:id:worker1
          effect: allow
        related_endpoints:
          - PUT /cluster/{node_id}/files
      cluster:delete_file:
        description: Delete Wazuh's cluster files
        resources:
          - "$ref": "#/x-rbac-catalog/resources/node:id"
          - "$ref": "#/x-rbac-catalog/resources/file:path"
        example:
          actions:
            - cluster:delete_file
          resources:
            - node:id:worker1
            - file:path:etc/rules/new-rules.xml
          effect: deny
        related_endpoints:
          - DELETE /cluster/{node_id}/files
      cluster:restart:
        description: Restart Wazuh's cluster nodes
        resources:
          - "$ref": "#/x-rbac-catalog/resources/node:id"
        example:
          actions:
            - cluster:restart
          resources:
            - node:id:worker1
          effect: allow
        related_endpoints:
          - PUT /cluster/restart
      lists:read:
        description: Read lists files
        resources:
          - "$ref": "#/x-rbac-catalog/resources/lists:path"
        example:
          actions:
            - lists:read
          resources:
            - lists:path:etc/lists/audit-keys
          effect: deny
        related_endpoints:
          - GET /lists
          - GET /lists/files
      manager:status:
        description: Check Wazuh manager status
        resources:
          - "$ref": "#/x-rbac-catalog/resources/*:*"
        example:
          actions:
            - manager:status
          resources:
            - "*:*:*"
          effect: deny
        related_endpoints:
          - GET /manager/status
      manager:read_config:
        description: Read Wazuh manager configuration
        resources:
          - "$ref": "#/x-rbac-catalog/resources/*:*"
        example:
          actions:
            - manager:read_config
          resources:
            - "*:*:*"
          effect: allow
        related_endpoints:
          - GET /manager/info
          - GET /manager/configuration
          - GET /manager/stats
          - GET /manager/stats/hourly
          - GET /manager/stats/weekly
          - GET /manager/stats/analysisd
          - GET /manager/stats/remoted
          - GET /manager/logs
          - GET /manager/logs/summary
          - GET /manager/configuration/validation
          - GET /manager/configuration/{component}/{configuration}
      manager:read_file:
        description: Read Wazuh manager files
        resources:
          - "$ref": "#/x-rbac-catalog/resources/file:path"
        example:
          actions:
            - manager:read_file
          resources:
            - file:path:etc/rules/new-rules.xml
          effect: allow
        related_endpoints:
          - GET /manager/files
      manager:upload_file:
        description: Upload new file to Wazuh manager node
        resources:
          - "$ref": "#/x-rbac-catalog/resources/*:*"
        example:
          actions:
            - manager:upload_file
          resources:
            - "*:*:*"
          effect: deny
        related_endpoints:
          - PUT /manager/files
      manager:delete_file:
        description: Delete Wazuh manager files
        resources:
          - "$ref": "#/x-rbac-catalog/resources/file:path"
        example:
          actions:
            - manager:delete_file
          resources:
            - file:path:etc/rules/new-rules.xml
          effect: allow
        related_endpoints:
          - DELETE /manager/files
      manager:restart:
        description: Restart Wazuh manager nodes
        resources:
          - "$ref": "#/x-rbac-catalog/resources/*:*"
        example:
          actions:
            - manager:restart
          resources:
            - "*:*:*"
          effect: deny
        related_endpoints:
          - PUT /manager/restart
      rules:read:
        description: Read rules files
        resources:
          - "$ref": "#/x-rbac-catalog/resources/rules:file"
        example:
          actions:
            - rules:read
          resources:
            - rules:file:0610-win-ms_logs_rules.xml
          effect: allow
        related_endpoints:
          - GET /rules
          - GET /rules/groups
          - GET /rules/requirement/{requirement}
          - GET /rules/files
          - GET /rules/files/{filename}/download
      sca:read:
        description: Get a list of policies analyzed in the configuration assessment for
          a given agent
        resources:
          - "$ref": "#/x-rbac-catalog/resources/agent:id"
        example:
          actions:
            - sca:read
          resources:
            - agent:id:*
          effect: allow
        related_endpoints:
          - GET /sca/{agent_id}
          - GET /sca/{agent_id}/checks/{policy_id}
      syscheck:run:
        description: Runs rootcheck and syscheck
        resources:
          - "$ref": "#/x-rbac-catalog/resources/agent:id"
        example:
          actions:
            - syscheck:run
          resources:
            - agent:id:*
          effect: allow
        related_endpoints:
          - PUT /syscheck
      syscheck:read:
        description: Read information from syscheck's database
        resources:
          - "$ref": "#/x-rbac-catalog/resources/agent:id"
        example:
          actions:
            - syscheck:read
          resources:
            - agent:id:011
          effect: allow
        related_endpoints:
          - GET /syscheck/{agent_id}
          - GET /syscheck/{agent_id}/last_scan
      syscheck:clear:
        description: Clear the syscheck database for specified agents
        resources:
          - "$ref": "#/x-rbac-catalog/resources/agent:id"
        example:
          actions:
            - syscheck:clear
          resources:
            - agent:id:*
          effect: deny
        related_endpoints:
          - DELETE /syscheck/{agent_id}
          - DELETE /experimental/syscheck
      decoder:read:
        description: Read decoders files
        resources:
          - "$ref": "#/x-rbac-catalog/resources/decoder:file"
        example:
          actions:
            - decoder:read
          resources:
            - decoder:file:*
          effect: allow
        related_endpoints:
          - GET /decoders
          - GET /decoders/files
          - GET /decoders/files/{filename}/download
          - GET /decoders/parents
      ciscat:read:
        description: Get CIS-CAT results for a list of agents
        resources:
          - "$ref": "#/x-rbac-catalog/resources/agent:id"
        example:
          actions:
            - ciscat:read
          resources:
            - agent:id:001
            - agent:id:003
          effect: deny
        related_endpoints:
          - GET /experimental/ciscat/results
      syscollector:read:
        description: Get syscollector information about a specified agents
        resources:
          - "$ref": "#/x-rbac-catalog/resources/agent:id"
        example:
          actions:
            - syscollector:read
          resources:
            - agent:id:*
          effect: allow
        related_endpoints:
          - GET /experimental/syscollector/hardware
          - GET /experimental/syscollector/netaddr
          - GET /experimental/syscollector/netiface
          - GET /experimental/syscollector/netproto
          - GET /experimental/syscollector/os
          - GET /experimental/syscollector/packages
          - GET /experimental/syscollector/ports
          - GET /experimental/syscollector/processes
          - GET /experimental/syscollector/hotfixes
          - GET /syscollector/{agent_id}/hardware
          - GET /syscollector/{agent_id}/hotfixes
          - GET /syscollector/{agent_id}/netaddr
          - GET /syscollector/{agent_id}/netiface
          - GET /syscollector/{agent_id}/netproto
          - GET /syscollector/{agent_id}/os
          - GET /syscollector/{agent_id}/packages
          - GET /syscollector/{agent_id}/ports
          - GET /syscollector/{agent_id}/processes
      security:read:
        description: Allow read information about system's security resources
        resources:
          - "$ref": "#/x-rbac-catalog/resources/policy:id"
          - "$ref": "#/x-rbac-catalog/resources/role:id"
          - "$ref": "#/x-rbac-catalog/resources/user:id"
        example:
          actions:
            - security:read
          resources:
            - policy:id:*
            - role:id:administrator
            - user:id:python
          effect: allow
        related_endpoints:
          - GET /security/roles
          - GET /security/policies
          - GET /security/users
      security:create:
        description: Create new system's security resources
        resources:
          - "$ref": "#/x-rbac-catalog/resources/*:*"
        example:
          actions:
            - security:create
          resources:
            - "*:*:*"
          effect: deny
        related_endpoints:
          - POST /security/roles
          - POST /security/policies
          - POST /security/roles/{role_id}/policies
          - POST /security/users/{username}/roles
          - POST /security/users
      security:delete:
        description: Delete system's security resources
        resources:
          - "$ref": "#/x-rbac-catalog/resources/policy:id"
          - "$ref": "#/x-rbac-catalog/resources/role:id"
          - "$ref": "#/x-rbac-catalog/resources/user:id"
        example:
          actions:
            - security:update
          resources:
            - policy:id:*
            - role:id:administrator
            - user:id:python
          effect: deny
        related_endpoints:
          - DELETE /security/roles
          - DELETE /security/policies
          - DELETE /security/roles/{role_id}/policies
          - DELETE /security/users/{username}/roles
          - DELETE /security/users
      security:update:
        description: Allow update the information of system's security resources
        resources:
          - "$ref": "#/x-rbac-catalog/resources/policy:id"
          - "$ref": "#/x-rbac-catalog/resources/role:id"
          - "$ref": "#/x-rbac-catalog/resources/user:id"
        example:
          actions:
            - security:update
          resources:
            - policy:id:*
            - role:id:administrator
            - user:id:python
          effect: deny
        related_endpoints:
          - PUT /security/roles/{role_id}
          - PUT /security/policies/{policy_id}
          - PUT /security/users/{username}
get_rbac_resources:
  - params:
      dummy: None
    result:
      "*:*":
        description: 'Resource applied in functions acting on resources that do not yet
          exist in the system We call these functions, resourceless functions. Example:
          agent:create'
      agent:id:
        description: Reference agents via agent ID (i.e. agent:id:001)
      group:id:
        description: Reference agent groups via group ID (i.e. group:id:default)
      node:id:
        description: Reference cluster node via node ID (i.e. node:id:worker1)
      file:path:
        description: Reference file via its path (i.e. file:path:etc/rules/new_rule.xml)
      decoder:file:
        description: Reference decoder file via its path (i.e. decoder:file:0005-wazuh_decoders.xml)
      lists:path:
        description: Reference list file via its path (i.e. lists:path:etc/lists/audit-keys)
      rules:file:
        description: Reference rule file via its path (i.e. rules:file:0610-win-ms_logs_rules.xml)
      policy:id:
        description: Reference security policy via its id (i.e. policy:id:1)
      role:id:
        description: Reference security role via its id (i.e. role:id:1)
      user:id:
        description: Reference security user via its username (i.e. user:id:wazuh)

